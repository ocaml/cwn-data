<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-01-03 Tue 10:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2022.12.27.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2023.01.10.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of December 27, 2022 to January 03, 2023.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Diskuv OCaml 1.1.0 - Windows MSVC</a></li>
<li><a href="#2">OCaml.org: recapping 2022 and queries on the Fediverse</a></li>
<li><a href="#org241ca51">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Diskuv OCaml 1.1.0 - Windows MSVC</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-diskuv-ocaml-1-1-0-windows-msvc/11077/1">https://discuss.ocaml.org/t/ann-diskuv-ocaml-1-1-0-windows-msvc/11077/1</a>
</p>
</div>

<div id="outline-container-org672ab9c" class="outline-3">
<h3 id="org672ab9c">jbeckford announced</h3>
<div class="outline-text-3" id="text-org672ab9c">
<p>
I&rsquo;m pleased to announce the release 1.1.0 of DKML (Diskuv OCaml) at
<a href="https://github.com/diskuv/dkml-installer-ocaml/releases/tag/v1.1.0_r2">https://github.com/diskuv/dkml-installer-ocaml/releases/tag/v1.1.0_r2</a>.
As usual the DKML distribution supports the Visual Studio compiler on Windows. After the 90-minute installer finishes you will have
a working environment where <code>dune build</code> and <code>utop</code> work immediately. The installed OCaml language server works in VS Code using the
installed <code>dkml</code> switch with a single VS Code option change (see <i>Full docs</i>). Creating a new local opam switch with an
<code>ocaml-system</code> compiler takes about 90 seconds with <code>dkml init</code>. <i>Full docs</i> are at
<a href="https://diskuv-ocaml.gitlab.io/distributions/dkml/index.html#introduction">https://diskuv-ocaml.gitlab.io/distributions/dkml/index.html#introduction</a>.
</p>

<p>
There are many new features and changes, so please browse the following release notes:
</p>

<p>
Quick Links:
</p>
<dl class="org-dl">
<dt>Installer</dt><dd><a href="https://github.com/diskuv/dkml-installer-ocaml/releases/download/v1.1.0_r2/setup-diskuv-ocaml-windows_x86_64-1.1.0.exe">https://github.com/diskuv/dkml-installer-ocaml/releases/download/v1.1.0_r2/setup-diskuv-ocaml-windows_x86_64-1.1.0.exe</a></dd>
<dt>Uninstaller</dt><dd><a href="https://github.com/diskuv/dkml-installer-ocaml/releases/download/v1.1.0_r2/uninstall-diskuv-ocaml-windows_x86_64-1.1.0.exe">https://github.com/diskuv/dkml-installer-ocaml/releases/download/v1.1.0_r2/uninstall-diskuv-ocaml-windows_x86_64-1.1.0.exe</a></dd>
</dl>

<p>
<b>Upgrading from 1.0.1?</b>
</p>
<ol class="org-ol">
<li>Uninstall the old version first with the uninstaller above!</li>
<li><p>
After uninstalling the old version, run the following in PowerShell:
</p>
<pre class="example" id="org09bdb65">
   if (Test-Path "$env:LOCALAPPDATA\opam\playground") { Remove-Item -Path "$env:LOCALAPPDATA\opam\playground" -Force -Recurse }
</pre></li>
<li>Exit Visual Studio Code and any <code>utop</code> or <code>ocaml</code> sessions. Then use the installer above.</li>
<li><p>
After installing the new version, run the following in PowerShell <b>in each directory that has a local opam switch</b> to upgrade to OCaml 4.14.0 and all the other package versions that come with DKML 1.1.0:
</p>
<pre class="example" id="org2161bd6">
   # Sometimes ~dkml init~ can fail, but you are OK as long as you see:
   # ...  upgrade   ocaml-system                       4.12.1 to 4.14.0
   dkml init

   opam upgrade
   opam install . --deps-only --with-test
</pre></li>
</ol>

<p>
Cautions:
</p>
<ul class="org-ul">
<li>Do not use this distribution if you have a space in your username (ex. <code>C:\Users\Jane Smith</code>). Sorry, but the broader OCaml ecosystem does not yet consistently support spaces in directories.</li>
<li>Your Windows anti-virus may play havoc with the installer. If possible, temporarily disable your anti-virus (the &ldquo;realtime protection&rdquo;, &ldquo;exploit protection&rdquo; and/or &ldquo;malware protection&rdquo; options). Some anti-virus products include a button to temporarily disable AV protection for two hours; do that. <i>If you forget and the installer fails, you will need to disable AV protection, run the uninstaller, and then rerun the installer!</i></li>
</ul>

<p>
New features:
</p>
<ul class="org-ul">
<li>The system OCaml is 4.14.0 (was 4.12.1)</li>
<li>The system includes ocamlnat, the experimental native toplevel. It should be run using <code>with-dkml ocamlnat</code> so native code is compiled with Visual Studio.</li>
<li>Add odoc 2.1.0 to user PATH, to align with the <a href="https://ocaml.org/docs/platform">OCaml Platform</a>.</li>
<li>Relocatable native binaries are installed rather than compiled into place. Installations should be quicker, which is a pre-requisite for <code>winget install</code> (pending!) on Windows.</li>
<li>Add opam global variable <code>sys-pkg-manager-cmd-msys2</code> for future compatibility with opam 2.2 depext support of MSYS2</li>
<li>The <code>opam dkml init</code> command is now <code>dkml init</code>. The <code>dkml</code> executable is precompiled and shaves ~20 minutes of installation time.</li>
</ul>

<p>
New security:
</p>
<ul class="org-ul">
<li><p>
(Advanced; experimental) If you are behind a corporate firewall that uses man-in-the-middle (MITM) TLS proxying, you can install your corporate CA chain so DKML, in particular MSYS2, does not reject connections. Only persons with write access to <code>$env:ProgramData\DiskuvOCaml\conf\unixutils.sexp</code> will be able to define the allowed MITM TLS chain; you may need access from your corporate Administrator. An example <code>unixutils.sexp</code> is:
</p>

<div class="org-src-container">
<pre class="src src-scheme">  (
      (trust_anchors (<span style="color: #ca3400;">"C:\\conf\\my.pem"</span> <span style="color: #ca3400;">"D:\\conf\\my.cer"</span>))
  )
</pre>
</div>

<p>
You specify one or more <code>.pem</code> or <code>.cer</code> CA files, making sure to use two backslashes to escape your paths. Your Administrator may have already placed the CA files on your machine; otherwise use the guide at <a href="https://www.msys2.org/docs/faq/#how-can-i-make-msys2pacman-trust-my-companys-custom-tls-ca-certificate">https://www.msys2.org/docs/faq/#how-can-i-make-msys2pacman-trust-my-companys-custom-tls-ca-certificate</a> to copy them from your web browsers.
</p></li>
</ul>

<p>
Not so good problems:
</p>
<ul class="org-ul">
<li><a href="https://github.com/diskuv/dkml-installer-ocaml/issues/21">Known bug #21</a> To install the OCaml language server in a new switch you will need to first do <code>opam pin remove fiber omd stdune dyn ordering --no-action</code> before doing <code>opam install ocaml-lsp-server</code>.</li>
<li>Many opam packages do not work with the MSVC compiler or with Windows. It will take a long time (months, years) to substantially improve Windows coverage. When you do find a package that fails to compile on Windows, please file an issue with whoever owns the package expressing interest in the package working on Windows. Please be patient: some package owners may want to see several people express interest before deciding the extra work is justified.</li>
</ul>

<p>
Breaking changes:
</p>
<ul class="org-ul">
<li>Cross-compiling on macOS with dkml-base-compiler now requires you to be explicit which CPU architecture you are targeting. Before using <code>dune -x darwin_arm64</code> would always cross-compile both Intel and Silicon. Now Silicon developers need to use <code>dune -x darwin_x86_64</code> and Intel developers need to use <code>dune -x darwin_arm64</code>. The change was necessary to not rely on the presence of optional Rosetta2 translation. <i>Since this cross-compiling feature is little used, it does not warrant a breaking version bump</i>.</li>
</ul>

<p>
Documentation changes:
</p>
<ul class="org-ul">
<li>The documentation site has moved to <a href="https://diskuv-ocaml.gitlab.io/distributions/dkml/">https://diskuv-ocaml.gitlab.io/distributions/dkml/</a>. Please update your bookmarks!</li>
</ul>

<p>
Bug fixes:
</p>
<ul class="org-ul">
<li>The dune.exe shim uses a cache containing the expensive-to-compute MSVC environment settings. A race condition populating the cache has been fixed.</li>
<li>Repetitive opam repository updates, a source of slowness, were eliminated during installation.</li>
<li><p>
ocaml-crunch upgraded (pinned) from 3.2.0 to 3.3.1 to fix Windows/Unix path inconsistency and handling of CRLF. That and other changed package versions are:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Package</th>
<th scope="col" class="org-right">Old Version</th>
<th scope="col" class="org-right">New Version</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">dune</td>
<td class="org-right">2.9.3</td>
<td class="org-right">3.6.2</td>
</tr>

<tr>
<td class="org-left">ocaml-crunch</td>
<td class="org-right">3.2.0</td>
<td class="org-right">3.3.1</td>
</tr>

<tr>
<td class="org-left">cmdliner</td>
<td class="org-right">1.0.4</td>
<td class="org-right">1.1.1</td>
</tr>

<tr>
<td class="org-left">uuidm</td>
<td class="org-right">0.9.7</td>
<td class="org-right">0.9.8</td>
</tr>

<tr>
<td class="org-left">ptime</td>
<td class="org-right">0.8.6</td>
<td class="org-right">1.1.0</td>
</tr>

<tr>
<td class="org-left">sexplib</td>
<td class="org-right">v0.14.0</td>
<td class="org-right">v0.15.1</td>
</tr>

<tr>
<td class="org-left">lsp</td>
<td class="org-right">1.9.0</td>
<td class="org-right">1.10.3</td>
</tr>

<tr>
<td class="org-left">ocaml-lsp-server</td>
<td class="org-right">1.9.0</td>
<td class="org-right">1.10.3</td>
</tr>

<tr>
<td class="org-left">jsonrpc</td>
<td class="org-right">1.9.0</td>
<td class="org-right">1.10.3</td>
</tr>

<tr>
<td class="org-left">odoc</td>
<td class="org-right">2.1.0</td>
<td class="org-right">2.2.0</td>
</tr>

<tr>
<td class="org-left">odoc-parser</td>
<td class="org-right">0.9.0</td>
<td class="org-right">1.0.1</td>
</tr>

<tr>
<td class="org-left">stdio</td>
<td class="org-right">v0.14.0</td>
<td class="org-right">v0.15.0</td>
</tr>

<tr>
<td class="org-left">base</td>
<td class="org-right">v0.14.2</td>
<td class="org-right">v0.15.1</td>
</tr>

<tr>
<td class="org-left">mdx</td>
<td class="org-right">2.0.0</td>
<td class="org-right">2.1.0</td>
</tr>

<tr>
<td class="org-left">ocamlformat</td>
<td class="org-right">0.19.0</td>
<td class="org-right">0.23.0</td>
</tr>

<tr>
<td class="org-left">ocamlformat-rpc</td>
<td class="org-right">0.19.0</td>
<td class="org-right"><b>not pinned</b></td>
</tr>

<tr>
<td class="org-left">ocamlformat-rpc-lib</td>
<td class="org-right">0.19.0</td>
<td class="org-right">0.23.0</td>
</tr>
</tbody>
</table></li>
<li>The Visual Studio installation cleans up aborted previous installations.</li>
<li>The Visual Studio installation, on failure, writes error logs to a location that isn&rsquo;t immediately erased.</li>
</ul>

<p>
Component changes:
</p>
<ul class="org-ul">
<li><del>opam.exe is compiled directly from the opam master branch; no patches! There is still a shim but that shim just sets up environment variables and delegates to the authoritative (unpatched) opam.</del> There is one patch for opam on top of the opam master branch (opam 2.2) dated 2022-12-21.</li>
<li>MSYS2 setup program is bundled inside the installer to lessen download TLS problems when a proxy is present (common with corporate/school Windows PCs). Resolves <a href="https://github.com/diskuv/dkml-installer-ocaml/issues/19">https://github.com/diskuv/dkml-installer-ocaml/issues/19</a></li>
</ul>

<p>
Reproducibility features:
</p>
<ul class="org-ul">
<li>Packages promoted to central Opam repository:
<ul class="org-ul">
<li>dkml-runtime-common</li>
<li>dkml-runtime-distribution</li>
<li>dkml-component-opam</li>
</ul></li>
<li>Introduce simple spec for which package+versions are installed and/or compiled as part of the DKML distribution (in dkml-runtime-distribution). Eventually it will become authoritative.</li>
<li>Introduce dkml-component-desktop which does CI for changes to that spec (aka. testing new package versions for Windows using MSVC), and builds all relocatable binaries like dune and ocp-indent used in the Windows installer. It is not yet in the central Opam repository.</li>
<li>During installation any <code>CAMLLIB</code> environment variable (in addition to <code>OCAMLLIB</code> which was already checked) is renamed to deconflict with a new OCaml installation. Among other things, this provides an upgrade from CamlLight to OCaml. <a href="https://github.com/diskuv/dkml-installer-ocaml/issues/13">https://github.com/diskuv/dkml-installer-ocaml/issues/13</a></li>
</ul>

<p>
Usability tweaks:
</p>
<ul class="org-ul">
<li>When building DKML packages like dkml-base-compiler, limit dump of Opam logs used for troubleshooting to 4 hours</li>
</ul>

<p>
Feature flags:
</p>
<ul class="org-ul">
<li><p>
Enable <code>--enable-imprecise-c99-float-ops</code> during OCaml compilation by setting
</p>

<div class="org-src-container">
<pre class="src src-scheme">  (
    (feature_flag_imprecise_c99_float_ops)
  )
</pre>
</div>

<p>
in <code>$env:ProgramData\DiskuvOCaml\conf\ocamlcompiler.sexp</code>. This is sometimes needed inside virtual machines like Vagrant
</p></li>
</ul>

<p>
Licensing:
</p>
<ul class="org-ul">
<li>Diskuv OCaml is fully open-source, and is targeted for pure OCaml development. Commercial tools and support are available from Diskuv for mixed OCaml/C development; however, Diskuv OCaml only has limited support for mixed OCaml/C. For example, the <code>ctypes</code> opam package has been patched to work with Visual Studio but is out-dated. Contact support AT diskuv.com if you need OCaml/C development.</li>
</ul>

<p>
Internal changes:
</p>
<ul class="org-ul">
<li>with-dkml.exe is now configured as a opam wrapper relative to the installation directory ($DiskuvOCamlHome) rather than the tools opam switch. That change decouples your new switches (aka. dkml init) from another opam switch.</li>
</ul>
</div>
</div>


<div id="outline-container-org93b233b" class="outline-3">
<h3 id="org93b233b">jbeckford later added</h3>
<div class="outline-text-3" id="text-org93b233b">
</div>
<div id="outline-container-orge88d90a" class="outline-4">
<h4 id="orge88d90a">winget</h4>
<div class="outline-text-4" id="text-orge88d90a">
<p>
This is the first release of DKML in <code>winget</code>, the (new) Windows Package Manager.
</p>

<blockquote>
<p>
Windows Package Manager <b>winget</b> command-line tool is bundled with Windows 11 and modern versions of Windows 10 by default as
the <b>App Installer</b>.
If you are running an earlier version of Windows and the App Installer is not
installed, you can <a href="https://www.microsoft.com/store/productId/9NBLGGH4NNS1">get App Installer from the Microsoft Store</a>.
If it&rsquo;s already installed, make sure it is updated with the latest version.
</p>
</blockquote>

<p>
Once you have <code>winget</code>, uninstall any existing DKML using the uninstall link (see the main announcement) and then type the following
for the 90-minute install:
</p>

<pre class="example" id="org0ef701a">
winget install Diskuv.OCaml
</pre>
<p>
You will then be able to start hacking in a new PowerShell window at <a href="https://diskuv-ocaml.gitlab.io/distributions/dkml/#install-is-done-what-next">Install is done! What
next?</a>
</p>
</div>
</div>
</div>


<div id="outline-container-orgbe0fde5" class="outline-3">
<h3 id="orgbe0fde5">jbeckford finally said</h3>
<div class="outline-text-3" id="text-orgbe0fde5">
</div>
<div id="outline-container-org7539765" class="outline-4">
<h4 id="org7539765">setup-dkml 1.2.0</h4>
<div class="outline-text-4" id="text-org7539765">
<p>
<i>How to check if you are using setup-dkml?</i> You have a <code>ci/setup-dkml</code> folder.
</p>

<p>
The new version of <a href="https://github.com/diskuv/dkml-workflows#readme">setup-dkml CI</a> goes along with the DKML 1.1.0 release (yes, it
would be nice if the version numbers were in sync). You will get CI for Windows MSVC with OCaml 4.14.0 (among other things) when you
upgrade.
</p>

<p>
You should check <code>ci/setup-dkml/*.md</code> to see if there is any upgrade documentation. If not, you can upgrade with:
</p>

<div class="org-src-container">
<pre class="src src-shell">opam update
opam upgrade dkml-workflows
opam exec -- generate-setup-dkml-scaffold
opam exec -- dune build <span style="color: #ca3400;">'@gen-dkml'</span> --auto-promote
</pre>
</div>
</div>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">OCaml.org: recapping 2022 and queries on the Fediverse</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-org-recapping-2022-and-queries-on-the-fediverse/11099/1">https://discuss.ocaml.org/t/ocaml-org-recapping-2022-and-queries-on-the-fediverse/11099/1</a>
</p>
</div>

<div id="outline-container-org506703c" class="outline-3">
<h3 id="org506703c">Anil Madhavapeddy announced</h3>
<div class="outline-text-3" id="text-org506703c">
<p>
Hot on the heels of the <a href="https://discuss.ocaml.org/t/ann-results-of-the-ocaml-user-survey-2022/11056">2022 User Survey results</a>, I thought it a good opportunity to look back over the <a href="https://www.dropbox.com/s/omba1d8vhljnrcn/OCaml-user-survey-2020.pdf?dl=0">2020 results</a> (and <a href="https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/6791">summary</a>) and look at some of the highlights of what the ocaml.org team of contributors did in the past year for our ecosystem, and to gather some inspiration on what to focus on next in 2023. As always, these recaps from me are my personal distillation of our community&rsquo;s work, with me just reporting as best I can. Errors and omissions are mine, and credit to the individual hardworking maintainers!
</p>

<p>
At the start of 2022, I communicated three priorities to the OCaml.org maintainer teams when asked about what to work on, based on
the work of the core development team and the feedback from the 2020 user survey:
</p>

<ul class="org-ul">
<li>help the OCaml 5 release be a success</li>
<li>launch a new OCaml.org web presence with documentation</li>
<li>prototype new workflows for OCaml development</li>
</ul>
</div>

<div id="outline-container-orgd05a717" class="outline-4">
<h4 id="orgd05a717">Help the OCaml 5 release be a success</h4>
<div class="outline-text-4" id="text-orgd05a717">
<p>
The first thing I found notable (and reassuring) in the 2022 survey results is what <span class="underline">wasn&rsquo;t</span> mentioned in the user responses:
instability with the core system. We began 2022 <a href="https://discuss.ocaml.org/t/multicore-ocaml-january-2022-and-post-merge-activity/9294">drunk with relief from the multicore PR being
merged</a>, and began the year-long 5.0.0
release process.  In one of the core developer meetings early in the year, I requested that the 5.0.0 release would be restricted to
<span class="underline">just</span> the multicore runtime and effects features, since so much had changed there that we would have our hands full.  This was
promptly ignored and followed by a <a href="https://github.com/ocaml/ocaml/pull/10867">surge of PRs</a> removing lots of legacy cruft that had
built up over the course of the 4.x series.  A recipe for release management disaster!
</p>

<p>
I&rsquo;m glad to say that I was wrong, and (as you&rsquo;ll see from the infrastructure report below) that the collective 5.0.0 release effort
has been one of the most impressive I&rsquo;ve witnessed.  The core team signalled deprecations clearly, and the various tooling teams
(such as opam and dune) in the ecosystem performed lots of differential builds and incremental releases to remove vestigial
deprecated fragments that now broke builds.  This was then followed by an engaged community releasing their various dependencies to
the mainline opam repository, all in good time for the 5.0 release candidates to be cut and be usable.
</p>

<p>
We are, of course, still really early in the lifetime of the OCaml 5.x series, and some serious breakages may yet lurk and only be
discovered as our users migrate. But we are at a point now where experimentation, prototyping and
<a href="https://watch.ocaml.org/videos/watch/629b89a8-bbd5-490d-98b0-d0c740912b02">migration</a> can be done in a controlled way across both
OCaml 4.x and 5.x, so let&rsquo;s pat ourselves on the backs for a moment about a job well done before moving on.  I&rsquo;ll ninja-edit this
post if next year&rsquo;s user survey is full of complaints about OCaml 5 ;-)
</p>
</div>
</div>

<div id="outline-container-org1e3973a" class="outline-4">
<h4 id="org1e3973a">Launch a new OCaml.org web presence with documentation</h4>
<div class="outline-text-4" id="text-org1e3973a">
<p>
The 2020 user surveys made it crystal clear that we needed to improve the state of art with documentation and OCaml. Accordingly, we
<a href="https://discuss.ocaml.org/t/v3-ocaml-org-a-roadmap-for-ocamls-online-presence/8368">started work</a> in 2021 on a new site, <a href="https://discuss.ocaml.org/t/v3-ocaml-org-getting-ready-to-launch/9146">previewed
it</a> in early 2022 and <a href="https://discuss.ocaml.org/t/v3-ocaml-org-we-are-live/9747">launched in April
2022</a>.
</p>

<p>
This new website preserved older links (by redirecting them to an archived v2.ocaml.org) and provided a brand new centralised
documentation site with package search and incremental rebuilds to ensure new packages get up there in a timely fashion.  This was a
complex task behind the scenes, since it requires <a href="https://watch.ocaml.org/videos/watch/9bb452d6-1829-4dac-a6a2-46b31050c931">ongoing bulk package
builds</a> of every version of every package in the opam
repository, with consistent cross-linking.
</p>

<p>
It&rsquo;s still by no means perfect, with some work needed on rendering glitches, missing sections, and the overall information
architecture of how to present so much information to a range of users (beginner to advanced), but it&rsquo;s a really solid foundation to
work from (unlike the previous website, which was really showing its age).  This year&rsquo;s user survey continues to emphasise the need
for advancing documentation, so I hope to see more contributions to the new website to ensure the content continues to improve.  And
of course, look to your own published libraries and ensure that your odoc markup is as good as you can make it.
</p>
</div>
</div>

<div id="outline-container-org59718f4" class="outline-4">
<h4 id="org59718f4">Prototype new workflows for OCaml development</h4>
<div class="outline-text-4" id="text-org59718f4">
<p>
The other hot topic in 2022 was for us to figure out how to integrate better with modern, stateless workflows for code development.
This is a complex topic for tool maintainers to work on, since we must also <a href="https://watch.ocaml.org/videos/watch/039f1096-a63c-4a88-af4b-dcc48791d723">preserve backwards
compatibility</a> with existing workflows (witness the very
high percentage of users in this year&rsquo;s survey that use the opam cli as their primary mechanism of interaction).  We also had a
decent idea of who the various sorts of users are <a href="https://speakerdeck.com/avsm/workflows-in-the-ocaml-platform?slide=4">from discussion in
2019</a> with application developers, library authors and OS
maintainers.
</p>

<p>
There have been a number of prototypes built this year to experiment with new workflows, but most of the effort from core
maintainers has gone into the earlier priorities (releasing OCaml 5, especially). The prevalence of dune (&gt;91% in the 2022 survey)
means that one simple stateless workflow is to have all the source code available in one monorepo, and perform a <code>dune build</code>.  This
works because dune can scan all the <code>dune</code> files in the repo and build them <a href="https://www.dra27.uk/blog/platform/2018/08/15/dune-vendoring.html">in one
pass</a>.  In this workflow, opam can be optionally used to assemble
the source code (see the <a href="https://github.com/tarides/opam-monorepo">opam-monorepo</a>) plugin, but our Nix-loving friends also have
their own alternative mechanisms (<a href="https://github.com/nix-ocaml/nix-overlays">1</a>, <a href="https://github.com/tweag/opam-nix">2</a>,
<a href="https://ryan.freumh.org/blog/hillingar/">3</a>).  While some projects like MirageOS and <a href="https://github.com/realworldocaml/book">Real World
OCaml</a> are using these workflows, they are still maturing.  Now that OCaml 5.0 is out and
the new website is live, I hope to see more production quality workflows emerging in 2023.
</p>

<p>
There is also some concern that dune shouldn&rsquo;t be a hard requirement on any workflow.  This requirement has been successfully
preserved to date, but is getting increasingly difficult to reconcile with the demand for a more opinionated, beginner-friendly
workflow.  With opam, our architectural answer to this is to separate the <span class="underline">opam file format</span> from the <span class="underline">opam CLI</span>, and make it easier
to <a href="https://github.com/ocaml-opam/opam-0install-solver">interpret opam repositories</a> via external tools.  The same discipline should
work for <code>dune</code> files with <a href="https://discuss.ocaml.org/t/status-update-bazel-enabled-ocaml-toolchain/10892">alternative build
systems</a>.
</p>
</div>
</div>

<div id="outline-container-org2b60f2f" class="outline-4">
<h4 id="org2b60f2f">OCaml.org and our decentralised future in 2023</h4>
<div class="outline-text-4" id="text-org2b60f2f">
<p>
How do we &#x2013; as a community &#x2013; figure out what will work for new workflows?  That&rsquo;s my segway into what I want to hear your thoughts
on for 2023: how to incrementally improve community communication.
</p>

<ul class="org-ul">
<li><p>
<b>discuss.ocaml.org (Discussion forum):</b> I setup this forum <a href="https://sympa.inria.fr/sympa/arc/caml-list/2017-05/msg00070.html">back in 2018</a> in response to a user request, and it has been a successful experiment.  The number of OCaml users who report interacting via this forum has increased percentage-wise from the 2020 to 2022 results.  I am also pleased that a small moderation team has been sufficient to deal with spam.  Traffic-wise, we have had to upgrade the hosting capacity several times in the past 5 years as demand rises, and there has been a mild surge in page-views towards the end of 2022 with the release of OCaml 5.0.0.
</p>


<div id="orge1dceb3" class="figure">
<p><img src="https://global.discourse-cdn.com/business7/uploads/ocaml/optimized/2X/d/d2810e2c8655eb03126c7b92987c6cf27fffc613_2_1380x320.png" alt="d2810e2c8655eb03126c7b92987c6cf27fffc613_2_1380x320.png" />
</p>
</div>

<p>
I am still regretful that I had to <a href="https://discuss.ocaml.org/t/lists-ocaml-org-service-temporarily-sunsetted/8692">sunset the mailing list service</a>, but it will hopefully <a href="https://github.com/ocaml/infrastructure/issues/24">be back in 2023</a>, especially if we find a volunteer to help configure and maintain it.
</p></li>

<li><p>
<b>watch.ocaml.org (Video sharing):</b> The <a href="https://joinpeertube.org">Peertube</a>-based service began in the 2020 lockdowns when we shifted our workshops online.  Since then, it has been a resilient and useful resource to host videos about OCaml related topics. There are some advantages to hosting our own videos: they can be permanently archived and linked to, and we can integrate well with other &ldquo;Fediverse&rdquo;-based services (more on this later).
</p>

<p>
What I&rsquo;d like to see in 2023 is more content being backfilled onto this site, so that we can have all the videos from the last few decades of OCaml conferences and workshops in one place!    To that end, we will promote the <a href="https://github.com/ocaml/infrastructure/issues/23">service to non-beta</a> status soon.  It is a little tricky to use Peertube with multiple users (still involves password sharing), so we&rsquo;re figuring it out as we go along and before finishing the promotion to production status. Please do leave comments and thoughts on that issue or here.
</p></li>

<li><p>
<b>opam.ocaml.org (Package management)</b>: The surveys confirm that opam remains the dominant mechanism of installing and accessing the OCaml package ecosystem.  In addition to <a href="https://github.com/ocaml/opam/releases">regular releases</a> of the opam tool itself, the backend infrastructure has been <a href="https://github.com/ocaml/infrastructure/issues/19">upgraded</a> significantly so that the package archive should be more available and secure, and easier to mirror onto global CDNs in 2023 and also integrate with other software security supply chain software.
</p>

<p>
Alongside serving the package archives themselves, we maintain a significant multi-architecture cluster of machines that perform the bulk builds to ensure the health and integrity of the opam repository (the <a href="https://github.com/ocaml/opam-repository">curated package database</a>). These machines comprise of x86, ARM, PowerPC and RISC-V machines (yes, we did finally get rackmounted RISC-V boards this year!).  The machines are variously hosted at the Cambridge Computer Laboratory, Inria, Scaleway and Equinix, and we are sunsetting our use of AWS for cost reasons. Individual machines have been generously funded by IBM, Tarides, Jane Street, the <a href="https://github.com/WorksOnArm">Works on ARM</a> program.
</p>

<p>
The software driving this cluster <a href="https://watch.ocaml.org/videos/watch/29055525-2b0f-4f00-a0a0-26c9d4e97f9c">continues to grow</a>, with support for Windows and macOS builds going live in 2022. These are not yet hooked up to the live opam-repository-ci, but will hopefully be back in 2023. This marks our migration away from hosted CI services such as Travis and AppVeyor, and the backing infrastructure <a href="https://github.com/ocurrent/overview">is open source</a> and possible to deploy for yourself (e.g. in an industrial context).
</p></li>

<li><b>www.ocaml.org (Website and Docs)</b>: I&rsquo;ve talked extensively about the new website earlier, but I would like to emphasise the importance of receiving external contributions to the <span class="underline">content</span> of the website.  The <a href="https://github.com/ocaml/ocaml.org/pulls">repository</a> is open for PRs, and it has been a little quiet in the latter half of 2022 outside of a small maintainer team.  If you&rsquo;d like to get involved, then please feel free to open an issue and discussing your plans, or signal any blockers you encountered.  Gabriel has already noted <a href="https://discuss.ocaml.org/t/maintenance-bottlenecks-in-the-compiler-distribution/11045">bottlenecks in the core OCaml distribution</a>, and a similar story is playing out in the wider ocaml.org ecosystem.  We need your contributions.</li>

<li><p>
<b>git.ocaml.org (not launched)</b>: a service that we have considered since 2019 and did <span class="underline">not</span> launch is a git mirror, or an alternative way of procuring OCaml ecosystem source code than from GitHub. There have been a small but steady <a href="https://discuss.ocaml.org/t/publishing-without-github/3232">stream of requests</a> for this, with several motivations: availability (GitHub is a central point of failure), security (replicating ecosystem git branches is sound and secure practise), and privacy.  The core OCaml team is firmly committed to GitHub at present, but launching a read-only mirror is in scope for 2023 if a maintainer is willing to step forward and survey available solutions (ideally not as heavy-weight as GitLab) for mirroring scripts.  Once we have a robust read-only git mirror, we can begin to consider how to accept patch contributions (particularly to the opam repository) via email or other mechanisms, but no promises until we reach the first read-only milestone.
</p>

<p>
I&rsquo;d really like to hear from industrial users who have stronger requirements for secure software supply chains here as well. I participated in a <a href="https://bpb-us-w2.wpmucdn.com/sites.gatech.edu/dist/a/2878/files/2022/10/OSSI-Final-Report.pdf">White House summit on software security</a> earlier in the year, and it is clear that this is going to be an important topic for OCaml to keep up with in 2023, especially with our role in the formal verification ecosystem.
</p></li>
</ul>
</div>

<ul class="org-ul">
<li><a id="orgf56dc85"></a>Should ocaml.org host more Fediverse services?<br />
<div class="outline-text-5" id="text-orgf56dc85">
<p>
I&rsquo;ve mentioned the <a href="https://en.wikipedia.org/wiki/Fediverse">Fediverse</a> earlier, and could use a wider set of opinions.  One of my concerns from the user survey is how much interaction happens on closed synchronous mediums such as Slack or Discord. I&rsquo;m not <span class="underline">against</span> such platforms (1-1 and small team private chats are not replaceable), but there&rsquo;s currently no way to then promote knowledge gathered from the closed systems into the public commons, where they benefit newcomers.  And more recently, there has been drama around centralised services such as Twitter that throws its permanence into question.  Our user survey indicated positive
vibes about our current interactions, and I of course want to ensure any of our technical platform choices support this healthy
growth.
</p>

<p>
The Fediverse itself is a fairly loosely arranged set of services that interoperate via two main protocols:
<a href="https://www.w3.org/TR/activitypub/">ActivityPub</a> for web-based services, and the Matrix chat protocol for encrypted 1:1 and group
encrypted communications.  Some potential services we could host are:
</p>

<ul class="org-ul">
<li><p>
<a href="https://joinmastodon.org">Mastodon</a> is a micro-blogging platform which can be run on several domains. It exposes feeds via RSS as well as several open source clients. Fediverse clients can interoperate: a &ldquo;boost&rdquo; on a watch.ocaml.org video can be expressed in a Mastodon timeline, and a &ldquo;favourite&rdquo; of a video in Mastodon will increment the &ldquo;like&rdquo; counter on the videopage.
</p>

<p>
For ocaml.org, a simple service to run would be an activity feed (e.g. from the opam repository and the website blog) that would publish &ldquo;Toots&rdquo; and make them searchable across the wider network, but not allow user registration. This would sidestep the need for moderation and selection of blocklists.  However, the hard work of the <a href="https://ocaml.org/policies/code-of-conduct">code of conduct</a> team means that we have the basis for user registration provision as well (especially by using discuss.ocaml.org as a single-sign on backend).  Opinions welcome &#x2013;  by default, I will select the conservative option of adding read-only ActivityPub to ocaml.org directly, as we do not currently have the moderation resources for a full Mastodon instance, and it can be upgraded at a later stage.
</p></li>

<li><a href="https://matrix.org">Matrix chat</a> is already sitting alongside the venerable IRC as an open alternative. One of the nicest features of Matrix is that multiple servers can publish the same room, and the domain name is simply a namespace which can be replicated. For example, we have a chat room for the Eio library that is published as <code>#eio:roscidus.com</code> (@talex5&rsquo;s Matrix server) and <code>#eio:recoil.org</code> (my own).  In the future, this could also be <code>#eio:ocaml.org</code> simply by publishing it as such.  The value in an ocaml.org Matrix server is thus to act as a conveniently searchable directory, with the room contents being replicated in various other homeservers for availability.</li>
</ul>

<p>
There are still significant downsides to using the Fediverse as opposed to centralised services. Usability is patchy, availability
can be variable as some servers go down while others remain, and moderation is never a fully solved problem that requires
distributed maintenance of blocklists. We&rsquo;ll need to be open to some experimentation and failures if we step further in this
direction, but it is promising.
</p>

<p>
In this spirit of experimentation, the ocaml.org changes are all now being recorded on a blog (infra.ocaml.org, and at
<a href="https://github.com/ocaml/infrastructure/issues">https://github.com/ocaml/infrastructure/issues</a>), and I&rsquo;ll begin discussions with ecosystem maintainers about how they feel about
moving to slightly more open platforms. In the meanwhile, nothing stops independent initiatives.  If you feel the urge to continue
developing <a href="https://github.com/kit-ty-kate/ocaml-activitypub/network/members">ActivityPub bindings</a> (begun by Kate at a MirageOS
retreat but in need of a new maintainer) or bringing the <a href="https://tarides.com/blog/2022-06-09-ocaml-matrix-a-virtual-world">OCaml
Matrix</a> implementation to production quality, now would be an
excellent time to do so!
</p>

<p>
None of these Fediverse services are intended to replace the excellent roundups often seen on these forums (such as Gabriel&rsquo;s
<a href="https://discuss.ocaml.org/tag/compiler-newsletter">compiler newsletters</a>) and via the <a href="https://discuss.ocaml.org/t/twenty-years-of-ocaml-weekly-news/8869">Caml weekly
news</a>.  If in doubt, feel free to step up with your own projects
and post about them regularly here!
</p>

<p>
Finally, the absolute highlight of OCaml in 2022 for me has been the continued support for <a href="https://outreachy.org">Outreachy</a> from
our maintainers (see <a href="https://discuss.ocaml.org/search?q=outreachy">posts</a> and even a <a href="https://watch.ocaml.org/videos/watch/dc5bbf5b-3dd9-4c8d-b26a-71e730a67788">video
roundup</a>).  This effort, along with the <a href="https://ocaml.org/policies/code-of-conduct">code of
conduct</a> process concluding, highlights the enthusiasm for bringing newcomers into our
world.  I encourage the senior members of our community to try to participate (even if just once), and get in touch with myself or
the OCSF if the bottleneck is something we can help address (like funding).
</p>

<p>
I&rsquo;ve never been more excited about the future of OCaml than I am heading into 2023; a whole new realm of systems programming has
opened up with the release of multicore and effects, and it&rsquo;s just really fun and a privilege being along for the ride with such
talented collaborators. <b>Happy new year everyone!</b> <span class="underline">(I&rsquo;m currently snowed in somewhere very remote, and am only 50% sure this will
make it through to the forum. Please please, don&rsquo;t give me a HTTP error when I click on &rsquo;create topic&rsquo;)</span> :slight_smile:
</p>
</div>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-org241ca51" class="outline-2">
<h2 id="org241ca51">Old CWN</h2>
<div class="outline-text-2" id="text-org241ca51">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I&rsquo;ll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org42d8099">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>