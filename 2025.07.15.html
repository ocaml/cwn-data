<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-07-15 Tue 19:13 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'JavaScript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2025.07.08.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2025.07.22.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of July 08 to 15, 2025.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">OCaml Language Committee: an update on a policy for conflicts of interest</a></li>
<li><a href="#2">OCaml intern for Claudius</a></li>
<li><a href="#3">An example for every OCaml package</a></li>
<li><a href="#4">Esa 0.1.0 - Enhanced Suffix Arrary(and further plans)</a></li>
<li><a href="#5">Tutorial: cut and pasting code</a></li>
<li><a href="#6">QCheck 0.24</a></li>
<li><a href="#7">New Odoc-3-Generated Package Documentation is Live on OCaml.org</a></li>
<li><a href="#8">Lwt.6.0.0~alpha (direct-style)</a></li>
<li><a href="#9">MirageOS on Unikraft</a></li>
<li><a href="#10">Other OCaml News</a></li>
<li><a href="#org86d3e99">Old CWN</a></li>
</ul>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="1">OCaml Language Committee: an update on a policy for conflicts of interest</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-language-committee-an-update-on-a-policy-for-conflicts-of-interest/16927/1">https://discuss.ocaml.org/t/ocaml-language-committee-an-update-on-a-policy-for-conflicts-of-interest/16927/1</a>
</p>
</div>
<div id="outline-container-orgcb3b0a2" class="outline-3">
<h3 id="orgcb3b0a2">octachron announced</h3>
<div class="outline-text-3" id="text-orgcb3b0a2">
<p>
When discussing the proposition for include functors, the <a href="https://github.com/ocaml/RFCs/blob/master/Committee.md">language committee</a> felt in the rabbit hole of discussing conflict of interests.
</p>

<p>
After some discussions, as the current committee chair, I have decided to propose to amend the committee description with our current understanding of transparency-based policy for conflicts of interest at <a href="https://github.com/ocaml/RFCs/pull/55">https://github.com/ocaml/RFCs/pull/55</a> .
</p>

<p>
The core idea behind that policy is that in a small-world community like ours, trying to completely avoid conflicts would be counter-productive. At the same time, making sure that anyone is aware of potential conflicts is fairer for all participants.
</p>

<p>
Thus the current proposal, which is not definitive. In particular, if we have any comments, you are more than welcome to participate in the discussion in the RFC above.
</p>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="2">OCaml intern for Claudius</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-intern-for-claudius/16935/1">https://discuss.ocaml.org/t/ocaml-intern-for-claudius/16935/1</a>
</p>
</div>
<div id="outline-container-org7349bf2" class="outline-3">
<h3 id="org7349bf2">Shreya Pawaskar announced</h3>
<div class="outline-text-3" id="text-org7349bf2">
<p>
Hello Everyone! 👋👋
</p>

<p>
I am Shreya Pawaskar, an outreachy intern working on the Claudius Project. 
</p>

<p>
A little late to post my blogs here. But here we go!
</p>

<p>
This is my <a href="https://pawaskar-shreya-outreachy.hashnode.dev/outreachy-week-1">first blog</a>. Here I've talked about my experience during the contribution phase and my fav contribution. 
</p>

<p>
And here's the <a href="https://pawaskar-shreya-outreachy.hashnode.dev/outreachy-week-3">second one</a>. This one is all about the journey and the learnings I made working with ocaml-gif. And ofcourse, the beautiful cover image for my second blog is built and captured with Claudius!
</p>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="3">An example for every OCaml package</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/an-example-for-every-ocaml-package/16953/1">https://discuss.ocaml.org/t/an-example-for-every-ocaml-package/16953/1</a>
</p>
</div>
<div id="outline-container-orgf2125cd" class="outline-3">
<h3 id="orgf2125cd">John Whitington announced</h3>
<div class="outline-text-3" id="text-orgf2125cd">
<p>
(One day, maybe).
</p>

<p>
Wouldn't it be nice if every OCaml package had examples as well as documentation? As part of a pilot programme funded by the OCaml Software Foundation, I've been looking into the feasibility of such an idea.
</p>

<p>
What do we mean by examples, and what distinguishes them from documentation and from tests?
</p>

<p>
<b>What an example is</b>
</p>

<ul class="org-ul">
<li>Examples are independent of the library they explain. They do not require the source of the library, or any built artefacts.</li>

<li>Examples are self-contained. They require only OCaml, a build system, and the library in question to be installed.</li>

<li>Examples are easy to build. They are built in a single command, and do not depend on environment.</li>

<li>Examples are easy to edit and play with. They are of a reasonable size, split into chunks, and are commented liberally.</li>

<li>Examples use standard techniques. Both in how the library is used, and in how the OCaml code is written.</li>

<li>Examples are open licensed. Users should be able to copy &amp; paste code from the examples without care.</li>
</ul>

<p>
<b>What an example is not</b>
</p>

<ul class="org-ul">
<li>Examples are not tests. Unlike tests, examples do not care about code coverage, cannot be automatically generated, and need not necessarily be tightly integrated into the source repository.</li>

<li>Examples are not in the API documentation. Examples need to be buildable, and separate from the API documentation. This is not to say that they might then not be automatically imported into the API documentation one day.</li>

<li>Examples need not be comprehensive. Better a small example than no example at all. So long as the basics of an API are introduced, the cliff is climbed and the API documentation should thereafter suffice.</li>
</ul>

<p>
<b>Pilot project plan</b>
</p>

<p>
The plan was to build small examples for about twenty packages, put together a place for them to live, and then try to upstream them. The examples' home, prior to upstreaming, is the OCaml Nursery:
</p>

<p>
<a href="https://github.com/johnwhitington/ocaml-nursery">https://github.com/johnwhitington/ocaml-nursery</a>
</p>

<p>
Most of these little examples have been submitted to upstream - you may have noticed the pull requests on your repositories - with varying degrees of interest / success.
</p>

<p>
<b>Opinions requested, please!</b>
</p>

<p>
Are you interested in adding examples for your package or someone else's package? To the nursery or to upstream? What do you think of the definition of example I gave above? Do you think examples should sit in a separate space like the nursery or be upstreamed or both? Opinions requested on all those topics, please!
</p>
</div>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="4">Esa 0.1.0 - Enhanced Suffix Arrary(and further plans)</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-esa-0-1-0-enhanced-suffix-arrary-and-further-plans/16956/1">https://discuss.ocaml.org/t/ann-esa-0-1-0-enhanced-suffix-arrary-and-further-plans/16956/1</a>
</p>
</div>
<div id="outline-container-org2a414cb" class="outline-3">
<h3 id="org2a414cb">Geoffrey Borough announced</h3>
<div class="outline-text-3" id="text-org2a414cb">
<p>
I just ported the original C++ Enhanced Suffix Tree to pure OCaml, you can find it here: <a href="https://github.com/gborough/esa">https://github.com/gborough/esa</a>.
</p>

<p>
It's the first time I have attempted at writing low allocation/no allocation code in OCaml and I must say this has been a great learning experience for the past few weeks, and it makes me appreciate more how OCaml is able to provide low level tunings that match other low level languages, whilst staying functional at the same time.
</p>

<p>
One of my personal goals(also our company tech alignment) is to bring OCaml up to the same level of convenience as <b>Python</b> in some areas of AI/LLM. We are inspired by existing efforts in the OCaml community to take on this challenge and our plan of attack will be more or less similar. Currently we are tackling the following problems:
</p>

<ul class="org-ul">
<li>Porting Google Sentencepiece(in progress): Enhanced Suffix Arrary done as a dependency, Double-Array Trie and few other tokenizer utilities in progress.</li>
<li>Porting Hugging Face Tokenizers(in progress): Pending the completion of sentencepiece though less dependent codes are being converted.</li>
</ul>

<p>
The end product probably contains a mixture of pure OCaml as well as a fair amount of FFI code. I dread to think how they are going to look like obviously there will be a ton of verbatim translations to OCaml, but I have little doubt about matching C++/Rust performance most of the time. We'll also look into the upcoming OxCaml extension to see if more performance can be eked out.
</p>

<p>
Hopefully we will have something to show for the community in the near future.
</p>
</div>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="5">Tutorial: cut and pasting code</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/tutorial-cut-and-pasting-code/16957/1">https://discuss.ocaml.org/t/tutorial-cut-and-pasting-code/16957/1</a>
</p>
</div>
<div id="outline-container-org3f18b7c" class="outline-3">
<h3 id="org3f18b7c">Daniel Bünzli announced</h3>
<div class="outline-text-3" id="text-org3f18b7c">
<p>
Dear all, 
</p>

<p>
I sometimes notice that my code gets cut and pasted or vendored litterally or modified in other projects. <b>That's very fine</b>, it's the reason why I publish almost all my code under <a href="https://choosealicense.com/licenses/isc/">a license</a> that makes that extremely simple. 
</p>

<p>
Yet people often fail to abide by the simple, single phrase request of the license which is (emphasis added):
</p>

<blockquote>
<p>
Copyright (c) [year] [fullname]
</p>

<p>
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, <b>provided that the above
copyright notice and this permission notice appear in all copies</b>.
</p>
</blockquote>

<p>
In all my source files you can find a header that has the copyright notice and a SPDX license identifier <a href="https://spdx.dev/learn/handling-license-info/#how">as per convention</a> (<a href="https://github.com/dbuenzli/jsont/blob/527808203554fcf9b93eb2ca79ed596937233149/src/jsont_base.ml#L1-L4">example</a>). So I kindly ask you when you reuse my code:
</p>

<ol class="org-ol">
<li><p>
If you copy the whole file to retain that copyright header. Reformatting
the header is ok. Also if you end up reworking the code significantly 
indicating:
</p>
<pre class="example" id="org8620ca2">
(* Part of this code is based on the xxx project and
   Copyright (c) 2020 The xxx programmers.
   SPDX-License-Identifier: ISC *)
</pre>
<p>
works for me.
</p></li>

<li><p>
If you copy say a single function please add a comment with the copyright
notice and the SPDX license identifier. For example:
</p>
<pre class="example" id="orge1ec790">
(* This code is Copyright (c) 2011 The xxx programmers.
    SPDX-License-Identifier: ISC *)
</pre></li>

<li>If you end up vendoring a significant part of the code without modifying
it (that is if technically you depend on the project) please mention it 
in your toplevel <code>LICENSE</code> file.</li>
</ol>

<p>
Now let's be clear, I will not call the police if don't do this or if you pretend to have written code you did not. Police and lawyers are at the top of the list of people I do not want to deal with or inflict onto other people.
</p>

<p>
What I'm seeking here is attribution. Not for having my name in your project, I couldn't care less and the copyrights of my projects are contributor based anyways. This is so that the code contribution can be traced for the little times I manage to convince people to pay me for making them rather than investing my own money in these projects.
</p>

<p>
Btw. this should not only be about my code. This is about any open source code you cut and paste from (and I also <a href="https://github.com/dbuenzli/typegist/blob/62798edf20688d8bf021928d0eb3b1a0580da583/src/typegist.ml#L40-L48">do this</a>). 
</p>

<p>
Ah and yes, please, if you are using them, also teach your LLMs to do that. If they are able to write OCaml code it's also thanks to me :–)
</p>

<p>
Thank for your attention. 
</p>

<p>
Daniel
</p>
</div>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="6">QCheck 0.24</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-qcheck-0-24/16198/3">https://discuss.ocaml.org/t/ann-qcheck-0-24/16198/3</a>
</p>
</div>
<div id="outline-container-orgdcd7681" class="outline-3">
<h3 id="orgdcd7681">Jan Midtgaard announced</h3>
<div class="outline-text-3" id="text-orgdcd7681">
<p>
QCheck 0.26 is now available from your favorite opam repository! :tada:
</p>

<p>
<a href="https://github.com/c-cube/qcheck/releases">https://github.com/c-cube/qcheck/releases</a>
</p>

<p>
The 0.26 release adjusts the <code>QCheck</code> and <code>QCheck2</code> <code>float</code> generator distributions, which was previously confined to a subset of floating point numbers. Users may experience that existing tests known to pass start to fail with the new and broader distribution. In addition the release contains a number of other fixes and documentation improvements, incl. the removal of an annoying newline which would cause the test suite to fail on OCaml 5.4.0:
</p>

<ul class="org-ul">
<li>Align printed <code>collect</code> statistics and also add a percentage</li>
<li>Fix <code>QCheck{,2}.Gen.float</code> generator which would only generate numbers with an exponent between 2^{-21} and 2^{22}</li>
<li>Elaborate on the <code>QCheck~/~QCheck2</code> situation in the README</li>
<li>Add a missing <code>description</code> field to the *.opam files</li>
<li>Document <code>Shrink</code> invariants in the <code>QCheck</code> module</li>
<li>Fix a <code>qcheck-ounit</code> test suite failure on OCaml 5.4, removing a needless extra newline</li>
<li>Fix <code>QCheck2</code> <code>float_range</code> operator which would fail on negative bounds</li>
<li>Fix <code>QCHECK_MSG_INTERVAL</code> not being applied to the first in-progress message</li>
</ul>

<p>
Thanks to @Pat-Lafon, @rmonat, and @kit-ty-kate for contributing! :pray:
</p>
</div>
</div>
</div>
<div id="outline-container-7" class="outline-2">
<h2 id="7">New Odoc-3-Generated Package Documentation is Live on OCaml.org</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/new-odoc-3-generated-package-documentation-is-live-on-ocaml-org/16967/1">https://discuss.ocaml.org/t/new-odoc-3-generated-package-documentation-is-live-on-ocaml-org/16967/1</a>
</p>
</div>
<div id="outline-container-orgc9de357" class="outline-3">
<h3 id="orgc9de357">Sabine Schmaltz announced</h3>
<div class="outline-text-3" id="text-orgc9de357">
<p>
Hi everyone,
</p>

<p>
I just merged the patch <a href="https://github.com/ocaml/ocaml.org/pull/3124">https://github.com/ocaml/ocaml.org/pull/3124</a> which enables the new and improved package documentation built with odoc 3 on OCaml.org. Thanks @mtelvers, @jonludlam, @panglesd for putting in the effort to make this happen for OCaml.org!
</p>

<p>
Thanks to everyone who gave us feedback when we ran this on the staging environment (<a href="https://discuss.ocaml.org/t/help-test-the-new-odoc-3-powered-package-documentation-pages/16795/6">https://discuss.ocaml.org/t/help-test-the-new-odoc-3-powered-package-documentation-pages/16795/6</a>), we're reasonably confident that things work well enough to apply this upgrade. :orange_heart: 
</p>

<p>
In case you see something that could be improved, please let us know (by replying here or by opening an issue on <a href="https://github.com/ocaml/ocaml.org">https://github.com/ocaml/ocaml.org</a>)!
</p>

<p>
Cheers
Sabine
</p>
</div>
</div>
</div>
<div id="outline-container-8" class="outline-2">
<h2 id="8">Lwt.6.0.0~alpha (direct-style)</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-lwt-6-0-0-alpha-direct-style/16972/1">https://discuss.ocaml.org/t/ann-lwt-6-0-0-alpha-direct-style/16972/1</a>
</p>
</div>
<div id="outline-container-orgef44e2c" class="outline-3">
<h3 id="orgef44e2c">Raphaël Proust announced</h3>
<div class="outline-text-3" id="text-orgef44e2c">
<p>
It is a great pleasure to announce the release of the first alpha release of Lwt 6. This major version bump brings two major changes to Lwt:
</p>

<ul class="org-ul">
<li>Using Lwt in direct-style! (Big thanks to @c-cube !!)</li>
<li>Using multiple Lwt schedulers running in separate domains!</li>
</ul>
</div>
<div id="outline-container-org8d5f978" class="outline-4">
<h4 id="org8d5f978">Direct-style</h4>
<div class="outline-text-4" id="text-org8d5f978">
<p>
This contribution from @c-cube is available in alpha00. It comes in the form of an <code>lwt_direct</code> package which provide an <code>Lwt_direct</code> module which provide two core functions:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code><span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">run</span> : (unit -&gt; 'a) -&gt; 'a <span style="color: #444fcf;">Lwt.</span>t
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">await</span> : 'a <span style="color: #444fcf;">Lwt.</span>t -&gt; 'a
</code></pre>
</div>

<p>
and allows you to write code such as
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code>run (<span style="color: #006f00; font-weight: bold;">fun</span> () -&gt;
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">continue</span> = <span style="color: #557400; font-weight: bold;">ref</span> <span style="color: #00824f;">true</span> <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #006f00; font-weight: bold;">while</span> <span style="color: #a52a2a;">!</span>continue <span style="color: #006f00; font-weight: bold;">do</span>
    <span style="color: #006f00; font-weight: bold;">match</span> await <span style="color: #a52a2a;">@@</span> <span style="color: #444fcf;">Lwt_io.</span>read_line ic <span style="color: #006f00; font-weight: bold;">with</span>
    | line -&gt; await <span style="color: #a52a2a;">@@</span> <span style="color: #444fcf;">Lwt_io.</span>write_line oc line
    | <span style="color: #006f00; font-weight: bold;">exception</span> <span style="color: #242521; background-color: #fcf7ef;">End_of_file</span> -&gt; continue := <span style="color: #00824f;">false</span>
  <span style="color: #006f00; font-weight: bold;">done</span>)
</code></pre>
</div>

<p>
There are a few more functions. All of which is documented in <a href="https://github.com/ocsigen/lwt/blob/6.0.0-alpha00/src/direct/lwt_direct.mli">lwt_direct.mli</a>.
</p>
</div>
</div>
<div id="outline-container-org0ecb2fa" class="outline-4">
<h4 id="org0ecb2fa">Multi-scheduler</h4>
<div class="outline-text-4" id="text-org0ecb2fa">
<p>
This addition is not available in alpha00 but should be added to alpha01 soon. It allows to call <code>Lwt_main.run</code> in different domains and benefit from actual parallelism. (Sneak peek in <a href="https://github.com/ocsigen/lwt/pull/1058">this pull request</a>)
</p>
</div>
</div>
<div id="outline-container-orgc8ab6aa" class="outline-4">
<h4 id="orgc8ab6aa">Installation</h4>
<div class="outline-text-4" id="text-orgc8ab6aa">
<p>
<code>lwt.6.0.0~alpha00</code> and <code>lwt_direct.6.0.0~alpha00</code> will soon be released on opam (<a href="https://github.com/ocaml/opam-repository/pull/28175">PR on opam-repo</a>. I'll publish some more alphas as the work progresses, and announce the releases on this thread.
</p>

<p>
You can also pin the packages to the lwt-6 branch to get everything a little bit earlier:
</p>

<pre class="example" id="org79b1b0d">
opam pin lwt https://github.com/ocsigen/lwt.git#lwt-6
opam pin lwt_direct https://github.com/ocsigen/lwt.git#lwt-6
</pre>
</div>
</div>
<div id="outline-container-org35ea06d" class="outline-4">
<h4 id="org35ea06d">Feedback</h4>
<div class="outline-text-4" id="text-org35ea06d">
<p>
Don't hesitate to chime in on here with any feedback you may have. Ideas, comments, requests, suggestions, etc.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-9" class="outline-2">
<h2 id="9">MirageOS on Unikraft</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/mirageos-on-unikraft/16975/1">https://discuss.ocaml.org/t/mirageos-on-unikraft/16975/1</a>
</p>
</div>
<div id="outline-container-orgaa404b9" class="outline-3">
<h3 id="orgaa404b9">shym announced</h3>
<div class="outline-text-3" id="text-orgaa404b9">
<p>
On behalf of all the developers involved (namely @fabbing, @Firobe, @n-osborne and me), it’s my pleasure to announce that the first release of the <a href="https://unikraft.org">Unikraft</a> backend support in MirageOS unikernels.
</p>

<p>
<a href="https://unikraft.org">Unikraft</a> is a unikernel development kit: it is a pretty large <a href="https://unikraft.org/docs/internals/architecture">collection of components</a> that can be picked up, or not, in the unikernel tradition of modularity. The scope of Unikraft is much larger than <a href="https://github.com/Solo5/solo5/">Solo5</a>, as it aims to make it easy to turn any Unix server into an efficient unikernel.
This was in fact a first motivation to explore using Unikraft as MirageOS backend: to experiment and see what performance we could get, in particular using their <code>virtio</code>-based network interface, as <code>virtio</code> is implemented currently only for one specific <code>x86_64</code>-only backend in Solo5.
</p>

<p>
Some of the immediate performance differences we observed are detailed further, but that is not all we hope from this Unikraft backend in the long-term. In particular, Unikraft is on the road to be multicore-compatible (i.e. having one unikernel use multiple cores). While this is not ready today and there are still significant efforts to get there, it means that this MirageOS backend will be able to benefit from these efforts and eventually support the full feature set of OCaml 5.
</p>

<p>
Furthermore, the Unikraft community (which is quite active) is experimenting with a variety of other targets such as bare-metal for some platforms or new hypervisors (e.g. seL4). Any new target Unikraft supports can be then supported "for free" by MirageOS too. For example, this already brings <code>firecracker</code> as a new supported VMM for MirageOS.
</p>

<p>
Lastly, since Unikraft is POSIX-compatible (for a large subset of syscalls), this potentially enables MirageOS unikernel to embed OCaml libraries that have not been ported to use the Mirage interfaces in the future. This would be useful for large libraries which are hard to port (<a href="https://ocaml.xyz/">owl</a> comes to mind).
</p>
</div>
<div id="outline-container-orgd0569a8" class="outline-4">
<h4 id="orgd0569a8">Overview of the Unikraft support</h4>
<div class="outline-text-4" id="text-orgd0569a8">
<p>
To add new MirageOS backends requires to create or modify a series of components:
</p>

<ul class="org-ul">
<li>a <a href="https://github.com/mirage/ocaml-unikraft">OCaml cross compiler</a> that can build this new backend, in particular by building its corresponding runtime and providing a way to build unikernel images (instead of normal executables),</li>
<li>new libraries for the <a href="https://github.com/mirage/mirage-unikraft">Unikraft system support</a>, and its <a href="https://github.com/mirage/mirage-net-unikraft">network</a> and <a href="https://github.com/mirage/mirage-block-unikraft">block</a> devices,</li>
<li><a href="https://github.com/mirage/mirage/pull/1607">support for the new backends</a> in the <code>mirage</code> tool.</li>
</ul>

<p>
Using Unikraft with a QEMU or a Firecracker backend is as simple as choosing the <code>unikraft-qemu</code> target or the <code>unikraft-firecracker</code> one when configuring a unikernel.
</p>
</div>
<ul class="org-ul">
<li><a id="org8782dfb"></a>The OCaml/Unikraft cross compiler<br />
<div class="outline-text-5" id="text-org8782dfb">
<p>
To build the <a href="https://github.com/mirage/ocaml-unikraft">OCaml cross compiler</a> to Unikraft, we use the <a href="https://unikraft.org">Unikraft</a> core, the Unikraft <a href="https://github.com/mirage/unikraft-lib-musl">lib-musl</a> and <a href="https://musl.libc.org/">musl</a> itself. <a href="https://musl.libc.org/">musl</a> is the C library recommended by Unikraft to build programs using the POSIX interface. This made it easy to build the OCaml 5 runtime, in particular because it provides an implementation of the <code>pthread</code> API which is now used in many places in the runtime[^*]. This could also make it easier to port some libraries that depend on <code>Unix</code> to work on Unikraft backends.
</p>

<p>
[^*]: Adding support for Thread-Local Storage has been a large part of the work to get OCaml 5 working on Solo5: even if the creation of threads is not supported, TLS is still necessary to get the runtime to compile.
</p>

<p>
The OCaml cross compiler <span class="underline">per se</span> builds upon the work that has been upstreamed to ease the <a href="https://discuss.ocaml.org/t/building-an-ocaml-cross-compiler-with-ocaml-5-3/15918">creation of cross compilers</a>, using almost the same series of patches than for <code>ocaml-solo5</code>. So the only version of the compiler that is currently supported for OCaml/Unikraft is OCaml 5.3. Almost all the patches will be in the upcoming OCaml 5.4 and there should no longer be any patches required by OCaml 5.5.
</p>

<p>
Note that we didn’t go with the full standard Unikraft POSIX stack, which includes <a href="https://savannah.nongnu.org/projects/lwip/">lwIP</a> to provide network support. We had a prototype at some point relying on lwIP to validate our progress on other building blocks but it raised many incompatibility issues with the standard MirageOS network stack so we dropped support for lwIP in that first release; we developed instead the libraries required to plug the MirageOS stacks into the low-level interfaces provided by the Unikraft core.
</p>
</div>
</li>
<li><a id="org93ded1d"></a>The new MirageOS libraries for Unikraft support<br />
<div class="outline-text-5" id="text-org93ded1d">
<p>
The Unikraft support comes with packages using the standard names: <code>mirage-block-unikraft</code> and <code>mirage-net-unikraft</code> to support the block and network devices. Those libraries are implemented directly on top of the low-level Unikraft APIs, and so are using <code>virtio</code> on both QEMU and Firecracker VMMs.
To evaluate the quality of the implementations for those devices, we ran a couple of small benchmarks. You can find those benchmarks (the unikernels along with some scripts to set them up and run them) in the <code>benchmarks</code> directory in <a href="https://github.com/Firobe/mirage-skeleton/tree/benchmarks">@Firobe’s fork of mirage-skeleton, <code>benchmarks</code> branch</a>. 
</p>
</div>
<ul class="org-ul">
<li><a id="org0df3cc5"></a>Network device<br />
<div class="outline-text-6" id="text-org0df3cc5">
<p>
To measure the performance of the network stack, we have tweaked the simple <a href="https://github.com/mirage/mirage-skeleton/tree/main/device-usage/network">network skeleton</a> unikernel to compute some statistics and used a variable number of clients all sending 512MB of null bytes. We have run this benchmark both on a couple of <code>x86_64</code> laptops and on a LX2160 <code>aarch64</code> board, all running a GNU/Linux OS.
</p>

<p>
We have observed a lot of variability in the performance of the <code>solo5-spt</code> unikernel (sometimes better, sometimes worse than <code>unikraft-qemu</code>) depending on the actual computer used, so those measures should be read with a grain of salt.
</p>

<p>
On two different <code>x86_64</code> laptops:
</p>


<div id="orgcaf69c4" class="figure">
<p><img src="https://us1.discourse-cdn.com/flex020/uploads/ocaml/original/2X/0/0ee00c0dca5cb89a4dceb6165e43cf5a46df2e01.jpeg" alt="0ee00c0dca5cb89a4dceb6165e43cf5a46df2e01.jpeg" width="80%" />
</p>
</div>


<div id="org052660e" class="figure">
<p><img src="https://us1.discourse-cdn.com/flex020/uploads/ocaml/original/2X/d/d8b19b3acbfb283a7a717d3c203b25bcfa6ecf20.png" alt="d8b19b3acbfb283a7a717d3c203b25bcfa6ecf20.png" width="80%" />
</p>
</div>

<p>
On the LX2160 <code>aarch64</code> board:
</p>


<div id="org45143d9" class="figure">
<p><img src="https://us1.discourse-cdn.com/flex020/uploads/ocaml/original/2X/f/fd4364c26dbd295590ef76346449a6daef50784d.jpeg" alt="fd4364c26dbd295590ef76346449a6daef50784d.jpeg" width="80%" />
</p>
</div>
</div>
</li>
<li><a id="org1c4a15c"></a>Block device<br />
<div class="outline-text-6" id="text-org1c4a15c">
<p>
To measure the performance of the block devices, we wrote a simple unikernel copying data from one disk to another. We can see that the performance of <code>unikraft-qemu</code> is lower than <code>solo5-hvt</code> for small buffer sizes; fortunately, the situation improves with larger buffer sizes. We ran this benchmark only on a <code>x86_64</code> laptop as there’s currently an <a href="https://github.com/unikraft/unikraft/issues/1622">issue with two block devices</a> on <code>aarch64</code> on Unikraft.
</p>


<div id="org39fde8c" class="figure">
<p><img src="https://us1.discourse-cdn.com/flex020/uploads/ocaml/optimized/2X/e/ee6f250ff3b0fc3efebdbe7b836198b0648cf24a_2_1380x974.png" alt="ee6f250ff3b0fc3efebdbe7b836198b0648cf24a_2_1380x974.png" width="80%" />
</p>
</div>

<p>
It is worth mentioning that I/Os can be parallelised, which also gives a significant performance boost. Indeed, <code>mirage-block-unikraft</code> can leverage the parallelised virtio backend of QEMU and Firecracker; it takes care of limiting I/Os to what the hardware supports in terms of both parallelism and sector size. 
</p>
</div>
</li>
</ul>
</li>
<li><a id="org8ccd8b5"></a>Current limitations<br />
<div class="outline-text-5" id="text-org8ccd8b5">
<ol class="org-ol">
<li>In our tests only Linux appeared well supported to compile Unikraft at the moment so we’ve restricted our packages to that OS for now.</li>
<li>Unikraft supports various backends itself; in this first release, we’ve only added support and tested its two major ones: <a href="https://www.qemu.org/">QEMU</a> and <a href="https://firecracker-microvm.github.io/">Firecracker</a>.</li>
</ol>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgb7140c8" class="outline-4">
<h4 id="orgb7140c8">How to use</h4>
<div class="outline-text-4" id="text-orgb7140c8">
<p>
To try the new Unikraft backend for MirageOS, you need to use an OCaml 5.3 switch, so create one first if needed. Then add our opam overlay to get access to our latest versions of the packages until they are published on the standard repository and install <code>mirage</code> and the OCaml/Unikraft cross compiler. The short version could be:
</p>

<pre class="example" id="org01d231f">
$ opam switch create unikraft-test 5.3.0
$ opam repo add mirage-unikraft-overlays https://github.com/Firobe/mirage-unikraft-overlays.git
$ opam install mirage ocaml-unikraft-backend-qemu ocaml-unikraft-x86_64
</pre>

<p>
See below for some explanations about the numerous OCaml/Unikraft packages.
</p>

<p>
From then on, you can follow the standard procedure (see how to <a href="https://mirage.io/docs/install">install MirageOS</a> and how to <a href="https://mirage.io/docs/hello-world">build a hello-world unikernel</a>) to build your unikernel with the Unikraft backend of your choice.
</p>

<pre class="example" id="orgcf363c5">
$ mirage configure -t unikraft-qemu
$ make
</pre>
</div>
<ul class="org-ul">
<li><a id="orgfc63ad6"></a>Details about the various packages for the OCaml/Unikraft cross compiler<br />
<div class="outline-text-5" id="text-orgfc63ad6">
<p>
The <a href="https://github.com/mirage/ocaml-unikraft">OCaml cross compiler</a> to Unikraft is split up into 14 packages (see the <a href="https://github.com/ocaml/opam-repository/pull/27856">PR to <code>opam-repository</code></a> for more details) so that users can:
</p>

<ul class="org-ul">
<li>choose which of the backends (QEMU or Firecracker) and which of the architectures (<code>x86_64</code> and <code>arm64</code>) they want to install, where all combinations can be installed at the same time,</li>
<li>choose which architecture is generated when they use the <code>unikraft</code> ocamlfind toolchain by installing one of the two <code>ocaml-unikraft-default-&lt;arch&gt;</code> package,</li>
<li>install the <code>ocaml-unikraft-option-debug</code> to enable the (really verbose!) debugging messages.</li>
</ul>

<p>
The virtual packages can be installed to make sure one of the architecture-specific packages is indeed installed:
</p>

<ul class="org-ul">
<li><code>ocaml-unikraft</code> can be installed to make sure that there is indeed a <code>unikraft</code> ocamlfind toolchain installed,</li>
<li><code>ocaml-unikraft-backend-qemu</code> and <code>ocaml-unikraft-backend-firecracker</code> can be intalled to make sure that the <code>unikraft</code> ocamlfind toolchain supports the corresponding backend.</li>
</ul>

<p>
Those virtual packages will be used in particular by the <code>mirage</code> tool when the target is <code>unikraft-qemu</code> or <code>unikraft-firecracker</code>.
</p>

<p>
All those packages use one of two version numbers. The backend packages use the Unikraft version number they are using, while the OCaml compiler packages <span class="underline">per se</span> use version <code>1.0.0</code>.
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-org6054272" class="outline-4">
<h4 id="org6054272">Conclusion</h4>
<div class="outline-text-4" id="text-org6054272">
<p>
This is a first release, which we are experimenting with; we expect to run it in production in the coming months but it may need improvements nevertheless. Notably absent from this release is an early attempt to leverage Unikraft’s POSIX compatibility to implement Mirage interfaces instead of hooking directly to Unikraft’s internal components. This early version used Unikraft’s <code>lwIP</code>-based network stack instead of Mirage’s (fooling Mirage into thinking it was running on Unix), and it may be interesting to revisit this kind of deployment, in particular for easy inclusion of unix-only OCaml libraries in unikernels.
</p>

<p>
We are eager for reviews, comments and discussion on the implementation, design and approach of this new Mirage backend, and hope it will be useful to others.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-10" class="outline-2">
<h2 id="10">Other OCaml News</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgd688551" class="outline-3">
<h3 id="orgd688551">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-orgd688551">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://tarides.com/blog/2025-07-09-introducing-jane-street-s-oxcaml-branch">Introducing Jane Street's OxCaml Branch!</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org86d3e99" class="outline-2">
<h2 id="org86d3e99">Old CWN</h2>
<div class="outline-text-2" id="text-org86d3e99">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe to the <a href="https://sympa.inria.fr/sympa/info/caml-list">caml-list</a>.
</p>

<div class="authorname" id="org508e115">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
