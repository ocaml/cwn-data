<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-06-15 Tue 15:28 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2021.06.08.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2021.06.22.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of June 08 to 15, 2021.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">Dependency visualization tool</a></li>
<li><a href="#2">Multicore OCaml: May 2021</a></li>
<li><a href="#3">First release of Popper</a></li>
<li><a href="#4">Orsetto: structured data interchange languages (release 1.1)</a></li>
<li><a href="#org4400a87">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Dependency visualization tool</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/dependency-visualization-tool/7964/2">https://discuss.ocaml.org/t/dependency-visualization-tool/7964/2</a>
</p>
</div>

<div id="outline-container-orgafee5e8" class="outline-3">
<h3 id="orgafee5e8">Chet Murthy announced</h3>
<div class="outline-text-3" id="text-orgafee5e8">
<p>
In the past, I've found doing this sort of dependency-graphing to be very useful for figuring out where
modularization in a large system needs to be applied.  And it's not very hard to do, based on ocamldep
output or other dependency information that already exists.
</p>

<p>
On a lark, I wrote something that did this for installed findlib packages:
<a href="https://github.com/chetmurthy/not-ocamlfind#package-graph">https://github.com/chetmurthy/not-ocamlfind#package-graph</a>
</p>

<p>
I mention this not to plug the tool, but rather, just to note that it's really easy, and yeah, people
should avail themselves of this more.
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">Multicore OCaml: May 2021</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/multicore-ocaml-may-2021/7990/1">https://discuss.ocaml.org/t/multicore-ocaml-may-2021/7990/1</a>
</p>
</div>

<div id="outline-container-org9e3a6f5" class="outline-3">
<h3 id="org9e3a6f5">Anil Madhavapeddy announced</h3>
<div class="outline-text-3" id="text-org9e3a6f5">
<p>
Welcome to the May 2021 <a href="https://github.com/ocaml-multicore/ocaml-multicore">Multicore OCaml</a> monthly
report! This month's update along with the <a href="https://discuss.ocaml.org/tag/multicore-monthly">previous
updates</a> have been compiled by @avsm, @ctk21,
@kayceesrk and @shakthimaan.
</p>

<p>
Firstly, all of our upstream activity on the OCaml compiler is now reported as part of the shiny new
<a href="https://discuss.ocaml.org/t/ocaml-compiler-development-newsletter-issue-2-may-2021/7965">compiler development newsletter
#2</a> that
@gasche has started. This represents a small but important shift &#x2013; domains-only multicore is firmly
locked in on the upstream roadmap for OCaml 5.0 and the whole OCaml compiler team has been helping and
contributing to it, with the <a href="https://github.com/ocaml/ocaml/pull/10039">GC safe points</a> feature being
one of the last major multicore-prerequisites (and due to be in OCaml 4.13 soon).
</p>

<p>
This multicore newsletter will now focus on getting our ecosystem ready for domains-only multicore in
OCaml 5.0, and on how the (not-yet-official) effect system and multicore IO stack is progressing.  It's
a long one this month, so settle in with your favourite beverage and let's begin :-)
</p>
</div>

<div id="outline-container-org4727157" class="outline-4">
<h4 id="org4727157">OCaml Multicore: 4.12.0+domains</h4>
<div class="outline-text-4" id="text-org4727157">
<p>
The multicore compiler now supports CTF runtime traces of its garbage collector and there are <a href="https://github.com/ocaml-multicore/eventlog-tools/tree/multicore_wip">tools to
display chrome tracing
visualisations</a> of the garbage
collector events. A number of performance improvements (see speedup graphs later on) that highlight
some ways to make best use of multicore were made to the existing benchmarks in Sandmark.  There has
also been work on scaling up to 128 cores/domains for task-based parallelism in domainslib using <a href="https://github.com/ocaml-multicore/domainslib/pull/29">work
stealing deques</a>, bringing us closer to
Cilk-style task-parallel performance.
</p>

<p>
As important as new features are what we have decided <span class="underline">not</span> to do. We've been working on and evaluating
Domain Local Allocation Buffers (DLABs) for some time, with the intention of reducing the cost of minor
GCs. We've found that the resulting performance didn't match our expectations (_vs_ the complexity of
the change), and so we've decided not to proceed with this for OCaml 5.0.  You can find the <a href="https://github.com/ocaml-multicore/ocaml-multicore/wiki/Domain-Local-Allocation-Buffers-Addendum">DLAB
summary</a>
page summarises our experiences. We'll come back to this post-OCaml 5.0 when there are fewer moving
parts.
</p>
</div>
</div>

<div id="outline-container-orgeb2f667" class="outline-4">
<h4 id="orgeb2f667">Ecosystem changes to prepare for 5.0.0 domains-only</h4>
<div class="outline-text-4" id="text-orgeb2f667">
<p>
As we are preparing 5.0 branches with the multicore branches over the coming months, we are stepping up
preparations to ensure the OCaml ecosystem is ready.
</p>
</div>

<div id="outline-container-org87ebf8d" class="outline-5">
<h5 id="org87ebf8d">Making the multicore compilers available by default in opam-repo</h5>
<div class="outline-text-5" id="text-org87ebf8d">
<p>
Over the next few week, we will be merging the multicore 4.12.0+domains and associated packages from
their opam remote over in
<a href="https://github.com/ocaml-multicore/multicore-opam">ocaml-multicore/multicore-opam</a> into the mainline
opam-repository. This is to make it more convenient to use the variant compilers to start testing your
own packages with ~Domain~s.
</p>

<p>
As part of this change, there are two new base packages that will be available in opam-repository:
</p>

<ul class="org-ul">
<li><code>base-domains</code>: This package indicates that the current compiler has the <code>Domain</code> module.</li>
<li><code>base-effects</code>: This package indicates the current compiler has the experimental effect system.</li>
</ul>

<p>
By adding a dependency on these packages, the only valid solutions will be <code>4.12.0+domains</code> (until
OCaml 5.0 which will have this module) or <code>4.12.0+effects</code>.
</p>

<p>
The goal of this is to let community packages more easily release versions of their code using
Domains-only parallelism ahead of OCaml 5.0, so that we can start migration and thread-safety early.
We do not encourage anyone to take a dependency on base-effects currently, as it is very much a moving
target.
</p>

<p>
This opam-repository change isn't in yet, but I'll comment on this post when it is merged.
</p>
</div>
</div>

<div id="outline-container-orga3b0a70" class="outline-5">
<h5 id="orga3b0a70">Adapting the Stdlib for thread-safety</h5>
<div class="outline-text-5" id="text-orga3b0a70">
<p>
One of the first things we have to do before porting third-party libraries is to get the Stdlib ready
for thread-safety. This isn't quite as simple as it might appear at first glance: if we adopt the naïve
approach of simply putting a mutex around every bit of global state, our sequential performance will
slow down. Therefore we are performing a more fine-grained analysis and fixes, which can be seen <a href="https://github.com/ocaml-multicore/ocaml-multicore/wiki/Safety-of-Stdlib-under-Multicore-OCaml">on
the multicore stdlib
page</a>.
</p>

<p>
For anyone wishing to contribute: hunt through the Stdlib for global state, and categorise it
appropriately, and then create a test case exercising that module with multiple Domains running, and
submit a PR to <a href="https://github.com/ocaml-multicore/ocaml-multicore">ocaml-multicore</a>.  In general, if
you see any build failures or runtime failures now, we'd really appreciate an issue being filed there
too. You can see some good examples of such issues
<a href="https://github.com/ocaml-multicore/ocaml-multicore/issues/574">here</a> (for mirage-crypto) and
<a href="https://github.com/ocaml-multicore/ocaml-multicore/issues/568">here</a> (for Coqt).
</p>
</div>
</div>

<div id="outline-container-org0917b45" class="outline-5">
<h5 id="org0917b45">Porting third-party libraries to Domains</h5>
<div class="outline-text-5" id="text-org0917b45">
<p>
As I mentioned last month, we put a call out for libraries and maintainers who wanted to port their
code over. We're starting with the following libraries and applications this month:
</p>

<ul class="org-ul">
<li><b>Lwt</b>: the famous lightweight-threads library now has a PR to add <a href="https://github.com/ocsigen/lwt/pull/860">Lwt_domains</a>. This is the first simple(ish) step to using multicore cores with Lwt: it lets you run a pure (non-Lwt) function in another Domain via <code>detach : ('a -&gt; 'b) -&gt; 'a -&gt; 'b Lwt.t</code>.</li>

<li><b>Mirage-Crypto</b>: the next library we are adapting is the cryptography library, since it is also low-hanging fruit that should be easy to parallelise (since crypto functions do not have much global state). The port is still ongoing, as there are some minor build failures and also Stdlib functions in Format that aren't yet thread-safe that are <a href="https://github.com/ocaml-multicore/ocaml-multicore/issues/563">causing failures</a>.</li>

<li><b>Tezos-Node</b>: the bigger application we are applying some of the previous dependencies too is Tezos-Node, which makes use of the dependency chain here via Lwt, mirage-crypto, Irmin, Cohttp and many other libraries. We've got this <a href="https://gitlab.com/tezos/tezos/-/merge_requests/2671">compiling under 4.12.0+domains</a> now and mostly passing the test suite, but will only report significant results once the dependencies and Stdlib are passing.</li>

<li><b>Owl</b>: OCaml's favourite machine learning library works surprisingly well out-of-the-box with 4.12.0+domains. An experiment for a significant machine-learning codebase written using it saw about a 2-4x speedup before some false-sharing bottlenecks kicked in. This is pretty good going given that we made no changes to the codebase itself, but stay tuned for more improvements over the coming months as we analyse the bottleneck.</li>
</ul>

<p>
This is hopefully a signal to all of you to start "having a go" with 4.12.0+domains on your own
applications, and particularly with respect to seeing how wrapping it in Domains works out and
identifying global state. You can read our handy <a href="https://github.com/ocaml-multicore/parallel-programming-in-multicore-ocaml">tutorial on parallel programming with Multicore
OCaml</a>.
</p>

<p>
We are developing some tools to help find global state, but we're going to all need to work together to
identify some of these cases and begin migration.  Crucially, we need some diversity in our dependency
chains &#x2013; if you have interesting applications using (e.g.) Async or the vanilla <code>Thread</code> module and
have some cycles to work with us, please get in touch with me or @kayceesrk .
</p>
</div>
</div>
</div>

<div id="outline-container-org8a62aa1" class="outline-4">
<h4 id="org8a62aa1">4.12.0+effects</h4>
<div class="outline-text-4" id="text-org8a62aa1">
<p>
The effects-based <a href="https://github.com/ocaml-multicore/eio">eio library</a> is coming together nicely, and
the interface and design rationales are all up-to-date in the README of the repository.  The primary IO
backend is <a href="https://github.com/ocaml-multicore/ocaml-uring">ocaml-uring</a>, which we are preparing for a
separate release to opam-repository now as it also works fine on the sequential runtime for Linux (as
long as you have a fairly recent kernel. Otherwise the kernel crashes).  We also have a <a href="https://github.com/ocaml-multicore/eio/pull/26">Grand Central
Dispatch effect backend</a> to give us a totally different
execution model to exercise our effect handler abstractions.
</p>

<p>
While we won't publish the performance numbers for the effect-based IO this month, you can get a sense
of the sorts of tests we are running by looking at the
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench">retro-httpaf-bench</a> repository, which now has
various permutations of effects-based, uring-based and select-based webservers. We've submitted a talk
to the upcoming OCaml Workshop later this summer, which, if accepted, will give you a deepdive into our
effect-based IO.
</p>

<p>
As always, we begin with the Multicore OCaml ongoing and completed tasks.  The ecosystem improvements
are then listed followed by the updates to the Sandmark benchmarking project. Finally, the upstream
OCaml work is mentioned for your reference.  For those of you that have read this far and can think of
nothing more fun than hacking on multicore programming runtimes, we are hiring in the UK, France and
India &#x2013; please find the job postings at the end!
</p>
</div>
</div>

<div id="outline-container-orgd60e369" class="outline-4">
<h4 id="orgd60e369">Multicore OCaml</h4>
<div class="outline-text-4" id="text-orgd60e369">
</div>
<div id="outline-container-org5ad2cc0" class="outline-5">
<h5 id="org5ad2cc0">Ongoing</h5>
<div class="outline-text-5" id="text-org5ad2cc0">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/552">ocaml-multicore/ocaml-multicore#552</a>
Add a force_instrumented_runtime option to configure
</p>

<p>
A new <code>--enable-force-instrumented-runtime</code> option is introduced to
facilitate use of the instrumented runtime on linker invocations to
obtain event logs.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/issues/553">ocaml-multicore/ocaml-multicore#553</a>
Testsuite failures with flambda enabled
</p>

<p>
A list of tests are failing on <code>b23a416</code> with flambda enabled, and
they need to be investigated further.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/555">ocaml-multicore/ocaml-multicore#555</a>
runtime: CAML_TRACE_VERSION is now set to a Multicore specific value
</p>

<p>
Define a <code>CAML_TRACE_VERSION</code> to distinguish between Multicore OCaml
and trunk for the runtime.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/558">ocaml-multicore/ocaml-multicore#558</a>
Refactor Domain.{spawn/join} to use no critical sections
</p>

<p>
The PR removes the use of <code>Domain.wait</code> and critical sections in
<code>Domain.{spawn/join}</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/559">ocaml-multicore/ocaml-multicore#559</a>
Improve the Multicore GC Stats
</p>

<p>
A draft PR to include more Multicore GC statistics when using
<code>OCAMLRUNPARAM=v=0x400</code>.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org365daab" class="outline-5">
<h5 id="org365daab">Completed</h5>
<div class="outline-text-5" id="text-org365daab">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/508">ocaml-multicore/ocaml-multicore#508</a>
Domain Local Allocation Buffers
</p>

<p>
The Domain Local Allocation Buffer implementation for OCaml Multicore has been dropped for now. A discussion is on the PR itself and there is a wiki page <a href="https://github.com/ocaml-multicore/ocaml-multicore/wiki/Domain-Local-Allocation-Buffers-Addendum">here</a>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/527">ocaml-multicore/ocaml-multicore#527</a>
Port eventlog to CTF
</p>

<p>
The porting of the <code>eventlog</code> implementation to the Common Trace
Format is now complete.
</p>

<p>
For an introduction to producing Chrome trace visualizations of the runtime events see <a href="https://github.com/ocaml-multicore/eventlog-tools/tree/multicore_wip">eventlog-tools</a>. This postprocessing tool turns the CTF trace into the Chrome tracing format that allows interactive visualizations like this:
<img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/optimized/2X/7/7984354f12695102e97bd6a37202ea8da9a6decf_2_1380x950.jpeg" alt="7984354f12695102e97bd6a37202ea8da9a6decf_2_1380x950.jpeg" />
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/543">ocaml-multicore/ocaml-multicore#543</a>
Parallel version of weaklifetime test
</p>

<p>
A parallel version of the <code>weaklifetime.ml</code> test is now added to the
test suite.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/546">ocaml-multicore/ocaml-multicore#546</a>
Coverage of domain life-cycle in domain_dls and ephetest_par tests
</p>

<p>
Additional tests to increase test coverage for domain life-cycle for
<code>domain_dls.ml</code> and <code>ephetest_par.ml</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/550">ocaml-multicore/ocaml-multicore$#550</a>
Lazy effects test
</p>

<p>
Inclusion of a test to address effects with Lazy computations for a
number of different use cases.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/ocaml-multicore/pull/557">ocaml-multicore/ocaml-multicore#557</a>
Remove unused domain functions
</p>

<p>
A clean-up to remove unused functions in <code>domain.c</code> and <code>domain.h</code>.
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgbe81c7a" class="outline-4">
<h4 id="orgbe81c7a">Ecosystem</h4>
<div class="outline-text-4" id="text-orgbe81c7a">
</div>
<div id="outline-container-orgc3e249a" class="outline-5">
<h5 id="orgc3e249a">Ongoing</h5>
<div class="outline-text-5" id="text-orgc3e249a">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/eventlog-tools/pull/2">ocaml-multicore/eventlog-tools#2</a>
Add a pausetimes tool
</p>

<p>
The <code>eventlog_pausetimes</code> tool takes a directory of eventlog files
and computes the mean, max pause times, as well as the distribution
up to the 99.9th percentiles. For example:
</p>

<pre class="example" id="org39adaef">
ocaml-eventlog-pausetimes /home/engil/dev/ocaml-multicore/trace3/caml-426094-* name
{
  "name": "name",
  "mean_latency": 718617,
  "max_latency": 33839379,
  "distr_latency": [191,250,707,16886,55829,105386,249272,552640,1325621,13312993,26227671]
}
</pre></li>

<li><p>
<a href="https://github.com/ocaml-multicore/domainslib/pull/29">domainslib#29</a>
Task stealing with CL deques
</p>

<p>
This ongoing work to use task-stealing Chase Lev deques for scheduling
tasks across domains is looking very promising. Particularly for machines
with 128 cores.
</p></li>
</ul>

<p>
*
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench/pull/10">ocaml-multicore/retro-httpaf-bench#10</a>
  Add Eio benchmark
</p>

<p>
The addition of an Eio benchmark for retro-httpaf-bench. This is a
work-in-progress.
</p>

<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/26">ocaml-multicore/eio#26</a>
Grand Central Dispatch Backend
</p>

<p>
An early draft PR that implements the Grand Central Dispatch (GCD)
backend for Eio.
</p></li>

<li><p>
<a href="https://github.com/ocsigen/lwt/pull/860">ocsigen/lwt#860</a>
Lwt_domain: An interfacet to Multicore parallelism
</p>

<p>
An on-going effort to introduce <code>Lwt_domain</code> for performing
computations to CPU cores using Multicore OCaml's Domains.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orge4a80ac" class="outline-5">
<h5 id="orge4a80ac">Completed</h5>
<div class="outline-text-5" id="text-orge4a80ac">
</div>
<div id="outline-container-org487010d" class="outline-6">
<h6 id="org487010d">retro-httpaf-bench</h6>
<div class="outline-text-6" id="text-org487010d">
<p>
The <code>retro-httpaf-bench</code> repository contains scripts for running HTTP
server benchmarks.
</p>

<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench/pull/6">ocaml-multicore/retro-httpaf-bench#6</a>
Move OCaml to 4.12
</p>

<p>
The build scripts have been updated to use 4.12.0.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench/pull/8">ocaml-multicore/retro-httpaf-bench#8</a>
Adds a Rust benchmark using hyper
</p>

<p>
The inclusion of the Hyper benchmark limited to a single core to
match the other existing benchmarks.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench/pull/9">ocaml-multicore/retro-httpaf-bench#9</a>
Release builds for dune, stretch request volumes, rust fixes and remove mimalloc
</p>

<p>
The Dockerfile, README, build_benchmarks.sh and run_benchmarks.sh
files have been updated.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/retro-httpaf-bench/pull/5">ocaml-multicore/retro-httpaf-bench#15</a>
Make benchmark more realistic
</p>

<p>
The PR enhances the implementation to correctly simulate a
hypothetical database request, and the effects code has been updated
accordingly.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org016363b" class="outline-6">
<h6 id="org016363b">eio</h6>
<div class="outline-text-6" id="text-org016363b">
<p>
The <code>eio</code> library provides an effects-based parallel IO stack for
Multicore OCaml.
</p>

<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/18">ocaml-multicore/eio#18</a>
Add fibreslib library
</p>

<p>
The <code>promise</code> library has been renamed to <code>fibreslib</code> to avoid
naming conflict with the existing package in opam, and the API
(waiters and effects) has been split into its own respective
modules.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/19">ocaml-multicore/eio#19</a>
Update to latest ocaml-uring
</p>

<p>
The code and configuration files have been updated to use the latest
<code>ocaml-uring</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/20">ocaml-multicore/eio#20</a>
Add Fibreslib.Semaphore
</p>

<p>
Implemented the <code>Fibreslib.Semaphone</code> module that is useful for
rate-limiting, and based on OCaml's <code>Semaphore.Counting</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/21">ocaml-multicore/eio#21</a>
Add high-level Eio API
</p>

<p>
A new Eio library with interfaces for sources and sinks. The README
documentation has been updated with motivation and usage.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/22">ocaml-multicore/eio#22</a>
Add switches for structured concurrency
</p>

<p>
Implementation of structured concurrency with documentation examples
for tracing and testing with mocks.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/23">ocaml-multicore/eio#23</a>
Rename repository to eio
</p>

<p>
The Effects based parallel IO for OCaml repository has now been
renamed from <code>eioio</code> to <code>eio</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/24">ocaml-multicore/eio#24</a>
Rename lib_eioio to lib_eunix
</p>

<p>
The names have been updated to match the dune file.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/25">ocaml-multicore/eio#25</a>
Detect deadlocks
</p>

<p>
An exception is now raised to detect deadlocks if the scheduler
finishes while the main thread continues to run.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/27">ocaml-multicore/eio#27</a>
Convert expect tests to MDX
</p>

<p>
The expected tests have been updated to use the MDX format, and this
avoids the need for ppx libraries.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/28">ocaml-multicore/eio#28</a>
Use splice to copy if possible
</p>

<p>
The effect Splice has been implemented along with the update to
ocaml-uring, and necessary documentation.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/29">ocaml-multicore/eio#29</a>
Improve exception handling in switches
</p>

<p>
Additional exception checks to handle when multiple threads fail,
and for <code>Switch.check</code> and <code>Fibre.fork_ignore</code>.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/30">ocaml-multicore/eio#30</a>
Add eio_main library to select backend automatically
</p>

<p>
Use <code>eio_main</code> to select the appropriate backend (<code>eunix</code>, for
example) based on the platform.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/31">ocaml-multicore/eio#31</a>
Add Eio.Flow API
</p>

<p>
Implemented a Flow module that allows combinations such as
bidirectional flows and closable flows.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/32">ocaml-multicore/eio#32</a>
Initial support for networks
</p>

<p>
Eio provides a high-level API for networking, and the <code>Network</code>
module has been added.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/33">ocaml-multicore/eio#33</a>
Add some design rationale notes to the README
</p>

<p>
The README has been updated with design notes, and reference to
further reading on the principles of Object-capability model.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/34">ocaml-multicore/eio#34</a>
Add shutdown, allow closing listening sockets, add cstruct_source
</p>

<p>
Added cstruct_source, <code>shutdown</code> method along with source, sink and
file descriptor types.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/eio/pull/35">ocaml-multicore/eio#35</a>
Add Switch.on_release to auto-close FDs
</p>

<p>
We can now attach resources such as file descriptors to switches,
and these are freed when the the switch is finished.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-org059b773" class="outline-6">
<h6 id="org059b773">Sundries</h6>
<div class="outline-text-6" id="text-org059b773">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-multicore/domainslib/issues/23">ocaml-multicore/domainslib#23</a>
Running tests: moving to <code>dune runtest</code> from manual commands in
<code>run_test</code> target
</p>

<p>
The <code>dune runtest</code> command is now used to execute the tests.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/domainslib/pull/24">ocaml-multicore/domainslib#24</a>
Move to Mutex &amp; Condition from Domain.Sync.{notify/wait}
</p>

<p>
The channel implementation using <code>Mutex</code> and <code>Condition</code> is now
complete. The performance results are shown in the following graph:
</p>


<div id="orgf27993c" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/optimized/2X/c/c3525f387ece415069bbac1f76525cf2ca96ef1d_2_930x1000.png" alt="c3525f387ece415069bbac1f76525cf2ca96ef1d_2_930x1000.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-multicore/multicore-opam/pull/53">ocaml-multicore/multicore-opam#53</a>
Add base-domains and base-effects packages
</p>

<p>
The <code>base-domains</code> and <code>base-effects</code> opam files have now been added
to multicore-opam.
</p></li>

<li><p>
<a href="https://github.com/ocaml-multicore/multicore-opam/pull/54">ocaml-multicore/multicore-opam#54</a>
Shift all multicore packages to unique versions and base-domains dependencies
</p>

<p>
The naming convention is to now use <code>base-effects</code> and
<code>base-domains</code> everywhere.
</p></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-orgcc3acfd" class="outline-4">
<h4 id="orgcc3acfd">Benchmarking</h4>
<div class="outline-text-4" id="text-orgcc3acfd">
</div>
<div id="outline-container-orgce56579" class="outline-5">
<h5 id="orgce56579">Ongoing</h5>
<div class="outline-text-5" id="text-orgce56579">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/230">ocaml-bench/sandmark#230</a>
Build for 4.13.0+trunk with dune.2.8.1
</p>

<p>
A work-in-progress to upgrade Sandmark to use dune.2.8.1 to build
4.13.0+trunk and generate the benchmarks. You can test the same
using:
</p>

<pre class="example" id="org5389ced">
TAG='"macro_bench"' make run_config_filtered.json
RUN_CONFIG_JSON=run_config_filtered.json make ocaml-versions/4.13.0+trunk.bench
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-orge2edf13" class="outline-5">
<h5 id="orge2edf13">Completed</h5>
<div class="outline-text-5" id="text-orge2edf13">
</div>
<div id="outline-container-orgcdde411" class="outline-6">
<h6 id="orgcdde411">Sandmark</h6>
<div class="outline-text-6" id="text-orgcdde411">
</div>
<ul class="org-ul">
<li><a id="org6b3e549"></a>Performance<br />
<div class="outline-text-7" id="text-org6b3e549">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/221">ocaml-bench/sandmark#221</a>
Fix up decompress iterations of work
</p>

<p>
The use of <code>parallel_for</code>, simplification of <code>data_to_compress</code> to
use <code>String.init</code>, and fix to correctly count the amount of work
configured and done produces the following speed improvements:
</p>


<div id="org8af35a1" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/4/49a4b0b3f2e8e7c89e23c91c5f5307cdaa160d5c.png" alt="49a4b0b3f2e8e7c89e23c91c5f5307cdaa160d5c.png" />
</p>
</div>


<div id="org61df2ce" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/4/49bfcda236b0a900565c73b37867a7d35565b266.png" alt="49bfcda236b0a900565c73b37867a7d35565b266.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/223">ocaml-bench/sandmark#223</a>
A better floyd warshall
</p>

<p>
An improvement to the Floyd Warshall implementation that fixes the
random seed so that it is repeatable, and improves the pattern
matching.
</p>

<p>
<img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/4/4a89577052976a094a4813b194aca1ebfb316a73.png" alt="4a89577052976a094a4813b194aca1ebfb316a73.png" />
<img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/b/be902a7ddc891b318c42a0e625b3335fbfeba1d0.png" alt="be902a7ddc891b318c42a0e625b3335fbfeba1d0.png" />
<img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/c/cbc5f44ea2b594b7d644a1ced93407e545c0bdb1.png" alt="cbc5f44ea2b594b7d644a1ced93407e545c0bdb1.png" />
</p></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/224">ocaml-bench/sandmark#224</a>
Some improvements for matrix multiplication
</p>

<p>
The <code>matrix_multiplication</code> and <code>matrix_multiplication_multicore</code>
code have been updated for easier maintenance, and results are
written only after summing the values.
</p>


<div id="org23cf6c9" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/a/ac194a6ecd26bdb6d9e602378ed4b44eb1f67d8e.png" alt="ac194a6ecd26bdb6d9e602378ed4b44eb1f67d8e.png" />
</p>
</div>


<div id="org0e3db14" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/4/4ecdd0c82cd59f50fffd9078cd85b5bbcf740e09.png" alt="4ecdd0c82cd59f50fffd9078cd85b5bbcf740e09.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/225">ocaml-bench/sandmark#225</a>
Better Multicore EA Benchmark
</p>

<p>
The Evolutionary Algorithm now inserts a poll point into <code>fittest</code>
to improve the benchmark results.
</p>


<div id="org943a364" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/6/613a8f51682c02da672d12232bd8b244c65ba6d7.png" alt="613a8f51682c02da672d12232bd8b244c65ba6d7.png" />
</p>
</div>


<div id="org0e41a06" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/b/b135d1269f57af9df575ab51ef7c31583713b42c.png" alt="b135d1269f57af9df575ab51ef7c31583713b42c.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/226">ocaml-bench/sandmark#226</a>
Better scaling for mandelbrot6_multicore
</p>

<p>
The <code>mandelbrot6_multicore</code> scales well now with the use of
<code>parallel_for</code> as observed in the following graphs:
</p>


<div id="org7132e7e" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/3/3ae484f3942252583abc4d44cebc0051adec2b32.png" alt="3ae484f3942252583abc4d44cebc0051adec2b32.png" />
</p>
</div>


<div id="orgadfa11e" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/b/b7dbb656928988548ae9668c0d1edfe5186479b2.png" alt="b7dbb656928988548ae9668c0d1edfe5186479b2.png" />
</p>
</div>


<div id="org7915dac" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/2/241f9360e8b3fee78b6f5d95ed40f7dcff24f813.png" alt="241f9360e8b3fee78b6f5d95ed40f7dcff24f813.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/227">ocaml-bench/sandmark#227</a>
Improve nbody_multicore benchmark with high core counts
</p>

<p>
The <code>energy</code> function is now parallelised with <code>parallel_for_reduce</code>
for larger core counts.
</p>


<div id="orge5f2281" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/d/d5bb284534e0f32e24c7d8937afa4cac022ef79c.png" alt="d5bb284534e0f32e24c7d8937afa4cac022ef79c.png" />
</p>
</div>


<div id="org493f083" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/b/be718f3e5cc676f44c827dfa56bdfa01e376e447.png" alt="be718f3e5cc676f44c827dfa56bdfa01e376e447.png" />
</p>
</div></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/229">ocaml-bench/sandmark#229</a>
Improve game_of_life benchmarks
</p>

<p>
The hot functions are now inlined to improve the <code>game_of_life</code>
benchmarks, and we avoid initialising the temporary matrix with
random numbers.
</p>


<div id="org5c9c93f" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/5/50c1b7e799a4c71ee4585409d1eba575bf0748ed.png" alt="50c1b7e799a4c71ee4585409d1eba575bf0748ed.png" />
</p>
</div>


<div id="org319b676" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/e/eb7b75ddaa314fa80908f12758f974223eb70490.png" alt="eb7b75ddaa314fa80908f12758f974223eb70490.png" />
</p>
</div></li>
</ul>
</div>
</li>

<li><a id="org3863817"></a>Sundries<br />
<div class="outline-text-7" id="text-org3863817">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/215">ocaml-bench/sandmark#215</a>
Remove Gc.promote_to from treiber_stack.ml
</p>

<p>
The 4.12+domains and 4.12+domains+effects branches have
<code>Gc.promote_to</code> removed from the runtime.
</p></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/216">ocaml-bench/sandmark#216</a>
Add configs for 4.12.0+stock, 4.12.0+domains, 4.12.0+domains+effects
</p>

<p>
The ocaml-version configuration files for 4.12.0+stock,
4.12.0+domains, and 4.12.0+domains+effects have now been included
to Sandmark.
</p></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/220">ocaml-bench/sandmark#220</a>
Attempt to improve the OCAMLRUNPARAM documentation
</p>

<p>
The README has been updated with more documentation on the use of
OCAMLRUNPARAM configuration when running the benchmarks.
</p></li>

<li><p>
<a href="https://github.com/ocaml-bench/sandmark/pull/222">ocaml-bench/sandmark#222</a>
Deprecate 4.06.1 and 4.10.0 and upgrade to 4.12.0
</p>

<p>
The 4.06.1, 4.10.0 ocaml-versions have been removed and the CI
has been updated to use 4.12.0 as the default version.
</p></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org7278c36" class="outline-6">
<h6 id="org7278c36">current-bench</h6>
<div class="outline-text-6" id="text-org7278c36">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocurrent/current-bench/issues/103">ocurrent/current-bench#103</a>
Ability to set scale on UI to start at 0
</p>

<p>
The graph origins now start from <code>[0, y_max+delta]</code> for the y-axis
for better comparison.
</p>

<p>
![current-bench frontend fix 0 baseline](images/Current-bench-PR-74.png)
</p></li>

<li><p>
<a href="https://github.com/ocurrent/current-bench/pull/121">ocurrent/current-bench#121</a>
Use string representation for docker cpu setting.
</p>

<p>
The <code>OCAML_BENCH_DOCKER_CPU</code> setting now switches from Integer to
String to support a range of CPUs for parallel execution.
</p></li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-org3cbc081" class="outline-4">
<h4 id="org3cbc081">OCaml</h4>
<div class="outline-text-4" id="text-org3cbc081">
</div>
<div id="outline-container-orge38786d" class="outline-5">
<h5 id="orge38786d">Ongoing</h5>
<div class="outline-text-5" id="text-orge38786d">
<ul class="org-ul">
<li><p>
<a href="https://github.com/ocaml/ocaml/pull/10039">ocaml/ocaml#10039</a>
Safepoints
</p>

<p>
The Sandmark benchmark runs to obtain the performance numbers for
the Safepoints PR for 4.13.0+trunk have been published. The PR is
ready to be merged.
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org047d8b9" class="outline-4">
<h4 id="org047d8b9">Job Advertisements</h4>
<div class="outline-text-4" id="text-org047d8b9">
<ul class="org-ul">
<li><a href="https://discuss.ocaml.org/t/runtime-systems-engineer-ocaml-labs-uk-tarides-fr-segfault-systems-in-remote/7959">Multicore OCaml Runtime Systems Engineer</a> OCaml Labs (UK), Tarides (France) and Segfault Systems (India)</li>

<li><a href="https://tarides.com/jobs/benchmark-tooling-engineer">Benchmark Tooling Engineer</a>
Tarides</li>
</ul>

<p>
Our thanks to all the OCaml users, developers and contributors in the
community for their continued support to the project. Stay safe!
</p>
</div>
</div>

<div id="outline-container-orgd6e0b23" class="outline-4">
<h4 id="orgd6e0b23">Acronyms</h4>
<div class="outline-text-4" id="text-orgd6e0b23">
<ul class="org-ul">
<li>AMD: Advanced Micro Devices</li>
<li>API: Application Programming Interface</li>
<li>CI: Continuous Integration</li>
<li>CPU: Central Processing Unit</li>
<li>CTF: Common Trace Format</li>
<li>DLAB: Domain Local Allocation Buffer</li>
<li>EA: Evolutionary Algorithm</li>
<li>GC: Garbage Collector</li>
<li>GCD: Grand Central Dispatch</li>
<li>HTTP: Hypertext Transfer Protocol</li>
<li>OPAM: OCaml Package Manager</li>
<li>MVP: Minimal Viable Product</li>
<li>PR: Pull Request</li>
<li>TPS: Transactions Per Second</li>
<li>UI: User Interface</li>
</ul>
</div>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">First release of Popper</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-first-release-of-popper/7992/1">https://discuss.ocaml.org/t/ann-first-release-of-popper/7992/1</a>
</p>
</div>

<div id="outline-container-org55ed1be" class="outline-3">
<h3 id="org55ed1be">Joel Bjornson announced</h3>
<div class="outline-text-3" id="text-org55ed1be">
<p>
I am happy to announce a first release of <a href="https://github.com/jobjo/popper">Popper</a> — an OCaml testing
library for writing simple unit tests as well as property-based tests, using a uniform API.
</p>

<p>
A few things that distinguishes <a href="https://github.com/jobjo/popper">Popper</a> from other property-based
testing libraries:
</p>

<ol class="org-ol">
<li>Generic shrinking — when a property-based test fails, the test function attempts to shrink the sample data. This works for any data type.</li>
<li>Any invariants used when constructing samples for property-based tests are also respected when shrinking.</li>
<li>There is a <a href="https://opam.ocaml.org/packages/ppx_deriving_popper/">ppx</a> for automatically deriving sample functions (generators in QuickCheck style libs) for custom data types.</li>
</ol>

<p>
The library also supports bundling and nesting tests arbitrarily, colorful output inspired by
<a href="https://github.com/mirage/alcotest">Alcotest</a>, logging facilities and timing info.
</p>

<p>
Here are some starting points:
</p>

<ul class="org-ul">
<li>The <a href="https://github.com/jobjo/popper">source repo</a>.</li>
<li>A <a href="https://jobjo.github.io/popper/getting_started/">getting started guide</a>.</li>
<li>The <a href="https://jobjo.github.io/popper/api/">API docs</a>.</li>
</ul>

<p>
Below is an example of what <a href="https://github.com/jobjo/popper">Popper</a> output looks like. It was
generated by <a href="https://gist.github.com/jobjo/32f1b7297a330dc16d7a7c9fb15008fe">this code</a>.
</p>


<div id="org63b34d9" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/8/86ab1380a1c443170656bc937a872c725cf6b78a.png" alt="86ab1380a1c443170656bc937a872c725cf6b78a.png" />
</p>
</div>

<p>
This is a first release and there are few work-in-progress items. For instance:
</p>

<ul class="org-ul">
<li>A CLI for filtering and sorting tests.</li>
<li>An API for better blending with <a href="https://github.com/ocsigen/lwt">Lwt</a> code bases.</li>
<li>A better way for limiting shrinking times for failing test samples.</li>
</ul>

<p>
Any suggestions or other feedback is much appreciated!
</p>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">Orsetto: structured data interchange languages (release 1.1)</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-orsetto-structured-data-interchange-languages-release-1-1/7995/1">https://discuss.ocaml.org/t/ann-orsetto-structured-data-interchange-languages-release-1-1/7995/1</a>
</p>
</div>

<div id="outline-container-orgd6d0d7b" class="outline-3">
<h3 id="orgd6d0d7b">james woodyatt announced</h3>
<div class="outline-text-3" id="text-orgd6d0d7b">
<p>
Announcing the release to OPAM of <a href="http://opam.ocaml.org/packages/orsetto/">Orsetto 1.1</a>, an update to
a personal project of mine not sponsored by my employer. Licensed with BSD 2-Clause.
</p>
</div>

<div id="outline-container-org35cdd0a" class="outline-4">
<h4 id="org35cdd0a">Q. What is Orsetto?</h4>
<div class="outline-text-4" id="text-org35cdd0a">
<p>
Aspires to do eventually for OCaml more or less what <a href="https://serde.rs">Serde</a> has done for Rust, i.e.
to be a curated and self-contained collection of structured data interchange languages with a cohesive
and unified model of serialization and deserialization.
</p>

<p>
Two interchange languages are currently supported: <a href="https://json.org">JSON</a> and
<a href="https://cbor.io">CBOR</a>.
</p>
</div>
</div>

<div id="outline-container-orgcb9761b" class="outline-4">
<h4 id="orgcb9761b">Q. What is new in this release?</h4>
<div class="outline-text-4" id="text-orgcb9761b">
<p>
The change log for the release is here:
<a href="https://bitbucket.org/jhw/orsetto/src/r1.1/CHANGES.md">CHANGES.md</a>
</p>

<ul class="org-ul">
<li>Drops support for OCaml &lt; 4.08.</li>
<li>Major improvements in test coverage.</li>
<li>Many corrections for logic errors.</li>
<li>Issues <a href="https://conjury.atlassian.net/browse/ORS">database</a> migrated to Atlassian Jira Cloud.</li>
<li>A few important usability improvements (see below).</li>
</ul>

<p>
Some usability improvements are meant to replace obsolescent interfaces (now marked obsolescent with
<code>@ocaml.deprecated</code>). A few improvements to some interfaces with especially suboptimal design were
updated with breaking changes, but these are not expected to cause major upgrade problems for anyone.
</p>

<p>
Some things have not changed:
</p>

<ul class="org-ul">
<li>Still requires <b>ocamlfind</b> and does not build with <b>dune</b>.</li>
<li>Still only supports JSON and CBOR.</li>
</ul>
</div>
</div>

<div id="outline-container-orgcf5e373" class="outline-4">
<h4 id="orgcf5e373">Q. It looks incomplete. What are your plans for future development?</h4>
<div class="outline-text-4" id="text-orgcf5e373">
<p>
Yes, it's a personal project. I'd welcome opportunities to collaborate with others who share my vision
for the project. As long as it's just me working on this, development will be somewhat slow. I have a
lot of projects. This is the only open source one.
</p>

<ul class="org-ul">
<li><b>Orsetto 1.0.3</b> is the previous release. It offered parsers and emitter combinators for JSON and CBOR for OCaml &gt;= 4.06.1 (including 4.13~alpha1). The quality of its JSON support is adequate, and it scores well on the <a href="https://github.com/nst/JSONTestSuite">nst/JSONTestSuite</a> tests. The quality of its CBOR support is provisional, and not recommended.</li>

<li><b>Orsetto 1.1</b> is the current release. It adds generalized and extensible structured data interchange models with specializations for producing emitters and parsers for JSON and CBOR. The quality of the CBOR support is much improved.</li>

<li><b>Orsetto 1.2</b> is the next planned release. It will drop interfaces marked <code>@caml.deprecated</code> in the 1.1 release. It will also drop support for OCaml &lt; 4.10, and I'd like to stop depending on <b>ocamlfind</b>. I hope to add a PPX for deriving parsers and emitters from OCaml data type definitions. I might also consider one or more new interchange languages— suggestions are heartily encouraged.</li>
</ul>
</div>
</div>
</div>
</div>




<div id="outline-container-org4400a87" class="outline-2">
<h2 id="org4400a87">Old CWN</h2>
<div class="outline-text-2" id="text-org4400a87">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org01ecd0b">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
