<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-10-17 Tue 09:46 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2023.10.10.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2023.10.24.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of October 10 to 17, 2023.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Hiring Functional Software Engineers (OCaml or Haskell) in Paris, France!</a></li>
<li><a href="#2">OCaml Hacking Day at Tarides Chennai</a></li>
<li><a href="#3">qcheck-lin and qcheck-stm 0.2</a></li>
<li><a href="#4">dune 3.11.0</a></li>
<li><a href="#5">runtime_events_tools 0.5.0</a></li>
<li><a href="#6">Gospel 0.2.0</a></li>
<li><a href="#7">Talk about declarative rhythm-machines with <code>Fry</code> and FRP @ Copenhagen</a></li>
<li><a href="#8">Deprecating ocaml-migrate-parsetree in favor of Ppxlib, also as a Platform tool</a></li>
<li><a href="#orgb5d8970">Old CWN</a></li>
</ul>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="1">Hiring Functional Software Engineers (OCaml or Haskell) in Paris, France!</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/hiring-functional-software-engineers-ocaml-or-haskell-in-paris-france/13221/1">https://discuss.ocaml.org/t/hiring-functional-software-engineers-ocaml-or-haskell-in-paris-france/13221/1</a>
</p>
</div>
<div id="outline-container-orgb5354ea" class="outline-3">
<h3 id="orgb5354ea">Christian announced</h3>
<div class="outline-text-3" id="text-orgb5354ea">
<p>
Hey team! Tweag is hiring a Functional Software engineer with Experience in OCaml or Haskell, if you&rsquo;re fluent in
ant of these languages please feel free to apply. This is an onsite position at our client offices located in Paris,
France. (Hybrid model can be discussed in the interview process)
</p>

<p>
If you want to lear more and how to apply please follow this link where you&rsquo;ll see all the information:
<a href="https://grnh.se/51d5e65b3us">https://grnh.se/51d5e65b3us</a>
</p>

<p>
Any questions let me know!
</p>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="2">OCaml Hacking Day at Tarides Chennai</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-hacking-day-at-tarides-chennai/13223/1">https://discuss.ocaml.org/t/ocaml-hacking-day-at-tarides-chennai/13223/1</a>
</p>
</div>
<div id="outline-container-orgfb5fc50" class="outline-3">
<h3 id="orgfb5fc50">Sudha Parimala announced</h3>
<div class="outline-text-3" id="text-orgfb5fc50">
<p>
We&rsquo;re running an OCaml Hacking event at the Tarides office in Chennai on the 21st of October.
</p>

<p>
We&rsquo;re excited to hack on a diverse range of OCaml projects, including the compiler, concurrency libraries, and
tooling, as well as benchmarking projects. Folks from Tarides will be around to assist with questions and support
participants.
</p>

<p>
This is an in-person event in Chennai. For more details and registration, please visit
<a href="https://forms.gle/9vNd4UyJejqJR5sMA">https://forms.gle/9vNd4UyJejqJR5sMA</a>. Looking forward to seeing some of you there!
</p>


<div id="org244bfac" class="figure">
<p><img src="https://global.discourse-cdn.com/business7/uploads/ocaml/optimized/2X/b/b2e00cb714801a53d2cb470ad139dac359e2fbaf_2_706x1000.jpeg" alt="b2e00cb714801a53d2cb470ad139dac359e2fbaf_2_706x1000.jpeg" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="3">qcheck-lin and qcheck-stm 0.2</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-qcheck-lin-and-qcheck-stm-0-2/12301/2">https://discuss.ocaml.org/t/ann-qcheck-lin-and-qcheck-stm-0-2/12301/2</a>
</p>
</div>
<div id="outline-container-orgfc73051" class="outline-3">
<h3 id="orgfc73051">Jan Midtgaard announced</h3>
<div class="outline-text-3" id="text-orgfc73051">
<p>
FYI, we just rolled out a 0.3 release of <code>qcheck-lin</code>, <code>qcheck-stm</code>, and <code>qcheck-multicoretests-util</code>:
<a href="https://github.com/ocaml-multicore/multicoretests/releases/tag/0.3">https://github.com/ocaml-multicore/multicoretests/releases/tag/0.3</a>
The release should be available in an opam repo near you shortly&#x2026; :wink:
</p>

<p>
The 0.3 release brings 3 &ldquo;usability improvements&rdquo; to <code>STM</code> and <code>Util</code> and a <code>Lin</code> search improvement that should
reduce memory allocation.
</p>

<ul class="org-ul">
<li>#400: Catch and delay exceptions in <code>STM</code>&rsquo;s <code>next_state</code> for a nicer UX</li>
<li>#387: Reduce needless allocations in <code>Lin</code>&rsquo;s sequential consistency search, as part of an <code>Out_channel</code> test cleanup</li>
<li>#379: Extend the set of <code>Util.Pp</code> pretty-printers and teach them to add break hints similar to <code>ppx_deriving.show</code>; teach <code>to_show</code> to generate truncated strings when <code>$MCTUTILS_TRUNCATE</code> environment variable is set</li>
<li>#368: Switch <code>STM_domain.agree_prop_par_asym</code> from using <code>Semaphore.Binary</code> to using an <code>int Atomic.t</code> which improves the error rate across platforms and backends</li>
</ul>

<p>
Happy testing! :smiley:
</p>
</div>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="4">dune 3.11.0</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-dune-3-11-0/13173/2">https://discuss.ocaml.org/t/ann-dune-3-11-0/13173/2</a>
</p>
</div>
<div id="outline-container-orgf760c09" class="outline-3">
<h3 id="orgf760c09">Etienne Millon announced</h3>
<div class="outline-text-3" id="text-orgf760c09">
<p>
We just released dune 3.11.1 with the following fixes:
</p>
</div>
<div id="outline-container-org1088ed0" class="outline-4">
<h4 id="org1088ed0">Fixed</h4>
<div class="outline-text-4" id="text-org1088ed0">
<ul class="org-ul">
<li>Fix <code>dune rpc</code> commands on Windows (#8806, fixes #8799, @nojb)</li>
<li>Fix <code>inline_tests</code> when the partition list is empty (#8849, fixes #8848, @hhugo)</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="5">runtime_events_tools 0.5.0</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-runtime-events-tools-0-5-0/13235/1">https://discuss.ocaml.org/t/ann-runtime-events-tools-0-5-0/13235/1</a>
</p>
</div>
<div id="outline-container-orgec760a8" class="outline-3">
<h3 id="orgec760a8">Sudha Parimala announced</h3>
<div class="outline-text-3" id="text-orgec760a8">
<p>
I&rsquo;m happy to announce the release of
<a href="https://opam.ocaml.org/packages/runtime_events_tools/runtime_events_tools.0.5.0/">runtime_events_tools.0.5.0</a>.
</p>

<p>
OCaml 5.0 introduced a new <a href="https://github.com/ocaml/ocaml/pull/10964">ring-buffer based tracing system</a> with low
overheads. This eliminated the need for a separate tracing runtime and added the ability to keeping tracing on by
default. The OCaml runtime uses this tracing system to track GC events. OCaml 5.1 went further to include <a href="https://github.com/ocaml/ocaml/pull/11474">support
for custom events</a>.
</p>

<p>
Runtime events tools through <code>olly</code>, provides functionality to grok the data provided by the runtime tracing system.
</p>

<p>
Olly has two modes; <code>trace</code> , and <code>gc-stats</code>
</p>

<p>
<b>olly trace</b>
</p>

<pre class="example" id="org3f6a3ea">
$ olly trace example.trace example.exe
</pre>

<p>
Records runtime traces in fuchsia and json formats. The trace files can be visualised with
<a href="https://ui.perfetto.dev/">ui.perfetto.</a> or <code>json</code> trace with [chrome://tracing](chrome://tracing).
</p>

<p>
Here&rsquo;s a sample trace rendered in perfetto.
</p>


<div id="org1c625a4" class="figure">
<p><img src="https://global.discourse-cdn.com/business7/uploads/ocaml/optimized/2X/f/f4da569dee12c0a8ea61ef2b4f1b25af2c775d65_2_1378x678.png" alt="f4da569dee12c0a8ea61ef2b4f1b25af2c775d65_2_1378x678.png" />
</p>
</div>

<p>
<b>olly gc-stats</b>
</p>

<p>
Provides information about GC time and latencies.
</p>

<pre class="example" id="orgb8e3167">
$ olly gc-stats "binarytrees5_multicore.exe 2 20"

Execution times:
Wall time (s):	2.61
CPU time (s):	4.63
GC time (s):	2.93
GC overhead (% of CPU time):	63.18%

GC time per domain (s):
Domain0: 	1.59
Domain1: 	1.34

GC latency profile:
#[Mean (ms):	0.76,	 Stddev (ms):	1.56]
#[Min (ms):	0.00,	 max (ms):	15.68]

Percentile 	 Latency (ms)
25.0000 	 0.00
50.0000 	 0.01
60.0000 	 0.04
70.0000 	 0.28
75.0000 	 0.66
80.0000 	 1.40
85.0000 	 2.44
90.0000 	 3.16
95.0000 	 3.62
96.0000 	 3.79
97.0000 	 4.06
98.0000 	 4.73
99.0000 	 6.29
99.9000 	 13.59
99.9900 	 15.68
99.9990 	 15.68
99.9999 	 15.68
100.0000 	 15.68
</pre>

<p>
New features in this release:
</p>

<ul class="org-ul">
<li><i>Support for fuchsia format</i>: Stores the trace in binary format, making the trace files 4x smaller in size, on an average.</li>
<li><i>gc-stats mode</i>: In addition to latency percentiles, GC stats provide more insights, such as GC time and GC time spent per domain.</li>
<li><p>
<i>Custom events support</i>: Not only can you trace GC events, but now you can also trace your own events
<img src="https://global.discourse-cdn.com/business7/uploads/ocaml/optimized/2X/a/a32a3bd2f83a24ce0f1580f749970437b384d8d8_2_1380x182.png" alt="a32a3bd2f83a24ce0f1580f749970437b384d8d8_2_1380x182.png" />
</p>

<p>
<i>Trace for a recursive fibonacci function</i>
</p></li>
</ul>

<p>
Note that if you see non-terminating events in your traces, you might want to include this compiler patch &#x2013;
<a href="https://github.com/ocaml/ocaml/pull/12583">https://github.com/ocaml/ocaml/pull/12583</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="6">Gospel 0.2.0</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-gospel-0-2-0/13236/1">https://discuss.ocaml.org/t/ann-gospel-0-2-0/13236/1</a>
</p>
</div>
<div id="outline-container-org31ed0a8" class="outline-3">
<h3 id="org31ed0a8">Nicolas Osborne announced</h3>
<div class="outline-text-3" id="text-org31ed0a8">
<p>
We are very happy to announce the release 0.2.0 of <code>gospel</code>!
</p>

<p>
Gospel is a tool-agnostic behavioural specification language for OCaml. It allows you to write strongly typed
contract-based specifications for your OCaml libraries (for a reasonable subset of OCaml). Gospel&rsquo;s syntax has been
designed to be easy to learn for an OCaml programmer. You can access the documentation
<a href="https://ocaml-gospel.github.io/gospel/">here</a>.
</p>

<p>
This release adds two main features, a <code>gospel dumpast</code> command and a <code>gospel.ppx</code> ppx rewriter to display Gospel
specification as documentation with <code>odoc</code>.
</p>

<p>
Some minor extensions have been added to the language itself:
</p>
<ul class="org-ul">
<li>a <code>with</code> construct to name a variable in type invariants referring to a
value of the specified type,</li>
<li><code>int</code> literals,</li>
<li>anonymous functions now support both patterns in arguments and return type
annotations,</li>
<li>unit result in function headers,</li>
<li>constants can now be referenced in specifications,</li>
<li>infix operators are now accepted in specification headers.</li>
</ul>

<p>
Parser, preprocessor, and error messages have been improved. In particular the preprocessor can now handle large
files and locations are properly tracked. Pattern matches are now also checked for exhaustiveness and redundancy.
</p>

<p>
We have made a number of improvements and bugfixes in the type checker as well as some minor modifications in the
Gospel standard library. Finally, the documentation has been revised.
</p>
</div>
</div>
</div>
<div id="outline-container-7" class="outline-2">
<h2 id="7">Talk about declarative rhythm-machines with <code>Fry</code> and FRP @ Copenhagen</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/talk-about-declarative-rhythm-machines-with-fry-and-frp-copenhagen/13238/1">https://discuss.ocaml.org/t/talk-about-declarative-rhythm-machines-with-fry-and-frp-copenhagen/13238/1</a>
</p>
</div>
<div id="outline-container-org1041c40" class="outline-3">
<h3 id="org1041c40">rand announced</h3>
<div class="outline-text-3" id="text-org1041c40">
<p>
I&rsquo;m happy to announce that I&rsquo;m doing a talk on <a href="https://github.com/rand00/fry"><code>Fry</code></a> at <a href="https://www.meetup.com/moedegruppefunktionellekoebenhavnere/events/296380134">meetup for functional
copenhageners</a> @ 24. october. <code>Fry</code> is
a small library that enables declarative definitions of rhythm-machines etc. together with FRP (<code>React</code>). These can
be interactive, generative, experimental - what ever you fancy. Recently I&rsquo;ve used it for a polyrhythmic machine
(<code>pmmd</code>) based on bpm-modulation, that I&rsquo;m planning on releasing as modular synthesizer hardware.
</p>

<p>
A couple of concepts from <code>Fry</code> that are interesting, which you can see from its
<a href="https://github.com/rand00/fry/tree/main/examples">examples</a>:
</p>
<ul class="org-ul">
<li><a href="https://github.com/rand00/fry/blob/main/examples/envelope_compositions/main.ml">a DSL for creation/composition of envelopes</a></li>
<li><a href="https://github.com/rand00/fry/blob/main/examples/beat_modulated/main.ml">bpm-modulation of beats</a></li>
<li><a href="https://github.com/rand00/fry/blob/main/examples/advanced_rhythm_with_notty-output_001/main.ml">FRP is excellent at programming with time</a></li>
</ul>

<p>
Also, OCaml with first class modules + module functors + FRP, map elegantly to the semantics of <a href="https://en.wikipedia.org/wiki/Modular_synthesizer">modular
synthesizers</a>. Simply:
</p>
<ul class="org-ul">
<li>a <code>unit event</code> maps to a <a href="https://en.wikipedia.org/wiki/CV/gate">control-voltage</a> (CV) trigger</li>
<li>a <code>float signal</code> maps to CV</li>
<li>a module functor maps to a modular synth module taking CV-in, exposing CV-out</li>
</ul>

<p>
If you are near Copenhagen - hope to see you (:
</p>
</div>
</div>
</div>
<div id="outline-container-8" class="outline-2">
<h2 id="8">Deprecating ocaml-migrate-parsetree in favor of Ppxlib, also as a Platform tool</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/rfc-deprecating-ocaml-migrate-parsetree-in-favor-of-ppxlib-also-as-a-platform-tool/13240/1">https://discuss.ocaml.org/t/rfc-deprecating-ocaml-migrate-parsetree-in-favor-of-ppxlib-also-as-a-platform-tool/13240/1</a>
</p>
</div>
<div id="outline-container-orge2cd7a5" class="outline-3">
<h3 id="orge2cd7a5">Sonja Heinze announced</h3>
<div class="outline-text-3" id="text-orge2cd7a5">
<p>
Hello everyone :wave:
</p>

<p>
We&rsquo;re planning to deprecate <a href="https://github.com/ocaml-ppx/ocaml-migrate-parsetree">ocaml-migrate-parsetree</a> (OMP)
finally. OMP forms part of the <a href="https://ocaml.org/docs/platform">OCaml Platform</a>, so we can&rsquo;t and wouldn&rsquo;t just do
that without the approval of the community. So first a bit of context:
</p>
</div>
<div id="outline-container-org2340cb5" class="outline-4">
<h4 id="org2340cb5">What is OMP anyways?</h4>
<div class="outline-text-4" id="text-org2340cb5">
<p>
OMP used to be an extremely important project in the meta-programming-related chunk of OCaml&rsquo;s ecosystem. Since the
introduction of <a href="https://v2.ocaml.org/manual/extensionnodes.html">extension nodes</a> and
<a href="https://v2.ocaml.org/manual/attributes.html#start-section">attributes</a> in OCaml 4.2 in 2014, meta-programming in
OCaml is most commonly done on OCaml&rsquo;s parsetree. The caveat: The parsetree is extended and modified between OCaml
minor versions, meaning that handling the OCaml parsetree directly is unstable. OMP came to the rescue by
introducing a concept we call <span class="underline">versioned parsetrees</span> (or versioned ASTs) together with migrations between those
fixed versions of the parsetree, allowing the workflow
</p>


<div id="orgabc226f" class="figure">
<p><img src="https://hackmd.io/_uploads/H13pahLWp.png" alt="H13pahLWp.png" />
</p>
</div>

<p>
That workflow allows one PPX to guarantee compatibility with multiple compiler versions (here, PPX = PreProcessor
eXtension stands for the meta-programming instance). That was extremely important at the time to introduce a more
version-flexible ecosystem and to reduce the maintenance burden of PPXs!
</p>

<p>
OMP also provided the concept of a <span class="underline">driver</span>, which is one single binary driving the applicatoin of all PPXs. Without
that, using n PPXs would mean copying the workflow pictured above n times. That&rsquo;s an incredible performance
overhead. The OMP driver took care of applying all PPXs, so fewer parsetree migrations and less communication
between different processes were necessary (before: one process per PPX).
</p>
</div>
</div>
<div id="outline-container-org460a317" class="outline-4">
<h4 id="org460a317">Why was OMP not enough?</h4>
<div class="outline-text-4" id="text-org460a317">
<p>
However, the OMP driver was still duplicating parsetree migrations, and it did one whole parsetree pass per PPX. And
because of the latter, the outcome of the preprocessor phase used to depend on the order of PPXs, which didn&rsquo;t
follow any semantically relevant or otherwise reasoned pattern. The reason why it would have been extremely
complicated to improve the OMP driver further was that each PPX chose its own versioned parsetree version. There was
no agreement between different PPXs.
</p>
</div>
<ul class="org-ul">
<li><a id="orgfbfafe4"></a>Ppxlib<br />
<div class="outline-text-5" id="text-orgfbfafe4">
<p>
So the solution was to have the PPXs agree on one versioned parsetree version. That&rsquo;s what
<a href="https://github.com/ocaml-ppx/ppxlib">Ppxlib</a> does. It also does a lot more by providing an extensive API to write
PPXs easily and others, but the main point here is that it consolidates a consistent PPX ecosystem wrt parsetree
versions. The way it does so is by exposing one fixed versioned parsetree version that all PPXs are defined against.
</p>

<p>
Thanks to that, the Ppxlib driver can get rid of unnecessary parsetree migrations, and it can merge a whole bunch of
PPXs into one AST pass, improving performance and guaranteeing a clear order of PPX transformations. Also important:
Having all PPXs on the same versioned parsetree version, makes it easy to have them all on the one of the latest
OCaml version. For details I&rsquo;m not going into, that&rsquo;s the only (reasonable) way to have the PPXs support the latest
compiler syntax features, so that&rsquo;s a huge advantage of Ppxlib as well.
</p>

<p>
Ppxlib still isn&rsquo;t perfect and comes with its own little set of problems, but it does solve the mentioned big
problems of performance overhead, unclear composition semantics, parsetree-version-fragmentation among different
PPXs, and lack of latest compiler syntax support. So by now, the whole OCaml opam ecosystem has shifted from OMP to
Ppxlib (more below).
</p>

<p>
The latest update on the state of Ppxlib, also including info about OMP and the ecosystem&rsquo;s transition from one to
the other <a href="https://discuss.ocaml.org/t/an-update-on-the-state-of-the-ppx-ecosystem-and-ppxlib-s-transition/8200">is this one from
2021</a>. All
Ppxlib maintainers have very very little time for communication and similar. If a new update would be strongly
appreciated, let us know. For here, let&rsquo;s focus on OMP:
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-org04d8af3" class="outline-4">
<h4 id="org04d8af3">What does it mean to deprecate OMP?</h4>
<div class="outline-text-4" id="text-org04d8af3">
<p>
Given that by now, OMP&rsquo;s maintenance is held at the bare bare minimum anyways, deprecating it would only have one
clear impact:
</p>
</div>
<ul class="org-ul">
<li><a id="orgfcab56a"></a>Real-life<br />
<div class="outline-text-5" id="text-orgfcab56a">
<p>
We&rsquo;d stop adding new compiler support, so the last supported compiler would be OCaml 5.0. Concretely: We won&rsquo;t add
the new versioned parsetrees and migrations for the new compilers anymore.
</p>
</div>
</li>
<li><a id="orge5da99d"></a>Formalities<br />
<div class="outline-text-5" id="text-orge5da99d">
<p>
We&rsquo;d also mark the OMP opam packages as deprecated, and we&rsquo;d move OMP to the Deprecate section in the <a href="https://ocaml.org/docs/platform">set of OCaml
Platform tools</a> (now it&rsquo;s in the Sustained section).
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-org1aee6bf" class="outline-4">
<h4 id="org1aee6bf">Is it ok to deprecate OMP?</h4>
<div class="outline-text-4" id="text-org1aee6bf">
<p>
You tell us :) Here&rsquo;s some info:
</p>
</div>
<ul class="org-ul">
<li><a id="org129138b"></a>Opam packages<br />
<div class="outline-text-5" id="text-org129138b">
<p>
All packages on opam have moved to Ppxlib now. There&rsquo;s only <a href="https://ocaml.org/p/ocaml-migrate-parsetree/latest#used-by">a hand-full of packages that formally still depend on
OMP</a>, but all of that seems to be formal left-overs in
the opam files, a left-over test dependency or similar. I&rsquo;ve opened issues on those packages, mentioning the
potential upcoming deprecation of OMP, and nobody has complained.
</p>
</div>
</li>
<li><a id="org8849f3d"></a>Distribution packages<br />
<div class="outline-text-5" id="text-org8849f3d">
<p>
There are still a few distributions that keep on packaging OMP on their distribution, e.g. there&rsquo;s <a href="https://tracker.debian.org/pkg/ocaml-migrate-parsetree">OMP on
Debian</a>, <a href="https://packages.fedoraproject.org/pkgs/ocaml-migrate-parsetree/ocaml-migrate-parsetree/">OMP on
Fedora</a> and <a href="https://aur.archlinux.org/packages/ocaml-migrate-parsetree">OMP on
Arch</a>. However, the reason for that seems merely
historical (with unquestioned inertia): There are no reverse dependencies on Debian or Fedora. On Arch, there are a
few reverse dependencies, none of them still being relevant in the present. I&rsquo;ll reach out to the three respective
package managers. If anyone has any info or relevant context about this, please share it!
</p>
</div>
</li>
<li><a id="orge698dc2"></a>Users/community<br />
<div class="outline-text-5" id="text-orge698dc2">
<p>
And this is where we&rsquo;re asking for feedback. Does it sound good to everyone to deprecate OMP? We do have the strong
impression that pretty much everyone has moved to Ppxlib, but if you think we&rsquo;re missing something important, please
let us know (or, just use this opportunity to say something nice about OMP :slight_smile: ).
</p>
</div>
</li>
<li><a id="org6c200e1"></a>Original author and current maintainer<br />
<div class="outline-text-5" id="text-org6c200e1">
<p>
Obviously, the current maintainer/&ldquo;sustainer&rdquo; (me) thinks it&rsquo;s good to deprecate OMP finally. And the original
author, @let-def, is behind it as well.
</p>

<p>
Btw, @let-def, thanks a lot for this crucial piece of OCaml software! It contains a lot of really good ideas,
concepts, and implementation details! Even once deprecated, it will persist - partly quite literally inside Ppxlib
in the form of the versioned parsetrees, the migrations, and parts of the driver.
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb5d8970" class="outline-2">
<h2 id="orgb5d8970">Old CWN</h2>
<div class="outline-text-2" id="text-orgb5d8970">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I&rsquo;ll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe to the <a href="https://sympa.inria.fr/sympa/info/caml-list">caml-list</a>.
</p>

<div class="authorname" id="orgb4d25c1">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>