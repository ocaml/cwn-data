<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-23 Tue 15:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'JavaScript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2025.09.16.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2025.09.30.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of September 16 to 23, 2025.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Introduction to the Dune build system, by OCamlPro</a></li>
<li><a href="#2">memprof-limits (first official release): Memory limits, allocation limits, and thread cancellation, with interrupt-safe resources</a></li>
<li><a href="#3">mlfront-shell - reference implementation of a build system</a></li>
<li><a href="#4">Zanuda &ndash; OCaml linter experiment</a></li>
<li><a href="#5">YOCaml, a framework for static site generator</a></li>
<li><a href="#6">Lwt.6.0.0~beta (direct-style, multi-domain parallelism)</a></li>
<li><a href="#7">schm-ocaml</a></li>
<li><a href="#8">detri cmd</a></li>
<li><a href="#9">seven ocaml tutorials</a></li>
<li><a href="#10">Ortac/Wrapper: a new plugin for specification driven unit testing</a></li>
<li><a href="#11">Other OCaml News</a></li>
<li><a href="#org71b44a4">Old CWN</a></li>
</ul>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="1">Introduction to the Dune build system, by OCamlPro</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/blog-introduction-to-the-dune-build-system-by-ocamlpro/17279/1">https://discuss.ocaml.org/t/blog-introduction-to-the-dune-build-system-by-ocamlpro/17279/1</a>
</p>
</div>
<div id="outline-container-org4586377" class="outline-3">
<h3 id="org4586377">OCamlPro announced</h3>
<div class="outline-text-3" id="text-org4586377">
<p>
<b>Greetings Cameleers,</b>
</p>

<p>
We’ve just released a new blog post: <a href="https://ocamlpro.com/blog/2025_07_29_ocaml_onboarding_introduction_to_dune/">OCaml Onboarding: Introduction to the Dune build system</a>
</p>

<p>
This is a practical, compact guide for those starting their OCaml and Dune journey — or helping others do so. Instead of diving into internals, we focus on what you need to know to get up and running with Dune confidently.
</p>

<p>
We walk through:
</p>
<ul class="org-ul">
<li>How Dune thinks about builds and directories</li>
<li>The role of dune files and static declarations</li>
<li>The tooling one interacts with day-to-day</li>
</ul>

<p>
The post keeps things hands-on and beginner-focused, with just enough theory to make the practical bits stick. We end by circling back to <code>dune init</code> — showing how understanding the basics makes the scaffolding tool far more intuitive.
</p>

<p>
📝 Read it on the <a href="https://ocamlpro.com/blog/">OCamlPro Blog</a>
</p>

<p>
Perfect for sharing with colleagues or newcomers dipping their toes into OCaml and Dune.
</p>

<p>
As always, feedback welcome!
Until next time,
— The OCamlPro Team
</p>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="2">memprof-limits (first official release): Memory limits, allocation limits, and thread cancellation, with interrupt-safe resources</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-memprof-limits-first-official-release-memory-limits-allocation-limits-and-thread-cancellation-with-interrupt-safe-resources/8135/3">https://discuss.ocaml.org/t/ann-memprof-limits-first-official-release-memory-limits-allocation-limits-and-thread-cancellation-with-interrupt-safe-resources/8135/3</a>
</p>
</div>
<div id="outline-container-orgfb84bb7" class="outline-3">
<h3 id="orgfb84bb7">Guillaume Munch-Maccagnoni announced</h3>
<div class="outline-text-3" id="text-orgfb84bb7">
<p>
I am pleased to announce the version <code>0.3.0</code> of the package <code>memprof-limits</code>. The main contribution of this release is the <b>support for OCaml 5 with multiple parallel domains</b>.
</p>

<p>
Memprof-limits can henceforth be used to conveniently interrupt (CPU-bound) domains in your parallel computations, using <i>cancellation tokens</i>, with the support of features to ensure interrupt-safety and resource-safety.
</p>

<p>
As example of uses, plans are underway to use memprof-limits to ensure the resource-safety of user interrupts in the Rocq prover (eliminating a class of bugs) and to add tactics for portable timeouts (that count allocations rather than elapsed time).
</p>

<ul class="org-ul">
<li>Read more: <a href="https://guillaume.munch.name/software/ocaml/memprof-limits.0.3.0/">https://guillaume.munch.name/software/ocaml/memprof-limits.0.3.0/</a></li>
<li>Report bugs and suggestions: <a href="https://gitlab.com/gadmm/memprof-limits">https://gitlab.com/gadmm/memprof-limits</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="3">mlfront-shell - reference implementation of a build system</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-mlfront-shell-reference-implementation-of-a-build-system/17186/2">https://discuss.ocaml.org/t/ann-mlfront-shell-reference-implementation-of-a-build-system/17186/2</a>
</p>
</div>
<div id="outline-container-orgb7d4988" class="outline-3">
<h3 id="orgb7d4988">jbeckford announced</h3>
<div class="outline-text-3" id="text-orgb7d4988">
<p>
There have been many improvements since the last update. Here are some of them:
</p>

<ol class="org-ol">
<li>The trace store (needed to not rebuild everything from scratch) has been implemented.</li>
<li>Build file ASTs are parsed, marshalled and put into a key-value directory (which can be shared or cached in CI).</li>
<li>Build keys are generated and used to protect sharing of the parsed AST.</li>
<li>A full walkthrough of “building” the 7zip executable from 7zip binary assets (it is more complicated than it sounds) is on the <a href="https://github.com/diskuv/dk?tab=readme-ov-file#using-the-build-tool-to-create-a-multi-platform-package">documentation page</a></li>
<li>An <code>–autofix</code> option to update build files with checksums, and allowing SHA1 checksum for local files (both are for eventual support of Meta’s watchman tool)</li>
<li>A new format for the JSON files (many functions versus one). The old format is deprecated.</li>
<li>Many many bug fixes, including specification updates.</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="4">Zanuda &ndash; OCaml linter experiment</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-zanuda-ocaml-linter-experiment/11784/13">https://discuss.ocaml.org/t/ann-zanuda-ocaml-linter-experiment/11784/13</a>
</p>
</div>
<div id="outline-container-org93f3d0a" class="outline-3">
<h3 id="org93f3d0a">Continuing this thread, Kakadu announced</h3>
<div class="outline-text-3" id="text-org93f3d0a">
<p>
Zanuda 2.0.0 with OCaml 5.3 support have hit opam.
</p>
</div>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="5">YOCaml, a framework for static site generator</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-yocaml-a-framework-for-static-site-generator/15393/9">https://discuss.ocaml.org/t/ann-yocaml-a-framework-for-static-site-generator/15393/9</a>
</p>
</div>
<div id="outline-container-org4543f3f" class="outline-3">
<h3 id="org4543f3f">Xavier Van de Woestyne announced</h3>
<div class="outline-text-3" id="text-org4543f3f">
</div>
<div id="outline-container-orga502aae" class="outline-4">
<h4 id="orga502aae">Release <code>2.5.0</code></h4>
<div class="outline-text-4" id="text-orga502aae">
<p>
We are delighted to present the new release of YOCaml: <code>2.5.0</code>!
As you can see, there have been a few intermediate versions since our last announcement. However, we have reached a new milestone: YOCaml can now be used seamlessly with an Applicative API (instead of the Arrow one), making many tasks much easier to express!
</p>

<p>
We have also finally taken the time to write <a href="https://yocaml.github.io/tutorial">a tutorial that explains how to use YOCaml to create a complete blog</a>, step by step, and our goal is to expand it over time to add more and more guides! (The documentation/guide generator (<a href="https://github.com/yocaml/yocaml-www">https://github.com/yocaml/yocaml-www</a> is also written in YOCaml and gives an idea of what can be done fairly quickly.)
</p>

<ul class="org-ul">
<li><a href="https://github.com/xhtmlboi/yocaml">Repository</a></li>
<li><a href="https://ocaml.org/packages/search?q=yocaml">YOCaml packages</a></li>
<li><a href="https://github.com/xhtmlboi/yocaml/releases/tag/v2.5.0">Complete release note</a></li>
</ul>

<p>
We look forward to receiving your feedback! YOCaml is a free and collaborative project, so any contributions (including the guide) are more than welcome! We would also be DELIGHTED to see your creations with YOCaml!  
</p>

<p>
<i>Happy Hacking!</i>
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="6">Lwt.6.0.0~beta (direct-style, multi-domain parallelism)</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-lwt-6-0-0-beta-direct-style-multi-domain-parallelism/17283/1">https://discuss.ocaml.org/t/ann-lwt-6-0-0-beta-direct-style-multi-domain-parallelism/17283/1</a>
</p>
</div>
<div id="outline-container-org320e0f9" class="outline-3">
<h3 id="org320e0f9">Raphaël Proust announced</h3>
<div class="outline-text-3" id="text-org320e0f9">
<p>
After some feedback and some work, I'm happy to announce the release of <code>lwt.6.0.0~beta00</code> and <code>lwt_direct.6.0.0~beta00</code>! (<a href="https://github.com/ocaml/opam-repository/pull/28558">https://github.com/ocaml/opam-repository/pull/28558</a>)
</p>

<p>
major CHANGES are:
</p>
<ul class="org-ul">
<li>direct style mode (see <a href="https://discuss.ocaml.org/t/ann-lwt-6-0-0-alpha-direct-style/16972/32">alpha release announce</a>): use <code>await : 'a Lwt.t -&gt; 'a</code> to transform any promises into a simple value. This allows you to break out of the monad which makes it possible to use libraries previously incompatible with Lwt.</li>
<li>multi-domain support: run separate schedulers in separate domains (some of the more advanced functions on Lwt are now domain-dependent, e.g., <code>run_in_main</code> becomes <code>run_in_domain</code> and takes one additional parameter)</li>
</ul>

<p>
Feedback is very welcome. Happy beta-testing and good luck with the parallel-programming!
</p>
</div>
</div>
</div>
<div id="outline-container-7" class="outline-2">
<h2 id="7">schm-ocaml</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-schm-ocaml/17293/1">https://discuss.ocaml.org/t/ann-schm-ocaml/17293/1</a>
</p>
</div>
<div id="outline-container-org83b785f" class="outline-3">
<h3 id="org83b785f">Florent Monnier announced</h3>
<div class="outline-text-3" id="text-org83b785f">
<p>
schm-ocaml provides a scheme-like syntax.
</p>

<p>
schm3 integrates nicely with the rescript-version that provides the ocaml syntax.
</p>

<p>
schm4 integrates with one of the later ocaml 4 versions, and tries to be accessible from .c
</p>

<p>
<a href="http://decapode314.free.fr/ocaml2/schm/">http://decapode314.free.fr/ocaml2/schm/</a>
</p>

<p>
There is a tutorial:
</p>

<p>
<a href="http://decapode314.free.fr/ocaml2/schm/schm-tut.html">http://decapode314.free.fr/ocaml2/schm/schm-tut.html</a>
</p>

<p>
<a href="http://decapode314.free.fr/ocaml2/schm/dl/schm4-0.03.zip">http://decapode314.free.fr/ocaml2/schm/dl/schm4-0.03.zip</a>
</p>

<p>
The oo got lost in a computer crash.
</p>

<p>
So there is no oo.
</p>
</div>
</div>
</div>
<div id="outline-container-8" class="outline-2">
<h2 id="8">detri cmd</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-detri-cmd/17301/1">https://discuss.ocaml.org/t/ann-detri-cmd/17301/1</a>
</p>
</div>
<div id="outline-container-org521af53" class="outline-3">
<h3 id="org521af53">Florent Monnier announced</h3>
<div class="outline-text-3" id="text-org521af53">
<p>
There is now a fifth variant for detri:
</p>

<p>
<a href="http://decapode314.free.fr/ocaml/detris.html">http://decapode314.free.fr/ocaml/detris.html</a>
</p>

<p>
This fifth one outputs .html, in-stead of console.
</p>

<p>
If you took a previous version for the console, it was already something you could do by-yourself easily rewriting the console esc-chars to html, but now there is a ready-made one.
</p>

<p>
(There is also a small tutorial, but it should be re-written,
</p>

<p>
<a href="http://decapode314.free.fr/ocaml/detri/tut/detri-tut.html">http://decapode314.free.fr/ocaml/detri/tut/detri-tut.html</a>
</p>

<p>
)
</p>
</div>
</div>
</div>
<div id="outline-container-9" class="outline-2">
<h2 id="9">seven ocaml tutorials</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-s-tut-seven-ocaml-tutorials/17302/1">https://discuss.ocaml.org/t/ann-s-tut-seven-ocaml-tutorials/17302/1</a>
</p>
</div>
<div id="outline-container-orgdf96c88" class="outline-3">
<h3 id="orgdf96c88">Florent Monnier announced</h3>
<div class="outline-text-3" id="text-orgdf96c88">
<p>
You will find seven new ocaml-tutorials on this page that I wrote recently:
</p>

<p>
<a href="http://decapode314.free.fr/ocaml2/blog/">http://decapode314.free.fr/ocaml2/blog/</a>
</p>

<p>
It was not writen with a chat-bot, but you will maybe notice a difference in the style of writing, since I’m using a chat-bot.
</p>
</div>
</div>
</div>
<div id="outline-container-10" class="outline-2">
<h2 id="10">Ortac/Wrapper: a new plugin for specification driven unit testing</h2>
<div class="outline-text-2" id="text-10">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ortac-wrapper-a-new-plugin-for-specification-driven-unit-testing/17304/1">https://discuss.ocaml.org/t/ann-ortac-wrapper-a-new-plugin-for-specification-driven-unit-testing/17304/1</a>
</p>
</div>
<div id="outline-container-org3a79691" class="outline-3">
<h3 id="org3a79691">Charlène_Gros announced</h3>
<div class="outline-text-3" id="text-org3a79691">
<p>
Hello everyone,
</p>

<p>
We, at Tarides, are excited to announce the release of a new plugin for <code>ortac</code>: <a href="https://github.com/ocaml-gospel/ortac/tree/main/plugins/wrapper">Ortac/Wrapper</a>!
</p>

<p>
This plugin is part of the Gospel project, a contract-based behavioural specification language for OCaml. <code>ortac</code> is a tool that converts an OCaml module interface with <a href="https://github.com/ocaml-gospel/gospel">Gospel</a> specifications into code to check those specifications. There are various ways to check specifications, all provided by plugins, and this post announces the new plugin: Ortac/Wrapper!
</p>

<p>
This plugin is designed to generate a wrapped module that exposes the same interface as the original module but instruments all function calls with assertions corresponding to the Gospel specifications.
The main objective is to assist with unit testing. You provide the Gospel specification for your file, and Ortac will instrument it. When you run the unit tests on the wrapped version, if a specification is violated, Ortac will crash with an explicit error, telling you which portion of your code is incorrect and which specifications were violated.
</p>

<p>
This work has been started by Clément Pascutto during his PhD at LMF and Tarides <a href="https://theses.hal.science/tel-04696708v1">https://theses.hal.science/tel-04696708v1</a>.
I continued his work to support some Gospel features such as the <code>old</code> operator and models.
</p>
</div>
<div id="outline-container-org56b3bd5" class="outline-4">
<h4 id="org56b3bd5">Installation</h4>
<div class="outline-text-4" id="text-org56b3bd5">
<p>
To install the Wrapper plugin, use the following command:
<code>opam install ortac-wrapper</code>
</p>

<p>
This will install the following OPAM packages:
</p>

<ul class="org-ul">
<li><code>ortac-core.opam</code> which provides the <code>ortac</code> command-line tool and the core functionalities used by all plugins,</li>
<li><code>ortac-runtime.opam</code> which provides the support library for the code generated by the Wrapper Ortac plugin,</li>
<li><code>ortac-wrapper.opam</code> which provides the Wrapper plugin for the <code>ortac</code> command-line tool.</li>
</ul>
</div>
<ul class="org-ul">
<li><a id="org09dcbdb"></a>To automatically generate dune files<br />
<div class="outline-text-5" id="text-org09dcbdb">
<p>
If you need dune rules to integrate Ortac into your project, you can install the Dune plugin:
<code>opam install ortac-dune</code>
This will install the following OPAM packages:
</p>

<ul class="org-ul">
<li><code>ortac-core.opam</code> which provides the <code>ortac</code> command-line tool and the core functionalities used by all plugins,</li>
<li><code>ortac-dune.opam</code> which provides the Dune plugin for the <code>ortac</code> command-line tool.</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="outline-container-org16a3731" class="outline-4">
<h4 id="org16a3731">Try it!</h4>
<div class="outline-text-4" id="text-org16a3731">
<p>
Let’s dive into a mini tutorial to see how the Ortac/Wrapper plugin can be used to enhance your unit testing with Gospel specifications. We’ll walk through creating a simple polymorphic container type with limited capacity and see how to specify and test its behavior using Gospel.
</p>
</div>
<ul class="org-ul">
<li><a id="org0b861c6"></a>1- Define the type and models<br />
<div class="outline-text-5" id="text-org0b861c6">
<p>
First, we define a polymorphic container type <code>'a t</code> with Gospel specifications. This type will have a fixed capacity and a mutable list of contents.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #444fcf;">'a t</span>
<span style="color: #8f6f4a; font-style: italic;">(*</span><span style="color: #8f6f4a; font-style: italic;">@ model capacity: int
        mutable model contents: 'a list
        with t
        invariant t.capacity &gt; 0
        invariant List.length t.contents &lt;= t.capacity</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
</code></pre>
</div>

<p>
Here, we define two models:
</p>

<ul class="org-ul">
<li><code>capacity</code>: Represents the fixed size of the container.</li>
<li><code>contents</code>: Represents the mutable list of elements currently stored in the container.</li>
</ul>

<p>
The invariants ensure that the capacity is always positive and that the contents list never exceeds the declared capacity.
</p>
</div>
</li>
<li><a id="org5e61b23"></a>2- Specify function behavior<br />
<div class="outline-text-5" id="text-org5e61b23">
<p>
Next, we specify the behavior of functions that manipulate the type <code>'a t</code>. We’ll define a <code>create</code> function to initialize the container and an <code>add</code> function to insert elements into the container.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code><span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">create</span>: int -&gt; 'a t
<span style="color: #8f6f4a; font-style: italic;">(*</span><span style="color: #8f6f4a; font-style: italic;">@ t = create c
        requires c &gt; 0
        ensures t.capacity = c
        ensures t.contents = []</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">add</span>: 'a t -&gt; 'a -&gt; unit
<span style="color: #8f6f4a; font-style: italic;">(*</span><span style="color: #8f6f4a; font-style: italic;">@ add t x
        modifies t.contents
        ensures t.contents = x :: (old t.contents)</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
</code></pre>
</div>

<p>
Here the functions <code>create</code> and <code>add</code> are specified in Gospel.
</p>

<ul class="org-ul">
<li>The <code>create</code> function requires the capacity <code>c</code> to be strictly positive and ensures that the model of the new container has the specified capacity and an empty list of contents.</li>
<li>The <code>add</code> function modifies the contents of the container and ensures that the new element <code>x</code> is added to the list of contents.</li>
</ul>
</div>
</li>
<li><a id="org02bfcaf"></a>3- Define projection functions<br />
<div class="outline-text-5" id="text-org02bfcaf">
<p>
To validate these specifications at runtime, you need to provide projection functions that link OCaml values to their Gospel models. Projection functions can be defined in two ways.
</p>

<ul class="org-ul">
<li>Using the same name as the model.</li>
<li>Using a different name, annotated with the attribute <code>@@projection_for</code> and the name of its Gospel model.</li>
</ul>

<p>
For our example, we define the projection functions as follows.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code><span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">capacity</span> : 'a t -&gt; int
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">to_list</span> : 'a t -&gt; 'a list <span style="color: #9f0d0f;">[@@projection_for contents]</span>
</code></pre>
</div>

<p>
Where we encounter the two types of naming.
</p>

<ul class="org-ul">
<li>The <code>capacity</code> function directly corresponds to the <code>capacity</code> model.</li>
<li>The <code>to_seq</code> function is explicitly declared as the projection for the <code>contents</code> model using the <code>@@projection_for</code> attribute.</li>
</ul>

<p>
These projection functions are mandatory for the Wrapper plugin to instrument the specifications. If any projection function is missing, nothing will be generated and an error will be printed.
</p>
</div>
</li>
<li><a id="org4811287"></a>4- Generate the wrapped version<br />
<div class="outline-text-5" id="text-org4811287">
<p>
Once you have both of the interface file annotated with Gospel and your implementation, you can start the generation.
If you have installed the <code>ortac-dune</code> package (which is recommended), you need to add the following in the dune file where you want to put the tests.
</p>

<pre class="example" id="orgb6d50da">
(rule
 (alias runtest)
 (mode promote)
 (action
  (with-stdout-to
   dune.wrapper.inc
   (setenv
    ORTAC_ONLY_PLUGIN
    dune-rules
    (run ortac dune wrapper &lt;path to lib/lib.mli&gt;)))))
</pre>

<p>
This will generate an additional Dune file called <code>dune.wrapper.inc</code> that you will need to include once created: <code>(include dune.wrapper.inc)</code>. Also, add the name of the wrapped module to the <code>libraries</code> stanza of the test folder.
</p>
</div>
</li>
<li><a id="org03b08c0"></a>5- Add unit tests<br />
<div class="outline-text-5" id="text-org03b08c0">
<p>
In order to test the <code>Lib</code> module, we can now simply write a program using the wrapped version. No need to specify the expected behaviour as the instrumentation will take care of that.
</p>

<p>
For example, if you run the following program:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><code><span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Lib_wrapped</span>
<span style="color: #000000; font-weight: bold;">let</span> () =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">q</span> = create 3 <span style="color: #000000; font-weight: bold;">in</span>
  add q 1;
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">q2</span> = create (-1) <span style="color: #000000; font-weight: bold;">in</span>
  add q2 1;
  ()
</code></pre>
</div>

<p>
You will obtain the following result:
</p>

<pre class="example" id="orgeb3cac0">
File "lib.mli", line 8, characters 0-175:
Runtime error in function ~create'
  - the pre-condition
      `c &gt; 0'
    was violated.
Fatal error: exception Ortac_runtime.Error(_)
</pre>

<p>
This process helps ensure that your code adheres to the specified behavior, making your unit tests more robust and informative.
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgcb43363" class="outline-4">
<h4 id="orgcb43363">Feel free to report</h4>
<div class="outline-text-4" id="text-orgcb43363">
<p>
For more information here is the link of the <a href="https://github.com/ocaml-gospel/ortac/blob/main/plugins/wrapper/README.md">dedicated README</a>.
If you encounter any bugs or misunderstandings, please feel free to report them as an issue on <a href="https://github.com/ocaml-gospel/ortac/issues">GitHub</a>.
</p>

<p>
We hope this plugin will be useful to you and look forward to your feedback!
</p>
</div>
</div>
<div id="outline-container-orgb112803" class="outline-4">
<h4 id="orgb112803">Acknowledgments</h4>
<div class="outline-text-4" id="text-orgb112803">
<p>
This work is partly founded by the ANR grant ANR-22-CE48-0013.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-11" class="outline-2">
<h2 id="11">Other OCaml News</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-org02c7422" class="outline-3">
<h3 id="org02c7422">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-org02c7422">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://ocaml.org/events">Upcoming OCaml Events</a></li>
<li><a href="https://fearful-odds.rocks/blog/database-testing-for-chaufr">Database Testing in OCaml: From CRUD to Connection Pool Stress Testing</a></li>
<li><a href="https://roscidus.com/blog/blog/2025/09/20/ocaml-vulkan/">Vulkan graphics in OCaml vs C</a></li>
<li><a href="https://www.tunbury.org/2025/09/17/parquet-files/">Apache Parquet Files</a></li>
<li><a href="https://www.tunbury.org/2025/09/17/optimising-parquet-files/">Optimising Data Access in Parquet Files</a></li>
<li><a href="https://www.tunbury.org/2025/09/17/freebsd-unionfs/">FreeBSD unionfs deadlock</a></li>
<li><a href="https://www.dra27.uk/blog/platform/2025/09/17/late-to-the-party.html">A first foray into agentic coding</a></li>
<li><a href="https://blog.robur.coop/articles/mollymawk-autoconfig.html">Auto-configuration of MirageOS unikernels</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org71b44a4" class="outline-2">
<h2 id="org71b44a4">Old CWN</h2>
<div class="outline-text-2" id="text-org71b44a4">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe to the <a href="https://sympa.inria.fr/sympa/info/caml-list">caml-list</a>.
</p>

<div class="authorname" id="org47ff3e9">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
