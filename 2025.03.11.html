<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-03-11 Tue 15:59 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2025.03.04.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2025.03.18.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of March 04 to 11, 2025.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">OCaml projects utilizing Category theory</a></li>
<li><a href="#2">Docker base images and OCaml-CI support for OCaml &lt; 4.08</a></li>
<li><a href="#3">ocamlmig, a tool to rewrite ocaml code, and complement <code>[@@deprecated]</code></a></li>
<li><a href="#4">Ortac 0.6.0 improve bug reporting</a></li>
<li><a href="#5">Dune Developer Preview Updates</a></li>
<li><a href="#6">ppxlib.0.36.0</a></li>
<li><a href="#7">I created an OCaml grammar for ANTLR4 (Earley parser compatible)</a></li>
<li><a href="#8">Melange 5.0</a></li>
<li><a href="#9">Other OCaml News</a></li>
<li><a href="#orgab6a7c9">Old CWN</a></li>
</ul>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="1">OCaml projects utilizing Category theory</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-projects-utilizing-category-theory/16206/5">https://discuss.ocaml.org/t/ocaml-projects-utilizing-category-theory/16206/5</a>
</p>
</div>
<div id="outline-container-org9f12395" class="outline-3">
<h3 id="org9f12395">Deep in this thread, Dmitrii Kovanikov announced</h3>
<div class="outline-text-3" id="text-org9f12395">
<p>
I started writing <a href="https://chshersh.com/blog/2024-07-30-pragmatic-category-theory-part-01.html">a series of articles about Pragmatic Category Theory</a> in OCaml, and there's a repository with examples:
</p>

<ul class="org-ul">
<li><a href="https://github.com/chshersh/pragmatic-category-theory">https://github.com/chshersh/pragmatic-category-theory</a></li>
</ul>

<p>
If you're interested in a complete project, I made <b>CCL: Categorical Configuration Language</b> which leverages multiple Category Theory concepts:
</p>

<ul class="org-ul">
<li><a href="https://chshersh.com/blog/2025-01-06-the-most-elegant-configuration-language.html">The Most Elegant Configuration Language by @chshersh</a></li>
</ul>

<p>
I'm currently working on a <a href="https://github.com/chshersh/github-tui">GitHub TUI</a> project in OCaml but the usage of CT concepts is not that crazy there. For now, I only use Semigroup and Monoids (which some people don't even consider part of CT but just Abstract Algebra).
</p>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="2">Docker base images and OCaml-CI support for OCaml &lt; 4.08</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/docker-base-images-and-ocaml-ci-support-for-ocaml-4-08/16229/1">https://discuss.ocaml.org/t/docker-base-images-and-ocaml-ci-support-for-ocaml-4-08/16229/1</a>
</p>
</div>
<div id="outline-container-org433d037" class="outline-3">
<h3 id="org433d037">Mark Elvers announced</h3>
<div class="outline-text-3" id="text-org433d037">
<p>
The <a href="https://discuss.ocaml.org/t/opam-repository-archival-phase-2-ocaml-4-08-is-the-lower-bound/15965">opam repository archival</a> process has set the minimum supported OCaml version to 4.08 <span class="underline">for opam repository</span>.  It logically follows that opam-repo-ci should only test against OCaml &gt;= 4.08.
</p>

<p>
The purpose of this post is to get a sense of whether the rest of the OCaml infrastructure should also adopt the same lower bound.  The current lower bound is 4.02.
</p>

<p>
Specific examples include OCaml-CI.  Individual projects can already opt out of testing on older platforms by adding a lower bound in the opam file.
</p>

<p>
Docker base images are built for all versions of OCaml used in the CI systems. These images are published weekly on Docker Hub.  We know that these images are also used by the community, but the pull counter is not broken down by individual tag.  Potentially only the latest OCaml versions are being used.
</p>

<p>
Users impacted by packages which have been archived from opam repository can easily restore the packages by adding the archive repository to the opam switch.  This only needs to be done once.  Users can build their own Docker base images, but they would need to be rebuilt periodically to keep them up to date.
</p>

<p>
Would removing testing on &lt; 4.08 in OCaml CI or removing the Docker base images &lt; 4.08 impact you?
</p>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="3">ocamlmig, a tool to rewrite ocaml code, and complement <code>[@@deprecated]</code></h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocamlmig-a-tool-to-rewrite-ocaml-code-and-complement-deprecated/16090/10">https://discuss.ocaml.org/t/ann-ocamlmig-a-tool-to-rewrite-ocaml-code-and-complement-deprecated/16090/10</a>
</p>
</div>
<div id="outline-container-org7d93fcd" class="outline-3">
<h3 id="org7d93fcd">v-gb announced</h3>
<div class="outline-text-3" id="text-org7d93fcd">
<p>
Hi,
</p>

<p>
I released a new version of ocamlmig in opam, whose main change is to avoid reformatting everything in codebases that don't use ocamlformat. Instead, only subexpressions touched by a rewrite are reformatted.
It also requalifies identifier in more places to preserve their meaning (e.g. when replacing <code>string_of_int</code> by <code>Int.to_string</code>, there might be an <code>Int</code> module in scope that's not <code>Stdlib.Int</code>. In such case, ocamlmig would more often replace <code>string_of_int</code> by <code>Stdlib.Int.to_string</code>).
</p>

<p>
Separately, I've thought about the recent addition of let+ operators in Cmdliner, and how one might migrate from the use of <code>$</code> to them. Concretetely, given:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">bistro</span> () (<span style="color: #242521; background-color: #fcf7ef;">`Dry_run</span> <span style="color: #007a9f;">dry_run</span>) (<span style="color: #242521; background-color: #fcf7ef;">`Package_names</span> <span style="color: #007a9f;">pkg_names</span>) ... = the code
<span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Cmdliner</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">term</span> = <span style="color: #444fcf;">Term.</span>(const bistro <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>setup <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>dry_run <span style="color: #a52a2a;">$</span> ...)
</pre>
</div>

<p>
you'd want to have instead:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Cmdliner</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">term</span> =
  <span style="color: #444fcf;">Term.</span>(<span style="color: #444fcf;">Syntax.</span>(
    <span style="color: #000000; font-weight: bold;">let+</span> () = <span style="color: #444fcf;">Cli.</span>setup
    <span style="color: #000000; font-weight: bold;">and+</span> (<span style="color: #242521; background-color: #fcf7ef;">`Dry_run</span> <span style="color: #007a9f;">dry_run</span>) = <span style="color: #444fcf;">Cli.</span>dry_run
    <span style="color: #000000; font-weight: bold;">and+</span> (<span style="color: #242521; background-color: #fcf7ef;">`Package_names</span> <span style="color: #007a9f;">pkg_names</span>) = ...
    ...
    <span style="color: #000000; font-weight: bold;">in</span>
    the code))
</pre>
</div>

<p>
ocamlmig can now transform code this way, at the tip of the ocamlmig repo (not the last release). You can see it <a href="https://github.com/tarides/dune-release/pull/503/commits">in the second commit in this branch</a> (and further mechanical cleanups in the commits with "&#x2026;" bubbles), but to explain a bit:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">bistro</span> () (<span style="color: #242521; background-color: #fcf7ef;">`Dry_run</span> <span style="color: #007a9f;">dry_run</span>) (<span style="color: #242521; background-color: #fcf7ef;">`Package_names</span> <span style="color: #007a9f;">pkg_names</span>) ... = the code
<span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Cmdliner</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">term</span> = <span style="color: #444fcf;">Term.</span>(const bistro <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>setup <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>dry_run <span style="color: #a52a2a;">$</span> ...)
</pre>
</div>

<p>
is first turned into:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Cmdliner</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">term</span> = <span style="color: #444fcf;">Term.</span>(const (<span style="color: #006f00; font-weight: bold;">fun</span> () (<span style="color: #242521; background-color: #fcf7ef;">`Dry_run</span> <span style="color: #007a9f;">dry_run</span>) (<span style="color: #242521; background-color: #fcf7ef;">`Package_names</span> <span style="color: #007a9f;">pkg_names</span>) ... -&gt; the code)
                 <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>setup <span style="color: #a52a2a;">$</span> <span style="color: #444fcf;">Cli.</span>dry_run <span style="color: #a52a2a;">$</span> ...)
</pre>
</div>

<p>
which is then turned into the final code:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Cmdliner</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">term</span> =
  <span style="color: #444fcf;">Term.</span>(<span style="color: #444fcf;">Syntax.</span>(
    <span style="color: #000000; font-weight: bold;">let+</span> () = <span style="color: #444fcf;">Cli.</span>setup
    <span style="color: #000000; font-weight: bold;">and+</span> (<span style="color: #242521; background-color: #fcf7ef;">`Dry_run</span> <span style="color: #007a9f;">dry_run</span>) = <span style="color: #444fcf;">Cli.</span>dry_run
    <span style="color: #000000; font-weight: bold;">and+</span> (<span style="color: #242521; background-color: #fcf7ef;">`Package_names</span> <span style="color: #007a9f;">pkg_names</span>) = ...
    ...
    <span style="color: #000000; font-weight: bold;">in</span>
    the code))
</pre>
</div>

<p>
The first step is done using <code>ocamlmig replace -w -e 'const [%move_def __f] /// const __f'</code>. In short, what this does is anytime it sees <code>const some-identifier</code>, it tries to inline the definition of the identifier. In details, the left side of the <code>///</code> specifies the code to search for, and the right side what to replace it with. <code>const ...</code> searches for literally <code>const</code> applied to one argument. <code>[%move_def __f]</code> is trickier: it matches identifiers that are let-bound somewhere in the current file, removes said let binding, and recursively matches the right hand side of the binding against <code>__f</code>. Variables that start with two underscores name a term for use in the replacement expression.
</p>

<p>
The second step is done with:
</p>

<div class="org-src-container">
<pre class="src src-shell">ocamlmig replace -w <span style="color: #ca3400;">\</span>
  -e <span style="color: #ca3400;">'const (fun __p1 __p2 __p3 -&gt; __body) $ __e1 $ __e2 $ __e3</span>
<span style="color: #ca3400;">      /// let open Syntax in let+ __p1 = __e1 and+ __p2 = __e2 and+ __p3 = __e3 in __body'</span>
</pre>
</div>

<p>
This is longer, but given the previous explanation, it's hopefully fairly clear what this does. The only twist is that ocamlmig generalizes this search/replace for three elements into an n-ary version (implicitly, although perhaps it should be explicit).
</p>

<p>
And that's it. So this is the full command that I used:
</p>

<div class="org-src-container">
<pre class="src src-shell">ocamlmig replace -w <span style="color: #ca3400;">\</span>
  -e <span style="color: #ca3400;">'const [%move_def __f] /// const __f'</span> <span style="color: #ca3400;">\</span>
  -e <span style="color: #ca3400;">'const (fun __p1 __p2 __p3 -&gt; __body) $ __e1 $ __e2 $ __e3</span>
<span style="color: #ca3400;">      /// let open Syntax in let+ __p1 = __e1 and+ __p2 = __e2 and+ __p3 = __e3 in __body'</span>
</pre>
</div>

<p>
which seems pretty reasonable considering the rewrite is somewhat sophisticated.
</p>

<p>
In general, mechanizing a change can reduce the chance of accidentally modifying something, but in this specific case, ocamlmig also detects shadowing when moving code with <code>[%move_def]</code>. Shadowing would likely cause type errors or tests errors, but if it didn't, it'd be quite hard to catch during code review.
</p>

<p>
Finally, if you want to try this out on your code, I'll note that <code>ocamlmig replace</code> is in flux, and that while the commands above work, obvious variations of them may not.
</p>
</div>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="4">Ortac 0.6.0 improve bug reporting</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ortac-0-6-0-improve-bug-reporting/16232/1">https://discuss.ocaml.org/t/ann-ortac-0-6-0-improve-bug-reporting/16232/1</a>
</p>
</div>
<div id="outline-container-orgc35fda9" class="outline-3">
<h3 id="orgc35fda9">Nicolas Osborne announced</h3>
<div class="outline-text-3" id="text-orgc35fda9">
<p>
Hi everyone!
</p>

<p>
We - at Tarides - are very pleased to announce the release of the Ortac-0.6.0 packages for specification-driven testing!
</p>

<p>
Ortac/QCheck-STM is a test generator based on the <a href="https://github.com/ocaml-multicore/multicoretests">QCheck-STM</a> model-based testing framework and the <a href="https://github.com/ocaml-gospel/gospel">Gospel</a> specification language for OCaml.
</p>

<p>
In addition to generating QCheck-STM tests based on the Gospel specifications, <code>Ortac/QCheck-STM</code> computes and display a bug report in case of test failure.
</p>

<p>
This report contains the piece of Gospel specification that has been violated, a runnable scenario to reproduce the bug and the expected returned value (if there is enough information in the specification to compute it).
</p>

<p>
This release improves the reporting in two ways.
</p>

<p>
First, the way we need to formulate the description of the expected returned value has been made more flexible (and fixed). The main limitation was about functions returning a boolean. Because of the coercion mechanism, Gospel often transforms equalities involving a boolean into a double implication. For example: <code>b = Sequence.mem t.contents a</code> is transformed into <code>b = true &lt;-&gt; Sequence.mem t.contents a</code>. (For the curious, this is because <code>Sequence.mem</code> returns a <code>prop</code>, not a <code>bool</code>, and we don't have equality on <code>prop</code>). <code>Ortac/QCheck-STM</code> now explores more patterns, including the double implication one, to try to find a suitable description of the returned value to use in the bug report.
</p>

<p>
Secondly, and more importantly, the Gospel specification language supports partial functions (<code>Sequence.hd</code> is <b>not</b> defined on the empty sequence for example). When we translate calls to such function to OCaml, we raise an exception when the call is out of the function's domain. Now, that exception was captured by QCheck at runtime, making the test a failure as expected. But the Ortac runtime was then stopped before being able to build and send the bug report to QCheck for display to the user. That was sad, so I've fixed it. We can now make use of Gospel partial functions when writing specifications and enjoy the bug report computed by <code>Ortac/QCheck-STM</code>!
</p>

<p>
You can install Ortac/QCheck-STM via opam (we also advise installing and using Ortac/Dune):
</p>

<pre class="example" id="org4c4632b">
$ opam install ortac-qcheck-stm ortac-dune
</pre>

<p>
You'll find more information in <a href="https://ocaml-gospel.github.io/ortac/ortac-qcheck-stm/index.html">Ortac/QCheck-STM documentation</a> and in The <a href="https://github.com/ocaml-gospel/ortac/tree/main/plugins/dune-rules#dune-rules-plugin-for-ortac">Ortac/Dune readme</a>.
</p>

<p>
If you have any questions, please don't hesitate to ping me :-)
</p>

<p>
Next release should be about making Ortac/QCheck-STM generate tests of a library in a parallel context (this is, after all, one of the <b>raison d'être</b> of the fantastic QCheck-STM test framework!).
</p>

<p>
Happy testing!
</p>
</div>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="5">Dune Developer Preview Updates</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-dune-developer-preview-updates/15160/57">https://discuss.ocaml.org/t/ann-dune-developer-preview-updates/15160/57</a>
</p>
</div>
<div id="outline-container-orgc232b0f" class="outline-3">
<h3 id="orgc232b0f">Leandro Ostera announced</h3>
<div class="outline-text-3" id="text-orgc232b0f">
<p>
Hello everyone! :waving_hand: Hope you had a great end of 2024 and your 2025 is starting well too :D 
</p>

<p>
We've been hard at work at Tarides to improve the Dune Developer Preview, and we'd love to learn more about what your adoption hurdles have been, so here's a very short form you can fill to let us know what's up.
</p>

<p>
Happy hacking! :two_hump_camel: 
</p>

<p>
<a href="https://forms.gle/piaw12XBYUeaCmg56">https://forms.gle/piaw12XBYUeaCmg56</a>
</p>
</div>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="6">ppxlib.0.36.0</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ppxlib-0-36-0/16241/1">https://discuss.ocaml.org/t/ann-ppxlib-0-36-0/16241/1</a>
</p>
</div>
<div id="outline-container-orgfdec847" class="outline-3">
<h3 id="orgfdec847">Patrick Ferris announced</h3>
<div class="outline-text-3" id="text-orgfdec847">
<p>
The ppxlib team is happy to announce the release of <code>ppxlib.0.36.0</code>! 
</p>

<p>
A full account of the changes can be found <a href="https://github.com/ocaml-ppx/ppxlib/releases/tag/0.36.0">on the 0.36.0 release</a>.
</p>
</div>
<div id="outline-container-orgd84a94f" class="outline-4">
<h4 id="orgd84a94f">OCaml 5.2 Internal AST</h4>
<div class="outline-text-4" id="text-orgd84a94f">
<p>
The main change in this release is that the internal AST used in ppxlib is now the same as OCaml 5.2's AST. Previously it was 4.14.0. The internal AST dictates what features your ppx can and cannot generate. To avoid confusion, this does <span class="underline">not</span> mean ppxlib only supports OCaml 5.2 and greater. Ppxlib still supports compilers starting at 4.08.0.
</p>

<p>
<b>The bump to 5.2 has caused a lot of reverse dependencies to break</b> as the 5.2 AST represents functions differently (<a href="https://github.com/ocaml/RFCs/pull/32">see the Syntactic Function Arity RFC</a>). Many patches have already been sent to users of ppxlib in the past few months, but quite a few still remain. 
</p>

<p>
:warning: Ppx authors are advised to read <a href="https://github.com/ocaml-ppx/ppxlib/wiki/Upgrading-to-ppxlib-0.36.0">the wiki entry for upgrading to ppxlib.0.36.0</a>. :warning: 
</p>

<p>
Please do not hesitate to reach out if you need any help upgrading to <code>ppxlib.0.36.0</code>.
</p>
</div>
</div>
<div id="outline-container-org4be588f" class="outline-4">
<h4 id="org4be588f">Other Changes</h4>
<div class="outline-text-4" id="text-org4be588f">
<ul class="org-ul">
<li>Change <code>Location.none</code> to match the compiler's <code>Location.none</code> as of OCaml 4.08.</li>
<li>New ways to create context free rules using floating expansions &#x2013; see <a href="https://github.com/ocaml-ppx/ppxlib/pull/560">#560</a> for the details.</li>
<li>Add a <code>-raise-embedded-errors</code> flag to the driver. Setting this flag raises the first <code>ocaml.error</code> embedded in the final AST.</li>
<li>Export <code>Ast_pattern.fail</code> making it easier to write new pattern-matchers.</li>
<li>Improvements to <code>Ast_traverse.sexp_of</code> to be more concise.</li>
</ul>

<p>
Do read the changes entry/release for all of the acknowledgments &#x2013; thank you to everyone who contributed to this release of ppxlib! A special thanks from me to @NathanReb who has been a massive help getting this work over the line.
</p>

<p>
Thank you to Tarides and Jane Street for funding my time on this release of ppxlib.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-7" class="outline-2">
<h2 id="7">I created an OCaml grammar for ANTLR4 (Earley parser compatible)</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/i-created-an-ocaml-grammar-for-antlr4-earley-parser-compatible/16246/1">https://discuss.ocaml.org/t/i-created-an-ocaml-grammar-for-antlr4-earley-parser-compatible/16246/1</a>
</p>
</div>
<div id="outline-container-org0e41043" class="outline-3">
<h3 id="org0e41043">ao wang announced</h3>
<div class="outline-text-3" id="text-org0e41043">
<p>
Hi everyone,
</p>

<p>
I’ve created an ANTLR4 grammar for OCaml that supports Earley parsing.  
Feel free to use it, and any feedback or contributions are welcome!
</p>

<p>
GitHub Repository:
<a href="https://github.com/WangAo0311/Antlr4-ocaml-earley-parser-grammar">https://github.com/WangAo0311/Antlr4-ocaml-earley-parser-grammar</a>
</p>
</div>
</div>
</div>
<div id="outline-container-8" class="outline-2">
<h2 id="8">Melange 5.0</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-melange-5-0/16247/1">https://discuss.ocaml.org/t/ann-melange-5-0/16247/1</a>
</p>
</div>
<div id="outline-container-org9a577c7" class="outline-3">
<h3 id="org9a577c7">Antonio Nuno Monteiro announced</h3>
<div class="outline-text-3" id="text-org9a577c7">
<p>
Dear OCaml users,
</p>

<p>
I'm proud to announce the release of Melange 5.0
</p>

<p>
Melange is a backend for the OCaml compiler that emits JavaScript. This release features improvements across a few areas, mostly targeting OCaml 5.3 support and JavaScript expressivity:
</p>

<ul class="org-ul">
<li>OCaml version support: we’re releasing Melange 5 with full support across a few OCaml versions: 4.14, 5.1, 5.2 and the recently released 5.3
<ul class="org-ul">
<li>Melange uses a versioning scheme similar to Merlin’s: releases are suffixed with the OCaml version they support, e.g. 5.0.1-414, 5.0.1-53, etc.</li>
</ul></li>
<li>We're introducing build system-aware, type-safe support for JavaScript's <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import">dynamic import</a>, allowing to code split Melange-generated JavaScript bundles without sacrificing type-safety.</li>
<li>Melange can now express <a href="https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes-func.html#discriminated-unions">discriminated unions</a>, a JavaScript pattern that</li>
</ul>

<p>
The <a href="https://melange.re/blog/posts/announcing-melange-5">release announcement</a> blog post covers the changes in a lot more detail. Please give it a read.
</p>

<p>
I'm excited to count on the support of our financial sponsors <a href="https://ahrefs.com/jobs">Ahrefs</a> and the <a href="https://ocaml-sf.org/">OCaml Software Foundation</a>, without which this release would not have been possible.
</p>
</div>
</div>
</div>
<div id="outline-container-9" class="outline-2">
<h2 id="9">Other OCaml News</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org7de0162" class="outline-3">
<h3 id="org7de0162">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-org7de0162">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://tech.ahrefs.com/openai-and-structured-outputs-from-ocaml-b198fcf701ca?source=rss----303662d88bae--ocaml">OpenAI and structured outputs from OCaml</a></li>
<li><a href="https://tarides.com/blog/2025-03-06-feature-parity-series-statmemprof-returns">Feature Parity Series: Statmemprof Returns!</a></li>
<li><a href="https://melange.re/blog/posts/announcing-melange-5">Announcing Melange 5</a></li>
<li><a href="https://batsov.com/articles/2025/03/02/learning-ocaml-functions-without-parameters/">Learning OCaml: Functions without Parameters</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgab6a7c9" class="outline-2">
<h2 id="orgab6a7c9">Old CWN</h2>
<div class="outline-text-2" id="text-orgab6a7c9">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe to the <a href="https://sympa.inria.fr/sympa/info/caml-list">caml-list</a>.
</p>

<div class="authorname" id="orgd7c5538">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
