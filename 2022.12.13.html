<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-12-13 Tue 18:53 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2022.12.06.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2022.12.20.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of December 06 to 13, 2022.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Status update: Bazel-enabled OCaml toolchain</a></li>
<li><a href="#2">First release candidate for OCaml 5.0.0</a></li>
<li><a href="#3">First release candidate for OCaml 4.14.1</a></li>
<li><a href="#4">Stable Diffusion in OCaml</a></li>
<li><a href="#5">qcheck-lin and qcheck-stm 0.1.0</a></li>
<li><a href="#6">Accelerating zk-SNARKs on FPGAs with Hardcaml</a></li>
<li><a href="#7">ppx_expjs: transparently export OCaml values to JavaScript</a></li>
<li><a href="#8">First public release of OCaml-Canvas 1.0</a></li>
<li><a href="#9">Release of Seqes version 0.1</a></li>
<li><a href="#10">Batteries v3.6.0</a></li>
<li><a href="#orga2dbb33">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Status update: Bazel-enabled OCaml toolchain</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/status-update-bazel-enabled-ocaml-toolchain/10892/1">https://discuss.ocaml.org/t/status-update-bazel-enabled-ocaml-toolchain/10892/1</a>
</p>
</div>

<div id="outline-container-org811ed4d" class="outline-3">
<h3 id="org811ed4d">Gregg Reynolds announced</h3>
<div class="outline-text-3" id="text-org811ed4d">
<p>
<a href="https://github.com/obazl-repository/ocamlcc">https://github.com/obazl-repository/ocamlcc</a>
</p>

<p>
From the readme:
</p>

<ul class="org-ul">
<li>New name: ocamlcc - the OCaml Compiler Collection. Analogous to GCC, the GNU Compiler Collection. Not only do we have multiple compilers - ocamlc.byte, ocamlopt.byte, etc., the compilers themselves may serve to drive a C toolchain, to compile, assemble, and link C code.</li>
<li>Platforms and toolchains have been revised to support recursive (staged) builds.</li>
<li>Recursive builds. Well, at least quasi-recursive. There is only one target for building a compiler, bin:ocamlcc; to build the compiler, this target needs a compiler, which it gets from a toolchain, which depends on bin:ocamlc, which needs a compiler, …​ recursively, until we get to the base case, the precompiled boot/ocamlc compiler. So the boot compiler (boot/ocamlc) builds the stage 1 compiler which builds the stage 2 compiler which builds the stage 3 compiler. See Staged builds.</li>
<li>Revised configuration logic. The goal is to eliminate dependency on autotools (./configure). This is very much a Work-In-Progress; the code is in //config. For more info see notes/autoconf.</li>
<li>Use the link command from the Bazel CC toolchain. OBazl now uses information from the cc toolchain selected (and configured) by Bazel to set the command string used by OCaml to run the C linker (Config.mkexe). For more info see ocaml_cc_config and notes/linking. [TODO: same thing for the assemble command Config.asm]</li>
<li>Revised preprocessing. OBazl eliminates shell scripts and tools, instead using a template engine written in portable C to generate code.</li>
</ul>

<p>
In other words, this version includes some stuff beyond just getting the Bazel build to work, in particular concerning configuration
and preprocessing. Part of the motivation there is to pave the way to Windows support by eliminating dependency on Unix-ish stuff.
</p>

<p>
Maintainers of the Makefiles may be interested in some of that stuff. Using templates for code generation instead of sh, awk, sed,
etc. The template engine is written in portable C. Personally I find that using templates simplifies things considerably.
</p>

<p>
Feedback always welcome. The issue tracker is enabled on the github repo, and a discourse server is at
<a href="https://discord.gg/wZCSq2nq6y">https://discord.gg/wZCSq2nq6y</a>.
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">First release candidate for OCaml 5.0.0</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/first-release-candidate-for-ocaml-5-0-0/10922/1">https://discuss.ocaml.org/t/first-release-candidate-for-ocaml-5-0-0/10922/1</a>
</p>
</div>

<div id="outline-container-org59bc3ed" class="outline-3">
<h3 id="org59bc3ed">octachron announced</h3>
<div class="outline-text-3" id="text-org59bc3ed">
<p>
The release of OCaml version 5.0.0 is imminent. As a final step before the release,
we are publishing a release candidate that you can test while waiting for the release
in the upcoming weeks.
</p>

<p>
If you find any bugs, please report them here:
</p>

<p>
<a href="https://github.com/ocaml/ocaml/issues">https://github.com/ocaml/ocaml/issues</a>
</p>

<p>
Compared to the second beta release, this release contains one toplevel bug fix
and a minor type system fix.
</p>

<p>
If you are interested by the bug fixes beyond the new multicore runtime, the
full change log for OCaml 5.0.0 is available at:
</p>

<p>
<a href="https://github.com/ocaml/ocaml/blob/5.0/Changes">https://github.com/ocaml/ocaml/blob/5.0/Changes</a>
</p>

<p>
A short summary of the two changes since the second beta release is also available below.
</p>

<p>
This release candidate will be followed shortly by a release candidate for OCaml 4.14.1 .
This updated minor version for OCaml 4.14 will mirror the safe bug fixes from the OCaml 5.0
branch.
</p>
</div>

<div id="outline-container-org5a6687b" class="outline-4">
<h4 id="org5a6687b">Installation instructions</h4>
<div class="outline-text-4" id="text-org5a6687b">
<p>
The base compiler can be installed as an opam switch with the following commands on opam 2.1:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create 5.0.0~rc1
</pre>
</div>
<p>
For previous version of opam, the switch creation command line is slightly more verbose:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create 5.0.0~rc1 --repositories=default,<span style="color: #007a9f;">beta</span>=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>
</div>
<p>
It might be also interesting to check the new support for parallelism by installing the domainslib library with
</p>
<div class="org-src-container">
<pre class="src src-shell">opam install domainslib
</pre>
</div>
<p>
The source code for the release candidate is available at these addresses:
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/archive/5.0.0-rc1.tar.gz">https://github.com/ocaml/ocaml/archive/5.0.0-rc1.tar.gz</a></li>
<li><a href="https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-5.0.0~rc1.tar.gz">https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-5.0.0~rc1.tar.gz</a></li>
</ul>
</div>

<ul class="org-ul">
<li><a id="org32aad68"></a>Fine-tuned compiler configuration<br />
<div class="outline-text-5" id="text-org32aad68">
<p>
If you want to tweak the configuration of the compiler, you can switch to the option variant with:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create &lt;switch_name&gt; ocaml-variants.5.0.0~rc1+options &lt;option_list&gt;
</pre>
</div>
<p>
where <code>&lt;option_list&gt;</code> is a comma separated list of <code>ocaml-option-*</code> packages. For instance, for a flambda and no-flat-float-array
switch:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam switch create 5.0.0~rc1+flambda+nffa ocaml-variants.5.0.0~rc1+options ocaml-option-flambda ocaml-option-no-flat-float-array
</pre>
</div>
<p>
The command line above is slightly more complicated for opam versions anterior to 2.1:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create &lt;switch_name&gt; --packages=ocaml-variants.5.0.0~rc1+options,&lt;option_list&gt;
--repositories=default,<span style="color: #007a9f;">beta</span>=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>
</div>
<p>
In both cases, all available options can be listed with &ldquo;opam search ocaml-option&rdquo;.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orga6653ff" class="outline-4">
<h4 id="orga6653ff">Changes since the second beta release</h4>
<div class="outline-text-4" id="text-orga6653ff">
</div>
<ul class="org-ul">
<li><a id="orgc932cf6"></a>Bug fixes<br />
<div class="outline-text-5" id="text-orgc932cf6">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11776">11776</a>: Extend environment with functor parameters in `strengthen_lazy`.
(Chris Casinghino and Luke Maurer, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11533">11533</a>, <a href="https://github.com/ocaml/ocaml/issues/11534">11534</a>: follow synonyms again in #show_module_type (this had stopped working in 4.14.0) (Gabriel Scherer, review by Jacques Garrigue, report by Yaron Minsky)</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">First release candidate for OCaml 4.14.1</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/first-release-candidate-for-ocaml-4-14-1/10929/1">https://discuss.ocaml.org/t/first-release-candidate-for-ocaml-4-14-1/10929/1</a>
</p>
</div>

<div id="outline-container-org532c4a3" class="outline-3">
<h3 id="org532c4a3">octachron announced</h3>
<div class="outline-text-3" id="text-org532c4a3">
<p>
The release of OCaml version 4.14.1 is (also) imminent.
</p>

<p>
This companion release to the OCaml 5.0.0 release will backport many safe bug
fixes from the currently experimental 5.0 branch to the stable 4.14 branch.
A full list of bug fixes is available below.
</p>

<p>
In order to ensure that the future release works as expected, we are testing
a release candidate during the upcoming weeks.
</p>

<p>
If you find any bugs, please report them here:
</p>

<p>
<a href="https://github.com/ocaml/ocaml/issues">https://github.com/ocaml/ocaml/issues</a>
</p>
</div>

<div id="outline-container-org694b4ed" class="outline-4">
<h4 id="org694b4ed">Installation Instructions</h4>
<div class="outline-text-4" id="text-org694b4ed">
<p>
The base compiler can be installed as an opam switch with the following commands on opam 2.1:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create 4.14.1~rc1
</pre>
</div>
<p>
For previous version of opam, the switch creation command line is slightly more verbose:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create 4.14.1~rc1 --repositories=default,<span style="color: #007a9f;">beta</span>=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>
</div>
<p>
It might be also interesting to check the new support for parallelism by installing the `domainslib` library with
</p>
<div class="org-src-container">
<pre class="src src-shell">opam install domainslib
</pre>
</div>
<p>
The source code for the release candidate is available at these addresses:
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/archive/4.14.1-rc1.tar.gz">https://github.com/ocaml/ocaml/archive/4.14.1-rc1.tar.gz</a></li>
<li><a href="https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-4.14.1~rc1.tar.gz">https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-4.14.1~rc1.tar.gz</a></li>
</ul>
</div>

<ul class="org-ul">
<li><a id="org50b566e"></a>Fine-Tuned Compiler Configuration<br />
<div class="outline-text-5" id="text-org50b566e">
<p>
If you want to tweak the configuration of the compiler, you can switch to the option variant with:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create &lt;switch_name&gt; ocaml-variants.4.14.1~rc1+options &lt;option_list&gt;
</pre>
</div>
<p>
where <code>&lt;option_list&gt;</code> is a comma-separated list of <code>ocaml-option-*</code> packages. For instance, for a <code>flambda</code> and
<code>no-flat-float-array</code> switch:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam switch create 4.14.1~rc1+flambda+nffa ocaml-variants.4.14.1~rc1+options ocaml-option-flambda ocaml-option-no-flat-float-array
</pre>
</div>
<p>
The command line above is slightly more complicated for opam versions before 2.1:
</p>
<div class="org-src-container">
<pre class="src src-shell">opam update
opam switch create &lt;switch_name&gt; --packages=ocaml-variants.4.14.1~rc1+options,&lt;option_list&gt;
--repositories=default,<span style="color: #007a9f;">beta</span>=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>
</div>
<p>
In both cases, all available options can be listed with <code>opam search ocaml-option</code>.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org86f184f" class="outline-4">
<h4 id="org86f184f">Changes Since OCaml 4.14.0</h4>
<div class="outline-text-4" id="text-org86f184f">
</div>
<ul class="org-ul">
<li><a id="org1a17e36"></a>Compiler user-interface and warnings:<br />
<div class="outline-text-5" id="text-org1a17e36">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11184">#11184</a>, <a href="https://github.com/ocaml/ocaml/issues/11670">#11670</a>: Stop calling ranlib on created / installed libraries (Sébastien Hinderer and Xavier Leroy, review by the same)</li>
</ul>
</div>
</li>

<li><a id="org56d92ff"></a>Build System:<br />
<div class="outline-text-5" id="text-org56d92ff">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11370">#11370</a>, <a href="https://github.com/ocaml/ocaml/issues/11373">#11373</a>: Don&rsquo;t pass CFLAGS to flexlink during configure. (David Allsopp, report by William Hu, review by Xavier Leroy and Sébastien Hinderer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11487">#11487</a>: Thwart FMA test optimization during configure (William Hu, review by David Allsopp and Sébastien Hinderer)</li>
</ul>
</div>
</li>

<li><a id="org72f9d8b"></a>Bug Fixes:<br />
<div class="outline-text-5" id="text-org72f9d8b">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/10768">#10768</a>, <a href="https://github.com/ocaml/ocaml/issues/11340">#11340</a>: Fix typechecking regression when combining first class modules and GADTs. (Jacques Garrigue, report by François Thiré, review by Matthew Ryan)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11204">#11204</a>: Fix regression introduced in 4.14.0 that would trigger Warning 17 when calling virtual methods introduced by constraining the self type from within the class definition. (Nicolás Ojeda Bär, review by Leo White)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11263">#11263</a>, <a href="https://github.com/ocaml/ocaml/issues/11267">#11267</a>: caml/{memory,misc}.h: check whether <code>_MSC_VER</code> is defined before using it to ensure that the headers can always be used in code which turns on -Wundef (or equivalent). (David Allsopp and Nicolás Ojeda Bär, review by Nicolás Ojeda Bär and Sébastien Hinderer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11314">#11314</a>, <a href="https://github.com/ocaml/ocaml/issues/11416">#11416</a>: fix non-informative error message for module inclusion (Florian Angeletti, report by Thierry Martinez, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11358">#11358</a>, <a href="https://github.com/ocaml/ocaml/issues/11379">#11379</a>: Refactor the initialization of bytecode threading, This avoids a &ldquo;dangling pointer&rdquo; warning of GCC 12.1. (Xavier Leroy, report by Armaël Guéneau, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11387">#11387</a>, module type with constraints no longer crash the compiler in presence of both shadowing warnings and the <code>-bin-annot</code> compiler flag. (Florian Angeletti, report by Christophe Raffalli, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11392">#11392</a>, <a href="https://github.com/ocaml/ocaml/issues/11392">#11392</a>: assertion failure with -rectypes and external definitions (Gabriel Scherer, review by Florian Angeletti, report by Dmitrii Kosarev)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11417">#11417</a>: Fix regression allowing virtual methods in non-virtual classes. (Leo White, review by Florian Angeletti)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11468">#11468</a>: Fix regression from <a href="https://github.com/ocaml/ocaml/issues/10186">#10186</a> (OCaml 4.13) detecting IPv6 on Windows for mingw-w64 i686 port. (David Allsopp, review by Xavier Leroy and Sébastien Hinderer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11489">#11489</a>, <a href="https://github.com/ocaml/ocaml/issues/11496">#11496</a>: More prudent deallocation of alternate signal stack (Xavier Leroy, report by @rajdakin, review by Florian Angeletti)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11516">#11516</a>, <a href="https://github.com/ocaml/ocaml/issues/11524">#11524</a>: Fix the <code>deprecated_mutable</code> attribute. (Chris Casinghino, review by Nicolás Ojeda Bär and Florian Angeletti)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11194">#11194</a>, <a href="https://github.com/ocaml/ocaml/issues/11609">#11609</a>: Fix inconsistent type variable names in &ldquo;unbound type var&rdquo; messages (Ulysse Gérard and Florian Angeletti, review Florian Angeletti and Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11622">#11622</a>: Prevent stack overflow when printing a constructor or record mismatch error involving recursive types. (Florian Angeletti, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11732">#11732</a>: Ensure that types from packed modules are always generalised (Stephen Dolan and Leo White, review by Jacques Garrigue)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11737">#11737</a>: Fix segfault condition in Unix.stat under Windows in the presence of multiple threads. (Marc Lasson, Nicolás Ojeda Bär, review by Gabriel Scherer and David Allsopp)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11776">#11776</a>: Extend environment with functor parameters in <code>strengthen_lazy</code>. (Chris Casinghino and Luke Maurer, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11533">#11533</a>, <a href="https://github.com/ocaml/ocaml/issues/11534">#11534</a>: follow synonyms again in #show_module_type (this had stopped working in 4.14.0) (Gabriel Scherer, review by Jacques Garrigue, report by Yaron Minsky)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11768">#11768</a>, <a href="https://github.com/ocaml/ocaml/issues/11788">#11788</a>: Fix crash at start-up of bytecode programs in no-naked-pointers mode caused by wrong initialization of caml_global_data (Xavier Leroy, report by Etienne Millon, review by Gabriel Scherer)</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">Stable Diffusion in OCaml</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/stable-diffusion-in-ocaml/10932/1">https://discuss.ocaml.org/t/stable-diffusion-in-ocaml/10932/1</a>
</p>
</div>

<div id="outline-container-org6a2d656" class="outline-3">
<h3 id="org6a2d656">Arul announced</h3>
<div class="outline-text-3" id="text-org6a2d656">
<p>
I ported over Stable Diffusion in OCaml as I tried to learn the internals of stable diffusion. So far, it has been a smooth process
to run deep learning models in OCaml.
</p>

<p>
<code>ocaml-torch</code> library is pretty neat!
</p>

<p>
<a href="https://github.com/ArulselvanMadhavan/diffusers-ocaml">https://github.com/ArulselvanMadhavan/diffusers-ocaml</a>
</p>

<p>
Comments/Feedbacks/Issues - welcome!
</p>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">qcheck-lin and qcheck-stm 0.1.0</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-qcheck-lin-and-qcheck-stm-0-1-0/10933/1">https://discuss.ocaml.org/t/ann-qcheck-lin-and-qcheck-stm-0-1-0/10933/1</a>
</p>
</div>

<div id="outline-container-org1186a2e" class="outline-3">
<h3 id="org1186a2e">Jan Midtgaard announced</h3>
<div class="outline-text-3" id="text-org1186a2e">
<p>
We are happy to announce the release of two new opam packages:
<code>qcheck-lin</code> and <code>qcheck-stm</code> for black-box property-based testing of
module interfaces under parallel usage. Both these libraries
build on top of <code>QCheck</code> - hence their names.
</p>

<ul class="org-ul">
<li><code>qcheck-lin</code> requires little more than an interface
description. It allows to test a library for sequential
consistency, that is, whether results obtained from using it in
parallel agree with some linear, single domain execution.</li>

<li><code>qcheck-stm</code> is a model-based, state-machine framework for both
sequential and parallel testing. It allows to test an
imperative interface against a pure model description, and
thereby allows to express and test intended behaviour beyond a
signature description.</li>
</ul>

<p>
We presented preliminary work on both these libraries at the
OCaml Workshop 2022 earlier this year. The libraries furthermore
underlie our work to test the new multicore runtime of OCaml 5.0,
and have helped us identify a number of issues.
</p>

<p>
More information is available from the GitHub repository:
</p>

<p>
<a href="https://github.com/ocaml-multicore/multicoretests">https://github.com/ocaml-multicore/multicoretests</a>
</p>

<p>
Happy multicore testing!
</p>
</div>
</div>


<div id="outline-container-org08e49d6" class="outline-3">
<h3 id="org08e49d6">Edwin Török then said</h3>
<div class="outline-text-3" id="text-org08e49d6">
<p>
Interesting, this looks like a nice addition to my testing &ldquo;toolbox&rdquo;.
I&rsquo;ve been using all of <code>crowbar</code>, <code>qcstm</code>, <code>monolith</code> and each has its own strenghts (what sparked my interest was in fact the
presentation about <code>qcstm</code> from an earlier ICFP):
</p>
<ul class="org-ul">
<li><code>monolith</code>:
<ul class="org-ul">
<li>:heavy_plus_sign: is like <code>qcstm</code> but integrates with <code>afl</code> with speeds up finding bugs a lot on multicore machines</li>
<li>:heavy_minus_sign: it doesn&rsquo;t integrate nicely with testcase shrinking (you <b>can</b> use <code>afl-tmin</code> but there is a bit of additional machinery to integrate all that into an efficient bugfinding cycle)</li>
</ul></li>

<li><code>qcstm</code>:
<ul class="org-ul">
<li>:heavy_plus_sign:  comparison with a reference implementation</li>
<li>:heavy_plus_sign:  shrinking helps produce understandable and actionable bugreports</li>
<li>:heavy_minus_sign: doesn&rsquo;t integrate with <code>afl</code>, so once you&rsquo;ve run out of the low hanging fruit to fix it takes longer to find more bugs</li>
</ul></li>

<li><code>crowbar</code>
<ul class="org-ul">
<li>:heavy_plus_sign:  integrates with <code>afl</code></li>
<li>:heavy_minus_sign: lacks the state machine exploration/reference implementation comparison that <code>monolith</code> and <code>qcstm</code> provide</li>
</ul></li>
</ul>

<p>
I haven&rsquo;t tried it yet, but <code>qcheck-stm</code> looks like a nice evolution of <code>qcstm</code> that addresses one of its disadvantages compared to
<code>crowbar~/~monolith</code>: the lack of parallelization.
</p>

<p>
Could you please clarify the connection between <code>qcstm</code> and <code>qcheck-stm</code> though? I see the README reference <code>qcstm</code> and some of the
authors are shared, however the new <code>qcheck-stm</code> has a lower version number than the old <code>qcstm</code>.
Based on &ldquo; <code>STM</code> contains a revision of <a href="https://github.com/jmid/qcstm">qcstm</a>&rdquo; I&rsquo;d assume that qcheck-stm is a superset of qcstm,
and qcstm is deprecated in favour of qcheck-stm?
</p>

<p>
FWIW both <code>qcstm</code> and <code>monolith</code> have helped discover some bugs and security issues in <code>oxenstored</code> (the ocaml implementation of
&rsquo;xenstored&rsquo; in Xen) a few years ago.
My initial intent was to compare against a reference implementation, not specifically to look for security bugs, and the first bug
found was a regular bug:
</p>
<ul class="org-ul">
<li><a href="https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c8b96708252a436da44005307f7c195d699bd7c5">https://xenbits.xen.org/gitweb/?p=xen.git;a=commit;h=c8b96708252a436da44005307f7c195d699bd7c5</a></li>
</ul>

<p>
However fairly quickly a combination of fuzzing, stress testing and manual code review has spotted a large number of security bugs,
some very obvious:
</p>
<ul class="org-ul">
<li><a href="https://xenbits.xen.org/xsa/advisory-353.html">XSA-353 permissions not checked on root node</a></li>
<li><a href="https://xenbits.xen.org/xsa/advisory-352.html">XSA-352 oxenstored: node ownership can be changed by unprivileged clients</a></li>
<li><a href="https://xenbits.xen.org/xsa/advisory-330.html">XSA-330 oxenstored memory leak in reset_watches</a></li>
<li><a href="https://xenbits.xen.org/xsa/advisory-354.html">XSA-354  XAPI: guest-triggered excessive memory usage</a></li>
</ul>

<p>
<code>qcstm~/~monolith</code> didn&rsquo;t find these bugs directly, at least not initially, but they pointed out enough suspicious behaviour in that
code area that tweaking the fuzzer would then find the security bug seen via manual review.
</p>

<p>
If it wasn&rsquo;t for
<a href="https://icfp20.sigplan.org/details/ocaml-2020-papers/2/A-Simple-State-Machine-Framework-for-Property-Based-Testing-in-OCaml">https://icfp20.sigplan.org/details/ocaml-2020-papers/2/A-Simple-State-Machine-Framework-for-Property-Based-Testing-in-OCaml</a> then a
lot of these (security) bugs wouldn&rsquo;t have been found, so thanks for helping me improve the quality of <code>oxenstored</code>!
</p>
</div>
</div>


<div id="outline-container-org313a5ca" class="outline-3">
<h3 id="org313a5ca">Jan Midtgaard replied</h3>
<div class="outline-text-3" id="text-org313a5ca">
<p>
Thanks for your kind feedback Edwin. I didn&rsquo;t know of any real <code>qcstm</code> users so you&rsquo;ve made my day! :smiley:
</p>

<p>
<code>qcheck-stm</code> is indeed intended as a replacement of <code>qcstm</code>, which was missing the ability to run parallel tests. The interfaces
required are largely the same, except we&rsquo;ve had to split <code>qcstm</code>&rsquo;s
<code>run_cmd</code> into two separate operations <code>run</code> and <code>postcond</code> in <code>qcheck-stm</code> in order to make parallel testing work. It should
therefore be relatively easy to port tests from <code>qcstm</code> to <code>qcheck-stm</code>. We did so ourselves for some of the example <code>qcstm</code>
<code>Stdlib</code> tests to stress test the standard library under parallel usage with OCaml 5.
</p>

<p>
<code>qcheck-stm</code> and <code>qcstm</code> are (as you point out) based on black-box property-based testing - whereas <code>crowbar</code> and <code>monolith</code> are
coverage-driven (&ldquo;grey-box&rdquo;) driven by AFL-instrumentation. Each of these have their advantages as you also point out. In the
present case, the black-box approach was relatively easy to get to work with non-deterministic parallel code in the style of
[Erlang&rsquo;s QuickCheck](
<a href="https://publications.lib.chalmers.se/records/fulltext/125252/local_125252.pdf">https://publications.lib.chalmers.se/records/fulltext/125252/local_125252.pdf</a>) and <a href="https://github.com/jmid/pbt-frameworks">its
derivatives</a>.
</p>

<p>
In the longer term, I&rsquo;m hoping that we can (eventually) unite these efforts in a full-featured, common testing library for OCaml
:smiley::crossed_fingers:
</p>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">Accelerating zk-SNARKs on FPGAs with Hardcaml</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/accelerating-zk-snarks-on-fpgas-with-hardcaml/10934/1">https://discuss.ocaml.org/t/accelerating-zk-snarks-on-fpgas-with-hardcaml/10934/1</a>
</p>
</div>

<div id="outline-container-org6cd38fb" class="outline-3">
<h3 id="org6cd38fb">Fu Yong Quah announced</h3>
<div class="outline-text-3" id="text-org6cd38fb">
<p>
@andyman, Ben Devlin, @rahuly and myself (@fyquah95) recently competed in the <a href="https://www.zprize.io/blog/announcing-zprize-results">ZPrize
competition</a> in our free time. We used <a href="http://hardcaml.com">Hardcaml</a> to
create our submissions, and we we came first and second in two of the competition tracks!
</p>

<p>
All source code is <a href="https://github.com/fyquah/hardcaml_zprize">open source at github</a>. A big motivation for joining the contest was
to increase the amount of publicly available open source Hardcaml examples. Using Hardcaml enabled us to productively create large
FPGA designs with competitive performance in the short time-frame of the competition.
</p>

<p>
We have a blog post with an overview of our work:
</p>

<p>
<a href="https://blog.janestreet.com/zero-knowledge-fpgas-hardcaml/">https://blog.janestreet.com/zero-knowledge-fpgas-hardcaml/</a>
</p>

<p>
We also have a much more technical write-up with details about methods, results and build instructions:
</p>

<p>
<a href="https://zprize.hardcaml.com">https://zprize.hardcaml.com</a>
</p>

<p>
We also developed a small web frontend made with Js_of_ocaml and Brr to showcase our designs in the browser. Our frontend allows
users to configure their designs, download RTL, view statistics, run simulations, and even view waveforms from the comfort of their
browser (even on your phone!). Source code is available at <a href="https://github.com/hardcamls/hardcaml_web">https://github.com/hardcamls/hardcaml_web</a>. (Special thanks to @TyOverby
for helping us put this together.)
</p>

<p>
<a href="https://zprize.hardcaml.com/apps/ntt/ntt-core-with-rams-app">https://zprize.hardcaml.com/apps/ntt/ntt-core-with-rams-app</a>
</p>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">ppx_expjs: transparently export OCaml values to JavaScript</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ppx-expjs-transparently-export-ocaml-values-to-javascript/10938/1">https://discuss.ocaml.org/t/ann-ppx-expjs-transparently-export-ocaml-values-to-javascript/10938/1</a>
</p>
</div>

<div id="outline-container-org612eaf2" class="outline-3">
<h3 id="org612eaf2">Zach Baylin announced</h3>
<div class="outline-text-3" id="text-org612eaf2">
<p>
I&rsquo;d like to share a ppx I&rsquo;ve been working on to help us build frontends with JSOO at Skolem as well as a blog post to accompany it.
</p>

<p>
<a href="https://github.com/skolemlabs/ppx_expjs">ppx_expjs</a> is a ppx that helps generate the boilerplate of exporting OCaml values
(including functions) to JavaScript when using Js_of_ocaml.
</p>
</div>

<div id="outline-container-org47ee4e8" class="outline-4">
<h4 id="org47ee4e8">Example</h4>
<div class="outline-text-4" id="text-org47ee4e8">
<p>
<code>my_module.ml</code>:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">concat</span> (<span style="color: #007a9f;">s1</span> :<span style="color: #444fcf;"> string</span>) (<span style="color: #007a9f;">s2</span> :<span style="color: #444fcf;"> string</span>) :<span style="color: #444fcf;"> string </span>= s1 <span style="color: #a52a2a;">^</span> s2
<span style="color: #a2604f;">[@@expjs]</span>
</pre>
</div>
<p>
<code>node</code>:
</p>
<pre class="example" id="org341f192">
Welcome to Node.js v16.13.0.
Type ".help" for more information.
&gt; const my_module = require("./_build/default/my_module.bc.js");
undefined
&gt; x.concat("Hello ", "World")
"Hello World"
</pre>
<p>
(note there is no need to use either <code>Js.string</code> nor <code>Js.to_string</code>)
</p>
</div>
</div>

<div id="outline-container-orge9a4f99" class="outline-4">
<h4 id="orge9a4f99">Blog post</h4>
<div class="outline-text-4" id="text-orge9a4f99">
<p>
I&rsquo;ve written a blog post that describes why one might find this ppx useful and how it works, which can be found
<a href="https://blog.skolem.com/ppx_expjs-generate-transparent-javascript-from-your-ocaml/">here</a>.
</p>
</div>
</div>

<div id="outline-container-org669bbf3" class="outline-4">
<h4 id="org669bbf3">Installation</h4>
<div class="outline-text-4" id="text-org669bbf3">
<p>
Currently there&rsquo;s no official release of the ppx on OPAM, but if you would like to install it you can run
</p>
<pre class="example" id="org9c364aa">
opam pin add ppx_expjs https://github.com/skolemlabs/ppx_expjs.git
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-8" class="outline-2">
<h2 id="8">First public release of OCaml-Canvas 1.0</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/first-public-release-of-ocaml-canvas-1-0/10945/1">https://discuss.ocaml.org/t/first-public-release-of-ocaml-canvas-1-0/10945/1</a>
</p>
</div>

<div id="outline-container-org6b9e0e5" class="outline-3">
<h3 id="org6b9e0e5">OCamlPro announced</h3>
<div class="outline-text-3" id="text-org6b9e0e5">
<p>
We are proud to announce the first public release of OCaml-Canvas 1.0!
</p>

<p>
<a href="https://ocamlpro.github.io/ocaml-canvas/">https://ocamlpro.github.io/ocaml-canvas/</a>
</p>

<p>
OCaml-Canvas provides canvases to do interactive vector graphics in OCaml, using native implementations (Windows, Macos, X11) and a
web-backend (Javascript), with a programming interface similar to HTML5 canvases.
</p>

<p>
Compared to the Graphics library, it provides a larger API, a web backend, and native Windows and Macos backends (with Cocoa API,
instead of XQuartz).
</p>

<p>
To sum up, OCaml-Canvas focuses on:
</p>

<ul class="org-ul">
<li>maximizing portability : OCaml-Canvas works natively under Linux (X11 and soon Wayland), macOS and Windows, and also provides a Javascript backend;</li>
<li>minimizing dependencies: the native backends make use of as few dependencies as possible;</li>
<li>improving aesthetics: OCaml-Canvas supports OpenType and TrueType fonts and anti-aliasing;</li>
</ul>

<p>
OCaml-Canvas is already available on Opam: <a href="https://opam.ocaml.org/packages/ocaml-canvas/">https://opam.ocaml.org/packages/ocaml-canvas/</a>
</p>

<p>
A quick tutorial is available on <a href="https://ocamlpro.github.io/ocaml-canvas/sphinx/quickstart.html">https://ocamlpro.github.io/ocaml-canvas/sphinx/quickstart.html</a>
</p>

<p>
The complete documentation is available on <a href="https://ocamlpro.github.io/ocaml-canvas/">https://ocamlpro.github.io/ocaml-canvas/</a>
</p>

<p>
Hope this will be useful to the community !
</p>
</div>
</div>
</div>




<div id="outline-container-9" class="outline-2">
<h2 id="9">Release of Seqes version 0.1</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-release-of-seqes-version-0-1/10947/1">https://discuss.ocaml.org/t/ann-release-of-seqes-version-0-1/10947/1</a>
</p>
</div>

<div id="outline-container-org5c3733f" class="outline-3">
<h3 id="org5c3733f">Raphaël Proust announced</h3>
<div class="outline-text-3" id="text-org5c3733f">
</div>
<div id="outline-container-org614305f" class="outline-4">
<h4 id="org614305f">Release</h4>
<div class="outline-text-4" id="text-org614305f">
<p>
I am happy to announce the release of <code>Seqes</code>, a library to combine <code>Seq</code> and monads. The bulk of the initial development happened
during the mirage-os retreat, with a few rounds of API design, test suite expansion, and documentation writing afterwards.
</p>

<p>
The package is released under LGPL with linking exception (it is based on code from the OCaml&rsquo;s Stdlib).
The code is <a href="https://gitlab.com/nomadic-labs/seqes">hosted on Gitlab</a>.
It is available through opam: <code>opam install seqes</code>.
</p>

<p>
The library is fully usable and has a comprehensive <code>QCheck</code>-based test coverage, but the interface may change in the future (see
follow-up thread with its typing puzzle).
</p>
</div>
</div>

<div id="outline-container-org207b8c7" class="outline-4">
<h4 id="org207b8c7">Uses and examples</h4>
<div class="outline-text-4" id="text-org207b8c7">
<p>
The <code>Seq</code> module does not mix well with monads. This is why in <code>Lwt</code> the <code>Lwt_seq</code> module defines its own <code>Stdlib.Seq.t</code>-like type —
whereas the <code>Lwt_list</code> module simply defines some functions around the <code>Stdlib.List.t</code> type.
</p>

<p>
In addition, the <code>Seq</code> module has grown a lot between OCaml 4.13 and 4.14. This makes the maintenance of <code>Seq</code>-like modules (in the
style of <code>Lwt_seq</code>) difficult.
</p>

<p>
The <code>Seqes</code> library addresses this by providing a functor to generate <code>Lwt_seq</code>-like modules but for any monad. There are two main
functors,
</p>

<p>
<b>Extending the <code>Stdlib.Seq</code> module</b>:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">Seq</span>
: <span style="color: #000000; font-weight: bold;">sig</span>

  <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">The whole of the Seq module from Stdlib</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
  <span style="color: #000000; font-weight: bold;">include</span> <span style="color: #000000; font-weight: bold;">module type of</span> <span style="color: #000000; font-weight: bold;">struct</span> <span style="color: #000000; font-weight: bold;">include</span> <span style="color: #444fcf;">Stdlib.Seq</span> <span style="color: #000000; font-weight: bold;">end</span>

  <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">Additional Lwt traversors</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
  <span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">S</span> : <span style="color: #444fcf;">Seqes.Sigs.SEQMON1TRAVERSORS</span>
    <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a mon</span> := 'a <span style="color: #444fcf;">Lwt.</span>t
    <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a callermon</span> := 'a <span style="color: #444fcf;">Lwt.</span>t
    <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a t</span> := 'a <span style="color: #444fcf;">Stdlib.Seq.</span>t

<span style="color: #000000; font-weight: bold;">end</span>
= <span style="color: #000000; font-weight: bold;">struct</span>
  <span style="color: #000000; font-weight: bold;">include</span> <span style="color: #444fcf;">Stdlib.Seq</span>
  <span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">S</span> = <span style="color: #444fcf;">Seqes.Standard.Make1(Lwt)</span>
<span style="color: #000000; font-weight: bold;">end</span>
</pre>
</div>

<p>
This extended module let&rsquo;s you traverse the Stdlib sequences with Lwt functions.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #444fcf;">Seq.</span>exists <span style="color: #444fcf;">Lwt_unix.</span>file_exists filename_sequence
</pre>
</div>

<p>
<b>Making a new monad-friendly type</b>
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">SeqS</span>
: <span style="color: #000000; font-weight: bold;">sig</span>

  <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">Similar to [Stdlib.Seq] but with [Lwt] baked into the sequence type.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
  <span style="color: #000000; font-weight: bold;">include</span> <span style="color: #444fcf;">Seqes.Sigs.SEQMON1ALL</span>
    <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a mon</span> := 'a <span style="color: #444fcf;">Lwt.</span>t

  <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">Additional Lwt helpers. E.g., [M.map : ('a -&gt; 'b Lwt.t) -&gt; 'a t -&gt; 'b t].</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
  <span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">M</span> :
    <span style="color: #444fcf;">Seqes.Sigs.SEQMON1TRANSFORMERS</span>
      <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a mon</span> := 'a <span style="color: #444fcf;">Lwt.</span>t
      <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a callermon</span> := 'a <span style="color: #444fcf;">Lwt.</span>t
      <span style="color: #000000; font-weight: bold;">with type</span> <span style="color: #444fcf;">'a t</span> := 'a t

<span style="color: #000000; font-weight: bold;">end</span>
= <span style="color: #444fcf;">Seqes.Monadic.</span><span style="color: #242521; background-color: #fcf7ef;">Make1</span>(<span style="color: #242521; background-color: #fcf7ef;">Lwt</span>)
</pre>
</div>

<p>
This module has its own <code>Seq</code>-like type but with the Lwt monad built-in.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #444fcf;">'a t</span> = unit -&gt; 'a node <span style="color: #444fcf;">Lwt.</span>t
</pre>
</div>
</div>
</div>
</div>
</div>




<div id="outline-container-10" class="outline-2">
<h2 id="10">Batteries v3.6.0</h2>
<div class="outline-text-2" id="text-10">
<p>
Archive: <a href="https://discuss.ocaml.org/t/batteries-v3-6-0/10953/1">https://discuss.ocaml.org/t/batteries-v3-6-0/10953/1</a>
</p>
</div>

<div id="outline-container-org4568bcd" class="outline-3">
<h3 id="org4568bcd">UnixJunkie announced</h3>
<div class="outline-text-3" id="text-org4568bcd">
<p>
The latest release of batteries landed in <a href="https://github.com/ocaml/opam-repository">https://github.com/ocaml/opam-repository</a>.
It is compatible with ocaml-5.
</p>

<p>
The change log can be seen below:
</p>
</div>

<div id="outline-container-org8e3d2f8" class="outline-4">
<h4 id="org8e3d2f8">v3.6.0 (minor release)</h4>
<div class="outline-text-4" id="text-org8e3d2f8">
<ul class="org-ul">
<li>BatBuffer.enum rewritten to work with OCaml-5
(Francois Berenger)</li>

<li>Fix &rsquo;make doc&rsquo;
#1097
(Simmo Saan)</li>

<li>Remove dependence to oasis
#1095
(Simmo Saan)</li>

<li>Fix compilation and unit tests for OCaml 5.0.0
#1094
#1087
#1086
(Simmo Saan, Francois Berenger)</li>

<li>Bug correction in BatString.split_on_string
#1089
(Francois Berenger, report by Lucas Franceschino)</li>

<li>bug correction in BatBitset.inter
#1091
(report by Yongho Yoon, fix by Gabriel Scherer)</li>

<li>Support new OCaml 5 unix primitive names
#1082
(David Allsopp, review by Francois Berenger)</li>

<li>BatRandom.choice on an empty enum now throws Empty instead of
Invalid_argument &ldquo;Random.int&rdquo; previously
#1080
(Nicolas Tollenaere, review by Francois Berenger)</li>
</ul>

<p>
Many thanks to all contributors.
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-orga2dbb33" class="outline-2">
<h2 id="orga2dbb33">Old CWN</h2>
<div class="outline-text-2" id="text-orga2dbb33">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I&rsquo;ll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org2a81386">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>