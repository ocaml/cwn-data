<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-05-23 Tue 11:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2023.05.16.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2023.05.30.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of May 16 to 23, 2023.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Looking for example tsdl games</a></li>
<li><a href="#2">OCaml.org Newsletter: April 2023</a></li>
<li><a href="#3">A bestiary of GADT examples?</a></li>
<li><a href="#4">2023 StackOverflow Developer Survey</a></li>
<li><a href="#5">Release 0.5.4 of <code>Fmlib_browser</code></a></li>
<li><a href="#6">OCaml Platform Newsletter: April 2023</a></li>
<li><a href="#7">Eio Developer Meetings</a></li>
<li><a href="#8">New major release of Parany (v14.0.0)</a></li>
<li><a href="#org22e167b">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Looking for example tsdl games</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/looking-for-example-tsdl-games/3880/12">https://discuss.ocaml.org/t/looking-for-example-tsdl-games/3880/12</a>
</p>
</div>

<div id="outline-container-orgb8f9b05" class="outline-3">
<h3 id="orgb8f9b05">Benjamin Thomas said</h3>
<div class="outline-text-3" id="text-orgb8f9b05">
<p>
This one is for the search engines&#x2026;
</p>

<p>
I was looking for a way to setup a &ldquo;proper&rdquo; game loop, functional style.
</p>

<p>
Looking at the <code>tsdl</code> repo, I noticed the examples in the test folder make heavy use of match expressions.
Replicating that style quickly led me to a &ldquo;callback hell&rdquo; type of problem though.
</p>

<p>
Anyhow, this is my take on setting up a basic game loop:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #8f6f4a; font-style: italic;">(*</span>
<span style="color: #8f6f4a; font-style: italic;"> * dune exec --display=quiet bin/main.exe</span>
<span style="color: #8f6f4a; font-style: italic;"> *)</span>

<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">Sdl</span> = <span style="color: #444fcf;">Tsdl.Sdl</span>
<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">Window</span> = <span style="color: #444fcf;">Sdl.Window</span>
<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #444fcf;">Event</span> = <span style="color: #444fcf;">Sdl.Event</span>

<span style="color: #000000; font-weight: bold;">let</span> ( <span style="color: #a7601f;">let*</span> ) = <span style="color: #444fcf;">Result.</span>bind

<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #444fcf;">error_ctx</span> =
  | <span style="color: #242521; background-color: #fcf7ef;">Partial</span> <span style="color: #006f00; font-weight: bold;">of</span> { window : <span style="color: #444fcf;">Sdl.</span>window }
  | <span style="color: #242521; background-color: #fcf7ef;">Full</span> <span style="color: #006f00; font-weight: bold;">of</span> { window : <span style="color: #444fcf;">Sdl.</span>window; renderer : <span style="color: #444fcf;">Sdl.</span>renderer }

<span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">Attach extra context to the original error.</span>
<span style="color: #8f6f4a; font-style: italic;"> * Used for resource cleanup on program exit.</span>
<span style="color: #8f6f4a; font-style: italic;"> *)</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">with_err_ctx</span> <span style="color: #007a9f;">ctx</span> = <span style="color: #444fcf;">Result.</span>map_error (<span style="color: #006f00; font-weight: bold;">fun</span> <span style="color: #007a9f;">err</span> -&gt; (err, ctx))

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">init_window</span> () =
  <span style="color: #000000; font-weight: bold;">let*</span> () = <span style="color: #444fcf;">Sdl.</span>init <span style="color: #444fcf;">Sdl.Init.</span>(audio + video) <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> <span style="color: #007a9f;">window</span> =
    <span style="color: #444fcf;">Sdl.</span>create_window <span style="color: #ca3400;">"OCaml/TSDL: CHANGE_ME"</span> <span style="color: #00824f;">~x</span>:<span style="color: #444fcf;">Window.</span>pos_centered
      <span style="color: #00824f;">~y</span>:<span style="color: #444fcf;">Window.</span>pos_centered <span style="color: #00824f;">~w</span>:<span style="color: #00824f;">640</span> <span style="color: #00824f;">~h</span>:<span style="color: #00824f;">480</span> <span style="color: #444fcf;">Window.</span>shown
  <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #242521; background-color: #fcf7ef;">Ok</span> window
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">render_frame</span> <span style="color: #007a9f;">renderer</span> (<span style="color: #007a9f;">x</span>, <span style="color: #007a9f;">y</span>) =
  <span style="color: #000000; font-weight: bold;">let*</span> () = <span style="color: #444fcf;">Sdl.</span>set_render_draw_color renderer <span style="color: #00824f;">255</span> <span style="color: #00824f;">127</span> <span style="color: #00824f;">40</span> <span style="color: #00824f;">255</span> <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> () = <span style="color: #444fcf;">Sdl.</span>render_clear renderer <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> () = <span style="color: #444fcf;">Sdl.</span>set_render_draw_color renderer <span style="color: #00824f;">255</span> <span style="color: #00824f;">0</span> <span style="color: #00824f;">0</span> <span style="color: #00824f;">255</span> <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> () =
    <span style="color: #444fcf;">Sdl.</span>render_fill_rect renderer (<span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #444fcf;">Sdl.Rect.</span>create ~x ~y <span style="color: #00824f;">~w</span>:<span style="color: #00824f;">70</span> <span style="color: #00824f;">~h</span>:<span style="color: #00824f;">70</span>))
  <span style="color: #000000; font-weight: bold;">in</span>
  ()
  ; <span style="color: #444fcf;">Sdl.</span>render_present renderer
  ; <span style="color: #242521; background-color: #fcf7ef;">Ok</span> ()
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #444fcf;">state</span> = { quit : bool; pos : int * int }

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">initial_state</span> = { quit = <span style="color: #00824f;">false</span>; pos = (<span style="color: #00824f;">0</span>, <span style="color: #00824f;">0</span>) }

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">poll</span> <span style="color: #007a9f;">evt</span> <span style="color: #007a9f;">state</span> =
  <span style="color: #000000; font-weight: bold;">let</span> (<span style="color: #007a9f;">x</span>, <span style="color: #007a9f;">y</span>) = state.pos <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">default</span> = { state <span style="color: #006f00; font-weight: bold;">with</span> pos = (x + <span style="color: #00824f;">2</span>, y + <span style="color: #00824f;">1</span>) } <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #006f00; font-weight: bold;">if</span> <span style="color: #444fcf;">Sdl.</span>poll_event (<span style="color: #242521; background-color: #fcf7ef;">Some</span> evt) <span style="color: #006f00; font-weight: bold;">then</span>
    <span style="color: #006f00; font-weight: bold;">match</span> <span style="color: #444fcf;">Event.</span>(enum (get evt typ)) <span style="color: #006f00; font-weight: bold;">with</span>
    | <span style="color: #242521; background-color: #fcf7ef;">`Quit</span> -&gt; { state <span style="color: #006f00; font-weight: bold;">with</span> quit = <span style="color: #00824f;">true</span> }
    | _ -&gt; default
  <span style="color: #006f00; font-weight: bold;">else</span>
    default
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">run_game_loop</span> <span style="color: #007a9f;">renderer</span> =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #000000; font-weight: bold;">rec</span> <span style="color: #a7601f;">loop</span> <span style="color: #007a9f;">evt</span> <span style="color: #007a9f;">state</span> =
    <span style="color: #006f00; font-weight: bold;">if</span> <span style="color: #a52a2a;">not</span> state.quit <span style="color: #006f00; font-weight: bold;">then</span> (
      <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">state</span> = poll evt state <span style="color: #000000; font-weight: bold;">in</span>
      <span style="color: #000000; font-weight: bold;">let*</span> () = render_frame renderer state.pos <span style="color: #000000; font-weight: bold;">in</span>
      ()
      ; <span style="color: #444fcf;">Sdl.</span>delay 17l <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">approx 60 FPS</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
      ; loop evt state
    ) <span style="color: #006f00; font-weight: bold;">else</span>
      <span style="color: #242521; background-color: #fcf7ef;">Ok</span> ()
  <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">evt</span> = <span style="color: #444fcf;">Event.</span>create () <span style="color: #000000; font-weight: bold;">in</span>
  loop evt initial_state
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">start_game</span> () =
  <span style="color: #000000; font-weight: bold;">let*</span> <span style="color: #007a9f;">window</span> = init_window () <span style="color: #a52a2a;">|&gt;</span> with_err_ctx <span style="color: #242521; background-color: #fcf7ef;">None</span> <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> <span style="color: #007a9f;">renderer</span> =
    <span style="color: #444fcf;">Sdl.</span>create_renderer window <span style="color: #a52a2a;">|&gt;</span> with_err_ctx (<span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #242521; background-color: #fcf7ef;">Partial</span> { window }))
  <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let*</span> () =
    run_game_loop renderer <span style="color: #a52a2a;">|&gt;</span> with_err_ctx (<span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #242521; background-color: #fcf7ef;">Full</span> { window; renderer }))
  <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #242521; background-color: #fcf7ef;">Ok</span> (window, renderer)
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #000000; font-weight: bold;">rec</span> <span style="color: #a7601f;">destroy_resources</span> = <span style="color: #006f00; font-weight: bold;">function</span>
  | <span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #242521; background-color: #fcf7ef;">Full</span> { window; renderer }) -&gt;
      ()
      ; <span style="color: #444fcf;">Sdl.</span>destroy_renderer renderer
      ; destroy_resources <span style="color: #a52a2a;">@@</span> <span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #242521; background-color: #fcf7ef;">Partial</span> { window })
  | <span style="color: #242521; background-color: #fcf7ef;">Some</span> (<span style="color: #242521; background-color: #fcf7ef;">Partial</span> { window }) -&gt;
      ()
      ; <span style="color: #444fcf;">Sdl.</span>destroy_window window
  | <span style="color: #242521; background-color: #fcf7ef;">None</span> -&gt; ()
<span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> () =
  <span style="color: #006f00; font-weight: bold;">match</span> start_game () <span style="color: #006f00; font-weight: bold;">with</span>
  | <span style="color: #242521; background-color: #fcf7ef;">Ok</span> (window, renderer) -&gt;
      ()
      ; <span style="color: #444fcf;">Sdl.</span>destroy_renderer renderer
      ; <span style="color: #444fcf;">Sdl.</span>destroy_window window
      ; <span style="color: #444fcf;">Sdl.</span>quit ()
      ; <span style="color: #557400; font-weight: bold;">exit</span> <span style="color: #00824f;">0</span>
  | <span style="color: #242521; background-color: #fcf7ef;">Error</span> (<span style="color: #242521; background-color: #fcf7ef;">`Msg</span> msg, ctx) -&gt;
      ()
      ; <span style="color: #444fcf;">Sdl.</span>log <span style="color: #ca3400;">"Error: %s"</span> msg
      ; destroy_resources ctx
      ; <span style="color: #444fcf;">Sdl.</span>quit ()
      ; <span style="color: #557400; font-weight: bold;">exit</span> <span style="color: #00824f;">1</span>
<span style="color: #ff4500;">;;</span>
</pre>
</div>

<p>
It took a bit of fiddling before finding something I was happy with, I&rsquo;ll gladly take any criticism/feedback :)
</p>

<p>
If you have made a game or project with <code>tsdl</code>, please do tell us about it!
</p>

<p>
(personally, I&rsquo;m going through the &ldquo;Nature of Code&rdquo; book and want to implement the exercises in many
languages/libraries)
</p>
</div>
</div>


<div id="outline-container-org7238d83" class="outline-3">
<h3 id="org7238d83">Yotam Barnoy then said</h3>
<div class="outline-text-3" id="text-org7238d83">
<p>
Take a look at my <a href="https://github.com/bluddy/rails">Railroad Tycoon reimplementation</a>.
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">OCaml.org Newsletter: April 2023</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-org-newsletter-april-2023/12173/1">https://discuss.ocaml.org/t/ocaml-org-newsletter-april-2023/12173/1</a>
</p>
</div>

<div id="outline-container-org3d4a88c" class="outline-3">
<h3 id="org3d4a88c">Thibaut Mattio announced</h3>
<div class="outline-text-3" id="text-org3d4a88c">
<p>
Welcome to the April 2023 edition of the OCaml.org newsletter! As with the <a href="https://ocaml.org/news/ocamlorg-2023-03">previous
update</a>, this has been compiled by @sabine and @tmattio.
</p>

<p>
The OCaml.org newsletter provides an overview of changes on the OCaml.org website and gives you a glimpse into what
has been going on behind the scenes. You can find a <a href="https://discuss.ocaml.org/tag/ocamlorg-newsletter">list of previous issues
here</a>.
</p>

<p>
Our goal is to make OCaml.org the best resource for anyone who wants to get started and be productive in OCaml. We
couldn&rsquo;t do it without all the amazing OCaml community members who help us review, revise and create better OCaml
documentation. Your feedback enables us to better prioritise our work and make progress towards our goal. Thank
you!
</p>

<p>
We present the work we&rsquo;ve been doing this month in three sections:
</p>
<ul class="org-ul">
<li><b>Learn area:</b> To make sure that we focus on the changes that truly have an impact on the success of OCaml and its community, we conducted a user survey targeted at OCaml newcomers. The survey allowed us to better understand their outlook on the existing site and their needs and wishes for the upcoming changes.</li>
<li><b>Package documentation:</b> Following the recent changes to the package area, we&rsquo;ve continued to make improvements to the usability of the package overview and documentation pages.</li>
<li><b>General Improvements:</b> We also worked on general maintenance and improvements, and we&rsquo;ll highlight some of them.</li>
</ul>
</div>

<div id="outline-container-org0102425" class="outline-4">
<h4 id="org0102425">Learn Area</h4>
<div class="outline-text-4" id="text-org0102425">
</div>
<ul class="org-ul">
<li><a id="org99ea168"></a>1. User Survey<br />
<div class="outline-text-5" id="text-org99ea168">
<p>
This month, we published <a href="https://discuss.ocaml.org/t/you-started-to-learn-ocaml-less-than-12-months-ago-please-help-us-with-our-user-survey-on-the-ocaml-org-learning-area/11945">the
survey</a>
that we started preparing in March. The survey was promoted on various platforms, including the official OCaml
Discuss platform, Discord, LinkedIn, Twitter, and received a lot of engagement: in total, we got 57 responses
before we had to close the survey in order to analyze the results adequately.
</p>

<p>
Apart from this, we reviewed recordings of the previous round of user interviews we did on the Learn and Package
areas, to group and prioritise the user feedback for use in upcoming user interviews. We also provided a <a href="https://discuss.ocaml.org/t/you-started-to-learn-ocaml-less-than-12-months-ago-please-help-us-with-our-user-survey-on-the-ocaml-org-learning-area/11945/2">public
summary of the survey results on the OCaml
Discuss</a>.
</p>

<p>
Overall, we&rsquo;re now in a very good position to understand which changes should be made to the Learn area in order to
improve the learning experience on OCaml.org. Our work will continue in May with the first wireframes for the new
Learn area.
</p>
</div>
</li>

<li><a id="orgc8d0219"></a>2. Work-in-progress Improvements on Documentation Pages<br />
<div class="outline-text-5" id="text-orgc8d0219">
<p>
In addition to the high-level overhaul of the Learn area we&rsquo;re working on, outlined above, we also made several
smaller improvements on the documentation to continuously improve the content of the documentation.
</p>

<p>
Many of the <a href="https://github.com/ocaml/ocaml.org/issues?q=is%3Apr+is%3Aopen+label%3Adocumentation">outstanding pull requests on
ocaml/ocaml.org</a> contain
updates to the existing documentation pages of the Learn area. We aim to merge the majority of these in May.
</p>

<p>
We are incredibly thankful for your feedback, suggestions, and help along the way. We are striving to make learning
OCaml frictionless by providing high-quality content on OCaml.org. It&rsquo;s quite a big task, and everyone&rsquo;s help is
essential to allow us to make this happen.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org3f52423" class="outline-4">
<h4 id="org3f52423">Package Documentation</h4>
<div class="outline-text-4" id="text-org3f52423">
<p>
Following the recent changes in the package area, we continued to make improvements to the layout. Notably, we
added a small footer to the Learn and Package sections, which solves the issue of sticky-positioned sidebars moving
out of the screen when scrolling into the footer. To better highlight the currently active section when scrolling
through the document, we reworked the table of contents UI in both the Package and Learn sections.
</p>

<p>
We now collapse the reverse dependencies section on the package overview page when it has more than 100 entries. To
make room for upcoming package status badges, we moved the breadcrumbs in the package area above the main content
area in line with the <a href="https://www.figma.com/file/Aqk5y03fsaCuhTSywmmY06/OCaml.org-Public-Designs?type=design&amp;node-id=0%3A1&amp;t=XYxilCb5hHk4mrDk-1">Figma
designs</a>.
We also updated the styles of the package search results page to be more compact, collapsing author lists with more
than five items, styling package tags the same as on the package overview page, and we added a link to go directly
to the package documentation.
</p>

<p>
Relevant PRs/Issues:
</p>

<ol class="org-ol">
<li>The Learn section and the Package section now have a <a href="https://github.com/ocaml/ocaml.org/pull/1018">small footer attached to the bottom of the screen (ocaml/ocaml.org#1018)</a>. This resolves the UX issue where the sticky-positioned sidebars would move upwards out of the screen when scrolling into the footer. An alternative solution where the sidebars shrink as the footer comes into view has been explored but ultimately discarded due to higher complexity and maintenance needs.</li>
<li>The table of contents UI in the Package section as well as in the Learn section is reworked to <a href="https://github.com/ocaml/ocaml.org/pull/1094">highlight the currently active section when scrolling through the document (ocaml/ocaml.org#1094)</a>. This makes it easier to see progress in reading the content and easier to relate to where we are in a larger document.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1097">layout of the package documentation section is now wide (ocaml/ocaml.org#1097)</a>, with an increased gap on the <code>xl</code> screen size.</li>
<li>Since there can be hundreds or even thousands of reverse dependencies for a package, we&rsquo;re now <a href="https://github.com/ocaml/ocaml.org/pull/1101">collapsing the reverse dependencies section when there are more than 100 items (ocaml/ocaml.org#1101)</a>.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1133">breadcrumbs in the package area are now above the main content area (ocaml/ocaml.org#1133)</a> with the intent to make room next to the package name for upcoming badges that, e.g., provide information on the build status.</li>
<li>We <a href="https://github.com/ocaml/ocaml.org/pull/1134">updated the styles of the package search results page to be more compact (ocaml/ocaml.org#1134)</a>: (a) author lists with more than five items are collapsed by listing the first five authors and &ldquo;et al.&rdquo;, (b) package tags are now styled the same as on the package overview page, (c) a link to go directly to the package documentation is provided.</li>
</ol>
</div>

<ul class="org-ul">
<li><a id="org6bf3c63"></a>Work in Progress: Basic In-Package Search<br />
<div class="outline-text-5" id="text-org6bf3c63">
<p>
During the last month, we made progress on bringing basic in-package search functionality to the OCaml.org package
documentation. Work on a prototype is ongoing on <a href="https://staging.ocaml.org">staging.ocaml.org</a> (see <a href="https://discuss.ocaml.org/t/a-minimal-prototype-of-in-package-search-is-on-staging-ocaml-org/12163">this Discuss
post</a>), and we
plan to roll out a rudimentary version of in-package search in May.
</p>

<p>
We&rsquo;ll be rolling out the initial version as experimental, so it may have some issues and will be quite limited. We
are releasing this early, as we find that having in-package search is vital for the usability of the package
documentation. The upside of this process is that we&rsquo;re able to adapt to your feedback and ideas as we design the
final product later on.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-orga0fd376" class="outline-4">
<h4 id="orga0fd376">General Improvements</h4>
<div class="outline-text-4" id="text-orga0fd376">
<p>
We made improvements to the <a href="https://ocaml.org/dashboard">OCaml.org dashboard</a> and GitHub actions workflows. The
dashboard now displays the Git commit hash and memory consumption in bytes. We worked on fixing the RSS feed
scraping workflow, which resulted in the ability to trigger the scraper to run via the GitHub UI and the ability to
run workflows on a local machine. The scraping workflow was made more robust against the temporary unavailability
of sources, and individual feeds for the Blog page are now scraped separately and merged into a global feed.
</p>

<p>
We are currently working on exposing the build status data for packages on the package overview pages. We also
started to work on a dedicated &ldquo;Install&rdquo; page for OCaml with the help of the OCaml community. The new page will
provide shorter instructions on how to set up OCaml quickly and the corresponding patch includes an overall
revision of the &ldquo;Get Up and Running&rdquo; documentation.
</p>

<p>
In addition to all of this, the team has diligently tackled numerous bug fixes and quality-of-life improvements to
enhance the overall user experience.
</p>

<p>
Relevant PRs/Issues:
</p>

<ol class="org-ol">
<li>We improved the <a href="https://ocaml.org/dashboard">ocaml.org dashboard</a> to <a href="https://github.com/ocaml/ocaml.org/pull/1136">display the Git commit hash from which the currently running instance has been built (ocaml/ocaml.org#1136)</a>, and to <a href="https://github.com/ocaml/ocaml.org/pull/1060">display the memory consumption in bytes (ocaml/ocaml.org#1060)</a>. For this, the build needed to happen in a Git-enabled folder which required <a href="https://github.com/ocurrent/ocurrent-deployer/pull/184">enabling the &ldquo;include Git&rdquo; option on the deployment pipeline (ocurrent/ocurrent-deployer#184)</a>.</li>
<li>RSS feed scraping (which provides the data we display on the &ldquo;Blog&rdquo; page) broke in January when Git LFS was introduced to store the OCaml Playground assets. Another issue we observed was that <a href="https://github.com/kayceesrk/river/issues/8">HTTP requests to some sources would time out (kayceesrk/river#8)</a>. We worked on fixing the scraping workflow and ultimately succeeded. As a consequence of this work, we now enjoy improvements to the GitHub actions workflows, such as the ability to trigger the scraper to run via the GitHub UI, and the <a href="https://github.com/ocaml/ocaml.org/pull/1068">ability to run workflows on a local machine (ocaml/ocaml.org#1068)</a>. Subsequently, the scraping workflow was <a href="https://github.com/ocaml/ocaml.org/pull/1120">made more robust against temporary unavailability of sources (ocaml/ocaml.org#1120)</a>, and, instead of building a global feed by scraping all sources at the same time, <a href="https://github.com/ocaml/ocaml.org/pull/1144">individual feeds are now scraped separately and merged into a global feed (ocaml/ocaml.org#1144)</a>.</li>
<li>We are working on <a href="https://github.com/ocaml/ocaml.org/pull/977#pullrequestreview-1404343612">exposing the build status data for packages on the package overview pages (ocaml/ocaml.org#977)</a>. As part of this effort,   <a href="https://github.com/ocaml/infrastructure/issues/40">check.ocamllabs.io has already been moved to check.ci.ocaml.org (ocaml/infrastructure#40)</a> by the infrastructure team.</li>
<li>To provide better statistics on the programming languages used in the ocaml/ocaml.org repository, we now <a href="https://github.com/ocaml/ocaml.org/pull/1074">exclude vendored files from stats (ocaml/ocaml.org#1074)</a>.</li>
<li>Some AlpineJS-related bugfixes and cleanups on the <a href="https://github.com/ocaml/ocaml.org/pull/1069">search dropdown (ocaml/ocaml.org#1069)</a> and <a href="https://github.com/ocaml/ocaml.org/pull/1061">sidebar (ocaml/ocaml.org#1061)</a>.</li>
<li>Upgrade AlpineJS to 3.12.0, HTMX to 1.9.0 (resolves <a href="https://github.com/ocaml/ocaml.org/issues/877">ocaml/ocaml.org#877</a>).</li>
<li>We started working on an &ldquo;Install&rdquo; page for OCaml with the help of the OCaml community at <a href="https://discuss.ocaml.org/t/please-improve-my-draft-of-an-install-page-on-ocaml-org/11837">https://discuss.ocaml.org/t/please-improve-my-draft-of-an-install-page-on-ocaml-org/11837</a>. The intent of this page is to provide short instructions on how to set up OCaml quickly by leveraging OS detection via JavaScript. The upcoming patch includes an overall revision of the &ldquo;Get Up and Running&rdquo; documentation to provide better section headings and to clarify instructions while removing noise from the document.</li>
<li>In response to an <a href="https://github.com/ocaml/ocaml.org/issues/1042">inquiry about package documentation failing to build</a>, the CI team helped us by investigating why the solver fails for the package in question. It turns out that, currently, the solver appears to only use two OCaml versions: 4.14 and 5.0.0. Until this changes, any package that does not work with either of these OCaml versions will not have its package documentation built successfully.</li>
<li>A <a href="https://github.com/ocaml/ocaml.org/pull/1009#pullrequestreview-1380824224">new page that highlights all the previous Outreachy internships conducted by the OCaml community (ocaml/ocaml.org#1009)</a> has been added to the Community section.</li>
<li>We improved the HACKING.md documentation to <a href="https://github.com/ocaml/ocaml.org/pull/1102">mention prerequisites on the development environment and to link to the Docker images built by the CI which are stored on Docker Hub (ocaml/ocaml.org#1102)</a>. The intent of this is to make it simpler for new contributors to join the project.</li>
<li><a href="https://github.com/ocaml/ocaml.org/pull/1082">Rearranged the &ldquo;featured&rdquo; section on the Blog page to allow featuring less than three posts (ocaml/ocaml.org#1082)</a>.</li>
<li><a href="https://github.com/ocaml/ocaml.org/pull/1083">Bugfix for a Unicode rendering problem (ocaml/ocaml.org#1083)</a> when searching for the empty string on the package search results page.</li>
<li><a href="https://github.com/ocaml/ocaml.org/pull/1085">Added &rsquo;Roboto Mono&rsquo; as a dedicated monospace font (ocaml/ocaml.org#1085)</a> to achieve a consistent display of code sections for all users.</li>
<li>Errors in the documentation were reported by OCaml users. Thank you! We fixed them immediately: (1) Resolve unused for-loop index i Error <a href="https://github.com/ocaml/ocaml.org/pull/1084">ocaml/ocaml.org#1084</a>, (2) remove incorrect mention of utop <a href="https://github.com/ocaml/ocaml.org/pull/1086">ocaml/ocaml.org#1086</a>, and (3) Explain how to activate -dtypedtree in <code>utop-full</code> <a href="https://github.com/ocaml/ocaml.org/pull/1089">ocaml/ocaml.org#1089</a></li>
<li>We vendored an experimental YAML parsing tool <a href="https://github.com/tmattio/yoshi">tmattio/yoshi</a> into the ocaml.org repository to explore if that is a suitable way to simplify the YAML parsing aspect of the current <code>ood-gen</code> tool of ocaml.org.</li>
<li>The package autocomplete search input in the top navigation bar now reacts faster since the <a href="https://github.com/ocaml/ocaml.org/pull/1122">throttling delay has been removed (ocaml/ocaml.org#1122)</a>.</li>
<li>We made the <a href="https://github.com/ocaml/ocaml.org/pull/1117">share button of the OCaml Playground more obvious (ocaml/ocaml.org#1117)</a> by adding a caption.</li>
<li>We worked on the <a href="https://ocaml.org/changelog">experimental changelog page</a>.</li>
<li>Considering that there are some unmet caching needs in our web stack (e.g., in the package documentation section: looking at the many HTTP requests and rendering the module tree menu), we <a href="https://discuss.ocaml.org/t/is-there-a-drop-in-solution-for-serving-responses-from-cache-in-dream/11985">reached out to the OCaml community</a> to understand what the ecosystem is like at the moment and if there is a meaningful opportunity to contribute to the OCaml ecosystem as part of our work on OCaml.org.</li>
<li>There is an open PR for <a href="https://github.com/ocaml/ocaml.org/pull/1126">adding WIP dev-container</a> that can make it easier to get started developing on the ocaml/ocaml.org repository.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1139">&ldquo;Contribute&rdquo; link on the documentation pages now links to the commit from which the content was rendered (ocaml/ocaml.org#1139</a></li>
<li>The OCaml.org project <a href="https://github.com/ocaml/ocaml.org/pull/1135">officially adopted the OCaml Code of Conduct by adding <code>CODE_OF_CONDUCT.md</code> to its GitHub repository (ocaml/ocaml.org#1135)</a> and by <a href="https://github.com/ocaml/code-of-conduct/pull/6">adding ocaml/ocaml.org to the list of adopters (ocaml/code-of-conduct#6)</a></li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1141#pullrequestreview-1403923329">problems in the exercises section of the Learn area can now be filtered by difficulty (ocaml/ocaml.org#1141)</a>.</li>
<li>Bugfix: the problem difficulty symbols in the exercise section would be cut off in the too-small margins. Now the <a href="https://github.com/ocaml/ocaml.org/pull/1138">problem difficulty symbols in the exercises section only show up in the margin on <code>xl</code> screen size (ocaml/ocaml.org#1138).</a></li>
</ol>
</div>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">A bestiary of GADT examples?</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/a-bestiary-of-gadt-examples/12143/11">https://discuss.ocaml.org/t/a-bestiary-of-gadt-examples/12143/11</a>
</p>
</div>

<div id="outline-container-org29ec4fb" class="outline-3">
<h3 id="org29ec4fb">Continuing this thread from last week, Reuben Rowe said</h3>
<div class="outline-text-3" id="text-org29ec4fb">
<p>
I have used GADTs in <a href="https://gitlab.com/trustworthy-refactoring/refactorer">rotor</a> to implement a rich identifier
type for different syntactic elements of the OCaml language, as well as some custom zipper types over the OCaml
compiler typed AST.
</p>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">2023 StackOverflow Developer Survey</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/2023-stackoverflow-developer-survey/12174/1">https://discuss.ocaml.org/t/2023-stackoverflow-developer-survey/12174/1</a>
</p>
</div>

<div id="outline-container-org5639da1" class="outline-3">
<h3 id="org5639da1">Thomas Gazagnaire announced</h3>
<div class="outline-text-3" id="text-org5639da1">
<p>
This year, OCaml is on the list of languages (while <a href="https://discuss.ocaml.org/t/stackoverflow-developer-survey/7961">it wasn&rsquo;t in
2021</a>!).
</p>

<p>
So now we can tell the world that we everyone is using (and hopefully want to continue to use) OCaml:
<a href="https://stackoverflow.blog/2023/05/08/the-2023-developer-survey-is-now-live/">https://stackoverflow.blog/2023/05/08/the-2023-developer-survey-is-now-live/</a> :camel:
</p>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">Release 0.5.4 of <code>Fmlib_browser</code></h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-release-0-5-4-of-fmlib-browser/12184/1">https://discuss.ocaml.org/t/ann-release-0-5-4-of-fmlib-browser/12184/1</a>
</p>
</div>

<div id="outline-container-org6cd13fd" class="outline-3">
<h3 id="org6cd13fd">Helmut announced</h3>
<div class="outline-text-3" id="text-org6cd13fd">
<p>
It is a pleasure to announce the release 0.5.4 of <code>Fmlib_browser</code>. The library helps to write interactive
webapplications running in the browser. It is quite easy to write interactive webapplications with the help of this
library. The user code is purely descriptive (aka functional) which avoids many common errors.
</p>

<p>
You can find some simple examples <a href="https://hbr.github.io/fmlib/odoc/fmlib_browser/index.html">here</a> and in <a href="https://hbr.github.io/fmlib/odoc/fmlib_browser/doc_overview.html">the
overview</a>.
</p>

<p>
Install the library with
</p>

<pre class="example" id="org89e86fb">
    opam install fmlib_browser
</pre>

<p>
The new release 0.5.4 fixes some bugs in the initial version 0.5.3 and has some minor added functionality.
</p>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">OCaml Platform Newsletter: April 2023</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-platform-newsletter-april-2023/12187/1">https://discuss.ocaml.org/t/ocaml-platform-newsletter-april-2023/12187/1</a>
</p>
</div>

<div id="outline-container-org3173aba" class="outline-3">
<h3 id="org3173aba">Thibaut Mattio announced</h3>
<div class="outline-text-3" id="text-org3173aba">
<p>
Welcome to the first issue of the OCaml Platform newsletter!
</p>

<p>
Following in the footsteps of the OCaml.org newsletter and inspired by the Multicore and Compiler newsletters,
we&rsquo;re excited to bring you monthly updates on the progress we&rsquo;re making in improving the OCaml Developer
Experience.
</p>

<p>
The <a href="https://ocaml.org/docs/platform">OCaml Platform</a> is the recommended set of tools to work and be productive
with OCaml. The Platform tools fill gaps in the OCaml developer experience and allow developers to perform specific
workflows (e.g. building packages, formatting code, generating documentation, releasing packages, etc.).
</p>

<p>
At the end of the day, all the work we&rsquo;re doing on the OCaml Platform has one objective: improving the OCaml
developer experience, so in this newsletter, we&rsquo;ll present the progress we&rsquo;re making on the different projects from
the lens of these developer workflows. Based on the results of the OCaml surveys
(<a href="https://www.dropbox.com/s/omba1d8vhljnrcn/OCaml-user-survey-2020.pdf?dl=0">2020</a> and
<a href="https://ocaml-sf.org/docs/2022/ocaml-user-survey-2022.pdf">2022</a>), discussions with industrial users, continuous
community feedback on Discuss, and other sources of user input, here are the workflows we&rsquo;re currently working on:
</p>

<ul class="org-ul">
<li><b>Building Packages:</b> Our immediate goal for the build workflow is to remove the friction associated to using two different tools for package management and build system. To this end, we <a href="https://discuss.ocaml.org/t/explorations-on-package-management-in-dune/12101">plan on integrating opam capabilities directly into Dune</a>, establishing it as the singular tool needed to build OCaml projects. As a by-product of this integration, we aim to improve other workflows such as working on multiple projects, cross-compilation, and improving the overall experience to get started with OCaml.</li>
<li><b>Compiling to JavaScript:</b> We&rsquo;re continuously supporting tools to compile OCaml to JavaScript. Dune integrates well with Js_of_ocaml and we&rsquo;ve been working on an integration of Dune and <a href="https://github.com/melange-re/melange">Melange</a>, a recent fork of <a href="https://github.com/rescript-lang/rescript-compiler">ReScript</a> that aims to bring to integrate closely with the OCaml ecosystem.</li>
<li><b>Generating Documentation:</b> The state of the OCaml Packages documentation is reported as a major pain point in the OCaml surveys (<a href="https://www.dropbox.com/s/omba1d8vhljnrcn/OCaml-user-survey-2020.pdf?dl=0">2020</a> and <a href="https://ocaml-sf.org/docs/2022/ocaml-user-survey-2022.pdf">2022</a>). We&rsquo;re working towards empowering OCaml developers to create high-quality documentation for their packages. Now that the documentation of packages is <a href="https://ocaml.org/packages">readily available on OCaml.org</a>, we want to make writing documentation rewarding and straightforward. We&rsquo;re working towards making Odoc suitable to create manuals by adding new features, improving the navigation, and expanding the odoc markup syntax to support rich content such as tables, images and graphs.</li>
<li><b>Editing and Refactoring Code:</b> We aim to enrich the OCaml editor support with more workflows to improve code navigation and automate refactoring. Our main focus currently is on adding support for project-wide references to Merlin. Future work will include implementing a project-wide rename query and queries such as renaming arguments. We are also working towards bringing the editor support for OCaml to the web and third-party platforms such as OCaml Playground, ReplIt, and GitHub Codespaces.</li>
<li><b>Formatting Code:</b> Our goal for formatting code is focused on improving accuracy, particularly for the to comments. We also want to strike the right balance between providing a default profile that appeals to most users and not requiring configuration to format your OCaml projects, while still maintaining a fully configurable formatter. Additionally, we plan to enhance the backward compatibility of ocamlformat and better integrate Dune and ocamlformat.</li>
</ul>

<p>
I&rsquo;ll also take the opportunity to call for new contributors. Platform projects are always looking for new
maintainers and contributors, so if you&rsquo;re interested in the future of OCaml&rsquo;s developer experience and would like
to shape that future with us, please reach out to me or any Platform maintainers. If you&rsquo;re an industrial user
looking for support on the OCaml Platform and would like to fund the maintainers and the developments on the
Platform tools, also don&rsquo;t hesitate to [reach out to me](<a href="mailto:thibaut@tarides.com">mailto:thibaut@tarides.com</a>).
</p>

<p>
April has seen a flurry of activity, and we can&rsquo;t wait to share our progress with you. So let&rsquo;s get right to it!
</p>

<p>
In this inaugural issue, we&rsquo;ll be discussing progress on the following projects:
</p>

<ul class="org-ul">
<li>Building Packages
<ul class="org-ul">
<li><b>[Dune]</b> Exploring Package Management in Dune</li>
<li><b>[opam]</b> Native Support for Windows in opam 2.2</li>
<li><b>[Dune]</b> Improving Dune&rsquo;s Documentation</li>
<li><b>[Dune]</b> Composing installed Coq theories</li>
<li><b>[Dune]</b> Dune Terminal User Interface</li>
<li><b>[Dune]</b> Running Actions Concurrently</li>
<li><b>[Dune]</b> Benchmarking Dune on Large Code Bases</li>
</ul></li>
<li>Compiling to JavaScript
<ul class="org-ul">
<li><b>[Dune]</b> Compile to JavaScript with Melange in Dune</li>
</ul></li>
<li>Generating Documentation
<ul class="org-ul">
<li><b>[Odoc]</b> Add Search Capabilities to <code>odoc</code></li>
<li><b>[Dune]</b> User-Friendly Command to Generate Documentation</li>
<li><b>[Odoc]</b> Support for Tables in <code>odoc</code></li>
</ul></li>
<li>Editing and Refactoring Code
<ul class="org-ul">
<li><b>[Merlin]</b> Support for Project-Wide References in Merlin</li>
<li><b>[Merlin]</b> Improving Merlin&rsquo;s Performance</li>
<li><b>[OCaml LSP]</b> Using Dune RPC on Windows</li>
<li><b>[OCaml LSP]</b> Upstreaming OCaml LSP&rsquo;s Fork of Merlin</li>
</ul></li>
<li>Formatting Code
<ul class="org-ul">
<li><b>[OCamlFormat]</b> Migrate OCamlFormat from an AST to a CST</li>
<li><b>[OCamlFormat]</b> Closing the Gap Between OCamlFormat and <code>ocp-indent</code></li>
</ul></li>
</ul>
</div>

<div id="outline-container-orgffdc949" class="outline-4">
<h4 id="orgffdc949">Releases</h4>
<div class="outline-text-4" id="text-orgffdc949">
<p>
Here are the new versions of Platform tools we released in April. Have a look at the <a href="https://ocaml.org/changelog">OCaml
Changelog</a> to read announcements and feature highlights!
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocaml-community/utop/releases/tag/2.12.0">UTop 2.12.0</a></li>
<li><a href="https://github.com/ocaml-community/utop/releases/tag/2.12.1">UTop 2.12.1</a></li>
<li><a href="https://github.com/realworldocaml/mdx/releases/tag/2.3.0">MDX 2.3</a></li>
<li><a href="https://github.com/ocaml/dune/releases/tag/3.7.1">Dune 3.7.1</a></li>
</ul>
</div>
</div>

<div id="outline-container-orge03bae2" class="outline-4">
<h4 id="orge03bae2">Building Packages</h4>
<div class="outline-text-4" id="text-orge03bae2">
</div>
<ul class="org-ul">
<li><a id="orgb087fa3"></a><b>[Dune]</b> Exploring Package Management in Dune<br />
<div class="outline-text-5" id="text-orgb087fa3">
<p>
Contributors: @rgrinberg (Tarides), @Leonidas-from-XIV (Tarides), @gridbugs (Tarides), @kit-ty-kate (Tarides)
</p>

<p>
Earlier this month, we <a href="https://discuss.ocaml.org/t/explorations-on-package-management-in-dune/12101">announced</a>
that we&rsquo;ve started exploring package management in Dune. You can read the Request for Comment (RFC) that details
our work-in-progress plans for the feature <a href="https://github.com/ocaml/dune/issues/7680">on GitHub</a>.
</p>

<p>
We&rsquo;re currently focused on building prototypes for different parts of the Dune workflow: source fetching, building
non-Dune opam packages, and generating a lock file.
</p>

<p>
In April, we merged a first version of <a href="https://github.com/ocaml/dune/pull/7179">Source Fetching</a>. We also started
thinking about how Dune could build opam packages and <a href="https://github.com/ocaml/dune/pull/7626">merged a PR</a> laying
the foundation for the rules on building them in Dune.
</p>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>Completed and merged a first version of <a href="https://github.com/ocaml/dune/pull/7179">Source Fetching</a></li>
<li>Upstreamed a patch in opam to <a href="https://github.com/ocaml/opam/pull/5508">remove preprocessing of backwards-compatibility code</a>. This helped to reduce the number of dependencies to vendor in Dune when vendoring opam.</li>
<li>We merged <a href="https://github.com/ocaml/dune/pull/7626">a PR</a> that lays the foundation and provides a skeleton for the features related to building opam packages.</li>
<li>Following work on <a href="https://github.com/ocaml-opam/opam-0install-solver">0install-solver</a>, which we&rsquo;ll use as a solver in Dune 4, we open a PR on <code>ocaml/opam-repository</code> to <a href="https://github.com/ocaml/opam-repository/pull/23736">remove constraints on package versions in conflicts</a> and a <a href="https://github.com/ocaml/opam/pull/5535">patch on opam</a> for the same conflict.</li>
</ul>
</div>
</li>

<li><a id="orge8a3f4d"></a><b>[opam]</b> Native Support for Windows in opam 2.2<br />
<div class="outline-text-5" id="text-orge8a3f4d">
<p>
Contributors: @rjbou (OCamlPro), @kit-ty-kate (Tarides), @dra27 (Tarides), @emillon (Tarides), @Leonidas-from-XIV
(Tarides)
</p>

<p>
Bringing Tier-1 support for Windows has been a dream for some time and April has seen us get closer than ever
before to the first alpha of opam 2.2, which we expect in May. This early alpha is a big step towards the release
of opam 2.2 with native Windows support, and is the result of a humongous amount of effort bringing together the
work of many people done over the years.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>Configure: Ensure a complementary (32bit on 64bit platforms and 64bit on 32bit platforms) C compiler is installed on Windows <a href="https://github.com/ocaml/opam/pull/5522">ocaml/opam#5522</a></li>
<li>Do not silently disable MCCS if a C++ compiler is not present <a href="https://github.com/ocaml/opam/pull/5527">ocaml/opam#5527</a></li>
<li>Move the <code>.ocamlinit</code> script out of the root directory <a href="https://github.com/ocaml/opam/pull/5526">ocaml/opam#5526</a></li>
<li>MCCS on Windows does not respect avoid-version <a href="https://github.com/ocaml/opam/issues/5523">ocaml/opam#5523</a></li>
<li>Setup benchmarking using current-bench <a href="https://github.com/ocaml/opam/pull/5525">ocaml/opam#5525</a></li>
<li>Update to latest <code>msvs-detect</code> <a href="https://github.com/ocaml/opam/pull/5514">ocaml/opam#5514</a></li>
<li>Fix the compilation of <code>camlheader</code> when BINDIR contains escaping characters <a href="https://github.com/ocaml/ocaml/pull/12214">ocaml/opam#12214</a></li>
<li>doc: ? evaluates to true if defined <a href="https://github.com/ocaml/opam/pull/5512">ocaml/opam#5512</a></li>
<li>Stop the configure script from downloading and vendoring dependencies <a href="https://github.com/ocaml/opam/pull/5511">ocaml/opam#5511</a></li>
<li>Remove preprocessing of backwards-compatibility code <a href="https://github.com/ocaml/opam/pull/5508">ocaml/opam#5508</a></li>
<li>Fix linting on <code>opam-crowbar.opam</code>  <a href="https://github.com/ocaml/opam/pull/5507">ocaml/opam#5507</a></li>
<li>depexts: reword message <a href="https://github.com/ocaml/opam/pull/5499">ocaml/opam#5499</a></li>
<li>Replace usage of CPPO <a href="https://github.com/ocaml/opam/pull/5498">ocaml/opam#5498</a></li>
<li>Check for the presence of swhid_core in the configure script <a href="https://github.com/ocaml/opam/pull/5497">ocaml/opam#5497</a></li>
<li>Add package stanza on all rules that depend on <code>opamMain.exe.exe</code> <a href="https://github.com/ocaml/opam/pull/5496">ocaml/opam#5496</a></li>
</ul>
</div>
</li>

<li><a id="org611b210"></a><b>[Dune]</b> Improving Dune&rsquo;s Documentation<br />
<div class="outline-text-5" id="text-org611b210">
<p>
Contributors: @emillon (Tarides)
</p>

<p>
In March, we started restructuring the Dune documentation according to the <a href="https://diataxis.fr/">Diataxis
framework</a>. We opened <a href="https://github.com/ocaml/dune/pull/7325">a draft PR</a> to demonstrate
the overall target structure. The new structure will improve the usability of the documentation, allowing users to
find the information that they are looking for, as well as enable us to better identify gaps that need to be
addressed.
</p>

<p>
In April we’ve continued this work, filling in some of those gaps as well as rewriting documents to better fit in
the intended quadrant of the framework.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>Turn &ldquo;Automatic Formatting&rdquo; into a how-to <a href="https://github.com/ocaml/dune/pull/7479">ocaml/dune#7479</a></li>
<li>Move lexical conventions to reference <a href="https://github.com/ocaml/dune/pull/7499">ocaml/dune#7499</a></li>
<li>Turn <code>opam.rst</code> into 3 guides <a href="https://github.com/ocaml/dune/pull/7515">ocaml/dune#7515</a></li>
<li>Add some info about writing docs <a href="https://github.com/ocaml/dune/pull/7537">ocaml/dune#7537</a></li>
<li>Merge <code>classical-ppx</code> into <code>preprocessing-spec</code> <a href="https://github.com/ocaml/dune/pull/7538">ocaml/dune#7538</a></li>
<li>Merge reference info about findlib <a href="https://github.com/ocaml/dune/pull/7567">ocaml/dune#7567</a></li>
<li>Add a lexer for opam files <a href="https://github.com/ocaml/dune/pull/7574">ocaml/dune#7574</a></li>
</ul>
</div>
</li>

<li><a id="orge8495a2"></a><b>[Dune]</b> Composing installed Coq theories<br />
<div class="outline-text-5" id="text-orge8495a2">
<p>
Contributors: @Alizter and @ejgallego (IRIF)
</p>

<p>
We&rsquo;ve merged the PR that brings <a href="https://github.com/ocaml/dune/pull/7047">support for composing Coq theories with
Dune</a>!
</p>

<p>
This was a huge effort lead by Ali Caglayan and  Emilio Jesús Gallego Arias that started earlier this year.
Starting in Dune 3.8, Coq users will be able to use Dune even if they depend on Coq projects that use other build
systems (such as make).
</p>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>Merged the PR that adds <a href="https://github.com/ocaml/dune/pull/7047">support for composition with installed theories to the Coq rules</a></li>
</ul>
</div>
</li>

<li><a id="org6134ee8"></a><b>[Dune]</b> Dune Terminal User Interface<br />
<div class="outline-text-5" id="text-org6134ee8">
<p>
Contributors: @Alizter, @rgrinberg (Tarides)
</p>

<p>
We&rsquo;re working on a new Terminal User Interface (TUI) mode for Dune. Our goal is to give Dune users an interactive
GUI-like experience right from the terminal, making it easier to interact with build targets, observe processes,
and more. The work is still very much in progress, but expect gradual improvements of <code>dune build --display tui</code> in
the coming months.
</p>


<div id="orgf7631ef" class="figure">
<p><img src="https://global.discourse-cdn.com/business7/uploads/ocaml/original/2X/e/ee1d60cc3b4d29b795bdafdd6857b93072975310.png" alt="ee1d60cc3b4d29b795bdafdd6857b93072975310.png" />
</p>
</div>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>Introduced the <a href="https://github.com/ocaml/dune/pull/6996">new <code>tui</code> mode</a> for Dune.</li>
<li>Enabled Dune to <a href="https://github.com/ocaml/dune/pull/7188">redisplay 24-bit color output</a>.</li>
</ul>
</div>
</li>

<li><a id="org36511ab"></a><b>[Dune]</b> Running Actions Concurrently<br />
<div class="outline-text-5" id="text-org36511ab">
<p>
Contributors: @Alizter and @hhugo (Nomadic Labs)
</p>

<p>
In January, we began working on allowing Dune to execute actions and run inline tests concurrently. This month, we
merged the two PRs and the feature will be available in the upcoming Dune 3.8. We&rsquo;re especially excited about the
ability to run inline tests concurrently to speed up test cycles!
</p>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>We&rsquo;ve merged the PR that <a href="https://github.com/ocaml/dune/pull/6933">implements a new concurrent action</a> in Dune, which allows you to execute actions concurrently.</li>
<li>We also merged the PR that built on this feature to <a href="https://github.com/ocaml/dune/pull/7012">enabled Dune to run inline tests concurrently</a>.</li>
<li>We&rsquo;ve <a href="https://github.com/janestreet/ppx_inline_test/pull/40">patched <code>ppx_inline_test</code></a> to leverage the new feature.</li>
</ul>
</div>
</li>

<li><a id="org4522d28"></a><b>[Dune]</b> Benchmarking Dune on Large Code Bases<br />
<div class="outline-text-5" id="text-org4522d28">
<p>
Contributors: @gridbugs (Tarides), @Leonidas-from-XIV (Tarides)
</p>

<p>
In March we added <a href="https://autumn.ocamllabs.io/ocaml/dune/branch/main?worker=fermat&amp;image=bench%2Fmonorepo%2Fbench.Dockerfile">continous
benchmarking</a>
of Dune builds on a 48 core baremetal system. This is the result of a lot of work that included <a href="https://github.com/ocaml-dune/ocaml-monorepo-benchmark">building a big
monorepo for opam packages</a> allowing users to run Dune
benchmarks on large code bases.
</p>

<p>
In April we added support for benchmarking builds in watch mode as well. This allows us to monitor for regressions
as we move forward with major initiatives, such as package management.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>Add <a href="https://github.com/ocaml/dune/pull/7552">watch-mode benchmarks</a> of dune monorepo using Dune&rsquo;s streaming RPC interface</li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgb8dea5b" class="outline-4">
<h4 id="orgb8dea5b">Compiling to JavaScript</h4>
<div class="outline-text-4" id="text-orgb8dea5b">
</div>
<ul class="org-ul">
<li><a id="org459c6a4"></a><b>[Dune]</b> Compile to JavaScript with Melange in Dune<br />
<div class="outline-text-5" id="text-org459c6a4">
<p>
Contributors: @anmonteiro, @jchavarri (Ahrefs), @rgrinberg (Tarides)
</p>

<p>
You may have read that <a href="https://medium.com/ahrefs/ahrefs-is-now-built-with-melange-b14f5ec56df4">Ahrefs migrated its codebase from ReScript to
Melange</a>, a new OCaml-to-JavaScript
compiler based on ReScript.
</p>

<p>
The goal of Melange is to offer an alternative to ReScript that pairs well with the OCaml ecosystem. To that end,
Antonio Nuno Monteiro and Javier Chávarri have been working on integrating Melange and Dune, allowing it to easily
compile OCaml projects to JavaScript with Melange.
</p>

<p>
The feature will be available in the upcoming Dune 3.8. You can already <a href="https://dune.readthedocs.io/en/latest/melange.html">read the
documentation</a> in Dune&rsquo;s manual to get a glimpse of how the
feature will work. You can also have a look at the <a href="https://github.com/melange-re/melange-opam-template">opam Melange
template</a> built by the Melange team.
</p>

<p>
<b>Activities</b>
</p>
<ul class="org-ul">
<li>Write a <a href="https://github.com/ocaml/dune/pull/7477">manual page</a> in Dune to compile to JavaScript using Melange.</li>
<li>Make Melange <a href="https://github.com/melange-re/melange/pull/548">work on 4.13-5.1</a> rather than just 4.14</li>
<li>In addition to what we did in April, here are some noteworthy PRs that were worked on in previous months:
<ul class="org-ul">
<li>Added a <a href="https://github.com/ocaml/dune/pull/7234">new field <code>melange.runtime_deps</code></a> to libraries, so that Melange library authors can tell Dune which frontend assets (like CSS or image files, fonts etc) have to be installed with their library</li>
<li><a href="https://github.com/ocaml/dune/pull/7187/">Speed up rule generation</a> for librariess and executables. This was useful for Melange, but benefits every Dune project.</li>
<li><a href="https://github.com/melange-re/melange/pull/517">Make reactjs-jsx-ppx a standalone ppx</a></li>
<li><a href="https://github.com/ocaml/dune/pull/7193">Implemented a <code>module_system</code> field</a> for the melange stanza (e.g. <code>(module_systems (es6 mjs) (commonjs js) (commonjs cjs))</code> which allows to output multiple module systems / js extensions at the same time to the melange output folder</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org160692b" class="outline-4">
<h4 id="org160692b">Generating Documentation</h4>
<div class="outline-text-4" id="text-org160692b">
</div>
<ul class="org-ul">
<li><a id="org1e05477"></a><b>[Odoc]</b> Add Search Capabilities to <code>odoc</code><br />
<div class="outline-text-5" id="text-org1e05477">
<p>
Contributors: @panglesd (Tarides), @EmileTrotignon (Tarides)
</p>

<p>
We&rsquo;re working on generating a search index and adding a search bar to <code>odoc</code>-generated documentation. We&rsquo;re still
exploring the different approaches and we are working with the OCaml.org team to implement a search bar on the
OCaml packages documentation.
</p>


<div id="orga3b9b1b" class="figure">
<p><img src="https://global.discourse-cdn.com/business7/uploads/ocaml/optimized/2X/d/d77fe2783830bf0245487ff323adf27794f76b4e_2_1380x942.png" alt="d77fe2783830bf0245487ff323adf27794f76b4e_2_1380x942.png" />
</p>
</div>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>We started <a href="https://github.com/panglesd/odoc/tree/search-bar">prototyping</a> the search index and search bar and we&rsquo;re discussing the design of it. In particular, we&rsquo;ve used the compiler Shapes in the prototype and we&rsquo;ll explore using odoc&rsquo;s path resolver instead as a next step.</li>
</ul>
</div>
</li>

<li><a id="orgfa21182"></a><b>[Dune]</b> User-Friendly Command to Generate Documentation<br />
<div class="outline-text-5" id="text-orgfa21182">
<p>
Contributor: @EmileTrotignon (Tarides), @jonludlam (Tarides)
</p>

<p>
We&rsquo;re working towards making generating documentation in Dune more accessible, especially for newcomers. Currently,
the <code>dune build @doc</code> command generates documentation in the <code>_build</code> directory, and users simply have to know that
they need to <code>open _build/default/_doc/_html/index.html</code>. To work around this, we&rsquo;re working on a new <code>dune ocaml
doc</code> command to generate documentation and open it in the browser directly.
</p>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>We opened a PR that <a href="https://github.com/ocaml/dune/pull/7262">implements the <code>dune ocaml doc</code></a> command in March. This month, we tested the feature on macOS. We are now working towards completing the Windows tests.</li>
</ul>
</div>
</li>

<li><a id="org8cc0e90"></a><b>[Odoc]</b> Support for Tables in <code>odoc</code><br />
<div class="outline-text-5" id="text-org8cc0e90">
<p>
Contributors: @gpetiot (Tarides), @panglesd (Tarides), @Julow (Tarides), @jonludlam (Tarides)
</p>

<p>
Currently, the only way to create tables with odoc is to inline HTML code in the documentation. Tis is not ideal as
the HTML table syntax is not well-suited as documentation markup and the tables can only be rendered by the HTML
renderer (so tables are not available in LaTex and manpages). We&rsquo;re working towards a new special syntax in odoc
for creating tables that is easier to use and can be rendered by all renderers.
</p>

<p>
The syntax support has been <a href="https://github.com/ocaml-doc/odoc-parser/pull/11">merged in odoc-parser</a>. It provides
a heavy-syntax, and a ligh-syntax inspired by Markdown:
</p>
<pre class="example" id="org7ad17a3">
{t
  a  | b | c | d
  ---|:--|--:|:-:
  a  | b | c | d
}
</pre>

<p>
The <a href="https://github.com/ocaml/odoc/pull/893">support for the feature in odoc</a> isn&rsquo;t merged yet, but should be
available in the next odoc version!
</p>

<p>
<b>Activities</b>
</p>
<ul class="org-ul">
<li>No new activity in March, but here are Pull Requests we have been working on until now:
<ul class="org-ul">
<li>Add a new syntax for tables in odoc-parser (<a href="https://github.com/ocaml-doc/odoc-parser/pull/11">odoc-parser#11</a>)</li>
<li>Fix light table parsing (<a href="https://github.com/ocaml-doc/odoc-parser/pull/14">odoc-parser#14</a>)</li>
<li>Add support for tables to odoc (<a href="https://github.com/ocaml/odoc/pull/893">odoc#893</a>)</li>
</ul></li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-org98433c6" class="outline-4">
<h4 id="org98433c6">Editing and Refactoring Code</h4>
<div class="outline-text-4" id="text-org98433c6">
</div>
<ul class="org-ul">
<li><a id="org05936e9"></a><b>[Merlin]</b> Support for Project-Wide References in Merlin<br />
<div class="outline-text-5" id="text-org05936e9">
<p>
Contributors: @voodoos (Tarides)
</p>

<p>
Our work on Merlin focuses on the
<a href="https://discuss.ocaml.org/t/search-for-occurrences-of-a-symbol-in-a-project-file-using-merlin-ocaml-lsp/10756/7?u=tmattio">long-standing</a>
project to add project-wide occurrences support to Merlin. In April, we continued to work on the <a href="https://github.com/ocaml/ocaml/pull/12142">compiler
patches</a> that allow to generate the index from the compiler, and we
updated the Merlin patches to work with the compiler patches, simplifying the Merlin logic that can now rely on the
compiler.
</p>

<p>
The feature requires patches for the OCaml compiler, Dune, and Merlin that are still unreleased, but if you&rsquo;re
courageous, you can give it a try by following the documentation on
<a href="https://github.com/voodoos/merlin-occurrences-switch"><code>voodoos/merlin-occurrences-switch</code></a>.
</p>

<p>
<b>Activities</b>
</p>
<ul class="org-ul">
<li>We backported the compiler-side-indexation to 4.14. We performed benchmarks to evaluate the impact on build time and the size of the installed ~cmt~s. We posted the results on the PR, for both the <a href="https://github.com/ocaml/ocaml/pull/12142#issuecomment-1504006093">build time</a> and <a href="https://github.com/ocaml/ocaml/pull/12142#issuecomment-1505536484">cmts size</a>.</li>
<li>We also reworked the iterator performing indexation and added most of the missing cases to the indexer. However, some elements remain unindexed due to constraints with the <code>Typedtree</code>.</li>
<li>We updated the &ldquo;indexing&rdquo; external tool following partial indexation implementation in the compiler.</li>
<li>We also ported new compiler changes to Merlin on the OCaml 5.1 preview, which will allow us to work on project-wide occurrences support.</li>
<li>Finally, we started refactoring and simplifying the Merlin patches to query the index now that more work is done by the compiler.</li>
</ul>
</div>
</li>

<li><a id="org93058f8"></a><b>[Merlin]</b> Improving Merlin&rsquo;s Performance<br />
<div class="outline-text-5" id="text-org93058f8">
<p>
Contributed by: @pitag-ha (Tarides)
</p>

<p>
Following reports that Merlin performance scaled poorly in large code bases, we had been working on
<a href="https://github.com/pitag-ha/merl-an">Merl-an</a>, a tool to measure the performance of different Merlin requests.
</p>

<p>
In March, we were able to use it to identify the major performance bottlenecks, the biggest one being the PPX
phase. We implemented a <a href="https://github.com/ocaml/merlin/pull/1584">caching strategy for PPX</a> and continued to work
on it throughout April.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>We worked on fixing the PPX cache and explored mechanisms to toggle the PPX phase cache. We ended up implementing a <a href="https://github.com/ocaml/merlin/pull/1584/commits/c54d10927f28f96372bdb1c5c50b5e839909a51e">flag-based approach</a>.</li>
<li>We <a href="https://github.com/ocaml/merlin/pull/1584/commits/99bba403a1a946c3afe3d15c02128f4321904129">added six tests</a> that cover default behavior, cache hits, cache invalidation of three kinds, and behavior in case of PPX dependencies.</li>
</ul>
</div>
</li>

<li><a id="orgb99f64b"></a><b>[OCaml LSP]</b> Using Dune RPC on Windows<br />
<div class="outline-text-5" id="text-orgb99f64b">
<p>
Contributors: @nojb (LexiFi)
</p>

<p>
In February, we released Dune 3.7.0 with <a href="https://github.com/ocaml/dune/pull/7010">support for watch mode on
Windows</a>. Building on this work, this month we fixed a couple of issues in
Dune and OCaml LSP to allow OCaml LSP to use Dune RPC. This allows VSCode users to leverage Dune RPC and get build
statuses and more exhaustive build errors in the editor when Dune is running in watch mode. The fixes are not
released yet, but they will be available on the upcoming releases of Dune and OCaml LSP.
</p>

<p>
<b>Activities</b>:
</p>
<ul class="org-ul">
<li>We <a href="https://github.com/ocaml/dune/pull/7666">made a patch</a> in Dune to use the RPC protocol on Windows.</li>
<li>We <a href="https://github.com/ocaml/ocaml-lsp/pull/1079">fixed a bug</a> in OCaml-LSP to enable the communication with Dune RPC on Windows.</li>
</ul>
</div>
</li>

<li><a id="org007f0c1"></a><b>[OCaml LSP]</b> Upstreaming OCaml LSP&rsquo;s Fork of Merlin<br />
<div class="outline-text-5" id="text-org007f0c1">
<p>
Contributors: @voodoos (Tarides), @3Rafal (Tarides)
</p>

<p>
We&rsquo;re at the finish line of our efforts to close the gap between Merlin and OCaml LSP by upstreaming OCaml LSP&rsquo;s
fork of Merlin! This month, we continued on the Merlin PR that <a href="https://github.com/ocaml/merlin/pull/1585">adds a hook to OCaml LSP letting it run system
commands</a>. We also opened <a href="https://github.com/ocaml/ocaml-lsp/pull/1070">a PR on
<code>ocaml-lsp</code></a> to use the above patch and remove Merlin&rsquo;s fork
entirely. We&rsquo;re expecting to release a version of OCaml LSP that uses Merlin as a library very soon.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>We discussed and reviewed changes that let you configure the process spawn for PPXs when using Merlin as a library. This led us to implement ideas concerning the exposed hook for PPX process spawning. Subsequently, we <a href="https://github.com/ocaml/merlin/blob/master/src/utils/lib_config.mli#L22">documented the complexities</a> of splitting a PPX command between program and arguments.</li>
<li>We opened <a href="https://github.com/ocaml/ocaml-lsp/pull/1070">a PR on <code>ocaml-lsp</code></a> to remove Merlin&rsquo;s fork and use Merlin as a library.</li>
</ul>
</div>
</li>
</ul>
</div>

<div id="outline-container-orgfa0dfe9" class="outline-4">
<h4 id="orgfa0dfe9">Formatting Code</h4>
<div class="outline-text-4" id="text-orgfa0dfe9">
</div>
<ul class="org-ul">
<li><a id="org7c2ed54"></a><b>[OCamlFormat]</b> Migrate OCamlFormat from an AST to a CST<br />
<div class="outline-text-5" id="text-org7c2ed54">
<p>
Contributors: @gpetiot (Tarides), @EmileTrotignon (Tarides)
</p>

<p>
Back in 2022, @trefis built <a href="https://github.com/tarides/ocamlformat-ng">a prototype of a new OCaml formatter</a> that
uses a Conrete Syntax Tree (CST) instead of an Abstract Syntax Tree (AST). This mode retains more information and
results in more accurate formatting in a lot of cases, most especially when formatting comments which is a big pain
point with OCamlFormat.
</p>

<p>
Since then, we&rsquo;ve worked on migrating OCamlFormat&rsquo;s syntax tree to this CST. We chose not to migrate everything at
once to minimize the impact on users as much as possible, making sure that we make formatting changes only when
they are bug fixes or clear improvements.
</p>

<p>
You can track our progress in <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2213">this PR</a>, which shows a diff of
the current syntax tree and the target CST.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>We made progress on the work-in-progress PR to <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2332">preserve comments attached to labelled args</a>, fixing more regressions.</li>
<li>We implemented a change to <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2343">keep literal char value during parsing</a>.</li>
<li>We worked on <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2345">preserving the functor concrete syntax in the Parsetree</a>.</li>
<li>We <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2350">normalized functions in the parser</a>.</li>
</ul>
</div>
</li>

<li><a id="orga33834b"></a><b>[OCamlFormat]</b> Closing the Gap Between OCamlFormat and <code>ocp-indent</code><br />
<div class="outline-text-5" id="text-orga33834b">
<p>
Contributors: @gpetiot (Tarides), @EmileTrotignon (Tarides), @Julow (Tarides)
</p>

<p>
The OCamlFormat team has been working with the Jane Street teams to migrate Jane Street&rsquo;s code base from ocp-indent
to OCamlFormat.
As a result, we&rsquo;ve made tons of changes to the <code>janestreet</code> profile in recent months. Perhaps most notably, this
work has allowed us to identify issues that were not specific to the <code>janestreet</code> profile, and consequently we&rsquo;ve
been fixing bugs and implementing formatting improvements across the board.
</p>

<p>
We&rsquo;re nearing the end of this project, but April has seen a lot of bug fixes and improvements that we detail below.
</p>

<p>
<b>Activities:</b>
</p>
<ul class="org-ul">
<li>We adjusted the indentation for several language features, including <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2330">extensions</a>, <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2328">class-expr function bodies</a>, and <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2323">module-expr extensions</a>.</li>
<li>We fixed issues with <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2321">ocp-indent compatibility</a> and <a href="https://github.com/OCamlPro/ocp-indent/pull/324">Let vs LetIn detection after &rsquo;struct&rsquo;</a>.</li>
<li>We improved the <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2322">formatting of module arguments</a> and worked on <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2332">preserving comments attached to labelled args</a>.</li>
<li>We fixed issues causing changes to the AST due to strings in <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2338">code blocks</a> and <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2344">comments</a>.</li>
<li>We improved the <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2349">formatting of cinaps comments with strings</a> and worked on parsing and <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2354">normalizing cinaps comments</a>.</li>
<li>We made adjustments to the handling of certain language constructs, such as <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2352">protecting match after <code>fun _ : _ -&gt;</code></a> and <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2347">consistently wrapping (::)</a>.</li>
<li>We extended our test suite with <a href="https://github.com/ocaml-ppx/ocamlformat/pull/2355">numstat and a single run of ocp-indent</a>.</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">Eio Developer Meetings</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/eio-developer-meetings/12207/1">https://discuss.ocaml.org/t/eio-developer-meetings/12207/1</a>
</p>
</div>

<div id="outline-container-org5d4cc5d" class="outline-3">
<h3 id="org5d4cc5d">Sudha Parimala announced</h3>
<div class="outline-text-3" id="text-org5d4cc5d">
<p>
Hi all! We&rsquo;ve started having <a href="https://github.com/ocaml-multicore/eio">Eio</a> developer meetings online, once every
two weeks. The meeting is open to everyone. Those interested to follow Eio&rsquo;s developments are welcome to join.
</p>

<p>
<b>Agenda</b>
</p>

<p>
The meetings are for planning the development of Eio. The current status and plans for Eio 1.0 are being tracked at
<a href="https://github.com/ocaml-multicore/eio/issues/388">Eio#388</a>.
</p>

<p>
We&rsquo;re also eager to hear feedback on Eio from users, and their experience of migrating applications to Eio. This
will greatly help us to make the experience more pleasant and close gaps, if any. If you&rsquo;re looking to get started,
the <a href="https://github.com/ocaml-multicore/eio#readme">README</a> is a good place to start.
</p>

<p>
<b>Timings</b>
</p>

<p>
The meeting takes place on alternate Mondays, at 10:00 UK.
</p>

<ul class="org-ul">
<li>Next meeting: June 5, Monday</li>
<li>Time: 10:00 AM - 11:00 AM BST (9:00 AM - 10:00 AM UTC)</li>
<li>Link to meeting: <a href="http://meet.google.com/byo-dfiz-dou">meet.google.com/byo-dfiz-dou</a></li>
<li>Meeting notes: <a href="https://docs.google.com/document/d/1ZBfbjAkvEkv9ldumpZV5VXrEc_HpPeYjHPW_TiwJe4Q/">https://docs.google.com/document/d/1ZBfbjAkvEkv9ldumpZV5VXrEc_HpPeYjHPW_TiwJe4Q/</a></li>
<li>Use this calendar link to add it to your calendar - <a href="https://calendar.google.com/calendar/u/4?cid=Y19iMDA5ZDA4MDg0YzIwYWMzMDQ4NjJhN2FkZWJiYjdmOTU0NGIxYzEwMmU0MDMyMTAzMDFiY2ZhYjcwMDBmMjNlQGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20">Eio Developer Meetings</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-8" class="outline-2">
<h2 id="8">New major release of Parany (v14.0.0)</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/new-major-release-of-parany-v14-0-0/12208/1">https://discuss.ocaml.org/t/new-major-release-of-parany-v14-0-0/12208/1</a>
</p>
</div>

<div id="outline-container-orgaa6554c" class="outline-3">
<h3 id="orgaa6554c">UnixJunkie announced</h3>
<div class="outline-text-3" id="text-orgaa6554c">
<pre class="example" id="org7af3ab4">
# opam search parany
[...]
parany 14.0.0      Parallelize any computation
</pre>

<p>
I switched back the runtime to fork+marshal.
As was the case before version 13.0.0.
Versions 13.* (up to 14.0.0 excluded) use ocaml5-threads to parallelize computations.
</p>

<p>
<a href="https://github.com/UnixJunkie/parany">https://github.com/UnixJunkie/parany</a>
</p>

<p>
There is a branch <a href="https://github.com/UnixJunkie/parany/tree/ocaml5_threads">https://github.com/UnixJunkie/parany/tree/ocaml5_threads</a>
if anybody wants to maintain this backend.
</p>

<p>
The Parany.Parmap module has new functions for arrays:
<a href="https://github.com/UnixJunkie/parany/blob/master/src/parany.mli">https://github.com/UnixJunkie/parany/blob/master/src/parany.mli</a>
</p>
</div>
</div>
</div>




<div id="outline-container-org22e167b" class="outline-2">
<h2 id="org22e167b">Old CWN</h2>
<div class="outline-text-2" id="text-org22e167b">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I&rsquo;ll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org6f38160">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>