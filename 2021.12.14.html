<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-12-14 Tue 11:59 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2021.12.07.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2021.12.21.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of December 07 to 14, 2021.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">kqueue-ml 0.2.0 and poll 0.1.0</a></li>
<li><a href="#2">SWIPl-OCaml v0.5 - Never write your own unification algorithms again!</a></li>
<li><a href="#3">opam 2.1.2</a></li>
<li><a href="#4">Set up OCaml 2.0.0-beta10</a></li>
<li><a href="#5">A hassle-free setup to release binaries for different platforms: the opam release process experiment</a></li>
<li><a href="#6">Set up OCaml 2.0.0-beta11</a></li>
<li><a href="#7">What's the best way to save an huge amount of data in a file</a></li>
<li><a href="#8">p5scm 0.1.0</a></li>
<li><a href="#9">nanoid 1.0.0</a></li>
<li><a href="#10">Other OCaml News</a></li>
<li><a href="#orga773e67">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">kqueue-ml 0.2.0 and poll 0.1.0</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-kqueue-ml-0-2-0-and-poll-0-1-0/8958/1">https://discuss.ocaml.org/t/ann-kqueue-ml-0-2-0-and-poll-0-1-0/8958/1</a>
</p>
</div>

<div id="outline-container-org5a9a7be" class="outline-3">
<h3 id="org5a9a7be">Anurag Soni announced</h3>
<div class="outline-text-3" id="text-org5a9a7be">
<p>
I'd like to announce new releases for <a href="https://github.com/anuragsoni/kqueue-ml/">kqueue-ml</a> (version 0.2.0) and an
initial release of <a href="https://github.com/anuragsoni/poll">poll</a> (version 0.1.0).
</p>

<p>
<b>Kqueue-ml</b>: Thin bindings to the kqueue event notification system. Changes since the last release:
</p>

<ul class="org-ul">
<li>Remove dependency on ctypes</li>
<li>Limit support to 64 bit systems</li>
<li>Adds constant values to be used as filter flags in the public API</li>
</ul>

<p>
Installation: <a href="https://opam.ocaml.org/packages/kqueue/">opam install kqueue</a>
</p>

<p>
Caveat: This is again mostly tested on macOS, but I plan to work on testing and fixing bugs for getting the library
to work well on the various BSD systems, so please open issues if you use it on a BSD system and notice problems
(Thanks!).
</p>

<p>
<b>Poll</b>: Portable OCaml interface to macOS/Linux/Windows native IO event notification mechanisms
</p>

<p>
Installation: <a href="https://opam.ocaml.org/packages/poll/poll.0.1.0/">opam install poll</a>
</p>

<p>
This is the first release of poll, which builds on top of <code>kqueue-ml</code> and adds bindings to the system IO event
notifications on linux and windows to provide a portable polling interface. It uses kqueue on macOS, epoll on linux,
and uses <a href="https://github.com/piscisaureus/wepoll">wepoll</a> on windows so it can leverage IOCP on windows instead of
select. All io events will be level triggered, i.e. there will be a notification as long as the file descriptor being
watched is ready to read/write.
</p>

<p>
If you experience any problems, please open an issue on the Github Issue tracker :slightly_smiling_face:
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">SWIPl-OCaml v0.5 - Never write your own unification algorithms again!</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-swipl-ocaml-v0-5-never-write-your-own-unification-algorithms-again/8968/1">https://discuss.ocaml.org/t/ann-swipl-ocaml-v0-5-never-write-your-own-unification-algorithms-again/8968/1</a>
</p>
</div>

<div id="outline-container-org40aa9b6" class="outline-3">
<h3 id="org40aa9b6">Kiran Gopinathan announced</h3>
<div class="outline-text-3" id="text-org40aa9b6">
<p>
Hey all! I am just posting to announce a new package I've been working on: OCaml bindings to SWI-Prolog (ver 8.5 or
higher)!
</p>


<div id="orge698356" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/b/b5a466fc6bc98f83b6935205ea9b4ff1d16a324d.png" alt="b5a466fc6bc98f83b6935205ea9b4ff1d16a324d.png" />
</p>
</div>

<p>
It's currently in the process of being submitted to OPAM, but it's my first time writing a package with bindings to C
(using ctypes), so some further changes might be needed? maybe?, but you can find the source code repository here:
<a href="https://gitlab.com/gopiandcode/swipl-ocaml">repo</a>/<a href="https://github.com/Gopiandcode/SWIPL-OCaml">github mirror</a>.
</p>

<p>
As a sneak peek of what the API looks like, here's a hello world:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #b22222;">(* </span><span style="color: #b22222;">initialise SWIProlog </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">let</span> () = <span style="color: #228b22;">Swipl.</span>initialise ()
<span style="color: #b22222;">(* </span><span style="color: #b22222;">setup the prolog database with some facts </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">let</span> () = <span style="color: #228b22;">Swipl.</span>load_source <span style="color: #8b2252;">"hello :- writeln('hello world')."</span>
<span style="color: #b22222;">(* </span><span style="color: #b22222;">construct a Swipl term in OCaml </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">hello</span> = <span style="color: #228b22;">Swipl.Syntax.</span>(<span style="color: #a52a2a;">!</span><span style="color: #8b2252;">"hello"</span>)
<span style="color: #b22222;">(* </span><span style="color: #b22222;">send the term to the Prolog engine </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">let</span> () = <span style="color: #228b22;">Swipl.</span>with_ctx <span style="color: #a52a2a;">@@</span> <span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">ctx</span> -&gt; <span style="color: #228b22;">Swipl.</span>call ctx hello
</pre>
</div>

<p>
I've taken care to provide some detailed documentation + quick start guide using odoc (see
<a href="https://gopiandcode.github.io/SWIPL-OCaml/swipl/index.html">https://gopiandcode.github.io/SWIPL-OCaml/swipl/index.html</a>) - the quick start guide shows a step by step walkthrough
on using the library to write a type inference algorithm for lambda calculus using OCaml+Prolog (no need to write
your own UF).
</p>

<p>
Anyway, hope this might be useful for others - I have spent way too long racking my brains on writing dumb custom
unification algorithms, but now, no more!
</p>
</div>
</div>


<div id="outline-container-orga68447d" class="outline-3">
<h3 id="orga68447d">Kiran Gopinathan later added</h3>
<div class="outline-text-3" id="text-orga68447d">
<p>
Here's another example that might be interesting for those who have experience with SWI-Prolog.
</p>

<p>
You can even get native interaction with CHR: <a href="https://en.wikipedia.org/wiki/Constraint_Handling_Rules">https://en.wikipedia.org/wiki/Constraint_Handling_Rules</a> is a very
elegant framework which comes bundled with SWI Prolog that allows users to write complex domain specific constraint
solving engines in a concise declaritive way.
</p>

<p>
Here's a CHR system that models the interaction between <code>salt</code> and <code>water</code> (basic I know, but look up CHR to see some
more powerful examples):
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> () = <span style="color: #228b22;">Swipl.</span>load_source <span style="color: #8b2252;">"</span>
<span style="color: #8b2252;">:- use_module(library(chr)).</span>

<span style="color: #8b2252;">:- chr_constraint salt/0, water/0, salt_water/0.</span>

<span style="color: #8b2252;">salt, water &lt;=&gt; salt_water.</span>

<span style="color: #8b2252;">reducesTo_(Goal, C) :-</span>
<span style="color: #8b2252;">        call(Goal),</span>
<span style="color: #8b2252;">        call(user:'$enumerate_constraints'(C)).</span>
<span style="color: #8b2252;">reducesTo(Goal, Constraints) :-</span>
<span style="color: #8b2252;">        findall(Constraint, reducesTo_(Goal, Constraint), Constraints).</span>
<span style="color: #8b2252;">"</span>
</pre>
</div>

<p>
Which we can then embed into OCaml using the following code:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">solve_constraints</span> <span style="color: #a0522d;">ls</span> =
  <span style="color: #b22222;">(* </span><span style="color: #b22222;">Create a new term variable context </span><span style="color: #b22222;">*)</span>
  <span style="color: #228b22;">Swipl.</span>with_ctx (<span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">ctx</span> -&gt;
    <span style="color: #b22222;">(* </span><span style="color: #b22222;">create a term for the result </span><span style="color: #b22222;">*)</span>
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">result</span> = <span style="color: #228b22;">Swipl.</span>fresh ctx <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #b22222;">(* </span><span style="color: #b22222;">encode the constraint store </span><span style="color: #b22222;">*)</span>
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">goal</span> = encode ls <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #b22222;">(* </span><span style="color: #b22222;">send the query to the Prolog engine </span><span style="color: #b22222;">*)</span>
    <span style="color: #228b22;">Swipl.</span>call ctx (reducesTo goal result);
    <span style="color: #b22222;">(* </span><span style="color: #b22222;">extract the result </span><span style="color: #b22222;">*)</span>
    decode ctx result
  )
<span style="color: #b22222;">(* </span><span style="color: #b22222;">val solve_constraints: t list -&gt; t list </span><span style="color: #b22222;">*)</span>
</pre>
</div>
<p>
(Again, some steps have been omitted for brevity, and you should check out the quick start guide for a step by step
walkthrough).
</p>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">opam 2.1.2</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-opam-2-1-2/8973/1">https://discuss.ocaml.org/t/ann-opam-2-1-2/8973/1</a>
</p>
</div>

<div id="outline-container-orga5872e3" class="outline-3">
<h3 id="orga5872e3">Kate announced</h3>
<div class="outline-text-3" id="text-orga5872e3">
<p>
We are pleased to announce the minor release of <a href="https://github.com/ocaml/opam/releases/tag/2.1.2">opam 2.1.2</a>.
</p>

<p>
This opam release consists of <a href="https://github.com/ocaml/opam/issues/4920">backported</a> fixes, including:
</p>

<ul class="org-ul">
<li>Fallback on <code>dnf</code> if <code>yum</code> does not exist on RHEL-based systems (<a href="https://github.com/ocaml/opam/pull/4825">#4825</a>)</li>

<li>Use <code>--no-depexts</code> in CLI 2.0 mode. This further improves the use of opam 2.1 as a drop-in replacement for opam 2.0 in CI, for example with setup-ocaml in GitHub Actions. (<a href="https://github.com/ocaml/opam/pull/4908">#4908</a>)</li>
</ul>

<p>
To upgrade simply run:
</p>
<div class="org-src-container">
<pre class="src src-shell">bash -c <span style="color: #8b2252;">"sh &lt;(curl -fsSL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh) --version 2.1.2"</span>
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">Set up OCaml 2.0.0-beta10</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta10/8974/1">https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta10/8974/1</a>
</p>
</div>

<div id="outline-container-orgf6cec2a" class="outline-3">
<h3 id="orgf6cec2a">Sora Morimoto announced</h3>
<div class="outline-text-3" id="text-orgf6cec2a">
</div>
<div id="outline-container-org87d7784" class="outline-4">
<h4 id="org87d7784">Added</h4>
<div class="outline-text-4" id="text-org87d7784">
<ul class="org-ul">
<li>Added "extends" experimentally.</li>
</ul>
</div>
</div>

<div id="outline-container-orga0f9ea0" class="outline-4">
<h4 id="orga0f9ea0">Changed</h4>
<div class="outline-text-4" id="text-orga0f9ea0">
<ul class="org-ul">
<li>Remove some hacks as <code>--no-depexts</code> is now used in CLI 2.0 mode from opam 2.1.2.</li>
</ul>

<p>
<a href="https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta10">https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta10</a>
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">A hassle-free setup to release binaries for different platforms: the opam release process experiment</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/a-hassle-free-setup-to-release-binaries-for-different-platforms-the-opam-release-process-experiment/8975/1">https://discuss.ocaml.org/t/a-hassle-free-setup-to-release-binaries-for-different-platforms-the-opam-release-process-experiment/8975/1</a>
</p>
</div>

<div id="outline-container-org7127019" class="outline-3">
<h3 id="org7127019">Kate announced</h3>
<div class="outline-text-3" id="text-org7127019">
<p>
On top of the <a href="https://discuss.ocaml.org/t/ann-opam-2-1-2/8973">opam 2.1.2 announcement</a>, I’d like share an
experiment with the opam release script used for this release.
</p>

<p>
As you might know, for each releases of opam we provide pre-compiled binaries for ease of use.
We’ve had a release script which up to this point required a specific setup to get it running correctly. For instance
we had to setup a local OpenBSD machine (possibliy virtualised), a macOS/x86_64 machine and a macOS/arm64. This setup
is rather tedious to reproduce.
</p>

<p>
To improve this situation I’ve experimented over the past week with <a href="https://en.wikipedia.org/wiki/QEMU">QEMU</a> and
<a href="https://en.wikipedia.org/wiki/Rosetta_(software)#Rosetta_2">Rosetta 2</a> to make it a "one click script":
</p>

<p>
<a href="https://github.com/ocaml/opam/pull/4947">https://github.com/ocaml/opam/pull/4947</a>
</p>

<p>
This change makes so that the script now only requires a macOS/arm64. From there you can:
</p>
<ul class="org-ul">
<li>compile locally for macOS/arm64 binaries</li>
<li>compile locally for macOS/x86_64 binaries (using Rosetta 2)</li>
<li>compile for BSDs (using QEMU)</li>
<li>compile for Linux (using Docker)</li>
</ul>

<p>
With this, the <a href="https://github.com/ocaml/opam/releases/tag/2.1.2">binaries</a> for this release have been compiled with
this more reproducible setup, and now include FreeBSD/x86_64 binaries as well :sparkles:
</p>

<p>
If someone wants to have a similar setup to distribute binaries here is the git repository (using Git LFS to store
the large files). Feel free to use and experiment with it:
</p>

<p>
<a href="https://gitlab.com/kit-ty-kate/qemu-base-images">https://gitlab.com/kit-ty-kate/qemu-base-images</a>
</p>

<p>
For now it only has OpenBSD/x86_64 and FreeBSD/x86_64 images but it could theoretically have more. Although I’m not
accepting PRs for now (for obvious security reasons), I’m open to suggestions to add more platforms. See the
<a href="https://gitlab.com/kit-ty-kate/qemu-base-images/-/blob/master/README.md">README</a> for high level details about the
setup.
</p>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">Set up OCaml 2.0.0-beta11</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta11/9002/1">https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta11/9002/1</a>
</p>
</div>

<div id="outline-container-org264ca4e" class="outline-3">
<h3 id="org264ca4e">Sora Morimoto announced</h3>
<div class="outline-text-3" id="text-org264ca4e">
</div>
<div id="outline-container-org9b45802" class="outline-4">
<h4 id="org9b45802">Fixed</h4>
<div class="outline-text-4" id="text-org9b45802">
<ul class="org-ul">
<li>Add support for more styles for the ocamlformat configuration in lint-fmt action.</li>
</ul>

<p>
<a href="https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta11">https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta11</a>
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">What's the best way to save an huge amount of data in a file</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/whats-the-best-way-to-save-an-huge-amount-of-data-in-a-file/9003/5">https://discuss.ocaml.org/t/whats-the-best-way-to-save-an-huge-amount-of-data-in-a-file/9003/5</a>
</p>
</div>

<div id="outline-container-org239705b" class="outline-3">
<h3 id="org239705b">Deep in this thread, Simon Cruanes announced</h3>
<div class="outline-text-3" id="text-org239705b">
<p>
What a coincidence, I wrote an
<a href="https://github.com/c-cube/ocaml-avro">Avro library</a> very recently. The
paint is still fresh. However, it might be worth giving it a try as it's
exactly the targeted use case: many rows of relatively simple data,
encoded as binary; it also supports gzip compression (per "block" of N
many rows, with N configurable). And there's no need to worry about
endianess.
</p>

<p>
It typically uses code generation from a schema (a json file).
</p>

<p>
There's libraries for Avro in java (with all the Spark ecosystem) and
also python (see "fastavro").
</p>
</div>
</div>
</div>




<div id="outline-container-8" class="outline-2">
<h2 id="8">p5scm 0.1.0</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-p5scm-0-1-0/9014/1">https://discuss.ocaml.org/t/ann-p5scm-0-1-0/9014/1</a>
</p>
</div>

<div id="outline-container-org6f38259" class="outline-3">
<h3 id="org6f38259">Jason Nielsen announced</h3>
<div class="outline-text-3" id="text-org6f38259">
<p>
I’ve released <a href="https://github.com/drjdn/p5scm">p5scm</a> which is now up on <code>opam</code>.  It is a scheme-like implementation
on top of <code>camlp5</code>'s <a href="https://github.com/camlp5/camlp5/blob/master/etc/pa_schemer.ml">pa_schemer.ml</a> extension.  I
know that <code>camlp5</code> isn't the cool kid on the block these days but it is a powerful tool and pretty cool in my
estimation ;-).
</p>
</div>
</div>
</div>




<div id="outline-container-9" class="outline-2">
<h2 id="9">nanoid 1.0.0</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-nanoid-1-0-0/9017/1">https://discuss.ocaml.org/t/ann-nanoid-1-0-0/9017/1</a>
</p>
</div>

<div id="outline-container-orge1f207c" class="outline-3">
<h3 id="orge1f207c">mefyl announced</h3>
<div class="outline-text-3" id="text-orge1f207c">
<p>
I'm pleased to announce the release of <a href="https://github.com/routineco/ocaml-nanoid">nanoid 1.0.0</a>. NanoID are
<a href="https://github.com/ai/nanoid">popular unique ids</a> amongst the javascript ecosystem. This library brings an
equivalent native implementation and a virtual library to transparently branch between the native implementation and
the original javascript one. The intent is to enable pieces of code generating such ids to be moved transparently
between frontend and backend of a web stack.
</p>

<p>
This is an humble first contribution to gain some experience and will hopefully be followed by more of our internal
developments.
</p>
</div>
</div>
</div>




<div id="outline-container-10" class="outline-2">
<h2 id="10">Other OCaml News</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org4995ec9" class="outline-3">
<h3 id="org4995ec9">From the ocamlcore planet blog</h3>
<div class="outline-text-3" id="text-org4995ec9">
<p>
Here are links from many OCaml blogs aggregated at <a href="http://ocaml.org/community/planet/">OCaml Planet</a>.
</p>

<ul class="org-ul">
<li><a href="https://tech.ahrefs.com/monorobot-a-slack-bot-for-monorepos-374260e2ca43?source=rss----303662d88bae--ocaml">Monorobot: a Slack bot for monorepos</a></li>
<li><a href="http://opam.ocaml.org/blog/blog/opam-2-1-2/">opam 2.1.2 release</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orga773e67" class="outline-2">
<h2 id="orga773e67">Old CWN</h2>
<div class="outline-text-2" id="text-orga773e67">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org13c404e">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
