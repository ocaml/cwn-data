<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-07-03 Tue 11:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="http://alan.petitepomme.net/cwn/2018.06.26.html">Previous Week</a> <a href="http://alan.petitepomme.net/cwn/index.html">Up</a> <a href="http://alan.petitepomme.net/cwn/2018.07.10.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of June 26 to July 03, 2018.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">Next OUPS meetup, July 5th 2018</a></li>
<li><a href="#2">Ocaml-multicore: report on a June 2018 development meeting in Paris</a></li>
<li><a href="#3">Sightings of OCaml around the Web</a></li>
<li><a href="#4">Lwt 4.1.0, first release with MIT license!</a></li>
<li><a href="#5">reed-solomon-erasure 1.0.1</a></li>
<li><a href="#6">Pull requests to OCaml now being linted</a></li>
<li><a href="#7">A proposal for a resource-management model for OCaml</a></li>
<li><a href="#8">What are my options for doing Native OCaml &lt;=&gt; Erlang &lt;=&gt; Browser (js_of_ocaml and/or bucklescript) RPC</a></li>
<li><a href="#9">What would it take to unify the parsetree with the typedtree?</a></li>
<li><a href="#10">Ocaml Github Pull Requests</a></li>
<li><a href="#11">Other OCaml News</a></li>
<li><a href="#orge8a806f">Old CWN</a></li>
</ul>
</div>
</div>


<hr />

<div id="outline-container-orgfd7c3c1" class="outline-2">
<h2 id="1"><a id="orgfd7c3c1"></a>Next OUPS meetup, July 5th 2018</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://sympa.inria.fr/sympa/arc/caml-list/2018-06/msg00044.html">https://sympa.inria.fr/sympa/arc/caml-list/2018-06/msg00044.html</a>
</p>
</div>

<div id="outline-container-org6c50d2e" class="outline-3">
<h3 id="org6c50d2e">Bruno Bernardo announced</h3>
<div class="outline-text-3" id="text-org6c50d2e">
<p>
The next OUPS meetup will take place on Thursday, July 5, 7pm at IRILL
on the Jussieu campus. As usual, we will have a few talks, followed by
pizzas and drinks.
</p>

<p>
The talks will be the following:
</p>
<ul class="org-ul">
<li>Nicolás Ojeda Bär on runtime types</li>
<li>Michel Mauny on the OCaml Foundation</li>
<li>Frédéric Bour on Wall, a vector graphics renderer using OpenGL
(<a href="https://github.com/let-def/wall">https://github.com/let-def/wall</a>).</li>
</ul>

<p>
Please do note that we are always in demand of talk <b>proposals</b> for future
meetups.
</p>

<p>
To register, or for more information, go here:
<a href="https://www.meetup.com/ocaml-paris/events/252133804/">https://www.meetup.com/ocaml-paris/events/252133804/</a>
</p>

<p>
<b>Registration is required! Access is not guaranteed after 7pm if
you're not registered.</b> (It also helps us to order the right amount of
food.)
</p>

<p>
Access map:<br />
IRILL - Université Pierre et Marie Curie (Paris VI)<br />
Barre 15-16 1er étage<br />
4 Place Jussieu<br />
75005 Paris<br />
<a href="https://www.irill.org/pages/access.html">https://www.irill.org/pages/access.html</a>
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-orgfa79d89" class="outline-2">
<h2 id="2"><a id="orgfa79d89"></a>Ocaml-multicore: report on a June 2018 development meeting in Paris</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-multicore-report-on-a-june-2018-development-meeting-in-paris/2202/1">https://discuss.ocaml.org/t/ocaml-multicore-report-on-a-june-2018-development-meeting-in-paris/2202/1</a>
</p>
</div>

<div id="outline-container-orgb6adade" class="outline-3">
<h3 id="orgb6adade">gasche announced</h3>
<div class="outline-text-3" id="text-orgb6adade">
<p>
Earlier this week (24-25 June 2018) we had a meeting in Paris between several
OCaml maintainers and researchers (folks from INRIA, OCamllabs, Jane Street, and
also Frédéric Bour), and one of the things that were discussed is the technical
state of the Multicore-OCaml project. I thought that people here could be
interested in a status update on that. Note that it's not an update on <b>user</b>
features (no release date for Multicore-OCaml in this post, sorry!), but an
update on technical <b>development</b> plans, so that people that follow the compiler
distribution development on <a href="https://github.com/ocaml/ocaml/">https://github.com/ocaml/ocaml/</a> ( or
<a href="https://github.com/ocamllabs/ocaml-multicore/">https://github.com/ocamllabs/ocaml-multicore/</a> ) have some context for what is
coming next.
</p>

<p>
I'm going to concentrate here on the part that concern the multicore <b>runtime</b>:
garbage collection and low-level runtime code, summarizing the main points from
my own notes of the meeting. Note that I'm not working on Multicore-OCaml
myself, I'm reporting on work done by others. I certainly have made some
mistakes below, and may update my post to fix some of those.
</p>

<p>
<b>TL;DR</b>: In 2019 we hope to integrate the multicore runtime into the upstream
compiler distribution, even if it is not enabled by default (still
experimental), so that it can evolve with the distribution and get the kind of
testing and code porting experience we need to make decisions before a wider
release.
</p>
</div>

<div id="outline-container-orga2cda86" class="outline-4">
<h4 id="orga2cda86">Current state of the multicore runtime</h4>
<div class="outline-text-4" id="text-orga2cda86">
<p>
KC Sivaramakrishnan ( @kayceesrk ) gave a presentation on the current state of
the <a href="https://github.com/ocamllabs/ocaml-multicore">Multicore OCaml</a> project. The
<a href="http://kcsrk.info/slides/mcocaml_gallium.pdf">slides are available</a>. They are a
good summary of the history and current state of the multicore runtime.
</p>
</div>
</div>

<div id="outline-container-org65c5331" class="outline-4">
<h4 id="org65c5331">General milestone: migrate the multicore-ocaml runtime into the main distribution</h4>
<div class="outline-text-4" id="text-org65c5331">
<p>
Stephen Dolan ( @stedolan ) and KC reported that it is a lot of work for them to
keep up with changes in the OCaml compiler implementation (they just recently
rebased their branch on top of 4.06, it was 4.02 before that). When someone
changes something in the OCaml compiler or runtime, they check that the rest of
the distribution works properly or fix/adapt what is affected by the change;
those changes are not tested against the multicore runtime, and Stephen and KC
have to do all the fix/adapt work for all changes themselves.
</p>

<p>
To help with this problem, the consensus is that we should upstream the
multicore-runtime code into the compiler distribution soon-ish, not enabled by
default, so that people that change the compiler codebase immediately see the
effect on the multicore runtime, and can participate in fixing and adapting the
code with respect to their change &#x2013; with guidance from multicore experts. For a
period of time, the multicore runtime would only be available as an experimental
option.
</p>

<p>
We hope that this migration could be done in about a year.
</p>
</div>

<ul class="org-ul">
<li><a id="orgec47078"></a>Q3/Q4 2018: build-up PRs<br />
<div class="outline-text-5" id="text-orgec47078">
<p>
There are some PRs that change part of the current compiler and runtime to play
nicer with the multicore bits, but are not part of the multicore runtime
themselves. The plan is to get these submitted as PRs during the next
development cycle (for 4.08, although we don't know whether they will be merged
by the 4.08 release). This is not a new process, some such PRs have already been
integrated in the last few omnths/years (see for example
<a href="https://github.com/ocaml/ocaml/pull/1073">GPR#1073</a>,
<a href="https://github.com/ocaml/ocaml/pull/1723">GPR#1723</a>), but the hope is to get as
much of those preliminary changes as possible.
</p>
</div>
</li>


<li><a id="org8d894c1"></a>Q3/Q4 2018 (?): forward-compatible C API<br />
<div class="outline-text-5" id="text-org8d894c1">
<p>
We know that Multicore OCaml will require some changes to the way C stubs are
written for OCaml. Of course, we cannot expect authors of C bindings to switch
overnight, so there will be some transition period where existing C bindings
won't be able to use the multicore runtime and will have to be ported. On the
other hand, the current runtime should be able to support the multicore-friendly
C API, so that ported code can work on both runtimes.
</p>

<p>
We agreed that it would be useful to have this "multicore-friendly C API" be
available as soon as possible, or at least part of it, even before the
multicore-runtime itself lands, so that people can already start making their
code forward-compatible. Stephen already tried to do this in a giant PR
<a href="https://github.com/ocaml/ocaml/pull/1003">GPR#1003</a> last year, and that was too
big and never quite finished.
</p>

<p>
My understanding is that the multicore-OCaml people are still not completely
sure on what the final API will be, which things definitely have to be broken
and which thing might be supported with more work on their side, and hesitated
to push changes that could end up unnecessary. We agreed to try again, with
smaller API changes submitted separately of each other, instead of a giant
single change; and agreed on principle that it was OK to propose new APIs that
had a small chance of not being necessary in the end, as long as the API is
sensible and can be easily implemented on top of the current runtime. (Early
adopters might face a bit of code churn as things stabilize.)
</p>

<p>
(One first change that we want to look at is <a href="https://github.com/ocaml/ocaml/pull/1798">GPR#1798</a>, which implements a notion of C-API versioning.)
</p>
</div>
</li>

<li><a id="org4575033"></a>2019: multicore runtime features, as an experimental runtime<br />
<div class="outline-text-5" id="text-org4575033">
<p>
Then the plan is to start merging the multicore runtime codebase itself, piece
by piece, so that it becomes possible to perform larger-scale experiment with
it. It still wouldn't be enabled by default at this point, but it would be part
of the actively moving compiler distribution, and in particular remain at
feature parity with the rest of the compiler and runtime codebase.
</p>

<p>
In this phase we'll need people to review the multicore runtime implementation,
if only to help future upstream maintenance. We have started to ask around who
would be potentially interested &#x2013; hopefully with a related skill set. The
project also has a laundry list of <a href="https://github.com/ocamllabs/ocaml-multicore/projects/3">pending
tasks</a> that could also
be worked on by the people studying the codebase.
</p>

<p>
Some of the tasks being worked on involve implementing parts of the OCaml
runtime systems that are not yet fully supported by the multicore runtime, such
as Ephemerons (a generalization of weak pointers). My understanding is that the
multicore devs would like to reach feature parity before merging the runtime
code, but this may be re-discussed and changed if some parts of the runtime
prove too difficult to support.
</p>
</div>
</li>

<li><a id="orgf855c5e"></a>remark: the runtime/language split<br />
<div class="outline-text-5" id="text-orgf855c5e">
<p>
The current multicore-ocaml fork/switch contains both the multicore runtime, and
an implementation of (untyped) effect handlers in the surface language, as the
way for users to access concurrency features (to control the fibers /
green-threads). Effect handlers come in evolving proposals of their own, there
is a type-and-effect system under work by Leo White, and they are being
discussed as well, in a somewhat independent way. Bundling the two changes in
the same patchset makes reviewing more difficult, and it also created some silly
technical issues: because effect handlers change the language AST, most
ppx-extension code is broken on the multicore-OCaml fork, which makes it
difficult to use language tooling, to test user programs, run interesting
benchmarks, etc.
</p>

<p>
In the short term the plan for upstreaming the runtime is to separate it from
the effect-handler part, by exposing an extremely minimal fiber-control API, as
compiler primitives or as part of the <code>Obj</code> runtime. That is not how anybody
wants end-users to access the multicore runtime, but it would be a minimal
device for the first period of runtime code upstreaming and reviewing, to make
it easy to compile any codebase against the multicore-aware compiler, and use
the standard OCaml packages and tooling in a multicore switch.
</p>
</div>
</li>

<li><a id="org12132ba"></a>remark: performance tuning, not yet<br />
<div class="outline-text-5" id="text-org12132ba">
<p>
Right now the multicore-OCaml devs, if I understand correctly, have been mostly
working with micro-benchmarks, in large part because of the difficulty of using
regular OCaml packages and tooling previously mentioned. A lot of opportunities
(and necessity) for performance tuning will appear once macro-benchmarks and
realistic workloads become available, and once some of the larger
performance-sensitive codebases (which often include some C bindings or
compiler-sensitive Obj hackery) have been ported. As Anil Madhavapeddy (@avsm)
pointed out, once more code out there can be benchmarked against the multicore
runtime we should start continuously monitoring the performance results.
</p>

<p>
The general expectation is that the multicore runtime will be slower for
purely-sequential programs than the current runtime, but the goal is to keep
this overhead small (a first goal that was mentioned was a 10% overhead,
although we really don't know yet how easy/hard that target is). The two
distinct runtimes may remain available in the distribution for as long as there
are enough users asking for the availability sequential runtime, and that the
overhead is high enough to justify the maintenance costs of keeping both. (In
term of the multicore-runtime performance on sequential workloads, some things
can be made faster at the cost of being harder to write and possibly more
painful to maintain, so there are tradeoffs still to be explored there.)
</p>

<p>
One thing I found interesting that Stephen explained to me is: you cannot just
take a sequential program (say Coq), compile and run it under a multicore
switch, and expect to get a meaningful "overhead number" (as in: "the multicore
runtime is X% slower than the sequential one on this program"). The problem is
that GCs can be configured to have more or less memory overhead &#x2013; asking for
less memory overhead results in more GC work, so a slower overall program. It
doesn't make sense to only compare the default settings of two GCs for time, as
they may have very different memory-overhead profile: maybe the second GC looks
faster, but if you adjust its settings to use no more memory than the first it
actually is slower. What you have to do instead is to try to plot the 2D
time/memory compromise, and compare the graphs for the two GCs, or at least
compare the entire plot of the new GC with the current results of your current
GC.
</p>
</div>
</li>
</ul>
</div>

<div id="outline-container-org720609d" class="outline-4">
<h4 id="org720609d">Summary</h4>
<div class="outline-text-4" id="text-org720609d">
<ul class="org-ul">
<li>In the next six months, we hope to start merging most of the preparatory work, and a forward-compatible C API, into the upstream compiler distribution.</li>
<li>Then in 2019 we hope to start merging the multicore runtime itself (independently of effect handlers), as a non-default experimental option. We will need people to review the codebase and feel more confident in their ability to also edit it.</li>
<li>This should allow much more extensive performance testing, and the porting of some performance-sensitive codebases, so that we can get a better picture of the performance profile, of the difficulty to port code, potential parts that need to be reworked, etc.</li>
</ul>

<p>
Plenty of interesting applications of a multicore runtime (and of a typed effect
system) have also been discussed, interesting memory-model questions,
formalization questions, etc. This is definitely an interesting time for the
OCaml community!
</p>




<hr />
</div>
</div>
</div>
</div>

<div id="outline-container-org70726dc" class="outline-2">
<h2 id="3"><a id="org70726dc"></a>Sightings of OCaml around the Web</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/sightings-of-ocaml-around-the-web/1867/22">https://discuss.ocaml.org/t/sightings-of-ocaml-around-the-web/1867/22</a>
</p>
</div>

<div id="outline-container-org8e9e8c3" class="outline-3">
<h3 id="org8e9e8c3">Yotam Barnoy announced</h3>
<div class="outline-text-3" id="text-org8e9e8c3">
<p>
Great new article out by @bobbypriambodo, this time on <a href="https://medium.com/@bobbypriambodo/interfacing-ocaml-and-postgresql-with-caqti-a92515bdaa11">creating a project with opam, caqti and postgresql</a>.
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-org04f51d3" class="outline-2">
<h2 id="4"><a id="org04f51d3"></a>Lwt 4.1.0, first release with MIT license!</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/lwt-4-1-0-first-release-with-mit-license/2216/1">https://discuss.ocaml.org/t/lwt-4-1-0-first-release-with-mit-license/2216/1</a>
</p>
</div>

<div id="outline-container-org46c6f89" class="outline-3">
<h3 id="org46c6f89">Anton Bachin announced</h3>
<div class="outline-text-3" id="text-org46c6f89">
<p>
Switching to the MIT license is actually the main reason to release Lwt now, so
this release is a bit sparse compared to most :) There are, however, other nice
additions and fixes. See the changelog below.
</p>

<p>
<a href="https://github.com/ocsigen/lwt/blob/33c37b550304b8d18b5dea4818fb1bfbc9a86aaf/src/unix/lwt_io.mli#L533"><code>Lwt_io.establish_server_with_client_socket</code></a>
was added to help <a href="https://github.com/inhabitedtype/httpaf/pull/53">port http/af to
Lwt</a>. http/af is the fast new
HTTP server by @seliopou. This should be coming out soon.
</p>

<p>
Additions
</p>

<ul class="org-ul">
<li>Change license to MIT (<a href="https://github.com/ocsigen/lwt/issues/560">#560</a>).</li>
<li><a href="https://github.com/ocsigen/lwt/blob/33c37b550304b8d18b5dea4818fb1bfbc9a86aaf/src/unix/lwt_fmt.mli"><code>Lwt_fmt</code></a>, an Lwt-aware version of <a href="http://caml.inria.fr/pub/docs/manual-ocaml/libref/Format.html"><code>Format</code></a> (<a href="https://github.com/ocsigen/lwt/pull/548">#548</a>, @Drup).</li>
<li><a href="https://github.com/ocsigen/lwt/blob/33c37b550304b8d18b5dea4818fb1bfbc9a86aaf/src/unix/lwt_io.mli#L533"><code>Lwt_io.establish_server_with_client_socket</code></a> (<a href="https://github.com/ocsigen/lwt/pull/586">#586</a>).</li>
</ul>

<p>
Bugs fixed
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocsigen/lwt/blob/33c37b550304b8d18b5dea4818fb1bfbc9a86aaf/src/core/lwt_stream.mli#L314"><code>Lwt_stream.iter_n</code></a>:</li>
</ul>
<p>
rename <code>?max_threads</code> argument to <code>?max_concurrency</code>
(<a href="https://github.com/ocsigen/lwt/pull/581">#581</a>, @hcarty).
</p>
<ul class="org-ul">
<li>PPX: reject <code>match</code> expressions that have only <code>exception</code> cases (<a href="https://github.com/ocsigen/lwt/pull/597">#597</a>, @raphael-proust).</li>
</ul>

<p>
Miscellaneous
</p>

<ul class="org-ul">
<li>Improvements to <a href="https://github.com/ocsigen/lwt/blob/33c37b550304b8d18b5dea4818fb1bfbc9a86aaf/src/core/lwt_pool.mli"><code>Lwt_pool</code></a> docs (<a href="https://github.com/ocsigen/lwt/pull/575">#575</a>, @bobbypriambodo).</li>
<li>Restore all PPX tests (<a href="https://github.com/ocsigen/lwt/pull/590">#590</a>, Jess Smith).</li>
</ul>

<p>
Thanks to all the contributors who worked on this release, and to past contributors for agreeing to the license switch!
</p>

<p>
changelog: <a href="https://github.com/ocsigen/lwt/releases/tag/4.1.0">https://github.com/ocsigen/lwt/releases/tag/4.1.0</a>
</p>

<p>
<a href="https://github.com/ocsigen/lwt#readme">https://github.com/ocsigen/lwt#readme</a>
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-org9f9cf09" class="outline-2">
<h2 id="5"><a id="org9f9cf09"></a>reed-solomon-erasure 1.0.1</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-reed-solomon-erasure-1-0-1/2217/1">https://discuss.ocaml.org/t/ann-reed-solomon-erasure-1-0-1/2217/1</a>
</p>
</div>

<div id="outline-container-org368bf92" class="outline-3">
<h3 id="org368bf92">Darren announced</h3>
<div class="outline-text-3" id="text-org368bf92">
</div>
<div id="outline-container-orgcd13d5a" class="outline-4">
<h4 id="orgcd13d5a">Overview</h4>
<div class="outline-text-4" id="text-orgcd13d5a">
<p>
reed-solomon-erasure is an OCaml implementation of Reed-Solomon erasure coding.
</p>

<p>
It is a port of the Rust library <a href="https://github.com/darrenldl/reed-solomon-erasure">reed-solomon-erasure</a>, which is a port of several other libraries.
</p>

<p>
It provides functions for encoding, verifying, and reconstructing data and parity shards, and deals with <code>string</code>, <code>bytes</code>, and <code>Core_kernel.Bigstring.t</code>
</p>

<p>
You can install it via <code>opam install reed-solomon-erasure</code>.
</p>
</div>
</div>

<div id="outline-container-org30b1a7a" class="outline-4">
<h4 id="org30b1a7a">Example</h4>
<div class="outline-text-4" id="text-org30b1a7a">
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">open </span><span style="color: #228b22;">Reed_solomon_erasure</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a52a2a;">()</span> <span style="color: #a52a2a;">=</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">r</span> <span style="color: #a52a2a;">=</span> <span style="color: #228b22;">ReedSolomon.</span>make 3 2 <span style="color: #000000; font-weight: bold;">in</span> <span style="color: #b22222;">(* </span><span style="color: #b22222;">3 data shards, 2 parity shards </span><span style="color: #b22222;">*)</span>

  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">master_copy</span> <span style="color: #a52a2a;">=</span> <span style="color: #a52a2a;">[|</span><span style="color: #8b2252;">"\000\001\002\003"</span><span style="color: #a52a2a;">;</span>
                      <span style="color: #8b2252;">"\004\005\006\007"</span><span style="color: #a52a2a;">;</span>
                      <span style="color: #8b2252;">"\008\009\010\011"</span><span style="color: #a52a2a;">;</span>
                      <span style="color: #8b2252;">"\000\000\000\000"</span><span style="color: #a52a2a;">;</span> <span style="color: #b22222;">(* </span><span style="color: #b22222;">last 2 rows are parity shards </span><span style="color: #b22222;">*)</span>
                      <span style="color: #8b2252;">"\000\000\000\000"</span><span style="color: #a52a2a;">|]</span> <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #b22222;">(* </span><span style="color: #b22222;">Construct the parity shards </span><span style="color: #b22222;">*)</span>
  <span style="color: #228b22;">ReedSolomon.</span>encode_str r master_copy<span style="color: #a52a2a;">;</span>

  <span style="color: #b22222;">(* </span><span style="color: #b22222;">Make a copy and transform it into option shards arrangement</span>
<span style="color: #b22222;">     for feeding into reconstruct_opt_str </span><span style="color: #b22222;">*)</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">shards</span> <span style="color: #a52a2a;">=</span> <span style="color: #228b22;">RS_Shard_utils.</span>shards_to_option_shards_str master_copy <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #b22222;">(* </span><span style="color: #b22222;">We can remove up to 2 shards, which may be data or parity shards </span><span style="color: #b22222;">*)</span>
  shards.<span style="color: #a52a2a;">(</span>0<span style="color: #a52a2a;">)</span> <span style="color: #a52a2a;">&lt;-</span> <span style="color: #000000; background-color: #ffffff;">None</span><span style="color: #a52a2a;">;</span>
  shards.<span style="color: #a52a2a;">(</span>4<span style="color: #a52a2a;">)</span> <span style="color: #a52a2a;">&lt;-</span> <span style="color: #000000; background-color: #ffffff;">None</span><span style="color: #a52a2a;">;</span>

  <span style="color: #b22222;">(* </span><span style="color: #b22222;">Try to reconstruct missing shards </span><span style="color: #b22222;">*)</span>
  <span style="color: #228b22;">ReedSolomon.</span>reconstruct_opt_str r shards<span style="color: #a52a2a;">;</span>

  <span style="color: #b22222;">(* </span><span style="color: #b22222;">Convert back to normal shard arrangement </span><span style="color: #b22222;">*)</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">result</span> <span style="color: #a52a2a;">=</span> <span style="color: #228b22;">RS_Shard_utils.</span>option_shards_to_shards_str shards <span style="color: #000000; font-weight: bold;">in</span>

  <span style="color: #a020f0;">assert</span> <span style="color: #a52a2a;">(</span><span style="color: #228b22;">ReedSolomon.</span>verify_str r result<span style="color: #a52a2a;">);</span>
  <span style="color: #a020f0;">assert</span> <span style="color: #a52a2a;">(</span>master_copy <span style="color: #a52a2a;">=</span> result<span style="color: #a52a2a;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdcee5bf" class="outline-4">
<h4 id="orgdcee5bf">Performance</h4>
<div class="outline-text-4" id="text-orgdcee5bf">
<p>
The encoding performance is shown below
</p>

<p>
Machine : laptop with <code>Intel(R) Core(TM) i5-3337U CPU @ 1.80GHz (max 2.70GHz) 2 Cores 4 Threads</code>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Configuration</th>
<th scope="col" class="org-left">Klaus Post's</th>
<th scope="col" class="org-left">reed-solomon-erasure (Rust)</th>
<th scope="col" class="org-left">ocaml-reed-solomon-erasure (bigstr)</th>
<th scope="col" class="org-left">&#x2026; (bytes)</th>
<th scope="col" class="org-left">&#x2026; (str)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">10x2x1M</td>
<td class="org-left">~7800MB/s</td>
<td class="org-left">~4800MB/s</td>
<td class="org-left">~3200MB/s</td>
<td class="org-left">~1500MB/s</td>
<td class="org-left">~1500MB/s</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgd39bef7" class="outline-4">
<h4 id="orgd39bef7">Links :</h4>
<div class="outline-text-4" id="text-orgd39bef7">
<ul class="org-ul">
<li>Documentation
<ul class="org-ul">
<li><a href="https://darrenldl.gitlab.io/ocaml-reed-solomon-erasure/">https://darrenldl.gitlab.io/ocaml-reed-solomon-erasure/</a></li>
</ul></li>
<li>OPAM
<ul class="org-ul">
<li><a href="http://opam.ocaml.org/packages/reed-solomon-erasure/">http://opam.ocaml.org/packages/reed-solomon-erasure/</a></li>
</ul></li>
<li>Repo
<ul class="org-ul">
<li><a href="https://gitlab.com/darrenldl/ocaml-reed-solomon-erasure">https://gitlab.com/darrenldl/ocaml-reed-solomon-erasure</a></li>
</ul></li>
<li>Archived GitHub repo (for those who keep track of things by stars)
<ul class="org-ul">
<li><a href="https://github.com/darrenldl/ocaml-reed-solomon-erasure">https://github.com/darrenldl/ocaml-reed-solomon-erasure</a></li>
</ul></li>
</ul>




<hr />
</div>
</div>
</div>
</div>

<div id="outline-container-orgec2ea7c" class="outline-2">
<h2 id="6"><a id="orgec2ea7c"></a>Pull requests to OCaml now being linted</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/pull-requests-to-ocaml-now-being-linted/2221/1">https://discuss.ocaml.org/t/pull-requests-to-ocaml-now-being-linted/2221/1</a>
</p>
</div>

<div id="outline-container-org562e2f2" class="outline-3">
<h3 id="org562e2f2">David Allsopp announced</h3>
<div class="outline-text-3" id="text-org562e2f2">
<p>
<a href="https://github.com/ocaml/ocaml/pull/1148">OCaml GPR#1148</a> has been merged this
weekend. Contrary to the title of this PR, the most relevant thing for
contributors to the compiler itself is that pull requests are now run via our
linting tool which resides in <code>tools/check-typo</code> in the compiler distribution.
It produces output like the following:
</p>

<pre class="example">
./asmcomp/selectgen.ml:798.81: [long-line] line is over 80 columns
./asmcomp/selectgen.ml:1129.81: [long-line] line is over 80 columns
./bytecomp/simplif.ml:419.81: [long-line] line is over 80 columns
./bytecomp/symtable.ml:43.3: [white-at-eol] whitespace at end of line
./bytecomp/symtable.ml:62.3: [white-at-eol] whitespace at end of line
./tools/dumpobj.ml:533.81: [long-line] line is over 80 columns
./typing/includemod.ml:167.48: [white-at-eol] whitespace at end of line
./typing/includemod.ml:168.64: [white-at-eol] whitespace at end of line
./typing/includemod.ml:319.81: [long-line] line is over 80 columns
./utils/misc.ml:180.40: [white-at-eol] whitespace at end of line
./utils/misc.mli:105.7: [white-at-eol] whitespace at end of line
</pre>

<p>
It's necessary for this test to pass (in certain situations it's possible to
override the tests via <code>.gitattributes</code>, but in general this is not permitted).
It's hoped that this won't cause too much pain for our wonderful contributors,
and, to ease development, that GPR includes a Git pre-commit hook which can be
installed to your local Git clone simply by running <code>cp tools/pre-commit-githook
.git/hooks/pre-commit</code> (even on Windows). Once installed, the hook blocks
attempts to commit files which are invalid:
</p>

<pre class="example">
[git:git-precommit] C:\DRA\ocaml&gt;git commit -m "GPR#1148 Changes"
./Changes:108.81: [long-line] line is over 80 columns
</pre>

<p>
If you're in a rush or, perish the thought, there's a bug in the pre-commit
hook, you can always use the <code>--no-verify</code> flag for <code>git commit</code> to skip the
<code>check-type</code> test, but bear in mind that Travis will still test it.
</p>

<p>
Please do report any issues either here, on caml-list or on Mantis.
</p>

<p>
Happy linted compiler hacking!
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-org9506ddc" class="outline-2">
<h2 id="7"><a id="org9506ddc"></a>A proposal for a resource-management model for OCaml</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/a-proposal-for-a-resource-management-model-for-ocaml/1680/22">https://discuss.ocaml.org/t/a-proposal-for-a-resource-management-model-for-ocaml/1680/22</a>
</p>
</div>

<div id="outline-container-org22ce0f2" class="outline-3">
<h3 id="org22ce0f2">Continuing this thread, Guillaume Munch-Maccagnoni announced</h3>
<div class="outline-text-3" id="text-org22ce0f2">
<p>
Interested people can find <a href="http://guillaume.munch.name/files/gallium-25-06-2018.pdf">slides</a> from my talk from Monday at Inria Paris (updated to take feedback into account).
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-orgd62fea1" class="outline-2">
<h2 id="8"><a id="orgd62fea1"></a>What are my options for doing Native OCaml &lt;=&gt; Erlang &lt;=&gt; Browser (js_of_ocaml and/or bucklescript) RPC</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/what-are-my-options-for-doing-native-ocaml-erlang-browser-js-of-ocaml-and-or-bucklescript-rpc/2223/1">https://discuss.ocaml.org/t/what-are-my-options-for-doing-native-ocaml-erlang-browser-js-of-ocaml-and-or-bucklescript-rpc/2223/1</a>
</p>
</div>

<div id="outline-container-org08ee69b" class="outline-3">
<h3 id="org08ee69b">Metin Akat asked</h3>
<div class="outline-text-3" id="text-org08ee69b">
<p>
I've been reading about various ways of doing RPC, though still haven't started testing&#x2026; but I am already quite lost.
</p>

<p>
Here is what I know so far, please correct me for where I'm wrong and other suggestions are very welcome.
</p>

<ol class="org-ol">
<li>gRPC - Currently not available for OCaml, as there is no HTTP2 support</li>
<li>Apache Thrift - seems to be officially supported by Apache, but really doubtful it will work in the browser</li>
<li>piqi - this project seems to be quite silent since 2014. I asked here if it will work in the browser: <a href="https://groups.google.com/forum/#!topic/piqi/yjZA42ZXobc">https://groups.google.com/forum/#!topic/piqi/yjZA42ZXobc</a></li>
<li>Cap'N Proto which <a href="https://capnproto.org/otherlang.html">here</a> only seems to support JS in node.js, so probably it won't work in the browser for OCaml either.</li>
</ol>

<p>
So what would you guys do if you were to implement something like this? 
</p>

<p>
In general, this question can be simplified if we remove the Erlang from the equation&#x2026; but then still, what would you do in order to implement RPC between native and in-browser OCaml of some sort?
</p>
</div>
</div>


<div id="outline-container-org8c5f6b7" class="outline-3">
<h3 id="org8c5f6b7">Bobby Priambodo suggested</h3>
<div class="outline-text-3" id="text-org8c5f6b7">
<p>
Have you taken a look at ocaml-rpc?
</p>

<p>
<a href="https://github.com/mirage/ocaml-rpc">https://github.com/mirage/ocaml-rpc</a>
</p>
</div>
</div>


<div id="outline-container-orgca203cb" class="outline-3">
<h3 id="orgca203cb">Aaron L. Zeng also suggested</h3>
<div class="outline-text-3" id="text-orgca203cb">
<p>
There is also <a href="https://github.com/janestreet/async_rpc_kernel">Async_rpc_kernel</a>
if you are using the Async ecosystem. You can use something like websockets to
provide a transport layer for the async RPC machinery.
</p>




<hr />
</div>
</div>
</div>

<div id="outline-container-orge16b369" class="outline-2">
<h2 id="9"><a id="orge16b369"></a>What would it take to unify the parsetree with the typedtree?</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/what-would-it-take-to-unify-the-parsetree-with-the-typedtree/2225/1">https://discuss.ocaml.org/t/what-would-it-take-to-unify-the-parsetree-with-the-typedtree/2225/1</a>
</p>
</div>

<div id="outline-container-org5c0d6f3" class="outline-3">
<h3 id="org5c0d6f3">Arthur Charguéraud said</h3>
<div class="outline-text-3" id="text-org5c0d6f3">
<p>
I suspect that I'm not the first one to raise this question, but as I could
not find the answer online, so I'll ask it here:
</p>

<p>
<b>What would be the major obstacles to using a single AST
 to represent both the parsetree and the typedtree?</b>
</p>
</div>


<div id="outline-container-orge0cd4fa" class="outline-4">
<h4 id="orge0cd4fa">Why factorize?</h4>
<div class="outline-text-4" id="text-orge0cd4fa">
<p>
Before elaborating on this question, let me explain why I care so much about it.
Improving the code factorization inside the compiler, as useful as it might
be to decrease the cost of maintaining and extending the codebase, is not
what motivates my question. What I care about is the ability to conveniently
write source-to-source program transformations that need to exploit information
about types, and need to be able to rely on fully-qualified paths for identifiers.
</p>

<p>
Given that I need type information, it's natural to start from the typedtree.
Maintaining types during transformation is tremendous effort, plus it's generally
completely useless, since I could re-typecheck the new code. I thus have the option
of rebuilding a typedtree with broken type information, or rebuilding a parsetree.
Rebuilding a parsetree from the typedtree is possible, but is a rather inconvenient
and awkward thing to do when the input is a typedtree. When in a branch I want
to leave the input program "as it was", I just expect to return it unchanged.
Moreover, due to small differences between the typedtree and the parsetree, some
extra work is required for producing valid a parsetree (see typing/untypeast.ml).
</p>

<p>
In summary, it seems that the sensible way to go is to express my program
transformation as a function that takes as input a typedtree with valid types,
and returns a typedtree with dummy type information, and then call the
type-checker again. However, I'm lacking at the moment all the mappers and
ast_helpers on the typedtree data type to help me produce structure. These tools
are provided for the parsetree only. This raises the obvious question: why
wouldn't the parser also produce a typedtree with dummy type information?
This would also help factorizing all the iterators/mappers/ast_helpers/printers
over the two ASTs.
</p>
</div>
</div>

<div id="outline-container-orgb6bcec1" class="outline-4">
<h4 id="orgb6bcec1">How to factorize?</h4>
<div class="outline-text-4" id="text-orgb6bcec1">
<p>
This brings us back to the main question that is the concern of this thread.
At a high level, the parsetree has become pretty much a strict subset of the
typedtree. Imo, it no longer makes much sense to live with such a large amount
of code duplication between the parsetree and the typedtree. Concretely,
what I have in mind is that the typedtree could be used for both, simply
using dummy values for fields of type "typ" and "env" and "path" etc. What
matters is to clearly mark, when manipulating an AST, whether its types are
assigned or missing. (For efficiency of multiple program transformations, one
could also imagine an AST with only part of its type information being invalid.)
</p>

<p>
Over the years, differences between the two AST have been dramatically reduced.
Investigating the files and looking at typing/untypeast.ml, I could spot several
differences, which I think could be handled either by adding a few constructors
in the typedtree without polluting it too much, or in a few cases by requiring
the parser to handle some trivial syntactic sugar. During type-checking:
</p>
<ul class="org-ul">
<li>fun gets encoded using function (not convinced this is for the better;
it seems not very hard for the typechecker to preserve the distinction;
preserving it would certainly help for the writing of program transformations.)</li>
<li>exp_construct has an inherent ambiguity that can only solved during typechecking
(nevertheless the Texp_construct could be used by the parser, and the typechecker
could later refine as Pexp_construct</li>
<li>exception patterns are cleanly separated from other patterns (parser could do it?)</li>
<li>order of arguments in applications involving optional arguments is unclear (?)</li>
</ul>
</div>
</div>

<div id="outline-container-org7f93b4a" class="outline-4">
<h4 id="org7f93b4a">Possible migration steps</h4>
<div class="outline-text-4" id="text-org7f93b4a">
<p>
I do not underestimate the work involved in a major refactoring of the code
base, and the issues associated with code migration of third-party code.
Yet, this cost could be mitigated, by carrying out the migration in several steps:
</p>
<ul class="org-ul">
<li>Define the new (unified) AST, with its iterator, mapper, helper, and printer,
so that it is ready to use for type-aware source-to-source program transformation.
This is certainly the part that involves the most work. But it's the part
that's unavoidable for being able to write type-aware transformations, which
is something that I &#x2014;and I bet others&#x2014; will certainly end up programming.
That said, it would be great that the definition of the "ideal" AST be
the result of an open discusssion with developers of the compiler.</li>
<li>Define a conversion function from and to that new AST to the old parsetree,
so as to allow backward compatibility with ppx transformations. Note that
one direction would be pretty much exactly the code from untypeast.ml.
The other direction could be defined with the help of the functions from the
AST_helper.ml associated with the new AST.</li>
<li>Update the code of the typechecker to take as input values from the new AST.
This involves only very minor and local changes, because the new AST would
be quite close to the current typed AST.</li>
<li>Update the code of the parser to directly produce values in the new AST.
This would also involve relatively minor changes: essentially, we need to
replace the constructors from the old parsetree datatype with calls to
the AST helper functions for the new AST.</li>
</ul>

<p>
At that point, the original parsetree datatype will only need to remain for
backward compatibility with existing ppx code.
</p>

<p>
I would really like the understand what are the obstacles to be expected
to get there.
</p>




<hr />
</div>
</div>
</div>
</div>

<div id="outline-container-org15c4007" class="outline-2">
<h2 id="10"><a id="org15c4007"></a>Ocaml Github Pull Requests</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgfd25f83" class="outline-3">
<h3 id="orgfd25f83">Gabriel Scherer and the editor compiled this list</h3>
<div class="outline-text-3" id="text-orgfd25f83">
<p>
Here is a sneak peek at some potential future features of the Ocaml
compiler, discussed by their implementers in these Github Pull Requests.
</p>

<ul class="org-ul">
<li>Functions to read/write binary representations of numbers (<a href="https://github.com/ocaml/ocaml/pull/1864">https://github.com/ocaml/ocaml/pull/1864</a>)</li>
<li>Remove the C plugins mechanism (<a href="https://github.com/ocaml/ocaml/pull/1867">https://github.com/ocaml/ocaml/pull/1867</a>)</li>
<li>Add paths for built-in types (<a href="https://github.com/ocaml/ocaml/pull/1876">https://github.com/ocaml/ocaml/pull/1876</a>)</li>
</ul>




<hr />
</div>
</div>
</div>

<div id="outline-container-orgf7685a1" class="outline-2">
<h2 id="11"><a id="orgf7685a1"></a>Other OCaml News</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-orged753cd" class="outline-3">
<h3 id="orged753cd">From the ocamlcore planet blog</h3>
<div class="outline-text-3" id="text-orged753cd">
<p>
Here are links from many OCaml blogs aggregated at <a href="http://ocaml.org/community/planet/">OCaml Planet</a>.
</p>

<ul class="org-ul">
<li><a href="http://jobs.github.com/positions/9e8ba450-e72e-11e7-926f-6ce07b7015c8">Full Time: Compiler Engineer at Jane Street in New York &amp; London</a></li>
<li><a href="http://jobs.github.com/positions/0a9333c4-71da-11e0-9ac7-692793c00b45">Full Time: Software Developer (Functional Programming) at Jane Street in New York, NY; London, UK; Hong Kong</a></li>
</ul>




<hr />
</div>
</div>
</div>

<div id="outline-container-orge8a806f" class="outline-2">
<h2 id="orge8a806f">Old CWN</h2>
<div class="outline-text-2" id="text-orge8a806f">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="http://alan.petitepomme.net/cwn/">the archive</a> or the <a href="http://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>
<hr />
<div class="authorname">
<p>
<a href="http://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
