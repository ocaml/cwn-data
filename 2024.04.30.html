<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-04-30 Tue 09:21 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2024.04.23.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2024.05.07.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of April 23 to 30, 2024.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">OCANNL 0.3.1: a from-scratch deep learning (i.e. dense tensor optimization) framework</a></li>
<li><a href="#2">I roughly translated Real World OCaml's Async concurrency chapter to eio</a></li>
<li><a href="#3">Using Property-Based Testing to Test OCaml 5</a></li>
<li><a href="#4">OCaml Backtraces on Uncaught Exceptions, by OCamlPro</a></li>
<li><a href="#5">OCaml Users on Windows: Please share your insights on our user survey</a></li>
<li><a href="#6">Graphql_jsoo_client 0.1.0 - library for GraphQL clients using WebSockts</a></li>
<li><a href="#7">dream-html 3.0.0</a></li>
<li><a href="#8">DkCoder 0.2 - Scripting in OCaml</a></li>
<li><a href="#9">Ocaml-protoc-plugin 6.1.0</a></li>
<li><a href="#10">Other OCaml News</a></li>
<li><a href="#org85d9b05">Old CWN</a></li>
</ul>
</div>
</div>
<div id="outline-container-1" class="outline-2">
<h2 id="1">OCANNL 0.3.1: a from-scratch deep learning (i.e. dense tensor optimization) framework</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocannl-0-3-1-a-from-scratch-deep-learning-i-e-dense-tensor-optimization-framework/14492/8">https://discuss.ocaml.org/t/ann-ocannl-0-3-1-a-from-scratch-deep-learning-i-e-dense-tensor-optimization-framework/14492/8</a>
</p>
</div>
<div id="outline-container-org0997c74" class="outline-3">
<h3 id="org0997c74">Lukasz Stafiniak announced</h3>
<div class="outline-text-3" id="text-org0997c74">
<p>
Third time the charm. OCANNL 0.3.3 is out now. I might need to change the name of the project, because of the lint warnings: Possible
name collision with packages 'OCADml',  'ocal',  'ocaml'?
</p>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="2">I roughly translated Real World OCaml's Async concurrency chapter to eio</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/i-roughly-translated-real-world-ocamls-async-concurrency-chapter-to-eio/14548/1">https://discuss.ocaml.org/t/i-roughly-translated-real-world-ocamls-async-concurrency-chapter-to-eio/14548/1</a>
</p>
</div>
<div id="outline-container-org3f0b056" class="outline-3">
<h3 id="org3f0b056">Dennis Dang announced</h3>
<div class="outline-text-3" id="text-org3f0b056">
<p>
Repo at <a href="https://github.com/dangdennis/rwo-eio/blob/main/lib/rwo_eio.ml">https://github.com/dangdennis/rwo-eio/blob/main/lib/rwo_eio.ml</a>
</p>

<p>
I was inspired by Taride's <a href="https://github.com/tarides/hackocaml/issues/9">Make an Eio version of the Async examples in Real World
OCaml</a> to translate the Async examples to eio to test out eio's concurrency story.
Warning, it's a rough translation. I hardly know OCaml and eio as well as I know my day-job languages :smile: .
</p>

<p>
There are still a few examples I haven't figured out.
</p>
<ol class="org-ol">
<li>I don't know how to implement <a href="https://github.com/dangdennis/rwo-eio/blob/a666d8aaaed0884218d706f94b6babeed85debea/lib/rwo_eio.ml#L88"><code>copy_blocks</code></a>. In  <a href="https://dev.realworldocaml.org/concurrent-programming.html">this section</a>, the example uses an intermediate buffer of some sorts to then copy from reader to writer. For now, I've left that intermediate buffer out.</li>
<li>I can't find an <code>interrupt</code> option in <code>cohttp-eio</code> as well as <code>choice</code> and <code>choose</code>. The book explains that cohttp-async can cancel http requests via an <code>interrupt</code> (<a href="https://dev.realworldocaml.org/concurrent-programming.html">see section</a>).</li>
<li>For <a href="https://github.com/dangdennis/rwo-eio/blob/a666d8aaaed0884218d706f94b6babeed85debea/lib/rwo_eio.ml#L348"><code>log_delays</code></a>, I have yet to solve how to await my own <code>every</code> ticker such that I can await its completion and then log the timer at the end.</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="3">Using Property-Based Testing to Test OCaml 5</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/blog-using-property-based-testing-to-test-ocaml-5/14550/1">https://discuss.ocaml.org/t/blog-using-property-based-testing-to-test-ocaml-5/14550/1</a>
</p>
</div>
<div id="outline-container-org782e9ea" class="outline-3">
<h3 id="org782e9ea">Jan Midtgaard announced</h3>
<div class="outline-text-3" id="text-org782e9ea">
<p>
Here's a blog post about how we have been using property-based testing to test OCaml 5:
<a href="https://tarides.com/blog/2024-04-24-under-the-hood-developing-multicore-property-based-tests-for-ocaml-5/">https://tarides.com/blog/2024-04-24-under-the-hood-developing-multicore-property-based-tests-for-ocaml-5/</a>
</p>
</div>
</div>
</div>
<div id="outline-container-4" class="outline-2">
<h2 id="4">OCaml Backtraces on Uncaught Exceptions, by OCamlPro</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/blog-ocaml-backtraces-on-uncaught-exceptions-by-ocamlpro/14551/1">https://discuss.ocaml.org/t/blog-ocaml-backtraces-on-uncaught-exceptions-by-ocamlpro/14551/1</a>
</p>
</div>
<div id="outline-container-orgb9af0e6" class="outline-3">
<h3 id="orgb9af0e6">OCamlPro announced</h3>
<div class="outline-text-3" id="text-orgb9af0e6">
<p>
Here's another one of our heads up about our latest blog release!
</p>

<p>
Today's topic is about an unintentionally hidden feature of the OCaml dev
environmment: <a href="https://ocamlpro.com/blog/2024_04_25_ocaml_backtraces_on_uncaught_exceptions/">backtraces on uncaught exception</a>! 
</p>

<p>
We believe this will be old news to the veteran OCaml devs but could be of much
use to the newer Cameleers out there!
</p>

<p>
Hopefully, you will learn a thing or two from reading this short article, we welcome all feedback in this very thread, thank you for
reading!
</p>
</div>
</div>
</div>
<div id="outline-container-5" class="outline-2">
<h2 id="5">OCaml Users on Windows: Please share your insights on our user survey</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-users-on-windows-please-share-your-insights-on-our-user-survey/14554/1">https://discuss.ocaml.org/t/ocaml-users-on-windows-please-share-your-insights-on-our-user-survey/14554/1</a>
</p>
</div>
<div id="outline-container-org8631d6b" class="outline-3">
<h3 id="org8631d6b">Sudha Parimala announced</h3>
<div class="outline-text-3" id="text-org8631d6b">
<p>
Do you use OCaml on Windows? We want to hear from you! Participate in our user survey to share your experiences with the OCaml
development environment on Windows. Your feedback is important in helping us understand the current pain points and identify areas
for improvement. Whether you're a seasoned OCaml developer or just starting out, your input can make a significant difference.
</p>

<p>
Please sign up here <a href="https://forms.gle/SxRvNaEZXgedxrnR9">https://forms.gle/SxRvNaEZXgedxrnR9</a>, and we'll reach out to you.
</p>
</div>
</div>
</div>
<div id="outline-container-6" class="outline-2">
<h2 id="6">Graphql_jsoo_client 0.1.0 - library for GraphQL clients using WebSockts</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/graphql-jsoo-client-0-1-0-library-for-graphql-clients-using-websockts/14557/1">https://discuss.ocaml.org/t/graphql-jsoo-client-0-1-0-library-for-graphql-clients-using-websockts/14557/1</a>
</p>
</div>
<div id="outline-container-orgd347119" class="outline-3">
<h3 id="orgd347119">Hans Ole Rafaelsen announced</h3>
<div class="outline-text-3" id="text-orgd347119">
<p>
I'm glad to announce the release of graphql_jsoo_client.
</p>

<p>
This is the client side implementation of the <a href="https://github.com/enisdenjo/graphql-ws/blob/master/PROTOCOL.md">GraphQL over WebSocket
Protocol</a>. It is mainly intended for use with Dream, which
implements the server side. This library supports writing client code in Ocaml, that will run in the browser.
</p>

<p>
It can be found <a href="https://github.com/hansole/graphql_jsoo_client">here</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-7" class="outline-2">
<h2 id="7">dream-html 3.0.0</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-dream-html-3-0-0/14013/8">https://discuss.ocaml.org/t/ann-dream-html-3-0-0/14013/8</a>
</p>
</div>
<div id="outline-container-org0350132" class="outline-3">
<h3 id="org0350132">Yawar Amin announced</h3>
<div class="outline-text-3" id="text-org0350132">
<p>
[ANN] dream-html 3.4.1
</p>

<p>
Add 'livereload' support ie automatically reloading the page in the browser when the Dream server restarts. Useful to run with dune's
watch mode for a fast dev cycle.
</p>

<p>
This is adapted from Dream's own livereload middleware but with a slightly different approach. Full details in the module
documentation: <a href="https://yawaramin.github.io/dream-html/dream-html/Dream_html/Livereload/">https://yawaramin.github.io/dream-html/dream-html/Dream_html/Livereload/</a>
</p>

<p>
Why reimplement this? It seems that Dream's built-in livereload needs to parse the HTML markup, find its <code>head</code> tag, and dynamically
inject the reloader <code>script</code> inside. Since parsing HTML can be pretty tricky and potentially buggy, I decided to manually add the
script in the <code>head</code> tag as a strong-typed dream-html <code>node</code>:
</p>

<pre class="example" id="org0d37603">
head [] [
  ...
  Livereload.script;
  ...
]
</pre>
</div>
</div>
</div>
<div id="outline-container-8" class="outline-2">
<h2 id="8">DkCoder 0.2 - Scripting in OCaml</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/dkcoder-0-2-scripting-in-ocaml/14560/1">https://discuss.ocaml.org/t/dkcoder-0-2-scripting-in-ocaml/14560/1</a>
</p>
</div>
<div id="outline-container-org79c324d" class="outline-3">
<h3 id="org79c324d">jbeckford announced</h3>
<div class="outline-text-3" id="text-org79c324d">
<p>
I'm happy to announce the second release of DkCoder, an OCaml scripting tool.
</p>

<p>
The first release was about <i>install ease</i>: a couple clicks and four (4) minutes later you and your Windows and macOS users can start
scripting. All users, including glibc-based Linux desktop users, can also use their Unix shells or Windows PowerShell. OCaml does
<b>not</b> need to be pre-installed. Just copy and paste two lines (you'll see some in this post) and your script is running and your
project is editable with OCaml LSP.
</p>

<p>
This second release is about <i>technical ease</i>. The three "big" ideas in this release are:
</p>

<ul class="org-ul">
<li>You don't write build files. If that sounds like <code>/bin/sh</code> that is intentional.</li>
<li>Almost every OCaml file is a script you can run. If that sounds like how Python scripts are almost indistinguishable from Python modules, that is intentional.</li>
<li>Almost every OCaml file can be referenced with a fully-qualified name. If that sounds like Java packages that is intentional.</li>
</ul>

<p>
Here are some examples:
</p>

<ol class="org-ol">
<li><p>
(<b>one of my own scripts</b>) The incomplete but growing DkCoder documentation is written in a script: <a href="https://diskuv.com/dksdk/coder/2024-intro-scripting/">https://diskuv.com/dksdk/coder/2024-intro-scripting/</a>. <i>The documentation is a side-effect of running tests.</i>
</p>

<p>
In a Unix shell or in PowerShell, the following will a) run tests using <a href="https://v3.ocaml.org/p/tezt/latest">tezt</a>, b) collect outputs, c) generate HTML documentation, and then d) serve the doc page on a <a href="https://v3.ocaml.org/p/tiny_httpd/latest">tiny_httpd</a> webserver for a quick preview:
</p>

<div class="org-src-container">
<pre class="src src-shell">git clone --branch V0_2 https://gitlab.com/diskuv/samples/dkcoder/DkHelloScript.git

./DkHelloScript/dk DkRun_V0_2.Run -- DkHelloScript_Std.Y33Article --serve
</pre>
</div>

<p>
The following will print mixed Markdown/HTML that I can render and publish with a static site generator to a website:
</p>

<div class="org-src-container">
<pre class="src src-shell">./DkHelloScript/dk DkRun_V0_2.Run -- DkHelloScript_Std.Y33Article --doc --doc-format markdown
</pre>
</div></li>

<li><p>
(<b>someone else's</b>) The Bogue demo game Snoke written by @sanette was "ported" to DkCoder. <i>The port did not change a single line of the original code</i>. I did re-arrange the directory structure (recall that there is a Java-like package mechanism underneath DkCoder) and I did add an extra <code>.ml</code> file. Run:
</p>

<div class="org-src-container">
<pre class="src src-shell">git clone --branch V0_2 https://gitlab.com/diskuv/samples/dkcoder/SanetteBogue.git

./SanetteBogue/dk DkRun_V0_2.Run -- SanetteBogue_Snoke.Snoke
</pre>
</div></li>
</ol>

<p>
The remaining items for DkCoder before a 1.x release: auto-downloading remote libraries (mostly done), meta/codegen tools (in
progress), conditional compilation (in design), and a security policy (in design).
</p>

<p>
But right now DkCoder is at a reasonable enough point that I can now recommend using it for your own scripts. With the usual caveats
that this is a 0.x release.
</p>

<p>
<i>I'd like some feedback, especially on pain points and missing must-have features.</i>
</p>
</div>
<div id="outline-container-orgc20072d" class="outline-4">
<h4 id="orgc20072d">Tech Details (if interested)</h4>
<div class="outline-text-4" id="text-orgc20072d">
<p>
Very simplistically, DkCoder is a high-level build system that transparently manages lower-level build systems (today that is Dune).
I think (?) DkCoder is the first build system to use <a href="https://discuss.ocaml.org/t/local-open-seems-to-confuse-dunes-dependency-cycle-detector/9529/2?u=jbeckford">the <code>codept</code> OCaml dependency
analyzer</a>. Huge huge
thanks to @octachron for that tool.
</p>

<p>
The rather boring driver pipeline is:
</p>

<ol class="org-ol">
<li>Seed a "universe" of modules with the single <code>.ml</code> file the user wants to run from the <code>./dk</code> CLI, or seed with all the <code>.ml</code> files if run through OCaml LSP.</li>
<li>Let <code>codept</code> analyse any module references inside the current universe. Any <b>missing modules</b> are located and added to the universe. Rinse and repeat until there is a closed universe with no more missing module references.</li>
<li>Generate and/or incrementally update the build files. Each <code>.ml</code> file is mapped to a single OCaml <code>.cma</code> library.</li>
<li>Run the chosen build tool (ie. Dune) and execute the code.</li>
</ol>

<p>
What does that pipeline give us? Even in this early 0.2 release you get some unusual benefits:
</p>

<ul class="org-ul">
<li>Step 2: The <b>missing modules</b> can be created implicitly. The Snoke game has font, image and sound assets. By using <code>Tr1Assets.LocalDir</code> in the code DkCoder automatically creates a module that has all the assets (think <a href="https://v3.ocaml.org/p/crunch/latest">ocaml-crunch</a>). If a script does not need the assets, the <code>codept</code> analysis knows it doesn't use <code>Tr1Assets</code>, and the assets won't waste time getting built.</li>
<li>Step 3: The <b>one-to-one .ml/.cma correspondence</b> means DkCoder can apply a unique set of compiler flags to each <code>.ml</code> file. You get the Java-like package structure by opening a unique set of modules per <code>.ml</code> with <code>-open</code> flags (nit: I also used implicitly created directory modules to let you navigate the packages in your source code).</li>
<li>Step 4: You can take the generated <code>dune-project</code> and <code>dune</code> files, tweak them and run them outside of DkCoder. <i>That means you are not locked into DkCoder!</i> You can alternatively do what I did with Snoke: make your project compatible with both regular dune (/ocamlbuild/etc.) and DkCoder. Either way, you only need to deal with two issues that arise from DkCoder's bytecode compilation and prebuilt C libraries: a) build C dependencies yourself, and b) tell Dune to switch from bytecode mode to native code mode. If you are a mildly experienced Linux/OCaml user who understands the terms "opam", "pkg-config", "depexts", and "dune-configurator", this is a low bar.</li>
</ul>

<p>
Script references:
</p>
<ul class="org-ul">
<li><a href="https://gitlab.com/diskuv/samples/dkcoder/DkHelloScript.git">https://gitlab.com/diskuv/samples/dkcoder/DkHelloScript.git</a></li>
<li><a href="https://gitlab.com/diskuv/samples/dkcoder/SanetteBogue.git">https://gitlab.com/diskuv/samples/dkcoder/SanetteBogue.git</a></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-9" class="outline-2">
<h2 id="9">Ocaml-protoc-plugin 6.1.0</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocaml-protoc-plugin-6-1-0/14566/1">https://discuss.ocaml.org/t/ann-ocaml-protoc-plugin-6-1-0/14566/1</a>
</p>
</div>
<div id="outline-container-org38f853a" class="outline-3">
<h3 id="org38f853a">Anders Fugmann announced</h3>
<div class="outline-text-3" id="text-org38f853a">
<p>
I'm happy to announce the release of <a href="https://github.com/andersfugmann/ocaml-protoc-plugin">Ocaml-protoc-plugin</a> version 6.1.0
Ocaml-protoc-pluginis a plugin for google's protobuf compiler (<code>protoc</code>)  that generates an idomatic ocaml mapping and
(de-)serialization functions based on .proto files. The library aims to be 100% compliant implementation of the protobuf
specification.
</p>

<p>
The 6.1.0 (and 6.0.0) release introduces Json serialization and deserialization based on protobuffers guidelines and the ability to
copy comments from .proto into ocaml generated code for improved documentation as well as numerous bug fixes and other improvements. 
</p>

<p>
<b>Full changelog since release 5.0.0</b>
</p>
</div>
<div id="outline-container-org26331a9" class="outline-4">
<h4 id="org26331a9">6.1.0: 2024-04-25</h4>
<div class="outline-text-4" id="text-org26331a9">
<ul class="org-ul">
<li>Fix name resolution leading to wrongly mapped names</li>
<li>Fix codegen bug causing the plugin to reject valid protobuf</li>
<li>Add preliminary support for melange though disabling eager
evaluation of serialize and deserialize functions when not using
native or bytecode backends</li>
<li>Fix missing cflags when compiling test c stub</li>
<li>Make Map tests compatible with older versions of protoc</li>
<li>Fix negative integer test failues due to a bug in older versions of protobuf (google) c lib</li>
</ul>
</div>
</div>
<div id="outline-container-org7a8c7d0" class="outline-4">
<h4 id="org7a8c7d0">6.0.0: 2024-04-13</h4>
<div class="outline-text-4" id="text-org7a8c7d0">
</div>
<ul class="org-ul">
<li><a id="org344e2a3"></a>New features<br />
<div class="outline-text-5" id="text-org344e2a3">
<ul class="org-ul">
<li>Implement json serialization and deserialization (#5)</li>
<li>Support special json mapping for google types (#9)</li>
<li>Add deprecation annotations for deprecated fields, services etc (#8)</li>
<li>Add option to prefix generated files with their package name</li>
<li>Copy documentation from proto files into generated ocaml bindings</li>
</ul>
</div>
</li>
<li><a id="orgec90b0c"></a>Bug fixes<br />
<div class="outline-text-5" id="text-orgec90b0c">
<ul class="org-ul">
<li>Fix file output name if files contains a '-'</li>
<li>Resolve bug for Request/Response module aliases leading to generating uncompilable code. (#21)</li>
<li>Fix codegen bug for messages without fields and setting singleton_records = true (#20)</li>
<li>In Services, the package field is now correctly set to None if the service if not defined in a package scope (#24)</li>
</ul>
</div>
</li>
<li><a id="org143954b"></a>Misc changes<br />
<div class="outline-text-5" id="text-org143954b">
<ul class="org-ul">
<li>Unify serialization and deserialization spec and optimize oneof handling</li>
<li>Simplify types used in code generation to improve readaility</li>
<li>*Replace <code>val name': unit -&gt; string</code> with <code>val name: unit -&gt; string</code> which will only return the full protobuf name</li>
<li>Optimize merge functions by applying eager evaluation</li>
<li>Change signature of <code>to_proto'</code> to return unit and not a writer</li>
</ul>

<p>
(<code>*</code> indicates breaking change)
</p>
</div>
</li>
<li><a id="orge5a3dc4"></a>Notes<br />
<div class="outline-text-5" id="text-orge5a3dc4">
<p>
<code>Message.name': unit -&gt; string</code> has been renamed to <code>Message.name:
  unit -&gt; string</code>, and is now contains the fully qualified protobuf
message name. Before the name was the ocaml module name of the
message.
</p>

<p>
<code>Service.Message</code> signature has been deprecated and replaced with
<code>Spec.Message</code> signature. <code>Service.Message</code> is now an alias for
<code>Spec.Message</code> and will be removed in future releases.
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-10" class="outline-2">
<h2 id="10">Other OCaml News</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-org855fd4d" class="outline-3">
<h3 id="org855fd4d">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-org855fd4d">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://ocamlpro.com/blog/2024_04_25_ocaml_backtraces_on_uncaught_exceptions">OCaml Backtraces on Uncaught Exceptions</a></li>
<li><a href="https://tarides.com/blog/2024-04-24-under-the-hood-developing-multicore-property-based-tests-for-ocaml-5">Under the Hood: Developing Multicore Property-Based Tests for OCaml 5</a></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org85d9b05" class="outline-2">
<h2 id="org85d9b05">Old CWN</h2>
<div class="outline-text-2" id="text-org85d9b05">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe to the <a href="https://sympa.inria.fr/sympa/info/caml-list">caml-list</a>.
</p>

<div class="authorname" id="org0b23940">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
