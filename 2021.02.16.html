<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-16 Tue 14:50 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2021.02.09.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2021.02.23.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of February 09 to 16, 2021.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">opam 2.0.8 release</a></li>
<li><a href="#2">opam 2.1.0~beta4</a></li>
<li><a href="#3">Set up OCaml 1.1.6</a></li>
<li><a href="#4">Set up OCaml 1.1.7</a></li>
<li><a href="#org7ae4fc7">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-org874e3b7" class="outline-2">
<h2 id="1">opam 2.0.8 release</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-opam-2-0-8-release/7242/1">https://discuss.ocaml.org/t/ann-opam-2-0-8-release/7242/1</a>
</p>
</div>

<div id="outline-container-org6498534" class="outline-3">
<h3 id="org6498534">R. Boujbel announced</h3>
<div class="outline-text-3" id="text-org6498534">
<p>
We are pleased to announce the minor release of <a href="https://github.com/ocaml/opam/releases/tag/2.0.8">opam 2.0.8</a>.
</p>

<p>
This new version contains some fixes, mainly for sandbox and fish scripts. You can find more information in this
<a href="https://opam.ocaml.org/blog/opam-2-0-8">blog post</a>, and more detailed in the <a href="https://github.com/ocaml/opam/releases/tag/2.0.8">release
note</a>.
</p>

<p>
<i>opam is a source-based package manager for OCaml. It supports multiple simultaneous compiler installations, flexible package constraints, and a Git-friendly development workflow.</i>
</p>
</div>
</div>
</div>




<div id="outline-container-org8ce6ca0" class="outline-2">
<h2 id="2">opam 2.1.0~beta4</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-opam-2-1-0-beta4/7252/1">https://discuss.ocaml.org/t/ann-opam-2-1-0-beta4/7252/1</a>
</p>
</div>

<div id="outline-container-org96372d9" class="outline-3">
<h3 id="org96372d9">David Allsopp announced</h3>
<div class="outline-text-3" id="text-org96372d9">
<p>
On behalf of the opam team, it gives me great pleasure to announce the third beta release of opam 2.1. Don’t worry,
you didn’t miss beta3 - we had an issue with a configure script that caused beta2 to report as beta3 in some
instances, so we skipped to beta4 to avoid any further confusion!
</p>

<p>
We encourage you to try out this new beta release: there are instructions for doing so in <a href="https://github.com/ocaml/opam/wiki/How-to-test-an-opam-feature">our
wiki</a>. The instructions include taking a backup of
your <code>~/.opam</code> root as part of the process, which can be restored in order to wind back. <span class="underline">Please note that local
switches which are written to by opam 2.1 are upgraded and will need to be rebuilt if you go back to opam 2.0</span>. This
can either be done by removing <code>_opam</code> and repeating whatever you use in your build process to create the switch, or
you can use <code>opam switch export switch.export</code> to backup the switch to a file before installing new packages. Note
that opam 2.1 <span class="underline">shouldn’t</span> upgrade a local switch unless you upgrade the base packages (i.e. the compiler).
</p>
</div>

<div id="outline-container-orgeb2ae47" class="outline-4">
<h4 id="orgeb2ae47">What’s new in opam 2.1?</h4>
<div class="outline-text-4" id="text-orgeb2ae47">
<ul class="org-ul">
<li>Switch invariants</li>
<li>Improved options configuration (see the new <code>option</code> and expanded <code>var</code> sub-commands)</li>
<li>Integration of system dependencies (formerly the opam-depext plugin), increasing their reliability as it integrates the solving step</li>
<li>Creation of lock files for reproducible installations (formerly the opam-lock plugin)</li>
<li>CLI versioning, allowing cleaner deprecations for opam now and also improvements to semantics in future without breaking backwards-compatibility</li>
<li>Performance improvements to opam-update, conflict messages, and many other areas</li>
<li>New plugins: opam-compiler and opam-monorepo</li>
</ul>
</div>

<div id="outline-container-orgcc2924b" class="outline-5">
<h5 id="orgcc2924b">Switch invariants</h5>
<div class="outline-text-5" id="text-orgcc2924b">
<p>
In opam 2.0, when a switch is created the packages selected are put into the “base” of the switch. These packages are
not normally considered for upgrade, in order to ease pressure on opam’s solver. This was a much bigger concern early
on in opam 2.0’s development, but is less of a problem with the default mccs solver.
</p>

<p>
However, it’s a problem for system compilers. opam would detect that your system compiler version had changed, but be
unable to upgrade the ocaml-system package unless you went through a slightly convoluted process with
<code>--unlock-base</code>.
</p>

<p>
In opam 2.1, base packages have been replaced by switch invariants. The switch invariant is a package formula which
must be satisfied on every upgrade and install. All existing switches’ base packages could just be expressed as
<code>package1 &amp; package2 &amp; package3</code> etc. but opam 2.1 recognises many existing patterns and simplifies them, so in most
cases the invariant will be <code>"ocaml-base-compiler" {= 4.11.1}</code>, etc. This means that <code>opam switch create my_switch
ocaml-system</code> now creates a <span class="underline">switch invariant</span> of <code>"ocaml-system"</code> rather than a specific version of the
<code>ocaml-system</code> package. If your system OCaml package is updated, <code>opam upgrade</code> will seamlessly switch to the new
package.
</p>

<p>
This also allows you to have switches which automatically install new point releases of OCaml. For example:
</p>

<pre class="example">
opam switch create ocaml-4.11 --formula='"ocaml-base-compiler" {&gt;= "4.11.0" &amp; &lt; "4.12.0~"}'
--repos=old=git+https://github.com/ocaml/opam-repository#a11299d81591
opam install utop
</pre>

<p>
Creates a switch with OCaml 4.11.0 (the <code>--repos=</code> was just to select a version of opam-repository from before 4.11.1
was released). Now issue:
</p>

<pre class="example">
opam repo set-url old git+https://github.com/ocaml/opam-repository
opam upgrade
</pre>

<p>
and opam 2.1 will automatically offer to upgrade OCaml 4.11.1 along with a rebuild of the switch. There’s not yet a
clean CLI for specifying the formula, but we intend to iterate further on this with future opam releases so that
there is an easier way of saying “install OCaml 4.11.x”.
</p>
</div>
</div>

<div id="outline-container-org57adaa7" class="outline-5">
<h5 id="org57adaa7">opam depext integration</h5>
<div class="outline-text-5" id="text-org57adaa7">
<p>
opam has long included the ability to install system dependencies automatically via the <a href="https://github.com/ocaml-opam/opam-depext">depext
plugin</a>. This plugin has been promoted to a native feature of opam 2.1.0
onwards, giving the following benefits:
</p>

<ul class="org-ul">
<li>You no longer have to remember to run <code>opam depext</code>, opam always checks depexts (there are options to disable this or automate it for CI use). Installation of an opam package in a CI system is now as easy as <code>opam install .</code>, without having to do the dance of <code>opam pin add -n/depext/install</code>. Just one command now for the common case!</li>
<li>The solver is only called once, which both saves time and also stabilises the behaviour of opam in cases where the solver result is not stable. It was possible to get one package solution for the <code>opam depext</code> stage and a different solution for the <code>opam install</code> stage, resulting in some depexts missing.</li>
<li>opam now has full knowledge of depexts, which means that packages can be automatically selected based on whether a system package is already installed. For example, if you have <b>neither</b> MariaDB nor MySQL dev libraries installed, <code>opam install mysql</code> will offer to install <code>conf-mysql</code> and <code>mysql</code>, but if you have the MariaDB dev libraries installed, opam will offer to install <code>conf-mariadb</code> and <code>mysql</code>.</li>
</ul>
</div>
</div>

<div id="outline-container-orgc51ecda" class="outline-5">
<h5 id="orgc51ecda">opam lock files and reproducibility</h5>
<div class="outline-text-5" id="text-orgc51ecda">
<p>
When opam was first released, it had the mission of gathering together scattered OCaml source code to build a
<a href="https://github.com/ocaml/opam-repository">community repository</a>. As time marches on, the size of the opam repository
has grown tremendously, to over 3000 unique packages with over 18000 unique versions. opam looks at all these
packages and is designed to solve for the best constraints for a given package, so that your project can keep up with
releases of your dependencies.
</p>

<p>
While this works well for libraries, we need a different strategy for projects that need to test and ship using a
fixed set of dependencies. To satisfy this use-case, opam 2.0.0 shipped with support for <span class="underline">using</span>
<code>project.opam.locked</code> files. These are normal opam files but with exact versions of dependencies. The lock file can
be used as simply as <code>opam install . --locked</code> to have a reproducible package installation.
</p>

<p>
With opam 2.1.0, the creation of lock files is also now integrated into the client:
</p>
<ul class="org-ul">
<li><code>opam lock</code> will create a <code>.locked</code> file for your current switch and project, that you can check into the repository.</li>
<li><code>opam switch create . --locked</code> can be used by users to reproduce your dependencies in a fresh switch.</li>
</ul>

<p>
This lets a project simultaneously keep up with the latest dependencies (without lock files) while providing a
stricter set for projects that need it (with lock files).
</p>
</div>
</div>

<div id="outline-container-org930fb79" class="outline-5">
<h5 id="org930fb79">CLI Versioning</h5>
<div class="outline-text-5" id="text-org930fb79">
<p>
A new <code>--cli</code> switch was added to the first beta release, but it’s only now that it’s being widely used. opam is a
complex enough system that sometimes bug fixes need to change the semantics of some commands. For example:
</p>

<ul class="org-ul">
<li><code>opam show --file</code> needed to change behaviour</li>
<li>The addition of new controls for setting global variables means that the <code>opam config</code> was becoming cluttered and some things want to move to <code>opam var</code></li>
<li><code>opam switch create 4.11.1</code> still works in opam 2.0, but it’s really an OPAM 1.2.2 syntax.</li>
</ul>

<p>
Changing the CLI is exceptionally painful since it can break scripts and tools which themselves need to drive <code>opam</code>.
CLI versioning is our attempt to solve this. The feature is inspired by the <code>(lang dune ...)</code> stanza in
<code>dune-project</code> files which has allowed the Dune project to rename variables and alter semantics without requiring
every single package using Dune to upgrade their <code>dune</code> files on each release.
</p>

<p>
Now you can specify which version of opam you expected the command to be run against. In day-to-day use of opam at
the terminal, you wouldn’t specify it, and you’ll get the latest version of the CLI. For example: <code>opam var --global</code>
is the same as <code>opam var --cli=2.1 --global</code>. However, if you issue <code>opam var --cli=2.0 --global</code>, you will told that
<code>--global</code> was added in 2.1 and so is not available to you. You can see similar things with the renaming of <code>opam
upgrade --unlock-base</code> to <code>opam upgrade --update-invariant</code>.
</p>

<p>
The intention is that <code>--cli</code> should be used in scripts, user guides (e.g. blog posts), and in software which calls
opam. The only decision you have to take is the <span class="underline">oldest</span> version of opam which you need to support. If your script is
using a new opam 2.1 feature (for example <code>opam switch create --formula=</code>) then you simply don’t support opam 2.0. If
you need to support opam 2.0, then you can’t use <code>--formula</code> and should use <code>--packages</code> instead. opam 2.0 does not
have the <code>--cli</code> option, so for opam 2.0 instead of <code>--cli=2.0</code> you should set the environment variable <code>OPAMCLI</code> to
<code>2.0</code>. As with <span class="underline">all</span> opam command line switches, <code>OPAMCLI</code> is simply the equivalent of <code>--cli</code> which opam 2.1 will
pick-up but opam 2.0 will quietly ignore (and, as with other options, the command line takes precedence over the
environment).
</p>

<p>
Note that opam 2.1 sets <code>OPAMCLI=2.0</code> when building packages, so on the rare instances where you need to use the
<code>opam</code> command in a <span class="underline">package</span> <code>build:</code> command (or in your build system), you <span class="underline">must</span> specify <code>--cli=2.1</code> if you’re
using new features.
</p>

<p>
There’s even more detail on this feature <a href="https://github.com/ocaml/opam/wiki/Spec-for-opam-CLI-versioning">in our
wiki</a>. We’re still finalising some details on
exactly how <code>opam</code> behaves when <code>--cli</code> is not given, but we’re hoping that this feature will make it much easier in
future releases for opam to make required changes and improvements to the CLI without breaking existing set-ups and
tools.
</p>
</div>
</div>
</div>

<div id="outline-container-org85f43ee" class="outline-4">
<h4 id="org85f43ee">What’s new since the last beta?</h4>
<div class="outline-text-4" id="text-org85f43ee">
<ul class="org-ul">
<li>opam now uses CLI versioning (<a href="https://github.com/ocaml/opam/pull/4385">#4385</a>)</li>
<li>opam now exits with code 31 if all failures were during fetch operations (<a href="https://github.com/ocaml/opam/issues/4214">#4214</a>)</li>
<li><code>opam install</code> now has a <code>--download-only</code> flag (<a href="https://github.com/ocaml/opam/issues/4036">#4036</a>), allowing opam’s caches to be primed</li>
<li><code>opam init</code> now advises the correct shell-specific command for <code>eval $(opam env)</code> (<a href="https://github.com/ocaml/opam/pull/4427">#4427</a>)</li>
<li><code>post-install</code> hooks are now allowed to modify or remove installed files (<a href="https://github.com/ocaml/opam/pull/4388">#4388</a>)</li>
<li>New package variable <code>opamfile-loc</code> with the location of the installed package opam file (<a href="https://github.com/ocaml/opam/pull/4402">#4402</a>)</li>
<li><code>opam update</code> now has <code>--depexts</code> flag (<a href="https://github.com/ocaml/opam/issues/4355">#4355</a>), allowing the system package manager to update too</li>
<li>depext support NetBSD and DragonFlyBSD added (<a href="https://github.com/ocaml/opam/pull/4396">#4396</a>)</li>
<li>The format-preserving opam file printer has been overhauled (<a href="https://github.com/ocaml/opam/issues/3993">#3993</a>, <a href="https://github.com/ocaml/opam/pull/4298">#4298</a> and <a href="https://github.com/ocaml/opam/pull/4302">#4302</a>)</li>
<li>pins are now fetched in parallel (<a href="https://github.com/ocaml/opam/issues/4315">#4315</a>)</li>
<li><code>os-family=ubuntu</code> is now treated as <code>os-family=debian</code> (<a href="https://github.com/ocaml/opam/pull/4441">#4441</a>)</li>
<li><code>opam lint</code> now checks that strings in filtered package formulae are booleans or variables (<a href="https://github.com/ocaml/opam/issues/4439">#4439</a>)</li>
</ul>

<p>
and many other bug fixes as listed <a href="https://github.com/ocaml/opam/releases/tag/2.1.0-beta4">on the release page</a>.
</p>
</div>
</div>

<div id="outline-container-orgd94b025" class="outline-4">
<h4 id="orgd94b025">New Plugins</h4>
<div class="outline-text-4" id="text-orgd94b025">
<p>
Several features that were formerly plugins have been integrated into opam 2.1.0. We have also developed some <span class="underline">new</span>
plugins that satisfy emerging workflows from the community and the core OCaml team. They are available for use with
the opam 2.1 beta as well, and feedback on them should be directed to the respective GitHub trackers for those
plugins.
</p>
</div>

<div id="outline-container-org44f2a22" class="outline-5">
<h5 id="org44f2a22">opam compiler</h5>
<div class="outline-text-5" id="text-org44f2a22">
<p>
The <a href="https://github.com/ocaml-opam/opam-compiler"><code>opam compiler</code></a> plugin can be used to create switches from various
sources such as the main opam repository, the ocaml-multicore fork, or a local development directory. It can use Git
tag names, branch names, or PR numbers to specify what to install.
</p>

<p>
Once installed, these are normal opam switches, and one can install packages in them. To iterate on a compiler
feature and try opam packages at the same time, it supports two ways to reinstall the compiler: either a safe and
slow technique that will reinstall all packages, or a quick way that will just overwrite the compiler in place.
</p>
</div>
</div>

<div id="outline-container-orgd392e28" class="outline-5">
<h5 id="orgd392e28">opam monorepo</h5>
<div class="outline-text-5" id="text-orgd392e28">
<p>
The <a href="https://github.com/ocamllabs/opam-monorepo"><code>opam monorepo</code></a> plugin lets you assemble standalone dune workspaces
with your projects and all of their opam dependencies, letting you build it all from scratch using only Dune and
OCaml. This satisfies the “monorepo” workflow which is commonly requested by large projects that need all of their
dependencies in one place. It is also being used by projects that need global cross-compilation for all aspects of a
codebase (including C stubs in packages), such as the MirageOS unikernel framework.
</p>
</div>
</div>
</div>

<div id="outline-container-org764b943" class="outline-4">
<h4 id="org764b943">Next Steps</h4>
<div class="outline-text-4" id="text-org764b943">
<p>
This is anticipated to be the final beta in the 2.1 series, and we will be moving to release candidate status after
this. We could really use your help with testing this release in your infrastructure and projects and let us know if
you run into any blockers. If you have feature requests, please also report them on <a href="https://github.com/ocaml/opam/issues">our issue
tracker</a> &#x2013; we will be planning the next release cycle once we ship opam 2.1.0
shortly.
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-org7188ce1" class="outline-2">
<h2 id="3">Set up OCaml 1.1.6</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-set-up-ocaml-1-1-6/7276/1">https://discuss.ocaml.org/t/ann-set-up-ocaml-1-1-6/7276/1</a>
</p>
</div>

<div id="outline-container-org9b4c651" class="outline-3">
<h3 id="org9b4c651">Sora Morimoto announced</h3>
<div class="outline-text-3" id="text-org9b4c651">
<p>
This release includes a change to make the OCaml CI workflow on Windows faster!
</p>

<blockquote>
<p>
I tested this on one of my repos where the build itself is mere seconds. Before this change, setup-ocaml needed an
average of 5:39 to install OCaml+opam and 1:53 to build the dependencies of the library. After this change, it
needs an average of 3:15 for the installation and 1:27 for the deps.
</p>
</blockquote>
</div>

<div id="outline-container-orgb514af6" class="outline-4">
<h4 id="orgb514af6">Changed</h4>
<div class="outline-text-4" id="text-orgb514af6">
<ul class="org-ul">
<li>Windows installs Cygwin to <code>D:\cygwin</code>, using faster Azure temporary storage.</li>
</ul>

<p>
<a href="https://github.com/avsm/setup-ocaml/releases/tag/v1.1.6">https://github.com/avsm/setup-ocaml/releases/tag/v1.1.6</a>
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-orgf917a5b" class="outline-2">
<h2 id="4">Set up OCaml 1.1.7</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-set-up-ocaml-1-1-7/7279/1">https://discuss.ocaml.org/t/ann-set-up-ocaml-1-1-7/7279/1</a>
</p>
</div>

<div id="outline-container-org746230a" class="outline-3">
<h3 id="org746230a">Sora Morimoto announced</h3>
<div class="outline-text-3" id="text-org746230a">
</div>
<div id="outline-container-org8f93df2" class="outline-4">
<h4 id="org8f93df2">Changed</h4>
<div class="outline-text-4" id="text-org8f93df2">
<ul class="org-ul">
<li>Ubuntu and macOS runners no longer display "No switch is currently installed." before building the compiler.</li>
<li>Ubuntu no longer installs the system ocaml packages.</li>
<li>macOS no longer builds two compilers on every run.</li>
<li>Upgrade opam to 2.0.8 for Linux VMs.</li>
</ul>

<p>
<a href="https://github.com/avsm/setup-ocaml/releases/tag/v1.1.7">https://github.com/avsm/setup-ocaml/releases/tag/v1.1.7</a>
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-org7ae4fc7" class="outline-2">
<h2 id="org7ae4fc7">Old CWN</h2>
<div class="outline-text-2" id="text-org7ae4fc7">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
