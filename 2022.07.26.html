<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-26 Tue 19:53 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2022.07.19.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2022.08.02.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of July 19 to 26, 2022.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Help w. my first GADT : unwrapping Sqlite3.Data.t</a></li>
<li><a href="#2">DocuLib 3.1.2 and MetaDB 1.0.2 now on OPAM</a></li>
<li><a href="#3">dune 3.4.0</a></li>
<li><a href="#4">OCaml 5.0, first normal alpha release</a></li>
<li><a href="#5">Other OCaml News</a></li>
<li><a href="#orga209748">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Help w. my first GADT : unwrapping Sqlite3.Data.t</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/help-w-my-first-gadt-unwrapping-sqlite3-data-t/10202/1">https://discuss.ocaml.org/t/help-w-my-first-gadt-unwrapping-sqlite3-data-t/10202/1</a>
</p>
</div>

<div id="outline-container-org06688f4" class="outline-3">
<h3 id="org06688f4">Philippe Strauss asked</h3>
<div class="outline-text-3" id="text-org06688f4">
<p>
I would like to convert sqlite3-ocaml returns from Sqlite3.Data.t array to plain ocaml types in a tuple. I guess
unwrapping the Data.t can be done using a GADT, here's my very very first attempt:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #b22222;">(* </span><span style="color: #b22222;">simulate Sqlite3.Data.t</span><span style="color: #b22222;"> *)</span>

<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">t</span> =
| <span style="color: #000000; background-color: #ffffff;">NONE</span>
| <span style="color: #000000; background-color: #ffffff;">NULL</span>
| <span style="color: #000000; background-color: #ffffff;">INT</span> <span style="color: #a020f0;">of</span> int64
| <span style="color: #000000; background-color: #ffffff;">FLOAT</span> <span style="color: #a020f0;">of</span> float
| <span style="color: #000000; background-color: #ffffff;">TEXT</span> <span style="color: #a020f0;">of</span> string
| <span style="color: #000000; background-color: #ffffff;">BLOB</span> <span style="color: #a020f0;">of</span> string <span style="color: #ff4500;">;;</span>

<span style="color: #b22222;">(* </span><span style="color: #b22222;">a simple GADT to unwrap Sqlite3.Data.t</span><span style="color: #b22222;"> *)</span>

<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">_ dbval</span> =
    | <span style="color: #000000; background-color: #ffffff;">INT</span> : int64 -&gt; int64 dbval
    | <span style="color: #000000; background-color: #ffffff;">FLOAT</span> : float -&gt; float dbval
    | <span style="color: #000000; background-color: #ffffff;">TEXT</span> : string -&gt; string dbval
    | <span style="color: #000000; background-color: #ffffff;">BLOB</span> : string -&gt; string dbval
    | <span style="color: #000000; background-color: #ffffff;">NONE</span> | <span style="color: #000000; background-color: #ffffff;">NULL</span> <span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">unwrap_data</span> :<span style="color: #228b22;"> </span><span style="color: #a020f0;">type</span><span style="color: #228b22;"> a. a dbval -&gt; a </span>= <span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">dbval</span> -&gt;
    <span style="color: #a020f0;">match</span> dbval <span style="color: #a020f0;">with</span>
    | <span style="color: #000000; background-color: #ffffff;">INT</span> x -&gt; x
    | <span style="color: #000000; background-color: #ffffff;">FLOAT</span> x -&gt; x
    | <span style="color: #000000; background-color: #ffffff;">TEXT</span> str -&gt; str
    | <span style="color: #000000; background-color: #ffffff;">BLOB</span> str -&gt; str <span style="color: #ff4500;">;;</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">tuple_of_array4</span> (<span style="color: #a0522d;">arr</span>:<span style="color: #228b22;"> t array</span>) =
    <span style="color: #a020f0;">assert</span> (<span style="color: #228b22;">Array.</span>length arr = 4) ;
    (unwrap_data arr.(0), unwrap_data arr.(1), unwrap_data arr.(2), unwrap_data arr.(3)) <span style="color: #ff4500;">;;</span>
</pre>
</div>

<p>
Compilation fails with this typing error:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; background-color: #ffffff;">File</span> <span style="color: #8b2252;">"database.ml"</span>, line 233, characters 17-24:
233 |     (unwrap_data arr.(0), unwrap_data arr.(1), unwrap_data arr.(2), unwrap_data arr.(3)) <span style="color: #ff4500;">;;</span>
                       <span style="color: #a52a2a;">^^^^^^^</span>
<span style="color: #000000; background-color: #ffffff;">Error</span>: <span style="color: #000000; background-color: #ffffff;">This</span> expression has <span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">t</span> but an expression was expected <span style="color: #a020f0;">of</span> <span style="color: #000000; font-weight: bold;">type</span>
         'a dbval
</pre>
</div>

<p>
What am I doing wrong? I need to make type t compatible with type 'a dbval.
Thanks in advance.
</p>
</div>
</div>


<div id="outline-container-org5d426ed" class="outline-3">
<h3 id="org5d426ed">octachron replied</h3>
<div class="outline-text-3" id="text-org5d426ed">
<p>
You cannot make the type <code>t</code> and <code>'a dbval</code> compatible, there are different types.
</p>

<p>
A very important point to keep in mind with GADTs is that one cannot create type-level information from dynamical
values. In other words, there are no functions of type ~ x : t -&gt;  f(x) dbval~that will infer the type of its return
from the value of its argument in OCaml.
</p>

<p>
Thus the type of the final result must come from your code source rather than from the dynamical data.
For instance, you can define constructor from the type <code>t</code> to the right <code>dbval</code> type:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #a020f0;">exception</span> <span style="color: #000000; background-color: #ffffff;">Type_error</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">int</span>:<span style="color: #228b22;"> t -&gt; _ dbval </span>= <span style="color: #a020f0;">function</span>
| <span style="color: #000000; background-color: #ffffff;">INT</span> x -&gt; <span style="color: #000000; background-color: #ffffff;">INT</span> x
| _ -&gt; <span style="color: #483d8b;">raise</span> <span style="color: #000000; background-color: #ffffff;">Type_error</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">float</span>:<span style="color: #228b22;"> t -&gt; _ dbval </span>= <span style="color: #a020f0;">function</span>
| <span style="color: #000000; background-color: #ffffff;">FLOAT</span> x -&gt; <span style="color: #000000; background-color: #ffffff;">FLOAT</span> x
| _ -&gt; <span style="color: #483d8b;">raise</span> Type_error
</pre>
</div>
<p>
Then if you know the type of the tuple, you can write it as:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">tuple_of_array4</span> (<span style="color: #a0522d;">arr</span>:<span style="color: #228b22;"> t array</span>) =
    <span style="color: #a020f0;">assert</span> (<span style="color: #228b22;">Array.</span>length arr = 4) ;
    int arr.(0), int arr.(1), int arr.(2), int arr.(3)
</pre>
</div>
<p>
or possibly as
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">int4</span> = int, int, int, int
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">tuple</span> (<span style="color: #a0522d;">a</span>,<span style="color: #a0522d;">b</span>,<span style="color: #a0522d;">c</span>,<span style="color: #a0522d;">d</span>) <span style="color: #a0522d;">arr</span> =
  <span style="color: #a020f0;">assert</span> (<span style="color: #228b22;">Array.</span>length arr = 4) ;
  a arr.(0), b arr.(1), c arr.(2), d arr.(3)
</pre>
</div>
<p>
There are more complex alternatives based on type witness, that allow to implement a form of static matching over the
dynamical type of data, but the core idea that the types are always present in the source code in some way is the
same.
</p>
</div>
</div>


<div id="outline-container-org94f47d8" class="outline-3">
<h3 id="org94f47d8">Philippe Strauss then said</h3>
<div class="outline-text-3" id="text-org94f47d8">
<p>
Oh I didn't noticed it would be dynamical typing! I'm too used to ppx (and previously camlp4) written db abstraction
layer!
</p>

<p>
I'm simply replacing sqlexpr by plain sqlite3-ocaml in some existing code of mine. sqlexpr quick doco:
</p>

<p>
<a href="https://github.com/mfp/ocaml-sqlexpr">https://github.com/mfp/ocaml-sqlexpr</a>
</p>

<p>
But I can live with a Data.t array!
</p>
</div>
</div>


<div id="outline-container-org7874834" class="outline-3">
<h3 id="org7874834">Yawar Amin then added</h3>
<div class="outline-text-3" id="text-org7874834">
<p>
Everybody has their favourite way of wrapping SQLite. Here's mine (no PPX):
<a href="https://github.com/yawaramin/ocaml_sql_query">https://github.com/yawaramin/ocaml_sql_query</a>
</p>

<p>
It has a little data translation layer to convert from <code>Data.t</code> array to the desired return type.
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">DocuLib 3.1.2 and MetaDB 1.0.2 now on OPAM</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/doculib-3-1-2-and-metadb-1-0-2-now-on-opam/10204/1">https://discuss.ocaml.org/t/doculib-3-1-2-and-metadb-1-0-2-now-on-opam/10204/1</a>
</p>
</div>

<div id="outline-container-org20ecb13" class="outline-3">
<h3 id="org20ecb13">nguermond announced</h3>
<div class="outline-text-3" id="text-org20ecb13">
<p>
I'm pleased to announce the release of <code>doculib</code> and <code>metadb</code>, now available on OPAM.
</p>

<p>
<b>DocuLib</b> is a GUI for document management, particularly for all the textbooks and articles you've accumulated but
know you'll never read :thinking:. The idea of DocuLib is to keep track of metadata of files stored across multiple
libraries on your file system in such a way that you can move, reorganize, or rename a file without losing your
metadata. You can additionally lookup metadata on <code>openlibrary.org</code> or <code>semanticscholar.org</code>. DocuLib will also warn
about missing and duplicate files. Stored metadata presently includes author, title, year, tags, and DOI/ISBN.
</p>


<div id="org67fff7b" class="figure">
<p><img src="https://global.discourse-cdn.com/standard11/uploads/ocaml/original/2X/f/fa064cd32bce6e52722d30047d8e0ef21fa09684.png" alt="fa064cd32bce6e52722d30047d8e0ef21fa09684.png" />
</p>
</div>

<p>
For more screenshots and details: <a href="https://github.com/nguermond/doculib">https://github.com/nguermond/doculib</a>
</p>

<p>
<b>Metadb</b> is the JSON database for manipulating file metadata underlying DocuLib, in hopes that it may be useful
somewhere else. Data is stored in the following way:
</p>
<pre class="example" id="org0076ba6">
path/to/library
|- .metadata
   |- ./foo.txt.json
   |- ./blah/bar.pdf.json
   |- ./foobar.pdf.json
|- ./foo.txt
|- ./blah/bar.pdf
|- ./foobar.pdf
</pre>
<p>
For documentation: <a href="https://github.com/nguermond/metadb">https://github.com/nguermond/metadb</a>
</p>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">dune 3.4.0</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-dune-3-4-0/10211/1">https://discuss.ocaml.org/t/ann-dune-3-4-0/10211/1</a>
</p>
</div>

<div id="outline-container-org08b6e71" class="outline-3">
<h3 id="org08b6e71">Etienne Millon announced</h3>
<div class="outline-text-3" id="text-org08b6e71">
<p>
On behalf of the dune team, I’m pleased to announce the release of version 3.4.0.
</p>

<p>
Bug fixes, a couple new features, better hints and error messages - I won't restate what's in the changelog below.
Thanks to everyone involved in this release!
</p>

<ul class="org-ul">
<li>Make <code>dune describe</code> correctly handle overlapping implementations
for virtual libraries (#5971, fixes #5747, @esope)</li>

<li>Building the <code>@check</code> alias should make sure the libraries and executables
don't have dependency cycles (#5892, @rgrinberg)</li>

<li>[ctypes] Add support for the <code>errno</code> parameter using the <code>errno_policy</code> field
in the ctypes settings. (#5827, @droyo)</li>

<li>Fix <code>dune coq top</code> when it is invoked on files from a subdirectory of the
directory containing the associated stanza (#5784, fixes #5552, @ejgallego,
@rlepigre, @Alizter)</li>

<li>Fix hint when an invalid module name is found. (#5922, fixes #5273, @emillon)</li>

<li>The <code>(cat)</code> action now supports several files. (#5928, fixes #5795, @emillon)</li>

<li>Dune no longer uses shimmed <code>META</code> files for OCaml 5.x, solely using the ones
installed by the compiler. (#5916, @dra27)</li>

<li>Fix handling of the <code>(deps)</code> field in <code>(test)</code> stanzas when there is an
<code>.expected</code> file. (#5952, #5951, fixes #5950, @emillon)</li>

<li>Ignore insignificant filesystem events. This stops RPC in watch mode from
flashing errors on insignificant file system events such as changes in the
<code>.git/</code> directory. (#5953, @rgrinberg)</li>

<li>Fix parsing more error messages emitted by the OCaml compiler. In
particular, messages where the excerpt line number started with a blank
character were skipped. (#5981, @rgrinberg)</li>

<li>env stanza: warn if some rules are ignored because they appear after a
wildcard rule. (#5898, fixes #5886, @emillon)</li>

<li>On Windows, XDG_CACHE_HOME is taken to be the <code>FOLDERID_InternetCache</code> if
unset, and XDG_CONFIG_HOME and XDG_DATA_HOME are both taken to be
<code>FOLDERID_LocalAppData</code> if unset.  (#5943, fixes #5808, @nojb)</li>
</ul>
</div>
</div>


<div id="outline-container-org1d44456" class="outline-3">
<h3 id="org1d44456">Etienne Millon then added</h3>
<div class="outline-text-3" id="text-org1d44456">
<p>
This broke 32-bit cygwin installations, so 3.4.1 was released with a fix.
</p>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">OCaml 5.0, first normal alpha release</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-5-0-first-normal-alpha-release/10216/1">https://discuss.ocaml.org/t/ocaml-5-0-first-normal-alpha-release/10216/1</a>
</p>
</div>

<div id="outline-container-org1ef3bc0" class="outline-3">
<h3 id="org1ef3bc0">octachron announced</h3>
<div class="outline-text-3" id="text-org1ef3bc0">
<p>
The stabilisation of OCaml 5.0 has been progressing well during the last month.
We have thus released a first normal alpha release of OCaml 5.0.0 to help
fellow hackers join us early in our bug hunting and opam ecosystem fixing fun
(see below for the installation instructions).
</p>

<p>
You can follow the progress in stabilising the opam ecosystem on
</p>

<p>
<a href="https://github.com/ocaml/opam-repository/issues/21526">https://github.com/ocaml/opam-repository/issues/21526</a>
</p>

<p>
If you find any bugs, please report them here:
</p>

<p>
<a href="https://github.com/ocaml/ocaml/issues">https://github.com/ocaml/ocaml/issues</a>
</p>

<p>
Compared to the zeroth alpha release, this alpha release restores the support
for the bytecode debugger, and integrates a change of type in the FFI API that
might trigger some warnings in FFI code.
</p>

<p>
We also have a change in the installed files: the compiler distributes now its
own META files rather than relying on either findlib or dune to provide those
files. This should simplify the tasks of both tools in future version.
</p>

<p>
Note there are still some changes expected in the Effect module before the next
candidate release. Generally, both the Effect and Domain modules are still
experimental and might change API even during the beta releases.
</p>

<p>
If you are interested by the ongoing list of bug fixes, the
updated change log for OCaml 5.0.0 is available at:
</p>

<p>
<a href="https://github.com/ocaml/ocaml/blob/5.0/Changes">https://github.com/ocaml/ocaml/blob/5.0/Changes</a>
</p>

<p>
A short summary of the changes since the zeroth alpha release is also available
below.
</p>
</div>

<div id="outline-container-org8907662" class="outline-4">
<h4 id="org8907662">Installation instructions</h4>
<div class="outline-text-4" id="text-org8907662">
<p>
The base compiler can be installed as an opam switch with the following commands
on opam 2.1:
</p>
<pre class="example" id="org7712f07">
opam update
opam switch create 5.0.0~alpha1
</pre>
<p>
For previous version of opam, the switch creation command line is slightly more verbose:
</p>
<pre class="example" id="org669e087">
opam update
opam switch create 5.0.0~alpha1 --repositories=default,beta=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>
<p>
If you want to test this version, it is strongly advised to install the alpha
opam repository
</p>

<p>
<a href="https://github.com/kit-ty-kate/opam-alpha-repository">https://github.com/kit-ty-kate/opam-alpha-repository</a>
</p>

<p>
with
</p>
<pre class="example" id="org1346e35">
opam repo add alpha git+https://github.com/kit-ty-kate/opam-alpha-repository.git
</pre>
<p>
You can check that the alpha repository has been correctly installed with
</p>

<pre class="example" id="org22fe495">
$ opam repo

&lt;&gt;&lt;&gt; Repository configuration for switch 5.0.0~alpha1 &lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;
 1 alpha   git+https://github.com/kit-ty-kate/opam-alpha-repository.git
 2 default https://opam.ocaml.org
</pre>

<p>
This alpha repository contains various fixes in the process of being upstreamed which
vastly increases the number of opam packages currently compatible with OCaml 5.0.0 .
</p>

<p>
If you want to tweak the configuration of the compiler, you can switch to the option variant with:
</p>
<pre class="example" id="org47e60eb">
opam update
opam switch create &lt;switch_name&gt; ocaml-variants.5.0.0~alpha1+options &lt;option_list&gt;
</pre>

<p>
where <code>option_list</code> is a comma separated list of <code>ocaml-option-*</code> packages. For instance, for a flambda and
no-flat-float-array switch:
</p>
<pre class="example" id="org2510041">
opam switch create 5.0.0~alpha1+flambda+nffa ocaml-variants.5.0.0~alpha1+options ocaml-option-flambda
ocaml-option-no-flat-float-array
</pre>
<p>
The command line above is slightly more complicated for opam version anterior to 2.1:
</p>
<pre class="example" id="orgbb53de3">
opam update
opam switch create &lt;switch_name&gt; --packages=ocaml-variants.5.0.0~alpha1+options,&lt;option_list&gt;
--repositories=default,beta=git+https://github.com/ocaml/ocaml-beta-repository.git
</pre>

<p>
In both cases, all available options can be listed with <code>opam search ocaml-option</code>.
</p>

<p>
The source code for the alpha is also available at these addresses:
</p>

<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/archive/5.0.0-alpha1.tar.gz">https://github.com/ocaml/ocaml/archive/5.0.0-alpha1.tar.gz</a></li>
<li><a href="https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-5.0.0~alpha1.tar.gz">https://caml.inria.fr/pub/distrib/ocaml-5.0/ocaml-5.0.0~alpha1.tar.gz</a></li>
</ul>
</div>
</div>

<div id="outline-container-org1edadef" class="outline-4">
<h4 id="org1edadef">Changes since the zeroth alpha release:</h4>
<div class="outline-text-4" id="text-org1edadef">
</div>
<div id="outline-container-orgf157983" class="outline-5">
<h5 id="orgf157983">Runtime system:</h5>
<div class="outline-text-5" id="text-orgf157983">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11400">#11400</a>: Runtime events counters fixes
Fixes mismatch between OCaml and C APIs, removes events from 4.x that
are not present in the 5.0 GC and adds some missing probes.
(Sadiq Jaffer, review by Gabriel Scherer, Florian Angeletti)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11368">#11368</a>: Runtime events buffer size OCAMLRUNPARAMS fix
The runtime events buffer size can now be set via the 'e' OCAMLRUNPARAM.
This is previously mistakenly enabled/disabled tracing instead.
(Sadiq Jaffer, review by KC Sivaramakrishnan, David Allsopp, Damien Doligez)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11304">#11304</a>: Fix data race on Windows file descriptors
(Olivier Nicole and Xavier Leroy, review by Xavier Leroy, David Allsopp,
 and Sadiq Jaffer)</li>

<li><b>breaking change</b> <a href="https://github.com/ocaml/ocaml/issues/11337">#11337</a>: pass 'flags' metadata to root scanners, to optimize stack scanning in the bytecode interpreter. Changes the interface of user-provided root-scanning hooks. (Gabriel Scherer, review by Xavier Leroy, Guillaume Munch-Maccagnoni, Sadiq Jaffer and Tom Kelly)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11144">#11144</a>: Restore frame-pointers support for amd64
(Fabrice Buoro, review by Frederic Bour and KC Sivaramakrishnan)</li>

<li><b>breaking change</b> <a href="https://github.com/ocaml/ocaml/issues/11255">#11255</a>: in the C interface, <code>&amp;Field(v, i)</code> now has type <code>volatile value *</code> instead of <code>value *</code> in OCaml 4.  This makes the memory model for mixed OCaml/C code better defined, but can cause warnings or type errors in user C code. (KC Sivaramakrishnan, review by Xavier Leroy, Gabriel Scherer and Guillaume Munch-Maccagnoni, additional discussions with Stephen Dolan and Luc Maranget)</li>
</ul>
</div>
</div>

<div id="outline-container-org0a4455d" class="outline-5">
<h5 id="org0a4455d">Standard library:</h5>
<div class="outline-text-5" id="text-org0a4455d">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/10867">#10867</a>, +<a href="https://github.com/ocaml/ocaml/issues/11345">#11345</a>: Remove deprecated values: …, the infix operator (.[  ]&lt;-). (Nicolás Ojeda Bär, review by Damien Doligez)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11309">#11309</a>, <a href="https://github.com/ocaml/ocaml/issues/11424">#11424</a>, <a href="https://github.com/ocaml/ocaml/issues/11427">#11427</a>: Add Domain.recommended_domain_count. (Christiano Haesbaert, Konstantin Belousov, review by David Allsopp, KC Sivaramakrishnan, Gabriel Scherer, Nicolas Ojeda Bar)</li>
</ul>
</div>
</div>

<div id="outline-container-org2b6fc05" class="outline-5">
<h5 id="org2b6fc05">Tools:</h5>
<div class="outline-text-5" id="text-org2b6fc05">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11065">#11065</a>: Port the bytecode debugger to 5.0, adding support for effect handlers. (Damien Doligez and fabbing, review by fabbing and Xavier Leroy)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11382">#11382</a>: OCamlmktop use a new initialization module "OCamlmktop_init" to
preserve backward-compatibility with user-module provided modules that install
toplevel printers.
(Florian Angeletti, review by Gabriel Scherer and David Allsopp)</li>
</ul>
</div>
</div>

<div id="outline-container-org6fc6910" class="outline-5">
<h5 id="org6fc6910">Installation:</h5>
<div class="outline-text-5" id="text-org6fc6910">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/11007">#11007</a>, <a href="https://github.com/ocaml/ocaml/issues/11399">#11399</a>: META files for the stdlib, compiler-libs and other libraries (unix, dynlink, str, runtime_events, threads, ocamldoc) are now installed along with the compiler. (David Allsopp, Florian Angeletti, Nicolás Ojeda Bär and Sébastien Hinderer, review by Daniel Bünzli, Kate Deplaix, Anil Madhavapeddy and Gabriel Scherer)</li>
</ul>
</div>
</div>

<div id="outline-container-org7382c71" class="outline-5">
<h5 id="org7382c71">Bug fixes:</h5>
<div class="outline-text-5" id="text-org7382c71">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/10768">#10768</a>, <a href="https://github.com/ocaml/ocaml/issues/11340">#11340</a>: Fix typechecking regression when combining first class modules and GADTs. (Jacques Garrigue, report by François Thiré, review by Matthew Ryan)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/10790">#10790</a>: don't drop variance and injectivity annotations when pretty printing <code>with</code> constraints (for example, <code>with type +!'a t = ...</code>). (Florian Angeletti, report by Luke Maurer, review by Matthew Ryan and Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11289">#11289</a>, <a href="https://github.com/ocaml/ocaml/issues/11405">#11405</a>: fix some leaks on systhread termination (Fabrice Buoro, Enguerrand Decorne, Gabriel Scherer, review by Xavier Leroy and Florian Angeletti, report by Romain Beauxis)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11314">#11314</a>, <a href="https://github.com/ocaml/ocaml/issues/11416">#11416</a>: fix non-informative error message for module inclusion (Florian Angeletti, report by Thierry Martinez, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11358">#11358</a>, <a href="https://github.com/ocaml/ocaml/issues/11379">#11379</a>: Refactor the initialization of bytecode threading, This avoids a "dangling pointer" warning of GCC 12.1. (Xavier Leroy, report by Armaël Guéneau, review by Gabriel Scherer)</li>

<li><a href="https://github.com/ocaml/ocaml/issues/11387">#11387</a>, module type with constraints no longer crash the compiler in presence of both shadowing warnings and the <code>-bin-annot</code> compiler flag. (Florian Angeletti, report by Christophe Raffalli, review by Gabriel Scherer)</li>
</ul>
</div>
</div>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">Other OCaml News</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgf5affb8" class="outline-3">
<h3 id="orgf5affb8">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-orgf5affb8">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://tarides.com/blog/2022-07-19-tarides-is-on-the-wavestone-radar">Tarides is on the Wavestone Radar!</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orga209748" class="outline-2">
<h2 id="orga209748">Old CWN</h2>
<div class="outline-text-2" id="text-orga209748">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org89337a6">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
