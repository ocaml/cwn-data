<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-01 Tue 09:51 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="http://alan.petitepomme.net/cwn/2020.08.25.html">Previous Week</a> <a href="http://alan.petitepomme.net/cwn/index.html">Up</a> <a href="http://alan.petitepomme.net/cwn/2020.09.08.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of August 25 to September 01, 2020.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">Writing bindings for Google Apps Script (GAS)</a></li>
<li><a href="#2">What the Jane Street interns have wrought</a></li>
<li><a href="#3">a small library for shell/AWK/Perl-like scripting</a></li>
<li><a href="#4">letters 0.2.0</a></li>
<li><a href="#5">raylib-ocaml 0.1.0</a></li>
<li><a href="#6">OCaml Workshop 2020 Online Conference is live now</a></li>
<li><a href="#7">Other OCaml News</a></li>
<li><a href="#orgb5a41a1">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-org721752e" class="outline-2">
<h2 id="1">Writing bindings for Google Apps Script (GAS)</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/writing-bindings-for-google-apps-script-gas/6293/1">https://discuss.ocaml.org/t/writing-bindings-for-google-apps-script-gas/6293/1</a>
</p>
</div>

<div id="outline-container-orgb23b469" class="outline-3">
<h3 id="orgb23b469">Danielo Rodr√≠guez announced</h3>
<div class="outline-text-3" id="text-orgb23b469">
<p>
Thanks to the help of this community I successfully completed a crazy idea: To write some ocaml
functions to use inside <a href="https://developers.google.com/apps-script">Google Apps Script</a> for a small
stupid spreadsheet that I had.
</p>

<p>
The way it works now is by having a main index.js file that calls the Ocaml functions that are
available under a global Lib namespace. Everything is bundled using parcel and the Idea was to use as
few JS code as possible. Because it was easier than I expected I decided to go one step further and
write some bindings for the GAS functions I was using and reduce the glue JS code even more.
</p>

<p>
This are the bindings that I wrote so far. They work, but are not usable inside Ocaml yet.
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">spreadsheet</span>
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">sheet</span>
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">range</span>
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">getActiveSpreadsheet</span> : unit -&gt; spreadsheet = <span style="color: #8b2252;">"getActiveSpreadsheet"</span> <span style="color: #483d8b;">[@@bs.val][@@bs.scope</span>
<span style="color: #8b2252;">"SpreadsheetApp"</span><span style="color: #483d8b;">]</span>
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">getSheets</span> : spreadsheet -&gt; sheet array = <span style="color: #8b2252;">"getSheets"</span> <span style="color: #483d8b;">[@@bs.send]</span>
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">getSheetByName</span> : spreadsheet -&gt; string -&gt; sheet = <span style="color: #8b2252;">"getSheetByName"</span> <span style="color: #483d8b;">[@@bs.send]</span>
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">getDataRange</span> : sheet -&gt; range = <span style="color: #8b2252;">"getDataRange"</span>  <span style="color: #483d8b;">[@@bs.send]</span>
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">getValues</span> : range -&gt; 'a array array = <span style="color: #8b2252;">"getValues"</span>  <span style="color: #483d8b;">[@@bs.send]</span>
</pre>
</div>

<p>
My doubt are on the edges. When it is just obscure GAS stuff I have no doubt, abstract types and
functions to interact with them. Is when a GAS function returns data where I have doubts. Usually they
are just arrays of arrays of Numbers or Strings. In the example above, the last definition says that
you will get an array of arrays of <code>'a</code>, but that is not true because it will be an array of "stuff"
(strings, numbers, floats).
How should I type it in a way that it's flexible but not cumbersome? For example, I don't think using a
functor will help because you will need to create a functor for every possible return type, in my case
if you have 3 sheets with 3 different shapes, you will need 3 functors.
An alternative that I have used was to provide some helper functions to convert from JS to Ocaml types
and then unwrap the Ocaml types, like the example I'm doing with Number_or_string.
This is nothing serious and I will just add the bindings that I may need for now, but I want to hear
what the community (and potential users) thinks.
</p>

<p>
If anyone is interested in taking a look on the project, it is here:
<a href="https://github.com/danielo515/ElectronicProjectsSpreadsheet">https://github.com/danielo515/ElectronicProjectsSpreadsheet</a>
</p>
</div>
</div>


<div id="outline-container-org8741ba2" class="outline-3">
<h3 id="org8741ba2">Matthieu Dubuget said</h3>
<div class="outline-text-3" id="text-org8741ba2">
<p>
Not answering directly to your question, sorry.
</p>

<p>
But here is a binding I have been using for around 4 years:
<a href="https://dubuget.fr/gitea/matthieu/ocaml-google-app.git">https://dubuget.fr/gitea/matthieu/ocaml-google-app.git</a>.
</p>
</div>
</div>


<div id="outline-container-org42bf163" class="outline-3">
<h3 id="org42bf163">Hongbo Zhang also replied</h3>
<div class="outline-text-3" id="text-org42bf163">
<p>
For return type polymorphism, you can use GADT with bs.ignore, the rough idea:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">'a t</span> =  <span style="color: #000000; background-color: #ffffff;">Int</span> : int t | <span style="color: #000000; background-color: #ffffff;">String</span> : string t
<span style="color: #000000; font-weight: bold;">external</span> <span style="color: #0000ff;">f</span> : ('a t <span style="color: #483d8b;">[@bs.ignore]</span>) -&gt; ... -&gt; 'a = <span style="color: #8b2252;">"xx"</span>
</pre>
</div>
<p>
I read discuss.ocaml.org from time to time, but checks <a href="https://forum.rescript-lang.org/">https://forum.rescript-lang.org/</a> daily where you
can get a quick answer
</p>
</div>
</div>
</div>




<div id="outline-container-orge978ef7" class="outline-2">
<h2 id="2">What the Jane Street interns have wrought</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/what-the-jane-street-interns-have-wrought/6294/1">https://discuss.ocaml.org/t/what-the-jane-street-interns-have-wrought/6294/1</a>
</p>
</div>

<div id="outline-container-org4c1f40f" class="outline-3">
<h3 id="org4c1f40f">Yaron Minsky announced</h3>
<div class="outline-text-3" id="text-org4c1f40f">
<p>
I thought folks here might find this interesting:
</p>

<p>
<a href="https://blog.janestreet.com/what-the-interns-have-wrought-2020/">https://blog.janestreet.com/what-the-interns-have-wrought-2020/</a>
</p>

<p>
The post summarizes three of the intern projects that happened this summer at Jane Street. It might be
interesting if you're looking for an internship (or know someone who is), or if you're interested in
any of the underlying tech. For example, if there's significant interest in a library for writing
OCaml, we'd be more likely to open-source it.
</p>
</div>
</div>
</div>




<div id="outline-container-org2dff03b" class="outline-2">
<h2 id="3">a small library for shell/AWK/Perl-like scripting</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://sympa.inria.fr/sympa/arc/caml-list/2020-08/msg00021.html">https://sympa.inria.fr/sympa/arc/caml-list/2020-08/msg00021.html</a>
</p>
</div>

<div id="outline-container-org517339f" class="outline-3">
<h3 id="org517339f">Oleg announced</h3>
<div class="outline-text-3" id="text-org517339f">
<p>
Some time ago Chet Murthy asked about writing shell-like scripts in
OCaml. Prompted by it, I also want to report on my experience and
announce a small library that made it pleasant to do
shell/AWK/Perl-like scripting in OCaml.
</p>

<p>
The library is available at<br />
        <a href="http://okmij.org/ftp/ML/myawk/0README.dr">http://okmij.org/ftp/ML/myawk/0README.dr</a><br />
and consists of two small ML files, myawk.ml and strings.ml. The
latter collects general-purpose string operations, more convenient
than those in Stdlib.String. The rest of that web directory contains
half a dozen sample scripts with comments.
</p>

<p>
Here is the first example: a typical AWK script, but written in OCaml:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #a52a2a;">#!/</span>bin/env -<span style="color: #000000; background-color: #ffffff;">S</span> ocaml

<span style="color: #708090;">#load</span> <span style="color: #8b2252;">"myawk.cma"</span>
<span style="color: #000000; font-weight: bold;">open </span><span style="color: #228b22;">Myawk</span> <span style="color: #000000; font-weight: bold;">open </span><span style="color: #228b22;">Strings</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">hash</span> = string_of_int &lt;<span style="color: #a52a2a;">|&gt;</span> <span style="color: #228b22;">Hashtbl.</span>hash
<span style="color: #ff4500;">;;</span>
<span style="color: #b22222;">(* </span><span style="color: #b22222;">Sanitize the files originally used by join1.ml and join2.ml</span>
<span style="color: #b22222;">   The files are made of space-separated fields; the first field is the</span>
<span style="color: #b22222;">   key. It is sensitive; but because it is a key it can't be replaced with</span>
<span style="color: #b22222;">   meaningless garbage. We obfuscate it beyond recognition. The third field</span>
<span style="color: #b22222;">   is obfuscated as well. The second and fourth can be left as they are,</span>
<span style="color: #b22222;">   and the fifth, if present, is replaced with XXX</span>

<span style="color: #b22222;">   The script is a proper filter: reads from stdin, writes to stdout</span>
<span style="color: #b22222;"> </span><span style="color: #b22222;">*)</span>

for_each_line <span style="color: #a52a2a;">@@</span> map words <span style="color: #a52a2a;">@@</span> <span style="color: #a020f0;">function</span> (f1<span style="color: #000000; background-color: #ffffff;">::</span>f2<span style="color: #000000; background-color: #ffffff;">::</span>f3<span style="color: #000000; background-color: #ffffff;">::</span>f4<span style="color: #000000; background-color: #ffffff;">::</span>rest) -&gt;
  print [hash f1; f2; hash f3; f4; <span style="color: #a020f0;">if</span> rest = <span style="color: #000000; background-color: #ffffff;">[]</span> <span style="color: #a020f0;">then</span> <span style="color: #8b2252;">""</span> <span style="color: #a020f0;">else</span> <span style="color: #8b2252;">"XXX"</span>]
<span style="color: #ff4500;">;;</span>
</pre>
</div>

<p>
Here &lt;|&gt; is a function composition. I wish it were in Stdlib. The real
example, used in real life, was performing a database join
</p>

<pre class="example">
SELECT T2.* from Table1 as T1, Table2 as T2 where T1.f1 = T2.f1
</pre>

<p>
where Table1 and Table2 are text files with space-separated column
values. Table1 is supposed to be fed to stdin:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> () =
  for_each_line <span style="color: #a52a2a;">@@</span> map words <span style="color: #a52a2a;">@@</span>
  map_option (<span style="color: #a020f0;">function</span> (x::_) -&gt; <span style="color: #000000; background-color: #ffffff;">Some</span> x | _ -&gt; <span style="color: #000000; background-color: #ffffff;">None</span>) <span style="color: #a52a2a;">@@</span>
  (<span style="color: #483d8b;">ignore</span> &lt;<span style="color: #a52a2a;">|&gt;</span> shell <span style="color: #8b2252;">"grep %s table1.txt"</span>)
</pre>
</div>

<p>
It is a typical rough-and-dirty script. Alas, it was too rough: I was
so excited that it typechecked and worked the first time, that I didn't
look carefully at the output and overlooked what I was looking for
(resulting in an unneeded hassle and apology). I should have queried exactly
for what I wanted:
</p>
<pre class="example">
SELECT T1.f1, T1.f4 FROM Table1 as T1, Table2 as T2
WHERE T1.f1 = T2.f1 AND T1.f3 &lt;&gt; "3"
</pre>

<p>
which is actually easy to write in myawk (probably not so in AWK though)
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> () =
  for_each_line <span style="color: #008b8b;">~fname</span>:<span style="color: #8b2252;">"table2.txt"</span> <span style="color: #a52a2a;">@@</span> map words <span style="color: #a52a2a;">@@</span>
  map_option (<span style="color: #a020f0;">function</span> (w::_) -&gt; <span style="color: #000000; background-color: #ffffff;">Some</span> w | _ -&gt; <span style="color: #000000; background-color: #ffffff;">None</span>) <span style="color: #a52a2a;">@@</span>
  <span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">w</span> -&gt;
    for_each_line <span style="color: #008b8b;">~fname</span>:<span style="color: #8b2252;">"table1.txt"</span> <span style="color: #a52a2a;">@@</span>  map words <span style="color: #a52a2a;">@@</span>
    map_option (<span style="color: #a020f0;">function</span>
     (x<span style="color: #000000; background-color: #ffffff;">::</span>f2<span style="color: #000000; background-color: #ffffff;">::</span>f3<span style="color: #000000; background-color: #ffffff;">::</span>f4::_) <span style="color: #a020f0;">when</span> x = w <span style="color: #a52a2a;">&amp;&amp;</span> f4 &lt;&gt; <span style="color: #8b2252;">"3"</span> -&gt; <span style="color: #000000; background-color: #ffffff;">Some</span> [x;f4] | _ -&gt; <span style="color: #000000; background-color: #ffffff;">None</span>) <span style="color: #a52a2a;">@@</span>
    print
</pre>
</div>

<p>
This is the classical nested loop join. Chet Murthy might be pleased to see
the extensive use of the continuation-passing style. I was
apprehensive at first, but it turned out not to be a hassle.
</p>

<p>
The library has a few other examples, including case-branching and
rewriting a real AWK script from the OCaml distribution.
</p>

<p>
Finally, let's compare with shell scripts. The example below doesn't
show off the library, but it does show the benefits of OCaml
for scripting. The original shell script is a sample GIT commit hook,
quoted in the comments:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #b22222;">(*</span>
<span style="color: #b22222;">From GIT's sample hooks:</span>
<span style="color: #b22222;">  ANY-GIT-REPO/.git/hooks/commit-msg.sample</span>

<span style="color: #b22222;">  # Called by "git commit" with one argument, the name of the file</span>
<span style="color: #b22222;">  # that has the commit message.  The hook should exit with non-zero</span>
<span style="color: #b22222;">  # status after issuing an appropriate message if it wants to stop the</span>
<span style="color: #b22222;">  # commit.  The hook is allowed to edit the commit message file.</span>

<span style="color: #b22222;">  # This example catches duplicate Signed-off-by lines.</span>

<span style="color: #b22222;">test "" = "$(grep '^Signed-off-by: ' "$1" |</span>
<span style="color: #b22222;">         sort | uniq -c | sed -e '/^[   ]*1[    ]/d')" || {</span>
<span style="color: #b22222;">        echo &gt;&amp;2 Duplicate Signed-off-by lines.</span>
<span style="color: #b22222;">        exit 1</span>
<span style="color: #b22222;">}</span>

<span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #228b22;">H</span> = <span style="color: #228b22;">Hashtbl</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">commit_msg</span> = <span style="color: #228b22;">Sys.</span>argv.(1)
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">ht</span> = <span style="color: #228b22;">H.</span>create 5
<span style="color: #000000; font-weight: bold;">let</span> () =
  for_each_line <span style="color: #008b8b;">~fname</span>:commit_msg <span style="color: #a52a2a;">@@</span> <span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">l</span> -&gt;
  <span style="color: #a020f0;">if</span> is_prefix <span style="color: #8b2252;">"Signed-off-by: "</span> l &lt;&gt; <span style="color: #000000; background-color: #ffffff;">None</span> <span style="color: #a020f0;">then</span> <span style="color: #000000; font-weight: bold;">begin</span>
    <span style="color: #a020f0;">if</span> <span style="color: #228b22;">H.</span>find_opt ht l &lt;&gt; <span style="color: #000000; background-color: #ffffff;">None</span> <span style="color: #a020f0;">then</span> <span style="color: #000000; font-weight: bold;">begin</span>
      prerr_endline <span style="color: #8b2252;">"Duplicate Signed-off-by lines."</span>;
      <span style="color: #483d8b;">exit</span> 1
    <span style="color: #000000; font-weight: bold;">end</span> <span style="color: #a020f0;">else</span>
      <span style="color: #228b22;">H.</span>add ht l ()
  <span style="color: #000000; font-weight: bold;">end</span>
</pre>
</div>

<p>
Although the OCaml script seems to have more characters, one doesn't
need to type them all. Scripts like that are meant to be entered in an
editor; even ancient editors have completion facilities.
</p>

<p>
Looking at the original shell script brings despair, and drives me
right towards Unix Haters. Not only the script is algorithmically
ugly: if a duplicate signed-off line occurs near the beginning, we can
report it right away and stop. We don't need to read the rest of the
commit message, filter it, sort it, precisely count all duplicates and
filter again. Not only the script gratuitously wastes system
resources (read: the laptop battery) by launching many processes and
allocating communication buffers. Mainly, the script isn't good at its
primary purpose: it isn't easy to write and read. Pipeline composition
of small stream processors is generally a good thing &#x2013; but not when each
stream processor is written in its own idiosyncratic
language. Incidentally, I have doubts about the script: I think that
quotes around $1 are meant to be embedded; but why they are not
escaped then? Probably it is some edge case of bash, out of several
0thousands.
</p>

<p>
In contrast, OCaml script does exactly what is required, with no extra
work. Everything is written in only one language.
</p>
</div>
</div>
</div>




<div id="outline-container-orgd25e27f" class="outline-2">
<h2 id="4">letters 0.2.0</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-letters-0-2-0/6307/1">https://discuss.ocaml.org/t/ann-letters-0-2-0/6307/1</a>
</p>
</div>

<div id="outline-container-org0e69847" class="outline-3">
<h3 id="org0e69847">Miko announced</h3>
<div class="outline-text-3" id="text-org0e69847">
<p>
Getting this release done took a bit longer than expected due to some real life factors, but finally
here it is.
</p>

<p>
This one mainly focuses on the most requested features and improvements like simplifying configuration
around CA certificates, provides some basic documentation and additionally adds support for
<code>multipart/alternative</code> emails with combined HTML and plain text content.
</p>
</div>
</div>


<div id="outline-container-org839405c" class="outline-3">
<h3 id="org839405c">jerben then added</h3>
<div class="outline-text-3" id="text-org839405c">
<p>
Link to Github: <a href="https://github.com/oxidizing/letters">https://github.com/oxidizing/letters</a>
</p>
</div>
</div>
</div>




<div id="outline-container-org83d926e" class="outline-2">
<h2 id="5">raylib-ocaml 0.1.0</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-raylib-ocaml-0-1-0/6313/1">https://discuss.ocaml.org/t/ann-raylib-ocaml-0-1-0/6313/1</a>
</p>
</div>

<div id="outline-container-org2d15d8a" class="outline-3">
<h3 id="org2d15d8a">Tobias Mock announced</h3>
<div class="outline-text-3" id="text-org2d15d8a">
<p>
I'd like to announce the first version of <a href="https://github.com/tjammer/raylib-ocaml">raylib-ocaml</a>, a
binding to the awesome <a href="https://www.raylib.com/">raylib</a> game development library. The release can be
found on opam as <a href="https://opam.ocaml.org/packages/raylib/">"raylib"</a>.
</p>

<p>
The bindings are nearly complete, as far as functions and types go, but only a subset was tested so
far. I will work on bringing more of the numerous examples of the C version to OCaml in the future.
</p>

<p>
Currently, raylib-ocaml only works on Linux, but I plan to support Windows (and possibly other targets)
in the future.
</p>

<p>
Feel free to give it a spin and please report any issues you run into.
</p>
</div>
</div>
</div>




<div id="outline-container-org12f0135" class="outline-2">
<h2 id="6">OCaml Workshop 2020 Online Conference is live now</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-workshop-2020-online-conference-is-live-now/6287/30">https://discuss.ocaml.org/t/ocaml-workshop-2020-online-conference-is-live-now/6287/30</a>
</p>
</div>

<div id="outline-container-orge7dd25a" class="outline-3">
<h3 id="orge7dd25a">Deep in this thread, Didier Wenzek announced</h3>
<div class="outline-text-3" id="text-orge7dd25a">
<p>
<a href="https://www.youtube.com/playlist?list=PLKO_ZowsIOu5fHjRj0ua7_QWE_L789K_f">OCaml 2020 All Videos</a>
</p>
</div>
</div>
</div>




<div id="outline-container-orga5be253" class="outline-2">
<h2 id="7">Other OCaml News</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org97623c3" class="outline-3">
<h3 id="org97623c3">From the ocamlcore planet blog</h3>
<div class="outline-text-3" id="text-org97623c3">
<p>
Here are links from many OCaml blogs aggregated at <a href="http://ocaml.org/community/planet/">OCaml Planet</a>.
</p>

<ul class="org-ul">
<li><a href="http://psellos.com/2020/08/2020.08.east-van-girls.html">BuckleScript Good and Bad News</a></li>
<li><a href="https://blog.janestreet.com/what-the-interns-have-wrought-2020/">What the interns have wrought, 2020 edition</a></li>
<li><a href="https://coq.inria.fr/news/coq-8-12-0-is-out.html">Coq 8.12.0 is out</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orgb5a41a1" class="outline-2">
<h2 id="orgb5a41a1">Old CWN</h2>
<div class="outline-text-2" id="text-orgb5a41a1">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="http://alan.petitepomme.net/cwn/">the archive</a> or the <a href="http://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname">
<p>
<a href="http://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
