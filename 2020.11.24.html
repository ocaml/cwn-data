<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-11-24 Tue 13:06 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="http://alan.petitepomme.net/cwn/2020.11.17.html">Previous Week</a> <a href="http://alan.petitepomme.net/cwn/index.html">Up</a> <a href="http://alan.petitepomme.net/cwn/2020.12.01.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of November 17 to 24, 2020.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">OCaml User Survey 2020</a></li>
<li><a href="#2">Suggestions from the OCaml Survey result</a></li>
<li><a href="#3">OCaml for ARM MacOS</a></li>
<li><a href="#4">TechEmpower benchmark: httpaf + lwt + unix on par with Haskell's warp</a></li>
<li><a href="#5">Dropbox v2 API, and JSoO bindings for GridJS and IndexedDB</a></li>
<li><a href="#6">OCaml in Jupyter-based Environments</a></li>
<li><a href="#7">Ocurrent/opam Docker images have moved to ocaml/opam</a></li>
<li><a href="#8">ocaml-lsp-server 1.2.0</a></li>
<li><a href="#9">ca-certs and ca-certs-nss</a></li>
<li><a href="#10">Compatibility packages for 4.12 (either, semaphore-compat)</a></li>
<li><a href="#11">Jupyter with pyml</a></li>
<li><a href="#12">OCaml needs an arbitrary-precision decimal type</a></li>
<li><a href="#13">Type-at-point ocaml-lsp/merlin in vim/neovim</a></li>
<li><a href="#14">ocamlearlybird now an OCaml Software Foundation supported project</a></li>
<li><a href="#15">release of mc2 0.1, a SMT solver</a></li>
<li><a href="#16">Wednesday, 25th November 2020 is MirageOS Bug Cleaning Day!</a></li>
<li><a href="#17">Other OCaml News</a></li>
<li><a href="#orgd96a1ff">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-org17471ba" class="outline-2">
<h2 id="1">OCaml User Survey 2020</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocaml-user-survey-2020/6624/25">https://discuss.ocaml.org/t/ann-ocaml-user-survey-2020/6624/25</a>
</p>
</div>

<div id="outline-container-orga54968d" class="outline-3">
<h3 id="orga54968d">Continuing this thread, Xavier Leroy announced</h3>
<div class="outline-text-3" id="text-orga54968d">
<p>
I extracted the replies to the free-form questions and made them available as a Gist.  There are so
many replies that I have no idea how to exploit and summarize them!
<a href="https://gist.github.com/xavierleroy/88a22b2b8e609c46bf9d23f36521a483">https://gist.github.com/xavierleroy/88a22b2b8e609c46bf9d23f36521a483</a>
</p>
</div>
</div>


<div id="outline-container-org053f929" class="outline-3">
<h3 id="org053f929">Patrick Ferris then said</h3>
<div class="outline-text-3" id="text-org053f929">
<p>
Thanks for putting together this great resource!
</p>

<p>
I think it's quite important to take the results from this survey and find actionable items (or
highlight ongoing efforts) which aim to improve different problems for different users. As a result I
have put together some graphs trying to categorise the answers based on proficiency (<code>beginner</code>,
<code>intermediate</code>, <code>advanced</code> and <code>expert</code>). These groupings are quite subjective but I thought it might
offer a slightly more nuanced look into what problems users had, where they come from, what they are
doing and what commonalities they share. The <a href="https://github.com/patricoferris/ocaml-survey-analysis/blob/main/survey-analysis.ipynb">code is here</a> and the
<a href="https://patricoferris.github.io/ocaml-survey-analysis/">HTML version of the notebook here</a> (I'm no
data-scientist nor python developer :snake: if you see glaring mistakes do raise an issue!).
</p>

<p>
Here are some possible inferences (<b>warning: opinions ahead</b>) that can be made from the data along with
possible actionable steps (or links to ongoing projects):
</p>
<ul class="org-ul">
<li><a href="https://patricoferris.github.io/ocaml-survey-analysis/#State-of-the-Art-">Everybody wants better documentation for user libraries</a>. I think people want more long-form style documentation. However, excellent work is currently taking place with <a href="https://github.com/ocaml/odoc">odoc</a> (see also <a href="https://www.youtube.com/watch?v=wVyZ-KveN-w">OCaml workshop video</a>) and perhaps these concerns can be wrapped into this ongoing work.</li>
<li>Everybody wants <b>multicore</b> but "experts" want <b>implicits</b> a little more &#x2013; <a href="https://discuss.ocaml.org/t/the-status-of-modular-implicits/6680">multicore is coming along amazingly</a> and <a href="https://discuss.ocaml.org/t/the-status-of-modular-implicits/6680">implicits</a> are in an earlier but active state AFAICT.</li>
<li><a href="https://patricoferris.github.io/ocaml-survey-analysis/#Fluency-in-other-languages-&amp;-Application-domains-">A wide variety of application domains</a></li>
<li>less proficient OCaml users tend to be doing more web-related tasks or data processing. Advanced/expert users are implementing programming languages, building developer tools, systems and formal methods. This is reflected in other breakdowns for example in <a href="https://patricoferris.github.io/ocaml-survey-analysis/#Fluency-in-other-languages-&amp;-Application-domains-">"other fluent languages"</a> we see JS more popular with beginners and C with experts. But also track the progress of <b>Coq and friends</b> moving up as proficiency increases. This is quite interesting and I think it could point to an actionable item of working more on the web and formal methods components of the OCaml ecosystem i.e. working with Coq devs and JS devs to help them.</li>
<li>From a Javascript point-of-view, looking at the <a href="https://patricoferris.github.io/ocaml-survey-analysis/#OCaml-Tools-">implementations</a> section it's interesting to note across the four proficiency levels <code>js_of_ocaml</code> is more popular than <code>Reason</code> except for beginners. Both projects are actively worked on, but perhaps more <code>js_of_ocaml</code> documentation would be good with many tools already existing like <a href="https://github.com/LexiFi/gen_js_api">gen_js_api</a>, Jane Street's <a href="https://github.com/janestreet/bonsai">bonsai</a> etc. In my opinion, this survey motivates working on unifying the JS world of OCaml as (at least to me) right now it feels a little fragmented and hard for someone new to know where to go.</li>
<li><a href="https://patricoferris.github.io/ocaml-survey-analysis/#OCaml-Tools-">Opam with the public repository</a> across all users is consistently the most used installation method &#x2013; this justifies the large amount of work that tasks place on <a href="https://github.com/ocaml/opam/projects/1">opam</a> that I'm sure most are very grateful for. Tying this back to the previous point of "cross community" work, opam have <a href="https://github.com/ocaml/opam/wiki/Community-dev-meetings">community meetings</a> which seem to be v. useful.</li>
<li>Pain points &#x2013; the top two (although they interchange) is "lack of critical libraries" and "too hard to find and hire OCaml developers". Some <a href="https://discuss.ocaml.org/t/what-libraries-are-missing/6543">effort has been made</a> to find these libraries including in the survey. I'm not sure what else can be done. As for hiring, looking at the different <a href="https://patricoferris.github.io/ocaml-survey-analysis/#Community-Interaction-">communication channels</a> there is quite a spread with different users using different channels. This is great, but may also cause some fragmentation and make the "hiring" process worse.</li>
</ul>

<p>
These are just some thoughts from a relatively new OCaml community member, I would love to know what
other actionable steps people think we can take from this data and hopefully we can produce a more
concise and specific set of steps to put this survey to great use :))
</p>
</div>
</div>


<div id="outline-container-org9de0971" class="outline-3">
<h3 id="org9de0971">After many replies, Patrick Ferris said</h3>
<div class="outline-text-3" id="text-org9de0971">
<p>
Thanks for the great suggestions so quickly! I'll also set aside some time to summarise everything once
some more ideas are posted and there is general consensus.
</p>

<blockquote>
<p>
I believe a common theme among the comments in the survey is a lack of structure found in
documentation, libraries, and critical build tools
</p>
</blockquote>

<p>
Completely agree &#x2013; documentation is fundamental as it is felt by most I feel. The limitations of
build-tools are perhaps more felt by more advanced or complicated workflows.
</p>

<blockquote>
<p>
curated Opam repos
</p>
</blockquote>

<p>
This sound really interesting &#x2013; from experience I think quite a few beginners are unfamiliar with the
ability of having multiple repos. I certainly was until I started cross-compiling to RISC-V :)) I think
a good example curated repo would help drive this home more, do you know if one exists beyond the
cross-compiling ones which aren't exactly what we're looking  for?
</p>

<blockquote>
<p>
Use sourcegraph and other code search mechanisms to surface all the work in progress (WIP) libraries
that people have put together on github/gitlab/etc
</p>
</blockquote>

<p>
This sounds good. I do wonder if more documentation/tutorials/awareness of
<a href="https://github.com/ocamllabs/dune-release">dune-release</a> and
<a href="https://github.com/ocaml-opam/opam-publish">opam-publish</a> might also help. I, for one, am sitting on a
few libraries I should really publish but the process can be a little intimidating, so I still agree a
search would be great but ultimately it would be good for libraries to make it upstream.
</p>

<blockquote>
<p>
Thanks for this great analysis
</p>
</blockquote>

<p>
Thanks for the kind words :))
</p>

<blockquote>
<p>
Is GSoC still a thing?
</p>
</blockquote>

<p>
Not in a position to start making GSoC proposals but they are definitely still a thing! For example
<a href="https://summerofcode.withgoogle.com/archive/2019/organizations/5422734538964992/">two</a>
<a href="https://www.lowrisc.org/docs/gsoc-2020-ideas/">projects</a> I think are great, still do them. Even
outside of GSoC perhaps a curated list of OCaml Community approved projects/internships that would
benefit the whole community would be good that different businesses/organisations/foundations could use
when making their own internships would be useful? At least everyone would be united on that front.
</p>
</div>
</div>


<div id="outline-container-org98494e5" class="outline-3">
<h3 id="org98494e5">gasche then said</h3>
<div class="outline-text-3" id="text-org98494e5">
<p>
Note: I "split" the <a href="https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/">excellent
discussion</a> by @patrickoferris
as a separate topic, as it was going in the (very useful) direction of discussing broadly the
ecosystem, rather than specifically the survey result. I would encourage people to post here for
specific details on the survey process and results, and create new topics for discussions inspired by
the survey.
</p>

<p>
Let me quote below the part of @patricoferris' post that would be most useful to anyone interested in
processing the results:
</p>

<blockquote>
<p>
I think it's quite important to take the results from this survey and find actionable items (or
highlight ongoing efforts) which aim to improve different problems for different users. As a result I
have put together some graphs trying to categorise the answers based on proficiency (<code>beginner</code>,
<code>intermediate</code>, <code>advanced</code> and <code>expert</code>). These groupings are quite subjective but I thought it might
offer a slightly more nuanced look into what problems users had, where they come from, what they are
doing and what commonalities they share. The <a href="https://github.com/patricoferris/ocaml-survey-analysis/blob/main/survey-analysis.ipynb">code is
here</a> and the
<a href="https://patricoferris.github.io/ocaml-survey-analysis/">HTML version of the notebook here</a> (I'm no
data-scientist nor python developer :snake: if you see glaring mistakes do raise an issue!).
</p>
</blockquote>

<p>
The <a href="https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/">new topic</a> has excellent
discussion on Patrick's findings from the survey data.
</p>
</div>
</div>
</div>




<div id="outline-container-orge3df765" class="outline-2">
<h2 id="2">Suggestions from the OCaml Survey result</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/6791/14">https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/6791/14</a>
</p>
</div>

<div id="outline-container-orgd605df8" class="outline-3">
<h3 id="orgd605df8">Anil Madhavapeddy said in this new thread</h3>
<div class="outline-text-3" id="text-orgd605df8">
<p>
Thanks Patrick for the fantastic distillation of results.  It's extremely useful to see our user
responses segmented by their experience. (in particular, our self-identified expert userbase runs Coq a
lot more than our self-identified newcomer codebase who tend to use JavaScript &#x2013; we want to make sure
we continue to help all of these segments!).
</p>

<p>
At a high level, this survey has already influenced the Platform tool developers.  Documentation has
been identified as a priority item for next year, and so a couple of next steps are happening this week
already among the various groups:
</p>

<ul class="org-ul">
<li>The regular odoc <a href="https://github.com/ocaml/odoc/wiki">developer meeting</a> this week will also feature the opam team as part of our <a href="https://github.com/ocaml/opam/wiki/Community-dev-meetings">community dev meetings</a>, and we are getting together to put the final plan together to put a docs.ocaml.org site together.  The results of this will be on the dev wiki as usual, so anyone interested can track progress and suggest ideas (the video meetings are not exactly closed, but fully open participation isn't practical given the constraints of current technology &#x2013; please ping the odoc maintainer @jonludlam directly if interested in attending)</li>

<li>the second part of a docs site is to ensure we have really reliable and solid workflows for opam-repo contributions (including bulk builds, health checks and having a more automated contribution process, ideally without having to run a CLI tool).  The next opam dev meeting <a href="https://github.com/ocaml/opam/wiki/Community-dev-meetings#20112020-opam-repo-testing-and-handling-and-bulk-builds">later this week</a> will feature us planning a switch to a <a href="https://www.youtube.com/watch?v=HjcCUZ9i-ug&amp;list=PLKO_ZowsIOu5fHjRj0ua7_QWE_L789K_f&amp;index=2">cluster-based nextgen CI</a> for opam-respository.  We've also invited the maintainers of the Coq opam repository as well as Tezos and Jane Street (who contribute large package sets regularly) so we can ensure we work well with those ecosystems as well.  Our intention here is to really reduce the burden on contributions to opam repository by mechanising as much of the grunt work as possible, thereby helping both beginners and expert users.  Our new CI will also feature macOS and Windows testing as we bring those cluster workers online, and be much more easily extensible to custom workflows.</li>

<li>Having all the fancy package cluster builds in the world don't help if noone is actually writing any documentation in their libraries. We're hoping that new tools (such as <a href="https://github.com/realworldocaml/mdx">mdx</a> from Real World OCaml) will reduce the friction of entry to writing ocamldoc tutorials and sites. The mdx tool usage is easy but the implementation is quite complex (due to the interlock with the internal compiler-libs), so there is a <a href="https://github.com/realworldocaml/mdx/wiki">mdx team</a> working away on it, including hopefully speeding it up with native code compilation and continuing to improve the integration with dune and other build tools.  @yminsky and I use mdx to write the whole of Real World OCaml (v2 of which is coming out soon in print), and we are most eager for other people to fork our tools and write their own books (like the <a href="https://ocaml.xyz/book/introduction.html">Owl scientific computing book</a>).</li>

<li>Finally, @ashish @gemmag and I have been putting our heads together to get funding sorted to reboot the ocaml.org site and make it easier to maintain, in recognition of the fact that the "old guard" (Christophe, Ashish, Phillippe, myself) just don't have the day-to-day time anymore to keep things up. @patricoferris, @kanishka @sanette Bella and @JohnWhitington have all been contributing content to ocaml.org, and we are doing both incremental changes and also overhauling the internals of how it is built to use the latest and greatest innovations.  I'm excited to see what all these new contributors will come up with.</li>
</ul>

<p>
This is of course not a closed list of action items &#x2013; simply what I am tracking as the coordinator of the OCaml Platform efforts &#x2013; so please keep suggestions and analysis flowing.
</p>

<p>
I would suggest one good way to "wrap up" the survey is to:
</p>
<ul class="org-ul">
<li>transfer @patricoferris' notebook over to the <code>ocaml/</code> GitHub org.</li>
<li>once the discussions and next steps here settle (both from individual comments, and also the aggregated decisions of the various Platform teams like the opam, odoc and dune maintainers), some combination of @patricoferris @xavierleroy @gasche and myself summarise them in that notebook as priority items we would like to accomplish next year.</li>
<li>we publicise the survey results notebook and conclusions on ocaml.org and this forum prominently.</li>
<li>we figure out a way to get more people involved and contributing in concrete projects around documentation (in particular) next year, perhaps via schemes such as Outreachy or direct funding from organisations such as the OCSF.</li>
</ul>

<p>
Thanks to everyone for the input and comments so far. If anyone has a burning desire to be in any of
the dev meetings, please get in touch with me directly (anil@recoil.org) or the maintainers of the
individual tool.  I've never seen this much activity happening in all my time working on OCaml, so it
warms my heart on this crisp winters day to see all the constructive positivity and effort going on.
Keep it up and keep the suggestions coming :slight_smile:
</p>
</div>
</div>
</div>




<div id="outline-container-orge1cd708" class="outline-2">
<h2 id="3">OCaml for ARM MacOS</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-for-arm-macos/6019/20">https://discuss.ocaml.org/t/ocaml-for-arm-macos/6019/20</a>
</p>
</div>

<div id="outline-container-orgf2de171" class="outline-3">
<h3 id="orgf2de171">Continuing this thread, John Whitington said</h3>
<div class="outline-text-3" id="text-orgf2de171">
<p>
OCaml 4.12 from trunk builds fine on ARM macOS for me, and I can build all my software, including mixed
C/OCaml DLLs and other exotic things.
</p>

<p>
For those interested in timings, "make -j9 world.opt" for OCaml runs in 1m6s.
</p>
</div>
</div>
</div>




<div id="outline-container-orgee3eff3" class="outline-2">
<h2 id="4">TechEmpower benchmark: httpaf + lwt + unix on par with Haskell's warp</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/techempower-benchmark-httpaf-lwt-unix-on-par-with-haskells-warp/6788/1">https://discuss.ocaml.org/t/techempower-benchmark-httpaf-lwt-unix-on-par-with-haskells-warp/6788/1</a>
</p>
</div>

<div id="outline-container-org8f2c7b4" class="outline-3">
<h3 id="org8f2c7b4">blandinw announced</h3>
<div class="outline-text-3" id="text-org8f2c7b4">
<p>
The recent talks around this benchmark (started by @rbjorklin) and the OCaml results piqued my
curiosity. After all, one of OCaml's strengths is its performance! It should smoke node.js and be in
the same ballpark as Haskell, Go, etc., right? Well, only one way to find out!
</p>

<p>
To start simple, I wanted to establish a baseline using a pre-forking approach with a listening socket
shared by all children and go from there. It turns out I didn't need to go far at all. This simple
architecture was enough to leave node.js in the dust and get results similar to Haskell and Go. This
says a lot about the current quality of OCaml and the ecosystem we have today! Handshakes all around!
🍺🐫
</p>

<p>
You can find the results for the <a href="https://www.techempower.com/benchmarks/#section=test&amp;runid=032630e0-3a86-4eac-ae2d-517e8b9586ac&amp;hw=ph&amp;test=json&amp;a=2">JSON benchmark
here</a>.
Be sure to check the Latency tab. Note that a lot of the top performers optimize aggressively by
precomputing responses, using object pools, etc.
</p>

<p>
From my limited testing, the big difference with the previous OCaml attempts might be that they had to
use (the otherwise amazing) <code>haproxy</code> to load-balance between all cores. Pre-forking and sharing a
socket removes that need, so that all cores can do useful work. I also had some fun using  <code>SIGALRM</code> to
render the date only once per second.
</p>

<p>
As a side note, it was my first time using these UNIX APIs from OCaml and it was an eye-opening
experience to be able to leverage all that power outside of C and without giving up any of OCaml's
strengths.
</p>

<p>
I'm happy with the results, but it should be possible to improve even further by:
</p>
<ul class="org-ul">
<li>profiling with <code>perf</code> to know where time is spent, e.g. in JSON encoding, allocations, GC, context switches, etc.</li>
<li>using <code>libuv</code> instead of <code>libev</code>, maybe via <a href="https://github.com/ocsigen/lwt/pull/811">this PR to Lwt</a></li>
<li>using <a href="https://www.youtube.com/watch?v=Z7YZR1q8wzI">Multicore domains</a> to use a pre-threaded architecture as opposed to a pre-forked architecture and hopefully reduce context switch costs, see <a href="https://unixism.net/2019/04/linux-applications-performance-part-vi-polling-servers/">Linux Applications Performance</a></li>
</ul>

<p>
Contributing is pretty easy, just clone <a href="https://github.com/TechEmpower/FrameworkBenchmarks">this repo</a>
and run <code>./tfb --test httpaf --type json --concurrency-levels 512</code>.
</p>
</div>
</div>
</div>




<div id="outline-container-org1ee7d94" class="outline-2">
<h2 id="5">Dropbox v2 API, and JSoO bindings for GridJS and IndexedDB</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-dropbox-v2-api-and-jsoo-bindings-for-gridjs-and-indexeddb/6793/1">https://discuss.ocaml.org/t/ann-dropbox-v2-api-and-jsoo-bindings-for-gridjs-and-indexeddb/6793/1</a>
</p>
</div>

<div id="outline-container-org37595b6" class="outline-3">
<h3 id="org37595b6">Xavier R. Guérin announced</h3>
<div class="outline-text-3" id="text-org37595b6">
<p>
I am releasing on GitHub today a set of libraries under ISC:
</p>

<ol class="org-ol">
<li><code>xguerin/ocaml-dropbox</code>: Dropbox v2 API. <code>auth</code>, <code>check</code>, and <code>files</code> operations are available, the rest is WIP.</li>
<li><code>xguerin/ocaml-dropbox</code>: JSoO bindings for <a href="https://gridjs.io">gridjs.io</a>.</li>
<li><code>xguerin/ocaml-indexeddb</code>: JSoO bindings for <code>IndexedDB</code>. Based on Thomas Leonard's work with <code>Irmin</code>.</li>
</ol>

<p>
Each of them is OPAM-enabled although not currently available in the official repo.
</p>
</div>
</div>
</div>




<div id="outline-container-org5d09787" class="outline-2">
<h2 id="6">OCaml in Jupyter-based Environments</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-in-jupyter-based-environments/6797/1">https://discuss.ocaml.org/t/ocaml-in-jupyter-based-environments/6797/1</a>
</p>
</div>

<div id="outline-container-orgf69429b" class="outline-3">
<h3 id="orgf69429b">Patrick Ferris announced</h3>
<div class="outline-text-3" id="text-orgf69429b">
<p>
As @CraigFe said, this conversation might be useful for other people looking to run OCaml for teaching
or data-science in a Jupyter-based environments. Continuing the discussion from <a href="https://discuss.ocaml.org/t/suggestions-from-the-ocaml-survey-result/6791/13">Suggestions from the
OCaml Survey result</a>
where <a href="https://mybinder.org/">binder</a> was mentioned, this looks like a neat way to lower the barrier to
entry for programming in OCaml.
</p>

<p>
To add to what @mseri asked:
</p>

<blockquote>
<p>
Do you know if and how one can use ocaml on colab? In principle there is support for the jupyter
protocol…
</p>
</blockquote>

<p>
You can but it is a bit hacky. You first need to generate a blank <code>ocaml.ipynb</code> locally and upload this
to colabs, this will enable you to select <code>Runtime &gt; Change Runtime Type &gt; Runtime Selection</code> to OCaml.
Then you need to install OCaml, jupyter and add the kernel. This code block did the trick for me:
</p>

<pre class="example">
!add-apt-repository ppa:avsm/ppa &amp;&amp; apt-get update &amp;&amp; apt-get install opam m4 libgmp-dev
!opam init --disable-sandboxing -y
!opam install jupyter
!opam exec -- ocaml-jupyter-opam-genspec
!jupyter kernelspec install --user --name ocaml-jupyter "$(opam var share)/jupyter"
</pre>

<p>
It takes quite a while and I'm not really going to recommend it, but it does work.
</p>

<p>
I also put together a few [dockerfiles]() with the purpose of being used in jupyter environments for
teaching. Also with an example of using
<a href="https://github.com/patricoferris/ocaml-teaching/tree/main/teaching">nbgrader</a> although I think this
still needs some work (it's based on @kayceesrk's <a href="https://kcsrk.info/ocaml/prolog/jupyter/notebooks/2020/01/19/OCaml-Prolog-Jupyter/">blog
post</a>). Are people
using other setups for teaching OCaml in a classroom/university setting?
</p>

<p>
As a small aside, I started doing the survey analysis in OCaml, but found two issues:
</p>

<ol class="org-ol">
<li>CSV loading with OWL was struggling (I think it struggled with the extra <code>,</code> in questions and also didn't like multiple headers with the same name &#x2013; other libraries I think just add the column number to make it unique), I ended up using the <a href="https://github.com/Chris00/ocaml-csv">csv</a> library and then making the dataframe by hand.</li>
<li>The plotting library is good, but lacks the customisability that something like Matplotlib offers. I did start using the very good <a href="https://github.com/LaurentMazare/ocaml-matplotlib/">ocaml-matplotlib bindings</a> but it all became a little too much effort&#x2026; :snake:</li>
</ol>
</div>
</div>


<div id="outline-container-orga63f19a" class="outline-3">
<h3 id="orga63f19a">Anton Kochkov suggested</h3>
<div class="outline-text-3" id="text-orga63f19a">
<p>
Another project that is probably a better inspiration for OCaml-based workflow -
<a href="https://github.com/fonsp/Pluto.jl">Pluto.jl</a> that is written in Julia itself.
</p>

<p>
See <a href="https://www.youtube.com/watch?v=IAF8DjrQSSk">Pluto presentation (20 min) at <b>Juliacon 2020</b></a>.
</p>
</div>
</div>


<div id="outline-container-org83e210a" class="outline-3">
<h3 id="org83e210a">Anil Madhavapeddy replied to Patrick Ferris</h3>
<div class="outline-text-3" id="text-org83e210a">
<blockquote>
<p>
Are people using other setups for teaching OCaml in a classroom/university setting?
</p>
</blockquote>

<p>
We use Jupyter and nbgrader in Cambridge for the first year Foundations of Programming course:
<a href="https://www.cl.cam.ac.uk/teaching/1920/FoundsCS/materials.html">https://www.cl.cam.ac.uk/teaching/1920/FoundsCS/materials.html</a>
(the pdf is generated from the Jupyter export, and the content is written in Markdown and converted to
notebook format using a <a href="https://github.com/realworldocaml/mdx/pull/124">modified mdx</a>).
</p>

<p>
It's on my todo list to resurrect <a href="https://github.com/andrewray/iocamljs">https://github.com/andrewray/iocamljs</a> so that we can do this with a
pure-client-side experience.  We have internal hosted servers so that each student has their own
container running their Jupyter/OCaml kernel, but I think it would be more robust to switch entirely
client side for everything except exercise grading.
</p>
</div>
</div>


<div id="outline-container-orga4ea3d0" class="outline-3">
<h3 id="orga4ea3d0">Philippe asked and Anil Madhavapeddy replied</h3>
<div class="outline-text-3" id="text-orga4ea3d0">
<blockquote>
<p>
This tool shows the interpreter outputs but can also render graphics in the page. Do you have plans to
include a similar feature in mdx? (I’m asking because if this is the case, I’d be happy to lend a
hand).
</p>
</blockquote>

<p>
Doesn't support it, and that sounds awesome. @jonludlam did something involving registering OCaml
toplevel printers that can output HTML that renders in a notebook (so you can pipe a <code>type tree = ...</code>
through dot to render it graphically). Never upstreamed that work I think.  Feel free to create an
issue on the mdx repo &#x2013; I think the utility of it will increase dramatically if it can create
notebooks!
</p>

<blockquote>
<p>
I have to say though, writing ocaml code in a markdown document is not very convenient since you don’t
have merlin+syntax highlighting helping you. Ideally we’d need an environment that knows both markdown
and ocaml very well…
</p>
</blockquote>

<p>
Yes indeed, mdx supports this mode too. In Real World OCaml, we have all our examples as separate files
that can have <code>dune build</code> run on them, and then <code>mdx</code> supports external references as well.   See for
example the <a href="https://github.com/realworldocaml/book/blob/master/book/json/README.md">JSON chapter in
RWO</a>: you just add a <code>file=</code>
block into the Markdown, and the dune promotion rules will either run the toplevel or include the
external ML file and update the Markdown content automatically.
</p>
</div>
</div>


<div id="outline-container-org2c070bd" class="outline-3">
<h3 id="org2c070bd">Jon Ludlam said</h3>
<div class="outline-text-3" id="text-org2c070bd">
<p>
Registering 'rich' printers with Jupyter is a standard feature of the wonderful
<a href="https://github.com/akabe/ocaml-jupyter">ocaml-jupyter</a> (thanks, @akabe!)  - you just register a
printer as normal that ends up calling
<a href="https://akabe.github.io/ocaml-jupyter/api/jupyter/Jupyter_notebook/index.html#val-display">Jupyter_notebook.display</a>.
I have a couple of examples <a href="https://github.com/jonludlam/focs-support/tree/master/lib">here</a> for
displaying trees &#x2013; the one you mentioned &#x2013; and ppm files. It would be very neat to be able to do
something similar for mdx, and probably not too tricky too. Perhaps a good starter project?
</p>
</div>
</div>
</div>




<div id="outline-container-org28eeb7f" class="outline-2">
<h2 id="7">Ocurrent/opam Docker images have moved to ocaml/opam</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocurrent-opam-docker-images-have-moved-to-ocaml-opam/6798/1">https://discuss.ocaml.org/t/ocurrent-opam-docker-images-have-moved-to-ocaml-opam/6798/1</a>
</p>
</div>

<div id="outline-container-orga68a4dd" class="outline-3">
<h3 id="orga68a4dd">Thomas Leonard announced</h3>
<div class="outline-text-3" id="text-orga68a4dd">
<p>
The <a href="https://github.com/ocurrent/docker-base-images">docker base image builder</a> has been reconfigured
to push the images to the <code>ocaml/opam</code> repository on Docker Hub.
</p>

<p>
If you were previously using the <code>ocurrent/opam</code> repository, you should update to the new location. The
<code>ocurrent/opam</code> repository will not get any further updates.
</p>

<p>
The images provide many combinations of distribution, OCaml version, architecture and flags. e.g. to
get an environment with OCaml 4.11 installed on Debian 10:
</p>

<pre class="example">
docker run --rm -it ocaml/opam:debian-10-ocaml-4.11
</pre>

<p>
Or to try the 4.12 pre-release, compiled with AFL fuzzing support, you'd use
<code>ocaml/opam:debian-10-ocaml-4.12-afl</code>.
</p>

<p>
(the full set of builds can be seen at the service's page at <a href="https://base-images.ocamllabs.io/">https://base-images.ocamllabs.io/</a>)
</p>
</div>
</div>


<div id="outline-container-org95f6edf" class="outline-3">
<h3 id="org95f6edf">Christian Lindig then said</h3>
<div class="outline-text-3" id="text-org95f6edf">
<p>
I recently looked at  <code>ocaml/opam:debian-10-ocaml-4.09</code> and noticed that in the root of the image the
Dockerfiles were included that generated the image. I'm not sure that was always the case but found
that helpful.
</p>
</div>
</div>
</div>




<div id="outline-container-org2b15e1b" class="outline-2">
<h2 id="8">ocaml-lsp-server 1.2.0</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocaml-lsp-server-1-2-0/6799/1">https://discuss.ocaml.org/t/ann-ocaml-lsp-server-1-2-0/6799/1</a>
</p>
</div>

<div id="outline-container-orgfe62f2d" class="outline-3">
<h3 id="orgfe62f2d">Rudi Grinberg announced</h3>
<div class="outline-text-3" id="text-orgfe62f2d">
<p>
On behalf of the ocaml-lsp team, I'd like to announce version 1.2.0.
</p>

<p>
This version contains many bug fixes and some performance improvements A couple of interesting features
made it in as well:
</p>

<ul class="org-ul">
<li>Auto-completion of OCaml keywords (not available for reaso)</li>
<li>The ability to jump to the declaration of a value in the .mli.</li>
</ul>
</div>
</div>


<div id="outline-container-orgd8052c6" class="outline-3">
<h3 id="orgd8052c6">Yawar Amin added</h3>
<div class="outline-text-3" id="text-orgd8052c6">
<p>
Release page: <a href="https://github.com/ocaml/ocaml-lsp/releases/tag/1.2.0">https://github.com/ocaml/ocaml-lsp/releases/tag/1.2.0</a>
</p>
</div>
</div>
</div>




<div id="outline-container-orgf74c237" class="outline-2">
<h2 id="9">ca-certs and ca-certs-nss</h2>
<div class="outline-text-2" id="text-9">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ca-certs-and-ca-certs-nss/6804/1">https://discuss.ocaml.org/t/ann-ca-certs-and-ca-certs-nss/6804/1</a>
</p>
</div>

<div id="outline-container-orgc4d23ba" class="outline-3">
<h3 id="orgc4d23ba">Hannes Mehnert announced</h3>
<div class="outline-text-3" id="text-orgc4d23ba">
<p>
I'm pleased to announce the release two opam packages, <a href="https://github.com/mirage/ca-certs">ca-certs</a>
and <a href="https://github.com/mirage/ca-certs-nss">ca-certs-nss</a>, which use the trust anchors from the system
/ embed trust anchors from <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS">Netscape Security
Services</a> (these days used by the
Mozilla Firefox browser).
</p>

<p>
For some context: when establishing a TLS connection you likely want to verify that the server provides
a valid certificate &#x2013; on the open world wide web this boils down to "is valid at the current time" and
"is signed by a trustworthy entity" (such as <a href="https://letsencrypt.org/">https://letsencrypt.org/</a> - which validates that you have
access to the domain before signing a certificate). If you do not verify the server certificate, a
person may be in the middle of the connection and read and modify arbitrary communication content. Read
more about <a href="https://en.wikipedia.org/wiki/Certificate_authority">this topic on Wikipedia</a>. NB in
private setups you can use your own CA setup and won't need ca-certs / ca-certs-nss.
</p>

<p>
Now, different operating systems store this information in different places and formats &#x2013; for Unix
(and Linux) there is unfortunately no common API or file location. To abstract over this, the package
ca-certs provides the API <code>val authenticator : [...] -&gt; unit -&gt; (X509.Authenticator.t, [&gt; `Msg of
string ]) result</code> &#x2013; which composes well with OCaml-TLS API for TLS clients (that receive such an
authenticator).
</p>

<p>
The ca-certs package has initially been implemented by @emillon in 2019, and only recently been pushed
to opam-repository. If you're using a not-so-mainstream Linux distribution (or other Unix), we're
interested in your feedback: does a <code>dune runtest</code> work on your system? &#x2013; it has been tested apart
from debian, ubuntu, SuSE, CentOS, also on FreeBSD, OpenBSD, and macOS. The macOS support uses the
<code>security</code> command, and could be improved by using appropriate API calls &#x2013; there is no support for
Windows at the moment (if you're interested in contributing support for windows, <a href="https://github.com/mirage/ca-certs/issues/4">it should be pretty
straightfoward</a>).
</p>

<p>
The ca-certs-nss package uses the same versioning scheme as NSS, and embeds the trust anchors that your
Firefox browser has as well. This is meant as alternative to ca-certs (e.g. if you're on a system which
is not (yet) supported by ca-certs), or in a MirageOS unikernel (where there's no access to the host
trust anchors).
</p>

<p>
We're interested in your feedback, and hope by releasing those libraries to improve the security of
network clients across the OCaml ecosystem by providing a simple API to authenticate server
certificates. If you're running into issues, please don't hesitate to reach out.
</p>

<p>
To install, <code>opam install ca-certs</code> / <code>opam install ca-certs-nss</code> is all you need.
</p>
</div>
</div>
</div>




<div id="outline-container-orga007d41" class="outline-2">
<h2 id="10">Compatibility packages for 4.12 (either, semaphore-compat)</h2>
<div class="outline-text-2" id="text-10">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-compatibility-packages-for-4-12-either-semaphore-compat/6806/1">https://discuss.ocaml.org/t/ann-compatibility-packages-for-4-12-either-semaphore-compat/6806/1</a>
</p>
</div>

<div id="outline-container-org2e09f1f" class="outline-3">
<h3 id="org2e09f1f">Craig Ferguson announced</h3>
<div class="outline-text-3" id="text-org2e09f1f">
<p>
I'm pleased to announce the release of two small compatibility libraries for modules added in OCaml
4.12.0:
</p>

<ul class="org-ul">
<li><a href="https://github.com/mirage/either"><code>either</code></a> – compatibility shims for the <a href="https://github.com/ocaml/ocaml/blob/trunk/stdlib/either.mli"><code>Either</code></a> module, which provides a canonical sum type in the standard library + various utility functions for it. To use it: simply add <code>either</code> as a library dependency and refer to the <code>Either</code> module, which will either alias the <code>Either</code> provided by the standard library or re-implement it as appropriate.</li>

<li><a href="https://github.com/mirage/semaphore-compat"><code>semaphore-compat</code></a> – compatibility shims for the <a href="https://github.com/ocaml/ocaml/blob/trunk/otherlibs/systhreads/semaphore.mli"><code>Semaphore</code></a> module in <code>systhreads</code>, which provides binary and counting semaphores for use in multi-threaded programs. To use it: add <code>semaphore-compat</code> as a library dependency and <code>open Semaphore_compat</code> in any module that requires semaphores.</li>
</ul>

<p>
<b><span class="underline">Note on OCaml concurrency primitives</span></b>. Users of OCaml's <code>Mutex</code> module should beware that
OCaml 4.12 features a changes to mutex semantics on certain platforms, since the mutexes are now "error
checking" (as noted in the <a href="https://github.com/ocaml/ocaml/blob/trunk/Changes#L329">changelog</a>). One
consequence of this is that <b><b>unlocking a mutex from a non-owning thread will now always fail</b></b>,
whereas previously this might succeed depending on the platform's mutex implementation – notably,
<code>glibc</code>'s mutexes allow this. If your code relies on this property of pre-4.12 mutexes, you may wish to
add a dependency on <code>semaphore-compat</code> and switch to using binary semaphores instead (as these provide
the right flavour of concurrency primitive in a POSIX-compatible manner).
</p>

<p>
Opam library authors making use of these compatibility libraries in their public API are encouraged to
<a href="https://opam.ocaml.org/doc/Manual.html#Package-Formulas">conditionally depend</a> on them in order to
ensure that downstream users of your library don't pull in unnecessary compatibility shims. This can be
done as follows:
</p>

<pre class="example">
depends: [
  ("ocaml" {&gt;= "4.12.0"} | "either")
]
</pre>

<p>
I hope you find these libraries useful!
</p>
</div>
</div>


<div id="outline-container-orgef57e08" class="outline-3">
<h3 id="orgef57e08">Hannes Mehnert then asked</h3>
<div class="outline-text-3" id="text-orgef57e08">
<p>
Thanks for your work on this.
</p>

<blockquote>
<p>
are encouraged to <a href="https://opam.ocaml.org/doc/Manual.html#Package-Formulas">conditionally depend</a>
</p>
</blockquote>

<p>
While I understand at the opam level how this could work, what about <code>_tags</code> or <code>dune</code> &#x2013; there's need
to repeat that condition (since in OCaml &lt; 4.12 you'll need <code>(libraries either)</code> in your dune file /
<code>*: package(either)</code> in your <code>_tags</code> file (+in your <code>META</code> file) &#x2013; or is there something obvious I
misunderstand?
</p>

<p>
I'm asking since I'd be interested in a general strategy / howto of such compatibility libraries. I'm
also curious why there are different approaches in respect to package name and strategy:
</p>
<ul class="org-ul">
<li>stdlib-shims (seems to (attempt to) cover all stdlib changes?)</li>
<li>bigarray-compat (there's a <code>-compat</code> suffix)</li>
<li>seq (there's a <code>seq.base</code> for ocaml &gt;= 4.07.0)</li>
</ul>

<p>
Are there plans to unify the approaches? I'm in favour of a "conditional dependency if the OCaml
distribution does not yet provide the module" and "no dependency if the OCaml distribution provides
that module" &#x2013; but as expressed above, I think this is needed both at the opam and the ocamlfind /
library level.
</p>
</div>
</div>


<div id="outline-container-org4f73b35" class="outline-3">
<h3 id="org4f73b35">Craig Ferguson replied</h3>
<div class="outline-text-3" id="text-org4f73b35">
<p>
To begin, I'll fill out my reasons for recommending conditional dependencies somewhat.
</p>
</div>

<div id="outline-container-orgf477096" class="outline-4">
<h4 id="orgf477096">Compatibility libraries and unconditional dependencies</h4>
<div class="outline-text-4" id="text-orgf477096">
<p>
The issue with unconditionally depending on compatibility libraries is that it forces users to take on
that implicit dependency – even if they don't need it – and ties that decision to the <span class="underline">current</span> minimal
version supported by one of their dependencies. This prevents use of <code>(implicit_transitive_deps false)</code>
in those downstream libraries, since the authors cannot know whether they actually depend on the alias
transitively. For instance:
</p>

<ul class="org-ul">
<li><code>lwt</code> currently depends on <code>result</code> unconditionally (to retain support for <code>4.02.0</code>);</li>

<li>as an author of <code>irmin</code> – which goes back to  <code>4.08.0</code> and so always has access to <code>Stdlib.Result</code> – I must be able to resolve the <code>Lwt_result.t</code> type, but I don't in general know which dependencies are necessary to do that since it's a property of <code>Lwt</code>'s code and not mine.</li>

<li>I must either add an explicit dependency on <code>result</code> – because that's what's <span class="underline">currently</span> necessary given <code>Lwt</code>'s own dependencies – or give up on using <code>(implicit_transitive_deps false)</code> entirely. Either way, if I myself expose a <code>result</code> type in the API of Irmin, this problem cascades to users of Irmin too.</li>
</ul>

<p>
For Lwt specifically, I need to find the time to upstream a patch to fix the issue:
<a href="https://github.com/ocsigen/lwt/issues/794">https://github.com/ocsigen/lwt/issues/794</a>.
</p>
</div>
</div>

<div id="outline-container-orgd8a2080" class="outline-4">
<h4 id="orgd8a2080">Conditional dependencies and Dune</h4>
<div class="outline-text-4" id="text-orgd8a2080">
<p>
It's possible to conditionally depend on a library on the Dune side via either a <a href="https://dune.readthedocs.io/en/stable/concepts.html#alternative-dependencies"><code>(select ... from
...)</code></a> dependency or by
generating Dune files programatically (either w/ <code>(include dune.inc)</code> or
<a href="https://dune.readthedocs.io/en/stable/advanced-topics.html#ocaml-syntax"><code>Jbuild_plugin</code></a>). None of
these solutions are particularly compelling to me, but I've been bitten by this problem enough to be
willing to consider ugly solutions – at least for very widely-used libraries such as Alcotest.
</p>

<p>
It's possible that conditional dependencies are the wrong approach altogether and we should be using
something like <a href="https://github.com/ocaml/dune/pull/2605"><code>(re_exports)</code></a> instead. I'm not familiar with
that feature, but it looks like it might work to avoid the above issues. Perhaps a Dune maintainer
could weigh in here, and I'll happily remove my suggestion re. conditional dependencies for something
better :slightly_smiling_face:
</p>
</div>
</div>

<div id="outline-container-orgd9e5408" class="outline-4">
<h4 id="orgd9e5408">Different approaches to compatibility libraries</h4>
<div class="outline-text-4" id="text-orgd9e5408">
<blockquote>
<p>
I’m asking since I’d be interested in a general strategy / howto of such compatibility libraries. I’m
also curious why there are different approaches in respect to package name and strategy:
</p>
<ul class="org-ul">
<li>stdlib-shims (seems to (attempt to) cover all stdlib changes?)</li>
<li>bigarray-compat (there’s a <code>-compat</code> suffix)</li>
<li>seq (there’s a <code>seq.base</code> for ocaml &gt;= 4.07.0)</li>
</ul>
</blockquote>

<p>
Indeed, there are quite a few different mechanisms used for this. Even just for this release, <code>either</code>
and <code>semaphore-compat</code> use different techniques! Partly this is because it's easier to shim modules in
<code>Stdlib</code> since it is the default-opened library. In particular, <code>Either</code> can exist without a namespace
collision, and the <span class="underline">implementation</span> of <code>either</code> can refer to <code>Stdlib.Either</code> to avoid Dune getting
confused about a self-referential module. This is the approach that was taken with the <code>result</code>
compatability package too.
</p>

<p>
Unfortunately, the above factors don't apply to <code>Semaphore</code>, which is why I grudgingly settled on
<code>semaphore-compat</code> instead. I'm not sure why the <code>Bigarray</code> compat module didn't take the more "direct"
approach, but I was happy to be consistent with it.
</p>

<p>
One final point: the <code>stdlib-shims</code> library exists <span class="underline">solely</span> to provide the alias <code>Stdlib</code> ↦
<code>Pervasives</code> in order to compensate for the name change. It doesn't ever provide re-implementations of
the modules and functions that were added since (and so really is a <code>-shim</code> and not a <code>-compat</code>). A
user of <code>stdlib-shims</code> is still restricted to the set of stdlib functions provided by their minimal
supported OCaml version.
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-org2f16905" class="outline-2">
<h2 id="11">Jupyter with pyml</h2>
<div class="outline-text-2" id="text-11">
<p>
Archive: <a href="https://discuss.ocaml.org/t/jupyter-with-pyml/6813/1">https://discuss.ocaml.org/t/jupyter-with-pyml/6813/1</a>
</p>
</div>

<div id="outline-container-org9bad78c" class="outline-3">
<h3 id="org9bad78c">n4323 asked</h3>
<div class="outline-text-3" id="text-org9bad78c">
<p>
Hi, I would like to achieve something similar to, but different from what is discussed in
<a href="https://discuss.ocaml.org/t/ocaml-in-jupyter-based-environments/6797">https://discuss.ocaml.org/t/ocaml-in-jupyter-based-environments/6797</a> . tl; dr: How can I get python
REPL access to OCaml values exported via <code>pyml</code>?
</p>

<p>
The use case is this: I have an OCaml library that does machine-learning type computation. I would like
to generate, plot and analyze the results interactively, with the best possible ease of use and
flexibility. For the plotting and analysis I want to use Python.
</p>

<p>
I have tried <code>ocaml-jupyter</code>, which provides a nice notebook environment but no python kernel and the
very useful <code>ocaml-matplotlib</code> which offers a matplotlib binding but cannot cover all my python library
needs.
</p>

<p>
A possible solution would be to use <code>pyml</code> and its numpy array memmapping support to export OCaml
values to a python process. The problem here is that I can't find a way to interact with the python
process spawned from <code>pyml</code> in an interactive python console. I am thinking there should be some way to
spawn a Jupyter python kernel from <code>pyml</code> and then access that from a separate jupyter console. I have
not been able to find one by googling though.
</p>

<p>
Another solution might be to wrap my OCaml library as an external python module. I'm afraid that this
may be painful &#x2013; please convince me otherwise ;)
</p>
</div>
</div>


<div id="outline-container-org431ae7c" class="outline-3">
<h3 id="org431ae7c">Craig Ferguson</h3>
<div class="outline-text-3" id="text-org431ae7c">
<p>
You may be interested in this post on the Jane Street tech blog:
</p>

<blockquote>
<p>
<a href="https://blog.janestreet.com/using-python-and-ocaml-in-the-same-jupyter-notebook/"><b>Using Python and OCaml in the same Jupyter notebook</b></a>, by
Laurent Mazare (@laurent).
</p>
</blockquote>

<p>
which offers some general tips and some bespoke tooling (showcased in
<a href="https://colab.research.google.com/drive/1MDuZc0v60lzBg0_xeiPR-bB6dCIWxvzT">https://colab.research.google.com/drive/1MDuZc0v60lzBg0_xeiPR-bB6dCIWxvzT</a>). I have found this very
useful in the past when trying to do Python + OCaml interop in Jupyter notebooks.
</p>
</div>
</div>
</div>




<div id="outline-container-org45e56f1" class="outline-2">
<h2 id="12">OCaml needs an arbitrary-precision decimal type</h2>
<div class="outline-text-2" id="text-12">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-needs-an-arbitrary-precision-decimal-type/6735/6">https://discuss.ocaml.org/t/ocaml-needs-an-arbitrary-precision-decimal-type/6735/6</a>
</p>
</div>

<div id="outline-container-orgd3bf2ed" class="outline-3">
<h3 id="orgd3bf2ed">Yaron Minsky announced</h3>
<div class="outline-text-3" id="text-orgd3bf2ed">
<p>
Our Bigdecimal library is now live:
</p>

<p>
<a href="https://github.com/janestreet/bigdecimal">https://github.com/janestreet/bigdecimal</a>
</p>

<p>
It won't be in the ordinary Opam repo until our next stable release, which is scheduled for early 2021.
</p>
</div>
</div>
</div>




<div id="outline-container-orge63fbb4" class="outline-2">
<h2 id="13">Type-at-point ocaml-lsp/merlin in vim/neovim</h2>
<div class="outline-text-2" id="text-13">
<p>
Archive: <a href="https://discuss.ocaml.org/t/type-at-point-ocaml-lsp-merlin-in-vim-neovim/6832/1">https://discuss.ocaml.org/t/type-at-point-ocaml-lsp-merlin-in-vim-neovim/6832/1</a>
</p>
</div>

<div id="outline-container-org920505b" class="outline-3">
<h3 id="org920505b">Nicolas Gimenez discussed</h3>
<div class="outline-text-3" id="text-org920505b">
<p>
I'd like to know whether ocaml-lsp supports type-at-point feature? The point is to display to the user
the type at point inferred by the compiler.
I think this functionality already exists in Merlin for a while:
<a href="https://github.com/ocaml/merlin/issues/6">merlin-show-type-at-point</a>, and I've read
<a href="https://khady.info/emacs-ocaml-lsp.html">articles</a> talking about people's corresponding
lsp-mode/merlin Emacs config.
How about VIM? Is it integrated in ocaml-lsp already? From looking on GitHub, it seems it's not, but
then how come people manage to integrate it in Emacs' lsp-mode?
</p>
</div>
</div>


<div id="outline-container-org8a9bc96" class="outline-3">
<h3 id="org8a9bc96">mudrz replied</h3>
<div class="outline-text-3" id="text-org8a9bc96">
<p>
I am using <code>neovim</code> and the following config:
</p>

<p>
in <code>.vimrc</code>
</p>
<pre class="example">
Plug 'sheerun/vim-polyglot'
Plug 'neoclide/coc.nvim', {'branch': 'release'}

nnoremap &lt;silent&gt; gh :call &lt;SID&gt;show_documentation()&lt;CR&gt;

function! s:show_documentation()
  if (index(['vim','help'], &amp;filetype) &gt;= 0)
    execute 'h '.expand('&lt;cword&gt;')
  else
    call CocAction('doHover')
  endif
endfunction
</pre>

<p>
and in <code>:CocConfig</code>:
</p>
<pre class="example">
"languageserver":{
  "ocaml": {
    "command": "ocamllsp",
    "rootPatterns": ["dune-project"],
    "filetypes": ["ocaml"],
    "initializationOptions": {},
    "settings": {}
  }
}
</pre>

<p>
which allows to show a type tooltip like this when you press `gh`
<img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/optimized/2X/9/943c5e3dbeb3f4d92bfc905a57d9ef2cfc339317_2_1380x150.png" alt="943c5e3dbeb3f4d92bfc905a57d9ef2cfc339317_2_1380x150.png" />
</p>
</div>
</div>


<div id="outline-container-orgf2cd019" class="outline-3">
<h3 id="orgf2cd019">Raphaël Proust also replied</h3>
<div class="outline-text-3" id="text-orgf2cd019">
<p>
In my <code>.config/nvim/init.vim</code> I have the default things setup by opam and then (amongst other things):
</p>

<pre class="example">
autocmd FileType ocaml nnoremap &lt;LocalLeader&gt;t :MerlinTypeOf&lt;CR&gt;
</pre>
</div>
</div>
</div>




<div id="outline-container-orgbb8fc6d" class="outline-2">
<h2 id="14">ocamlearlybird now an OCaml Software Foundation supported project</h2>
<div class="outline-text-2" id="text-14">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocamlearlybird-now-an-ocaml-software-foundation-supported-project/6834/1">https://discuss.ocaml.org/t/ann-ocamlearlybird-now-an-ocaml-software-foundation-supported-project/6834/1</a>
</p>
</div>

<div id="outline-container-orgf71c5cf" class="outline-3">
<h3 id="orgf71c5cf">文宇祥 announced</h3>
<div class="outline-text-3" id="text-orgf71c5cf">
<p>
I’m happy to announce ocamlearlybird now an OCaml Software Foundation supported project.
</p>

<p>
We will continue to develop/maintain ocamlearlybird, and may contribute to ocamlrun/ocaml to
improve/achieve OCaml bytecode/native debugging support.
</p>

<p>
Please expect that OCaml debugging experience will be as good as Javascript in the future.
</p>
</div>
</div>


<div id="outline-container-org584f785" class="outline-3">
<h3 id="org584f785">Louis Roché then said</h3>
<div class="outline-text-3" id="text-org584f785">
<p>
I suppose that you are referring to <a href="https://github.com/hackwaly/ocamlearlybird">https://github.com/hackwaly/ocamlearlybird</a>
</p>

<p>
That's a great news. Thanks for your work.
</p>
</div>
</div>
</div>




<div id="outline-container-org978b579" class="outline-2">
<h2 id="15">release of mc2 0.1, a SMT solver</h2>
<div class="outline-text-2" id="text-15">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-release-of-mc2-0-1-a-smt-solver/6835/1">https://discuss.ocaml.org/t/ann-release-of-mc2-0-1-a-smt-solver/6835/1</a>
</p>
</div>

<div id="outline-container-orgfbed6a9" class="outline-3">
<h3 id="orgfbed6a9">Simon Cruanes announced</h3>
<div class="outline-text-3" id="text-orgfbed6a9">
<p>
I'm happy to announce the initial release 0.1 of <a href="https://github.com/c-cube/mc2">mc2</a>, a <a href="https://en.wikipedia.org/wiki/Satisfiability_modulo_theories">SMT
solver</a> in pure OCaml based on the mcSAT
framework. It can handle the QF_UFLRA fragment (functions and linear rational arithmetic). It is more
of a research project than a production ready solver, but has pretty acceptable performance (see for
examples benchmarks on
<a href="https://benchpress.cedeela.fr/show/res-20201117T131950-cfa5920b-5187-4d73-8f5b-00b5c77aaeb8.sqlite">QF_UFLRA</a>
and
<a href="https://benchpress.cedeela.fr/show/res-20201116T203511-687d557c-5c27-4478-9cc2-8b2603820ab6.sqlite">QF_LRA</a>
with timeout=10s).
</p>

<p>
The solver is Apache licensed and weights around 7kloc (+ a few basic dependencies). Questions or
comments welcome :slight_smile:
</p>
</div>
</div>
</div>




<div id="outline-container-org9a2b41e" class="outline-2">
<h2 id="16">Wednesday, 25th November 2020 is MirageOS Bug Cleaning Day!</h2>
<div class="outline-text-2" id="text-16">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-wednesday-25th-november-2020-is-mirageos-bug-cleaning-day/6836/1">https://discuss.ocaml.org/t/ann-wednesday-25th-november-2020-is-mirageos-bug-cleaning-day/6836/1</a>
</p>
</div>

<div id="outline-container-org03d8ca9" class="outline-3">
<h3 id="org03d8ca9">Hannes Mehnert announced</h3>
<div class="outline-text-3" id="text-org03d8ca9">
<p>
We have many repositories that have lots of old and no-longer-relevant
issues in them (some have even been fixed!) as well as issues that
haven't gotten a reply yet from a maintainer. In preparation for the
next release, I think it would be nice to take a day and do some
housecleaning.
</p>

<p>
Our last bug cleaning day was on 17th November 2017, and pretty successful.
</p>

<p>
On Wednesday, 25th November (in two days) most people of the mirage-core
team will be going through old issues and coordinating our efforts on
the #mirage channel over on irc.freenode.net.  I expect there to be the
most activity during 10:00-18:00 UTC and maybe a bit later, but don't
feel limited to that timeslot &#x2013; if you're familiar with a repository
and have a bit of time, we'd love your help any time at all.  Please do
join us if you're free! We'll as well be watching the OCaml discord #mirage channel
<a href="https://discord.com/channels/436568060288172042/519199441769594911">https://discord.com/channels/436568060288172042/519199441769594911</a>
</p>

<p>
If you're not sure where to start, here's a link to a GitHub search for
all issues in repositories owned by the Mirage organization which are
open and not archived, sorted with the least recently updated first, for
your editing and browsing pleasure:
</p>

<p>
<a href="https://github.com/issues?q=is%3Aopen+is%3Aissue+org%3Amirage+archived%3Afalse+sort%3Aupdated-asc">https://github.com/issues?q=is%3Aopen+is%3Aissue+org%3Amirage+archived%3Afalse+sort%3Aupdated-asc</a>
</p>

<p>
If you've a specific issue at your heart that you want to be solved,
please show up and tell us about it.
</p>
</div>
</div>
</div>




<div id="outline-container-org8c74eae" class="outline-2">
<h2 id="17">Other OCaml News</h2>
<div class="outline-text-2" id="text-17">
</div>
<div id="outline-container-org2a70011" class="outline-3">
<h3 id="org2a70011">From the ocamlcore planet blog</h3>
<div class="outline-text-3" id="text-org2a70011">
<p>
Here are links from many OCaml blogs aggregated at <a href="http://ocaml.org/community/planet/">OCaml Planet</a>.
</p>

<ul class="org-ul">
<li><a href="https://rescript-lang.org/blog/editor-support-custom-operators-and-more">Editor Support, Custom Operators and More</a></li>
<li><a href="https://coq.inria.fr/news/coq-8-12-1-is-out.html">Coq 8.12.1 is out</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orgd96a1ff" class="outline-2">
<h2 id="orgd96a1ff">Old CWN</h2>
<div class="outline-text-2" id="text-orgd96a1ff">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="http://alan.petitepomme.net/cwn/">the archive</a> or the <a href="http://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname">
<p>
<a href="http://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
