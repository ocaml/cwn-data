<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-05-09 Tue 08:44 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2023.05.02.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2023.05.16.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of May 02 to 09, 2023.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#1">Overview of libraries for showing OCaml values</a></li>
<li><a href="#2">kcas and kcas_data 0.3.0: Software Transactional Memory</a></li>
<li><a href="#3">OCaml.org Newsletter: March 2023</a></li>
<li><a href="#4">Creating a tutorial on sequences</a></li>
<li><a href="#5">You started to learn OCaml less than 12 months ago? Please help us with our user survey on the OCaml.org Learning Area</a></li>
<li><a href="#6">Explorations on Package Management in Dune</a></li>
<li><a href="#7">Functional web applications running in the browser</a></li>
<li><a href="#8">Ahrefs is now built with Melange</a></li>
<li><a href="#9">Other OCaml News</a></li>
<li><a href="#org8b939b0">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">Overview of libraries for showing OCaml values</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/overview-of-libraries-for-showing-ocaml-values/12076/1">https://discuss.ocaml.org/t/overview-of-libraries-for-showing-ocaml-values/12076/1</a>
</p>
</div>

<div id="outline-container-orga72952e" class="outline-3">
<h3 id="orga72952e">Anton Bachin said</h3>
<div class="outline-text-3" id="text-orga72952e">
<p>
In light of the <a href="https://discuss.ocaml.org/t/idea-standard-ocaml-runtime-type-representation/12051/2">recent
thread</a> on, among other
things, showing OCaml values, and because of Dream&rsquo;s <a href="https://github.com/aantron/dream/wiki/Roadmap#logging">long-standing
need</a> for this to exist in OCaml, I&rsquo;ve done, as
<a href="https://discuss.ocaml.org/t/idea-standard-ocaml-runtime-type-representation/12051/6">suggested</a>, a comparison of
the available libraries. They seem to fall into three categories.
</p>

<ol class="org-ol">
<li><p>
Libraries that walk the runtime representation of values and dump it.
</p>

<p>
These provide a <b><code>'a -&gt; string</code></b> functions that can immediately print any value, and are the easiest to use. They are what I need in Dream &#x2013; something that a normal person can use for debugging without any boilerplate.
The <b>accuracy</b> of these libraries is <b>limited</b> because the type information preserved in the runtime is very bare.
</p>

<p>
These are:
</p>

<ol class="org-ol">
<li>reason-native&rsquo;s <a href="https://github.com/reasonml/reason-native/tree/master/src/console#consoleloganything"><b><code>Console.log</code></b></a>.</li>
<li><a href="https://github.com/mjambon/dum#readme"><b>Dum</b></a></li>
<li><a href="https://github.com/krohrer/caml-inspect#readme"><b>Inspect</b></a></li>
</ol>

<p>
There is also <a href="https://github.com/gbury/ocaml-memgraph">Memgraph</a>, but this appears to only output DOT graphs, so I didn&rsquo;t look into it in detail.
</p>

<p>
Since I am interested in these for my purposes, I wrote a tester that compares their outputs, and uploaded it into a <a href="https://gist.github.com/aantron/a65098b0febb3ac34cb63ea9285d9316#file-test-ml">gist</a>. See the outputs for <a href="https://gist.github.com/aantron/a65098b0febb3ac34cb63ea9285d9316#file-z-console-log-txt"><code>Console.log</code></a>, <a href="https://gist.github.com/aantron/a65098b0febb3ac34cb63ea9285d9316#file-z-dum-txt">Dum</a>, <a href="https://gist.github.com/aantron/a65098b0febb3ac34cb63ea9285d9316#file-z-inspect-txt">Inspect</a>. They are all variants of each other. Each has its own quirks and bugs, but they all look roughly like this:
</p>

<pre class="example" id="org4234ab5">
    &gt; Console.log "abc"
    "abc"
    &gt; Console.log 42
    42
    &gt; Console.log {a = "abc"; b = 42}
    {"abc"; 42}
</pre>

<p>
Interestingly (but predictably), for extensible variants like <code>exn</code>, these dumpers are able to print the string representation of variant constructors even with OCaml&rsquo;s current runtime.
</p></li>

<li><p>
Libraries, such as <code>ppx_deriving</code>, that have a PPX generate, or the user manually provide, information about types &#x2013; that is, provide helper values that describe types, and then ask the user to provide that information to walk values and dump them.
</p>

<p>
These are unsuitable for my goals. All of these require the user to pass in the type information to the printing function at each call site, because in the absence of modular implicits or type classes, the compiler cannot automatically associate the type information with the values. They provide, roughly, <b><code>('a -&gt; string) -&gt; 'a -&gt; string</code></b> functions. The user has to provide the <code>'a -&gt; string</code> for each <code>'a</code> each time they would like to print an <code>'a</code>.
</p>

<p>
If <code>'a</code> is a “container” type, the required function is a higher-order function that needs additional function(s) for the element types. This is <b>not ergonomic</b>, as each call site where one would like to show a value needs boilerplate. Even if the <code>'a -&gt; string</code> is precomposed, it requires the user to remember what it is called, pick the right one, and is not resistant to various refactorings such as wrapping in <code>option</code>. But such libraries are accurate, because the type information provided in the boilerplate can be precise.
</p>

<p>
These are:
</p>

<ol class="org-ol">
<li><a href="https://github.com/ocaml-ppx/ppx_deriving#usage"><b>ppx_deriving</b></a>&rsquo;s <code>[@@deriving show]</code>.</li>
<li><a href="https://github.com/thierry-martinez/refl#basic-usage"><b>refl</b></a>, a ppx_deriving-like.</li>
<li><a href="https://github.com/LexiFi/lrt#getting-started"><b>lrt</b></a>, another ppx_deriving-like.</li>
<li><a href="https://github.com/pqwy/tpf#readme"><b>tpf</b></a>, again a ppx_deriving-like.</li>
<li><a href="https://github.com/janestreet/typerep"><b>typerep</b></a>, probably a ppx_deriving-like with ppx_typerep_conv.</li>
<li><a href="https://mirage.github.io/repr/repr/Repr/index.html#val-pp_json"><b>repr</b></a>, which appears to have the user build the type representation manually from combinators and then also pass it where need it.</li>
<li><a href="https://gitlab.com/nomadic-labs/data-encoding/-/blob/master/src/tutorial.md#how-to-build-an-encoding"><b>data-encoding</b></a>, also fully manual.</li>
<li><a href="https://github.com/let-def/cmon#documentation"><b>cmon</b></a>, fully manual.</li>
<li><a href="https://github.com/ocaml/dune/blob/4b95cd3d1b3a62e69a9a9db2bc4af2f9fd2e56d8/otherlibs/dyn/dyn.mli"><b>dyn</b></a> in Dune. Appears to also be fully manual.</li>
</ol>

<p>
I didn&rsquo;t try these out in detail because they are all unsuitable as <code>Console.log</code>-alikes for inspecting OCaml values without excessive boilerplate. As can be seen from their documentation, they all require boilerplate in the form of functions/witnesses/calling the right function, depending on the type, at the place where you&rsquo;d like to show a value. The last four also require the user to manually build up the type representation using combinators.
</p>

<div class="org-src-container">
<pre class="src src-ocaml">    <span style="color: #444fcf;">M.</span>show_myfpclass <span style="color: #242521; background-color: #fcf7ef;">FP_normal</span>       <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">ppx_deriving: know the function.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>

    <span style="color: #444fcf;">Refl.</span>show <span style="color: #a2604f; background-color: #ebebeb;">[%refl</span>: (string * int) list<span style="color: #a2604f; background-color: #ebebeb;">]</span> <span style="color: #242521; background-color: #fcf7ef;">[]</span> [<span style="color: #ca3400;">"a"</span>, <span style="color: #00824f;">1</span>; <span style="color: #ca3400;">"b"</span>, <span style="color: #00824f;">2</span>]<span style="color: #ff4500;">;;</span>
                                     <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">refl: describe the type.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
    <span style="color: #444fcf;">Print.</span>show <span style="color: #00824f;">~t</span>:nat_t (<span style="color: #242521; background-color: #fcf7ef;">S</span> (<span style="color: #242521; background-color: #fcf7ef;">S</span> (<span style="color: #242521; background-color: #fcf7ef;">S</span> <span style="color: #242521; background-color: #fcf7ef;">Z</span>)))
                                     <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">lrt: provide the type info.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
    <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">The docs for tpf are too obscure, but it's the same kind of library.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>

    <span style="color: #444fcf;">Fmt.</span>str <span style="color: #ca3400;">"%a\n"</span> (pp t) { foo = <span style="color: #242521; background-color: #fcf7ef;">None</span>; bar = [ <span style="color: #ca3400;">"foo"</span> ] }
                                     <span style="color: #8f6f4a; font-style: italic;">(* </span><span style="color: #8f6f4a; font-style: italic;">repr: build &amp; provide the type info.</span><span style="color: #8f6f4a; font-style: italic;"> *)</span>
</pre>
</div>

<p>
etc. These kinds of approaches are probably also present in other libraries that do e.g. JSON encoding.
</p></li>

<li><p>
Libraries that use a PPX at the call site to provide what looks like an <code>'a -&gt; string</code> function as in (1), but try to infer the type of the value being shown and derive its printer as in (2).
</p>

<p>
These don&rsquo;t seem to handle separate compilation well, as could be expected, and generally appear fragile.
</p>

<p>
These are:
</p>

<ol class="org-ol">
<li><a href="https://github.com/progman1/genprintlib#readme"><b>Genprint</b></a></li>
<li><a href="https://github.com/tsubame-sp/ocaml_at_p#readme"><b>OCaml@p</b></a></li>
</ol></li>
</ol>

<p>
In my opinion, for the needs I see, the best approach would be runtime printing as in (1) with runtime type
information that is accessible through pointers or indices stored in OCaml blocks. I wonder if this is what the
LexiFi <a href="https://discuss.ocaml.org/t/idea-standard-ocaml-runtime-type-representation/12051/2">fork</a> does. @nojb?
</p>

<p>
For those interested, we did the main part of the comparison on
<a href="https://www.twitch.tv/videos/1809433679?t=00h14m21s">stream</a>.
</p>
</div>
</div>


<div id="outline-container-orge032367" class="outline-3">
<h3 id="orge032367">Nicolas Ojeda Bar replied</h3>
<div class="outline-text-3" id="text-orge032367">
<blockquote>
<p>
I wonder if this is what the LexiFi <a href="https://discuss.ocaml.org/t/idea-standard-ocaml-runtime-type-representation/12051/2">fork
</a> does. @nojb?
</p>
</blockquote>

<p>
Not exactly.
</p>

<p>
We don&rsquo;t attach type information to values directly, as we don&rsquo;t want to modify the runtime model of OCaml (also,
this would only work with heap-allocated values, which would all become larger).
</p>

<p>
What we do instead is that when a function has a labeled, <span class="underline">non-optional</span> argument of type <code>'a ttype</code> (here <code>'a
ttype</code> is the &ldquo;type of types&rdquo; with constructors corresponding to each kind of type in OCaml) and the argument is
not passed explicitly, then the compiler synthetizes it at each callsite.
</p>

<p>
Concretely, if we define a function of the form
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">show</span> ~(<span style="color: #007a9f;">t</span>:<span style="color: #444fcf;"> 'a ttype</span>) (<span style="color: #007a9f;">x</span>:<span style="color: #444fcf;"> 'a</span>) :<span style="color: #444fcf;"> string </span>=
  <span style="color: #006f00; font-weight: bold;">match</span> t <span style="color: #006f00; font-weight: bold;">with</span>
  | <span style="color: #242521; background-color: #fcf7ef;">Int</span> -&gt; string_of_int x
  | <span style="color: #242521; background-color: #fcf7ef;">String</span> -&gt; x
  | ...
</pre>
</div>
<p>
And we call it with <code>show 42</code>, the compiler inserts <code>~t:Int</code> as first argument. For efficiency, type witnesses (the
values of type <code>'a ttype</code>) are actually computed at compilation-time whenever possible.
</p>

<p>
Makes sense?
</p>
</div>
</div>


<div id="outline-container-org763ffc8" class="outline-3">
<h3 id="org763ffc8">Later on, Nicolas Ojeda Bar said</h3>
<div class="outline-text-3" id="text-org763ffc8">
<p>
I see there is a lot of enthusiasm for adding some form of type reflection to OCaml; that&rsquo;s great! It is true that
at LexiFi we have a tried-and-tested system in use for a long time. Let me try to give some perspective about it
and answer some of the questions that came up:
</p>

<ul class="org-ul">
<li>The LexiFi patch actually consists of two parts: 1) the representation of types as an OCaml datatype; 2) a patch to the typechecker/middle end to have the compiler automatically generate type witnesses (as sketched <a href="https://discuss.ocaml.org/t/overview-of-libraries-for-showing-ocaml-values/12076/2?u=nojb">above</a>).</li>

<li>It is important to note that 1) is to an extent independent of 2); it comes down to giving a suitable definition of the &ldquo;type of types&rdquo;. I understand from past discussion that proposals in this direction would be welcome by the OCaml dev team. Accordingly, one should concentrate for the most part in 1) to make progress.</li>

<li>For historical reasons the LexiFi version of 1) (ie the type representation, see <a href="https://github.com/LexiFi/lrt/blob/038ff963bd066c9d94cffb9896b04b6b8696f136/lib/stype.mli#L12-L25">here</a> and <a href="https://github.com/LexiFi/lrt/blob/038ff963bd066c9d94cffb9896b04b6b8696f136/lib/xtype.mli#L16-L36">here</a>) has a number of quirks. Furthermore, it makes design choices that may not be the best ones in general. For example, it only represents closed types: no type constructors or type variables can be represented, and so in particular neither can exotic types such as GADTs, first-class modules, extensible types, polymorphic variants, etc.</li>

<li>The <span class="underline">main</span> challenge in devising a suitable representation of types is deciding how to handle abstract types (see the <a href="https://v2.ocaml.org/meetings/ocaml/2013/proposals/runtime-types.pdf">paper</a> and the <a href="https://v2.ocaml.org/meetings/ocaml/2013/slides/henry.pdf">slides</a> I linked to in <a href="https://discuss.ocaml.org/t/idea-standard-ocaml-runtime-type-representation/12051/2?u=nojb">the other thread</a>). At LexiFi abstract types are represented via &ldquo;global names&rdquo; (ie we identify an abstract type <code>M.t</code> by its name <code>"M.t"</code>). This works reasonably well in practice, but is not a good solution in general (the notion of &ldquo;name&rdquo; for an abstract type is not well-defined). I suspect the answer may be something of a research problem&#x2026;</li>

<li>LexiFi did discuss upstreaming a version of its fork long time ago (~2011), but I suspect it wasn&rsquo;t done mainly because of the theoretical shortcomings of the current implementation (eg handling of abstract types).</li>

<li>Accordingly, the LexiFi fork is not open-source: we don&rsquo;t have the manpower to support it as an open-source project, we don&rsquo;t want to release a version of this technology which has known limitations that make it easy to shot yourself in the foot if you don&rsquo;t know what you are doing, and finally there are some commercial considerations to take into account (but my impression is that if this technology was polished enough that it could be accepted upstream, LexiFi would be happy to do so).</li>

<li>Personally, from a distance, <a href="https://github.com/thierry-martinez/refl">https://github.com/thierry-martinez/refl</a> looks rather interesting, but its <a href="https://github.com/thierry-martinez/refl/blob/master/runtime/desc.ml">type representation</a> is quite complex and is not clear it can be made suitable for &ldquo;practical&rdquo; use.</li>
</ul>

<p>
I hope this answers some of the questions!
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">kcas and kcas_data 0.3.0: Software Transactional Memory</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-kcas-and-kcas-data-0-3-0-software-transactional-memory/12085/1">https://discuss.ocaml.org/t/ann-kcas-and-kcas-data-0-3-0-software-transactional-memory/12085/1</a>
</p>
</div>

<div id="outline-container-orga83b686" class="outline-3">
<h3 id="orga83b686">Vesa Karvonen announced</h3>
<div class="outline-text-3" id="text-orga83b686">
<p>
I&rsquo;m happy to announce that, as of version 0.3.0, <a href="https://opam.ocaml.org/packages/kcas/"><code>kcas</code></a> can be considered
to be a software transactional memory (STM) implementation based on lock-free multi-word compare-and-set (MCAS).
</p>

<p>
The main feature added in 0.3.0 is <a href="https://github.com/ocaml-multicore/kcas/#blocking-transactions">the ability to
block</a> — in a scheduler friendly manner
— awaiting for changes to shared memory locations.
</p>

<p>
Let&rsquo;s explore this by writing a short example with the help of <a href="https://github.com/realworldocaml/mdx">MDX</a>. (Yes,
I&rsquo;m actually testing this announcement.)
</p>

<p>
First we&rsquo;ll require and open the
<a href="https://ocaml-multicore.github.io/kcas/doc/kcas_data/Kcas_data/index.html"><code>kcas_data</code></a> library:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># #require <span style="color: #ca3400;">"kcas_data"</span>
# <span style="color: #000000; font-weight: bold;">open </span><span style="color: #444fcf;">Kcas_data</span>
</pre>
</div>

<p>
<code>kcas_data</code> gives us a number of domain safe and composable data structures and communication and synchronization
primitives, such as a <a href="https://ocaml-multicore.github.io/kcas/doc/kcas_data/Kcas_data/Queue/index.html"><code>Queue</code></a>
and a <a href="https://ocaml-multicore.github.io/kcas/doc/kcas_data/Kcas_data/Promise/index.html"><code>Promise</code></a>, for
concurrent programming.
</p>

<p>
Let&rsquo;s then create a message queue:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">greeter_queue</span> = <span style="color: #444fcf;">Queue.</span>create ()
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">greeter_queue</span> : '_weak1 <span style="color: #444fcf;">Kcas_data.Queue.</span>t = &lt;abstr&gt;
</pre>
</div>

<p>
And spawn a &ldquo;greeter&rdquo; domain that responds to messages with a greeting:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">greeter_domain</span> = <span style="color: #444fcf;">Domain.</span>spawn <span style="color: #a52a2a;">@@</span> <span style="color: #006f00; font-weight: bold;">fun</span> () -&gt;
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #000000; font-weight: bold;">rec</span> <span style="color: #a7601f;">loop</span> () =
      <span style="color: #006f00; font-weight: bold;">match</span> <span style="color: #444fcf;">Queue.</span>take_blocking greeter_queue <span style="color: #006f00; font-weight: bold;">with</span>
      | <span style="color: #242521; background-color: #fcf7ef;">`Close</span> -&gt; ()
      | <span style="color: #242521; background-color: #fcf7ef;">`Greet</span> (target, resolver) -&gt;
        <span style="color: #444fcf;">Promise.</span>resolve resolver (<span style="color: #444fcf;">Printf.</span>sprintf <span style="color: #ca3400;">"Hello, %s!"</span> target);
        loop ()
    <span style="color: #000000; font-weight: bold;">in</span>
    loop ()
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">greeter_domain</span> : unit <span style="color: #444fcf;">Domain.</span>t = &lt;abstr&gt;
</pre>
</div>

<p>
Let&rsquo;s also create a helper function, <code>greet</code>, to interact with the greeter:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a7601f;">greet</span> <span style="color: #007a9f;">target</span> =
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #007a9f;">promise</span>, <span style="color: #007a9f;">resolver</span> = <span style="color: #444fcf;">Promise.</span>create () <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #444fcf;">Queue.</span>add (<span style="color: #242521; background-color: #fcf7ef;">`Greet</span> (target, resolver)) greeter_queue;
    <span style="color: #444fcf;">Promise.</span>await promise
<span style="color: #000000; font-weight: bold;">val</span> <span style="color: #a7601f;">greet</span> : string -&gt; string = &lt;<span style="color: #006f00; font-weight: bold;">fun</span>&gt;
</pre>
</div>

<p>
Now we can call the greeter, which is running in another domain, as if it was a regular function. So, here is to
you:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># greet <span style="color: #ca3400;">"fellow concurrent programmer"</span>
- : string = <span style="color: #ca3400;">"Hello, fellow concurrent programmer!"</span>
</pre>
</div>

<p>
And everyone else:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># greet <span style="color: #ca3400;">"the rest of the world"</span>
- : string = <span style="color: #ca3400;">"Hello, the rest of the world!"</span>
</pre>
</div>

<p>
Let&rsquo;s not forget to clean up:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"># <span style="color: #444fcf;">Queue.</span>add <span style="color: #242521; background-color: #fcf7ef;">`Close</span> greeter_queue
- : unit = ()
# <span style="color: #444fcf;">Domain.</span>join greeter_domain
- : unit = ()
</pre>
</div>

<p>
The blocking mechanism in <code>kcas</code> does not only work with plain domains and systhreads. It can also work across
schedulers such as <a href="https://discuss.ocaml.org/t/interaction-between-eio-and-domainslib-unhandled-exceptions/11971/10">Eio and
Domainslib</a>,
which both recently merged support for it and should soon have the necessary support out-of-the-box.
</p>

<p>
Finally, one might ask what is the cost of all this?
</p>

<p>
It turns out that after some careful optimizations, <code>kcas</code> performs pretty much as well as it used to. As a random
data point, at the time of writing this, the <code>Queue</code> provided by the latest version of <code>kcas_data</code> can actually be
faster than the Michael-Scott queue implementation from the latest version of
<a href="https://github.com/ocaml-multicore/lockfree"><code>lockfree</code></a>:
</p>

<pre class="example" id="org4c7032a">
Kcas_data.Queue : mean = 0.005985, sd = 0.000001 tp=50121937.812194
Lockfree.MSQueue: mean = 0.013976, sd = 0.000001 tp=21465000.358236
</pre>

<p>
Don&rsquo;t be fooled, however. It is clear that the composability of <code>kcas</code> adds overhead — probably something
generally between 1x to 4x in time and space — compared to non-composable lock-free data structures using
plain ~Atomic~s and it has already been demonstrated that <a href="https://github.com/ocaml-multicore/lockfree/pull/35#issuecomment-1479883022">a much faster version of the Michael-Scott
queue</a> could be implemented.
</p>

<p>
Nevertheless, the take home message is that STM could very well be fast enough for your application. The extra
nanoseconds are probably not going to be the main bottlenecks in most concurrent programs.
</p>
</div>
</div>


<div id="outline-container-orgc47ca4b" class="outline-3">
<h3 id="orgc47ca4b">Sid Kshatriya asked and Vesa Karvonen replied</h3>
<div class="outline-text-3" id="text-orgc47ca4b">
<blockquote>
<p>
Thanks for the readable example! Also very interesting to read blocking transactions portion especially of
<a href="https://github.com/ocaml-multicore/kcas/#blocking-transactions">https://github.com/ocaml-multicore/kcas/#blocking-transactions</a> !
</p>

<p>
Can you explain how this is integrated with Eio briefly &#x2013; I know you have added a link but the discussion there is
quite detailed&#x2026;
</p>
</blockquote>

<p>
It is pretty simple.
</p>

<p>
DLA (<a href="https://github.com/ocaml-multicore/domain-local-await/">domain-local-await</a>) basically stores, in the
<a href="https://v2.ocaml.org/api/Domain.DLS.html">DLS</a>, a domain (or systhread) specific function that implements the
blocking mechanism. Inside a scheduler like Eio (and Domainslib and pretty much any imaginable scheduler) there is
a loop (running in each domain managed by the scheduler) that takes ready fibers from a queue or some other
collection and runs them on the domain.  Just before entering that loop, Eio installs an Eio specific
implementation of the blocking mechanism for DLA.  That Eio specific implementation of blocking uses the algebraic
effects (and cancellation protocol) that Eio normally uses for blocking.  The support for Domainslib works the same
way — before domainslib enters the loop running ready Domainslib tasks, a Domainslib specific blocking
implementation is installed for DLA.
</p>

<p>
A single program can have multiple different domains running different schedulers.  A library like <code>kcas</code>, that
just wants to be able to block, can then obtain the blocking implementation from DLA without directly depending on
the scheduler.
</p>

<p>
Most people should not need to know anything about DLA.  It should be considered an internal implementation detail
and, in the future, we might use some other standard blocking mechanism.  An advantage of DLA is that it can be
made to work today without changes to the runtime or Stdlib.  DLA is also relatively non-intrusive.  It doesn&rsquo;t
require making extensive changes to a scheduler and installing the support is essentially free — it just
takes a few words of memory per domain.  DLA should also be future proof such that once a standard blocking
approach emerges, it should be possible to change the default DLA implementation to use the standard blocking
mechanism.
</p>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">OCaml.org Newsletter: March 2023</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-org-newsletter-march-2023/12090/1">https://discuss.ocaml.org/t/ocaml-org-newsletter-march-2023/12090/1</a>
</p>
</div>

<div id="outline-container-org9ab8f34" class="outline-3">
<h3 id="org9ab8f34">Thibaut Mattio announced</h3>
<div class="outline-text-3" id="text-org9ab8f34">
<p>
Welcome to the inaugural edition of the OCaml.org newsletter!
</p>

<p>
Following the example of the now-retired Multicore monthlies, and the  Compiler newsletter, we&rsquo;ll be running a
monthly newsletter on the progress we&rsquo;re making on the development of OCaml.org.
</p>

<p>
This newsletter has been compiled by @sabine and @tmattio and offers a recap&rsquo; of the work we&rsquo;ve been doing on
OCaml.org in March.
</p>

<p>
We highlight the work we&rsquo;ve been doing in three distinct areas:
</p>

<ul class="org-ul">
<li><b>Package Documentation</b>: Following user feedback, in the past months, we&rsquo;ve been focusing on improving the package documentation area. It started earlier this year with the team running a survey and user interviews, and we&rsquo;re nearing the end of the improvements.</li>
<li><b>Learn Area</b>: As a next milestone after improving the package documentation, we started work on the learn area with the aim to improve the learning experience of new OCaml users and offer new documentation resources to both beginners and experienced developers.</li>
<li><b>General Maintenance</b>: We also worked on general maintenance and improvements, and we&rsquo;ll highlight some of them.</li>
</ul>

<p>
Many thanks to all of the community members who contributed by participating in surveys, giving feedback on
Discuss, and opening issues and Pull Requests! Your contributions and feedback enable us to make progress on making
OCaml.org the best resource to learn OCaml and discover OCaml packages!
</p>
</div>

<div id="outline-container-org02e3896" class="outline-4">
<h4 id="org02e3896">Package Documentation</h4>
<div class="outline-text-4" id="text-org02e3896">
<p>
When we started to work on the package documentation navigation, we reached out to the community on the OCaml
Discuss forums with a survey on the Package and Learn areas on OCaml.org. The goal behind this was to enable our
new team member, a UX/UI designer, to quickly get up to speed and make impactful contributions to OCaml.org. Thanks
to the active participation of the community, this turned out to be a highly effective method to identify the most
impactful issues to work on.
</p>

<p>
This month, we completed <a href="https://github.com/ocaml/ocaml.org/tree/main/doc/personas.md">personas</a> representing
different types of users which includes mid-level developer, student, team lead, senior developer, academic
instructor/researcher.
</p>

<p>
We designed the UI and user flows for two possible design options of the package section (which includes the
package overview page, package documentation, the package search results, as well as an upcoming page that lists
all versions of a package). You can access the designs on
<a href="https://www.figma.com/file/Aqk5y03fsaCuhTSywmmY06/OCaml.org-Public-Designs">Figma</a>.
</p>

<p>
We&rsquo;ve been making good progress on a (low-fidelity) implementation of the designs we have in Figma, and we still
have a few UI elements to rework to align the site to the designs.
</p>

<p>
Relevant PRs/Issues:
</p>

<ol class="org-ol">
<li>We now <a href="https://github.com/ocaml/ocaml.org/pull/994">display README/CHANGELOG/LICENSE on the package overview layout</a>, instead of within the documentation layout. This better reflects their status as &ldquo;files that accompany the package&rdquo;.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/986">source code download button and source hash display was reworked</a> to have a better UX.</li>
<li><a href="https://github.com/ocaml/ocaml.org/pull/987">The package overview page was rearranged</a>. This improves the styling and placement of dependencies, tags, description, publication date.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1001">authors/maintainers display was improved</a> to (1) render an automatically-generated avatar if we don&rsquo;t have one for the given user, and (2) hide excessive amounts of authors/maintainers behind a &ldquo;show more&rdquo; button.</li>
<li>To make it easier to scan for relevant dependencies, we <a href="https://github.com/ocaml/ocaml.org/pull/1006">separate the dependencies into &ldquo;development dependencies&rdquo; and regular dependencies</a></li>
<li>After <a href="https://github.com/ocaml/ocaml.org/pull/1003">moving the package overview sidebar to the left</a>, the package overview page and the package documentation page were <a href="https://github.com/ocaml/ocaml.org/pull/1015">unified to use the same layout</a></li>
<li>We now <a href="https://github.com/ocaml/ocaml.org/pull/1017">render a table of contents on the package overview pages</a></li>
</ol>
</div>
</div>

<div id="outline-container-orgf340e4d" class="outline-4">
<h4 id="orgf340e4d">Learn Area</h4>
<div class="outline-text-4" id="text-orgf340e4d">
<p>
We started the discovery phase in which we are taking inventory of the current content and structure of the
OCaml.org Learn area. We reviewed the user interview videos from the Q1 survey on the Learn and Package areas to
extract user needs and pain points. We also started preparing a survey that specifically targets new OCaml users
(both programming beginners and experienced developers). At the time we publish this newsletter, we&rsquo;ve already
completed the survey and we&rsquo;ll be sharing the results in the next issue of this newsletter.
</p>

<p>
Improving the Learn Area will be our biggest focus in the coming months, so expect more updates on this in the
following newsletters.
</p>
</div>
</div>

<div id="outline-container-orge5da5be" class="outline-4">
<h4 id="orge5da5be">General Maintenance</h4>
<div class="outline-text-4" id="text-orge5da5be">
</div>
<ul class="org-ul">
<li><a id="org622d635"></a>User-facing changes<br />
<div class="outline-text-5" id="text-org622d635">
<ol class="org-ol">
<li><a href="https://github.com/ocaml/ocaml.org/pull/994">Display of README/LICENSE/CHANGELOG now uses the package overview page layout</a>, instead of the documentation layout.</li>
<li>@YassineHaouzane <a href="https://github.com/ocaml/ocaml.org/pull/955">added the display of exercise difficulty</a> to the problems in the exercises section. Thank you very much!</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/978">package search dropdown in the top navigation bar now allows you to navigate the search results using your keyboard</a>.</li>
<li>When <a href="https://github.com/ocaml/ocaml.org/pull/983">using the version switcher dropdown on the package documentation pages, the current path within the docs is now preserved</a>.</li>
<li>(WIP) We made progress on <a href="https://github.com/ocaml/ocaml.org/pull/1009">adding a page to the community section that highlights the Outreachy internship projects</a>.</li>
<li>(WIP) We made progress on <a href="https://github.com/ocaml/ocaml.org/pull/977">exposing check.ocamllabs.io build information on the package overview page</a>.</li>
<li>(WIP) We started work on <a href="https://github.com/ocaml/ocaml.org/pull/1038">adding a dedicated “Install” page</a>, together with the community: Discuss thread <a href="https://discuss.ocaml.org/t/please-improve-my-draft-of-an-install-page-on-ocaml-org/11837">Please Improve my Draft of an “Install” Page on OCaml.org</a>.</li>
</ol>
</div>
</li>

<li><a id="org0f1ba4c"></a>Updates to OCaml.org’s data:<br />
<div class="outline-text-5" id="text-org0f1ba4c">
<ol class="org-ol">
<li>Following the announcement of the jobs section on the OCaml Discuss forums, the team reviewed and merged job listings submitted by external contributors. Thank you everyone!</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/970">videos for the Outreachy projects have been added</a> but are not yet exposed via a dedicated page.</li>
</ol>
</div>
</li>

<li><a id="orgbda605c"></a>Internal maintenance, code health, and bug fixes<br />
<div class="outline-text-5" id="text-orgbda605c">
<ol class="org-ol">
<li>The code of “ood” (OCaml.org’s data library and data parser) received some refactoring in order to make it easier for people to contribute to OCaml.org.</li>
<li>All internal links to (subdomains of) ocaml.org were changed to use https in order to avoid unnecessary redirects.</li>
<li><a href="https://github.com/ocaml/ocaml.org/pull/985">README/LICENSE/CHANGELOG files were not properly picked up</a> by OCaml.org after the odoc upgrade. Now they are.</li>
<li>@voodoos <a href="https://github.com/ocaml/ocaml.org/pull/996">fixed the non-operational Merlin in the OCaml Playground</a>.</li>
<li>When a new build was deployed, package information used to be unavailable for around a minute. Now, the <a href="https://github.com/ocaml/ocaml.org/issues/980">Issue: When package info is regenerating, package info is unavailable</a> has been fixed.</li>
<li>Bug fix: <a href="https://github.com/ocaml/ocaml.org/pull/989">don&rsquo;t crash on packages that have avoid-version on all versions</a>.</li>
<li>The <a href="https://github.com/ocaml/ocaml.org/pull/1000">package breadcrumbs template now uses the breadcrumbs data coming from odoc</a>.</li>
<li>Introduced a short-circuiting 404 let-binding operator to the handler functions: <a href="https://github.com/ocaml/ocaml.org/pull/1010">PR: Return 404 on not found</a>.</li>
<li>We kept having spurious CI build failures because the CI would use the most current version of opam-repository. Now, we pin opam-repository in all three places: 1) Makefile, 2) Dockerfile, 3) GitHub actions.</li>
<li>Version upgrades: ocaml to 4.14.1, actions/checkout@v3 in GitHub Actions, dune to 3.6.</li>
<li>After visually highlighting targeted headings was added in <a href="https://github.com/ocaml/ocaml.org/pull/628">#628</a>, there were two sets of hover styles being applied to the anchor targets in the headings of the package documentation. This has been resolved: <a href="https://github.com/ocaml/ocaml.org/pull/1014">PR: Remove duplicate doc.css anchor target styles, adjust hover styles</a>.</li>
<li>There was a problem with the right sidebar not showing up when you navigated to the tutorial coming from the &ldquo;Learn&rdquo; page. Thanks to <a href="https://github.com/ocaml/ocaml.org/pull/1021">#1021</a> and <a href="https://github.com/ocaml/ocaml.org/pull/1041">#1041</a>, the sidebar now works properly with the AJAX-navigation provided by HTMX.</li>
<li>A user reported problems with font-sizing / layout. We <a href="https://github.com/ocaml/ocaml.org/pull/1032">changed Tailwind’s px-based breakpoints to em-based breakpoints</a> - in order to respect people&rsquo;s browser and OS font size settings.</li>
<li>(WIP) Work on <a href="https://github.com/ocaml/ocaml.org/pull/830">adding a sitemap.xml</a> to help search engines to index all of OCaml.org’s pages is in progress.</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">Creating a tutorial on sequences</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/creating-a-tutorial-on-sequences/12091/1">https://discuss.ocaml.org/t/creating-a-tutorial-on-sequences/12091/1</a>
</p>
</div>

<div id="outline-container-org89fe91a" class="outline-3">
<h3 id="org89fe91a">Cuihtlauac Alvarado announced</h3>
<div class="outline-text-3" id="text-org89fe91a">
<p>
Following up on ocaml.org tutorial updates, I&rsquo;ve created one on sequences:
</p>

<ul class="org-ul">
<li>Online tutorial: <a href="https://staging.ocaml.org/docs/sequences">https://staging.ocaml.org/docs/sequences</a></li>
<li>GitHub PR: <a href="https://github.com/ocaml/ocaml.org/pull/791">https://github.com/ocaml/ocaml.org/pull/791</a></li>
</ul>

<p>
Again, feedback is highly welcome
</p>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">You started to learn OCaml less than 12 months ago? Please help us with our user survey on the OCaml.org Learning Area</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/you-started-to-learn-ocaml-less-than-12-months-ago-please-help-us-with-our-user-survey-on-the-ocaml-org-learning-area/11945/2">https://discuss.ocaml.org/t/you-started-to-learn-ocaml-less-than-12-months-ago-please-help-us-with-our-user-survey-on-the-ocaml-org-learning-area/11945/2</a>
</p>
</div>

<div id="outline-container-org1a4408c" class="outline-3">
<h3 id="org1a4408c">Sabine Schmaltz announced</h3>
<div class="outline-text-3" id="text-org1a4408c">
<p>
Here’s the promised update on what kind of feedback we got out of the survey.
</p>

<p>
We distributed the survey (1) here on the OCaml Discuss, and (2) on the OCaml Discord server. The survey was also
shared via (3) LinkedIn, (4) Twitter, and possibly more channels. We asked newcomers to OCaml to participate.
</p>

<p>
57 people responded to the survey and we had to close the survey early so that we have the capacity to properly
analyze and categorize all feedback.
</p>

<p>
Invites have been sent out by Claire to the participants who volunteered to be interviewed.
</p>

<p>
We have found last time that the interviews helped us understand the status quo and the potential improvements from
the community&rsquo;s varied perspectives much better than we did only from the survey. I feel this has been a critical
factor to enable us to change things for the better.
</p>

<p>
So thank you for taking the time to help us! :camel:
</p>

<p>
<i>Editor&rsquo;s note: this post is very long, please follow the link above to read it.</i>
</p>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">Explorations on Package Management in Dune</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/explorations-on-package-management-in-dune/12101/1">https://discuss.ocaml.org/t/explorations-on-package-management-in-dune/12101/1</a>
</p>
</div>

<div id="outline-container-org066858b" class="outline-3">
<h3 id="org066858b">Thibaut Mattio announced</h3>
<div class="outline-text-3" id="text-org066858b">
<p>
The OCaml Platform team is excited to announce that we have started explorations to add support for package
management in Dune.
</p>

<p>
This joint work led by the Dune, opam and opam-monorepo teams, started a few months ago with discussions on how to
address what is one of the most important pain points <a href="https://www.dropbox.com/s/omba1d8vhljnrcn/OCaml-user-survey-2020.pdf?dl=0">reported by the
community</a>. This is the continuation of
the focus we had in 2022 on <a href="https://discuss.ocaml.org/t/ocaml-org-recapping-2022-and-queries-on-the-fediverse/11099#prototype-new-workflows-for-ocaml-development-3">prototyping new developer
workflows</a>
and we&rsquo;ll explore new workflows this integration enables throughout 2023. In particular, we&rsquo;ve been developing
similar workflows with <a href="https://github.com/tarides/opam-monorepo">opam-monorepo</a> and we&rsquo;re building on our
experience of the past 3 years to explore how to implement these workflows in Dune.
</p>

<p>
As we want to involve the community as much as possible and start gathering feedback early, we wrote an <a href="https://github.com/ocaml/dune/issues/7680">RFC on
GitHub</a> that lays down a high-level overview of the different features.
</p>

<p>
The project is in the prototyping stage, so the goal of the RFC is to invite feedback and discussion from the
community, rather than serve as a definitive spec of package management in Dune. We will be opening separate RFCs
for the different parts as we continue our explorations.
</p>

<p>
If you want to follow our work, you can look at issues and Pull Requests tagged as `package-management` in
<a href="https://github.com/ocaml/dune/labels/package%20management">Dune</a>. You can also have a look at the dev meeting
minutes for <a href="https://github.com/ocaml/dune/wiki">Dune</a> and <a href="https://github.com/ocaml/opam/wiki">opam</a>.
</p>

<p>
It&rsquo;s the beginning of quite a bit project, with many people involved, so I want to take a moment to acknowledge the
contributions of everyone. The initiative is spearheaded by Tarides and the Dune, opam and opam-monorepo
development teams are leading the project. We are also grateful for the generous funding provided by Jane Street,
whose support is instrumental to continuously improve the OCaml Platform.
</p>

<p>
Happy coding!
</p>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">Functional web applications running in the browser</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-functional-web-applications-running-in-the-browser/11984/6">https://discuss.ocaml.org/t/ann-functional-web-applications-running-in-the-browser/11984/6</a>
</p>
</div>

<div id="outline-container-org1a1de43" class="outline-3">
<h3 id="org1a1de43">Continuing this thread, Helmut announced</h3>
<div class="outline-text-3" id="text-org1a1de43">
<blockquote>
<p>
Sounds compelling :slight_smile:
</p>

<p>
If you have the time, it’d be great if you could implement the 7 GUIs tasks to serve as example code to your lib.
</p>

<p>
<a href="https://eugenkiss.github.io/7guis/">https://eugenkiss.github.io/7guis/ </a>
</p>

<p>
I find this benchmark quite good: small enough in scope not to be a time sink, but complex enough to make one
understand the limitations or advantages of a language or library
</p>
</blockquote>

<p>
I have implemented some of the examples:
</p>

<ul class="org-ul">
<li>Counter: already part of the demo <a href="https://hbr.github.io/fmlib/webapp/index.html">https://hbr.github.io/fmlib/webapp/index.html</a></li>
<li>Temperature Converter: <a href="https://hbr.github.io/fmlib/webapp/temperature.html">https://hbr.github.io/fmlib/webapp/temperature.html</a></li>
<li>Timer: <a href="https://hbr.github.io/fmlib/webapp/timer.html">https://hbr.github.io/fmlib/webapp/timer.html</a></li>
<li>Flight Booking: <a href="https://hbr.github.io/fmlib/webapp/flight.html">https://hbr.github.io/fmlib/webapp/flight.html</a></li>
<li>Draw Circles: <a href="https://hbr.github.io/fmlib/webapp/circles.html">https://hbr.github.io/fmlib/webapp/circles.html</a></li>
</ul>

<p>
The last two examples of the benchmark are still missing. You can find the sources at:
<a href="https://github.com/hbr/fmlib/tree/browser/src/examples/browser">https://github.com/hbr/fmlib/tree/browser/src/examples/browser</a>
</p>
</div>
</div>
</div>




<div id="outline-container-8" class="outline-2">
<h2 id="8">Ahrefs is now built with Melange</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ahrefs-is-now-built-with-melange/12107/1">https://discuss.ocaml.org/t/ahrefs-is-now-built-with-melange/12107/1</a>
</p>
</div>

<div id="outline-container-orgeab70d6" class="outline-3">
<h3 id="orgeab70d6">Javier Chávarri announced</h3>
<div class="outline-text-3" id="text-orgeab70d6">
<p>
Since last September, the Melange, Dune, and Ahrefs development teams have been working to enhance the integration
between Dune and <a href="https://github.com/melange-re/melange">Melange</a>. As a company that uses a lot of OCaml in the
backend, Ahrefs saw an opportunity to bring its frontend stack closer to OCaml by using Melange while still
integrating with the JavaScript ecosystem of UI libraries. Thus, the company decided to invest and actively
participate to make this integration happen.
</p>

<p>
I am happy to announce we achieved a significant milestone in this integration process: we transitioned all Ahrefs
frontend projects to use Melange. We have explained this transition in detail in a blog post:
</p>

<p>
<a href="https://tech.ahrefs.com/ahrefs-is-now-built-with-melange-b14f5ec56df4">https://tech.ahrefs.com/ahrefs-is-now-built-with-melange-b14f5ec56df4</a>
</p>

<p>
Regarding the current state of Melange, it&rsquo;s worth noting that our focus thus far has been on designing and
implementing the Dune-Melange integration and applying it within Ahrefs. The goal has been to demonstrate that the
toolchain can scale and be used in mid-large codebases, and the result has been successful so far. The process has
been beneficial not only for Melange but also for Dune itself, as we were able to identify and address some
performance issues, including a significant <a href="https://github.com/ocaml/dune/pull/7187">performance fix</a> that made
some build commands nearly 10 times faster in our case.
</p>

<p>
While we&rsquo;ve made significant progress with the Dune-Melange integration, we recognize that there is still work to
be done to improve the documentation and developer experience. Currently, Melange lacks a dedicated documentation
site, and the latest functionality isn&rsquo;t yet available in published versions of Dune and Melange on the opam
repository.
</p>

<p>
We&rsquo;re actively working to address this, but in the meantime, we invite those who are adventurous to explore the
<a href="https://github.com/melange-re/melange-opam-template">melange-opam-template</a> and review the newly added
<code>melange.emit</code> stanza documentation found in the latest version of <a href="https://dune.readthedocs.io/en/latest/melange.html">Dune&rsquo;s
documentation</a>. If you have any questions, encounter any
issues, or otherwise want to participate in any way, we invite you to join the <code>#melange</code> channel in the <a href="https://discord.gg/reasonml">Reason
Discord</a>.
</p>

<p>
Thank you for taking the time to read about our progress with the Dune-Melange integration. We hope you share our
excitement about this project!
</p>
</div>
</div>
</div>




<div id="outline-container-9" class="outline-2">
<h2 id="9">Other OCaml News</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org1797a2e" class="outline-3">
<h3 id="org1797a2e">From the ocaml.org blog</h3>
<div class="outline-text-3" id="text-org1797a2e">
<p>
Here are links from many OCaml blogs aggregated at <a href="https://ocaml.org/blog/">the ocaml.org blog</a>.
</p>

<ul class="org-ul">
<li><a href="https://tarides.com/blog/2023-05-05-optimising-archive-node-storage-for-tezos">Optimising Archive Node Storage for Tezos</a></li>
<li><a href="https://tech.ahrefs.com/ahrefs-is-now-built-with-melange-b14f5ec56df4?source=rss----303662d88bae--ocaml">Ahrefs is now built with Melange</a></li>
<li><a href="https://tarides.com/blog/2023-04-28-ocaml-at-minidebconf-tn-2023">OCaml at MinidebConf TN 2023</a></li>
</ul>
</div>
</div>
</div>




<div id="outline-container-org8b939b0" class="outline-2">
<h2 id="org8b939b0">Old CWN</h2>
<div class="outline-text-2" id="text-org8b939b0">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I&rsquo;ll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="orgabe8ff7">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>