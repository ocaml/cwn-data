#+OPTIONS: ^:nil
#+OPTIONS: html-postamble:nil
#+OPTIONS: num:nil
#+OPTIONS: toc:nil
#+OPTIONS: author:nil
#+HTML_HEAD: <style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
#+HTML_HEAD: <style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
#+TITLE: OCaml Weekly News
[[https://alan.petitepomme.net/cwn/2025.11.18.html][Previous Week]] [[https://alan.petitepomme.net/cwn/index.html][Up]] [[https://alan.petitepomme.net/cwn/2025.12.02.html][Next Week]]

Hello

Here is the latest OCaml Weekly News, for the week of November 18 to 25, 2025.

#+TOC: headlines 1


* Tapak: Experimental Web Framework Based on EIO
:PROPERTIES:
:CUSTOM_ID: 1
:END:
Archive: https://discuss.ocaml.org/t/ann-tapak-experimental-web-framework-based-on-eio/17507/1

** Syaiful Bahri announced


Hello! I am a newcomer to the OCaml community, and this is my first post.

I would like to share an experimental web framework I have been working on, based on Eio. I am a happy user of Dream and Opium, but I felt there was still room for improvement.

I’ve shared my motivation here: https://www.sbahri.com/projects/tapak/

I would love to hear your suggestions and opinions regarding the API. What important features do you feel are missing in existing libraries? Personally, I miss the type-safe routing that Servant offers, as well as the Phoenix real-time API.
      



* FUN OCaml is live on YouTube and Twitch
:PROPERTIES:
:CUSTOM_ID: 2
:END:
Archive: https://discuss.ocaml.org/t/fun-ocaml-is-live-on-youtube-and-twitch/17254/3

** Continuing this thread, Sabine Schmaltz announced


After hiding the original live stream recording, and starting to publish the talk recordings individually on the YouTube channel at https://www.youtube.com/@FUNOCaml, we're almost done listing all the talks!

https://youtu.be/0Hwd7NxQ8_c?si=PkrJtJXPYS1kSAyg
      



* Native debugging on macOS (DWARF support)
:PROPERTIES:
:CUSTOM_ID: 3
:END:
Archive: https://discuss.ocaml.org/t/native-debugging-on-macos-dwarf-support/17509/1

** Joel Reymont announced


With DWARF v5 support, the compiler now includes proper debug info — line mappings, symbols, and variable names — so LLDB can actually follow your code.

A small LLDB Python plug-in reads OCaml values at runtime and prints them in a readable form: lists, tuples, closures, strings, etc. It follows DWARF location lists to track where each variable lives and uses the runtime headers to decode them. The ~p~ and ~ocaml_vars~ commands work like normal LLDB commands but understand OCaml values.

It’s not complete yet (records and variants still show as tuples), but it makes debugging native OCaml code straightforward. You can finally set breakpoints by source, inspect locals, and understand what’s in memory without switching to disassembly.

https://joel.id/native-binary-debugging-for-ocaml/
      



* Package Hygiene in Alice
:PROPERTIES:
:CUSTOM_ID: 4
:END:
Archive: https://discuss.ocaml.org/t/package-hygiene-in-alice/17513/1

** Steve Sherratt announced


https://www.alicecaml.org/blog/package-hygiene-in-alice/

Alice is an OCaml build system and package manager I'm developing in my spare time. This post is about Alice's packaging protocol and how it enforces hygiene while building packages.
      



* crypt 2.0 - unix crypt function
:PROPERTIES:
:CUSTOM_ID: 5
:END:
Archive: https://discuss.ocaml.org/t/ann-crypt-2-0-unix-crypt-function/17485/2

** Continuing this thread, Mikhail announced


Minor update: crypt 2.1.

We have added a mutex for the POSIX crypt function and a platform-dependent implementation of crypt, i.e., crypt_r for Linux and FreeBSD. We have also added the Ffi module for accessing native platform bindings.
      



* opam 2.5.0~rc1 and opam-publish 2.7.1
:PROPERTIES:
:CUSTOM_ID: 6
:END:
Archive: https://discuss.ocaml.org/t/ann-opam-2-5-0-rc1-opam-publish-2-7-1/17515/1

** Kate announced


Hi everyone,

We are happy to announce the first release candidate of opam ~2.5.0~, which boasts a grand total of zero (0) changes compared to ~2.5.0~beta1~!

We also take this opportunity to announce the release of opam-publish ~2.7.1~, whose full release notes can be seen [[https://github.com/ocaml-opam/opam-publish/releases/tag/2.7.1][here]].

*** Changes in opam-publish 2.7.1

In ~2.7.0~, opam-publish changed the way user's branches are pushed to their GitHub forks before opening a PR, switching from using SSH keys to using the GitHub API token that opam-publish already requires.

~2.7.1~ fixes a couple of bugs related to that where opam-publish stopped working if the GitHub Action workflow files of upstream opam-repository are changed, owing to the way GitHub token permissions work.
*Thanks to [[https://github.com/filipeom][@filipeom]] both for the original contribution in ~2.7.0~ and for subsequent work on it in ~2.7.1~*.

Read our [[https://opam.ocaml.org/blog/opam-2-5-0-rc1-publish/][blog post]] for more details.

Please report any issues to [[https://github.com/ocaml/opam/issues][the opam bug-tracker]] or [[https://github.com/ocaml/opam-publish/issues][the opam-publish bug-tracker]].

*** Try the new opam 2.5.0 release candidate:

The upgrade instructions are unchanged:

For Unix systems
#+begin_example
bash -c "sh <(curl -fsSL https://opam.ocaml.org/install.sh) --version 2.5.0~rc1"
#+end_example
or from PowerShell for Windows systems
#+begin_example
Invoke-Expression "& { $(Invoke-RestMethod https://opam.ocaml.org/install.ps1) } -Version 2.5.0~rc1"
#+end_example
Please report any issues to the [[https://github.com/ocaml/opam/issues][bug-tracker]].

Happy hacking,
<> <> The opam team <> <> :camel:
      



* ocaml-protoc 4.0, pbrt 4.0
:PROPERTIES:
:CUSTOM_ID: 7
:END:
Archive: https://discuss.ocaml.org/t/ann-ocaml-protoc-4-0-pbrt-4-0/17524/1

** Simon Cruanes announced


Dear caml riders, I'm happy to announce the release of [[https://github.com/mransan/ocaml-protoc/][ocaml-protoc]] 4.0, alongside its runtime libraries ~pbrt~, ~pbrt_yojson~, and ~pbrt_services~.

Ocaml-protoc is a pure OCaml implementation of a [[https://protobuf.dev][protobuf]] compiler and runtime. [[https://en.wikipedia.org/wiki/Protocol_Buffers][Protobuf]] is a binary serialization format and IDL (interface description language) first introduced by Google in the early 00s, and still in pervasive use there and elsewhere. It is faster (to encode/decode) and more compact than JSON, and is designed for backward compatibility on the wire.

Anyway, this new major release is *breaking* because it finally follows the standard's semantics about [[https://protobuf.dev/programming-guides/field_presence/][_field presence_]]. By default, many fields in protobuf are somewhat optional[^1] and are not serialized at all if not present. Ocaml-protoc now tracks this for every non-required field, even scalars, moving towards better compliance with the standard. It does that either via ~option~ or via a presence bitfield. Because of this, the generated code has changed significantly and looks more like what the official ~protoc~ produces.

In a nutshell, each protobuf message now becomes a private record type with mutable fields and a presence bitfield. All modification and creation for a type ~foo~ is done via  ~make_foo~ and ~foo_set_<field>~ functions; presence can be checked with ~foo_has_<field>~. This means the runtime knows which fields have been explicitly modified.

I don't think ocaml-protoc is 100% compliant with the fine print on default values in proto3, etc. but this is a lot closer than it used to be. Thanks to the work of [[https://github.com/Lupus][@lupus]] there's also a new option validation layer.

*** detailed example

Let's look at this simple example:
#+begin_example
syntax = "proto3";

message Person {
  string name = 1;
  sint64 age = 2;
}

message Store {
  string address = 1;
  repeated Person employees = 2;
  repeated Person clients = 3;
}

message Company {
  string name = 1;
  repeated Store stores = 2;
  repeated Company subsidiaries = 3;
}
#+end_example

#+begin_src ocaml
(* generated from "orgchart.proto", do not edit *)

(** {2 Types} *)

type person = {
  name : string;
  age : int64;
}

type store = {
  address : string;
  employees : person list;
  clients : person list;
}

type company = {
  name : string;
  stores : store list;
  subsidiaries : company list;
}


(** {2 Basic values} *)

val default_person : 
  ?name:string ->
  ?age:int64 ->
  unit ->
  person
(** [default_person ()] is the default value for type [person] *)

val default_store : 
  ?address:string ->
  ?employees:person list ->
  ?clients:person list ->
  unit ->
  store
(** [default_store ()] is the default value for type [store] *)

val default_company : 
  ?name:string ->
  ?stores:store list ->
  ?subsidiaries:company list ->
  unit ->
  company
(** [default_company ()] is the default value for type [company] *)


(** {2 Formatters} *)

val pp_person : Format.formatter -> person -> unit 
(** [pp_person v] formats v *)

val pp_store : Format.formatter -> store -> unit 
(** [pp_store v] formats v *)

val pp_company : Format.formatter -> company -> unit 
(** [pp_company v] formats v *)


(** {2 Protobuf Encoding} *)

val encode_pb_person : person -> Pbrt.Encoder.t -> unit
(** [encode_pb_person v encoder] encodes [v] with the given [encoder] *)

val encode_pb_store : store -> Pbrt.Encoder.t -> unit
(** [encode_pb_store v encoder] encodes [v] with the given [encoder] *)

val encode_pb_company : company -> Pbrt.Encoder.t -> unit
(** [encode_pb_company v encoder] encodes [v] with the given [encoder] *)


(** {2 Protobuf Decoding} *)

val decode_pb_person : Pbrt.Decoder.t -> person
(** [decode_pb_person decoder] decodes a [person] binary value from [decoder] *)

val decode_pb_store : Pbrt.Decoder.t -> store
(** [decode_pb_store decoder] decodes a [store] binary value from [decoder] *)

val decode_pb_company : Pbrt.Decoder.t -> company
(** [decode_pb_company decoder] decodes a [company] binary value from [decoder] *)
```

new code:

```ocaml

(** Code for orgchart.proto *)

(* generated from "orgchart.proto", do not edit *)



(** {2 Types} *)

type person = private {
  mutable _presence: Pbrt.Bitfield.t; (** presence for 2 fields *)
  mutable name : string;
  mutable age : int64;
}

type store = private {
  mutable _presence: Pbrt.Bitfield.t; (** presence for 1 fields *)
  mutable address : string;
  mutable employees : person list;
  mutable clients : person list;
}

type company = private {
  mutable _presence: Pbrt.Bitfield.t; (** presence for 1 fields *)
  mutable name : string;
  mutable stores : store list;
  mutable subsidiaries : company list;
}


(** {2 Basic values} *)

val default_person : unit -> person 
(** [default_person ()] is a new empty value for type [person] *)

val default_store : unit -> store 
(** [default_store ()] is a new empty value for type [store] *)

val default_company : unit -> company 
(** [default_company ()] is a new empty value for type [company] *)


(** {2 Make functions} *)

val make_person : 
  ?name:string ->
  ?age:int64 ->
  unit ->
  person
(** [make_person … ()] is a builder for type [person] *)

val copy_person : person -> person

val person_has_name : person -> bool
  (** presence of field "name" in [person] *)

val person_set_name : person -> string -> unit
  (** set field name in person *)

val person_has_age : person -> bool
  (** presence of field "age" in [person] *)

val person_set_age : person -> int64 -> unit
  (** set field age in person *)

val make_store : 
  ?address:string ->
  ?employees:person list ->
  ?clients:person list ->
  unit ->
  store
(** [make_store … ()] is a builder for type [store] *)

val copy_store : store -> store

val store_has_address : store -> bool
  (** presence of field "address" in [store] *)

val store_set_address : store -> string -> unit
  (** set field address in store *)

val store_set_employees : store -> person list -> unit
  (** set field employees in store *)

val store_set_clients : store -> person list -> unit
  (** set field clients in store *)

val make_company : 
  ?name:string ->
  ?stores:store list ->
  ?subsidiaries:company list ->
  unit ->
  company
(** [make_company … ()] is a builder for type [company] *)

val copy_company : company -> company

val company_has_name : company -> bool
  (** presence of field "name" in [company] *)

val company_set_name : company -> string -> unit
  (** set field name in company *)

val company_set_stores : company -> store list -> unit
  (** set field stores in company *)

val company_set_subsidiaries : company -> company list -> unit
  (** set field subsidiaries in company *)


(** {2 Formatters} *)

val pp_person : Format.formatter -> person -> unit 
(** [pp_person v] formats v *)

val pp_store : Format.formatter -> store -> unit 
(** [pp_store v] formats v *)

val pp_company : Format.formatter -> company -> unit 
(** [pp_company v] formats v *)


(** {2 Protobuf Encoding} *)

val encode_pb_person : person -> Pbrt.Encoder.t -> unit
(** [encode_pb_person v encoder] encodes [v] with the given [encoder] *)

val encode_pb_store : store -> Pbrt.Encoder.t -> unit
(** [encode_pb_store v encoder] encodes [v] with the given [encoder] *)

val encode_pb_company : company -> Pbrt.Encoder.t -> unit
(** [encode_pb_company v encoder] encodes [v] with the given [encoder] *)


(** {2 Protobuf Decoding} *)

val decode_pb_person : Pbrt.Decoder.t -> person
(** [decode_pb_person decoder] decodes a [person] binary value from [decoder] *)

val decode_pb_store : Pbrt.Decoder.t -> store
(** [decode_pb_store decoder] decodes a [store] binary value from [decoder] *)

val decode_pb_company : Pbrt.Decoder.t -> company
(** [decode_pb_company decoder] decodes a [company] binary value from [decoder] *)
#+end_src

[^1]: the precise semantics of presence are, imho, quite messy.
      



* Cmdliner 2.1.0 – The powershell edition
:PROPERTIES:
:CUSTOM_ID: 8
:END:
Archive: https://discuss.ocaml.org/t/ann-cmdliner-2-1-0-the-powershell-edition/17527/1

** Brian Ward announced


Hello, 

It's my pleasure to announce the version 2.1.0 of cmdliner

#+begin_quote
Cmdliner is an ISC-licensed library that allows the declarative and
compositional definition of command lines with excellent support for
command line interface user conventions and standards.
#+end_quote

This releases consolidates additional work on command line completion. I added:

- Support for powershell auto-completion ([[https://erratique.ch/software/cmdliner/doc/cli.html#user_pwsh][details]]).
- Significant improvements to the ~bash~ completion.
- Updated [[https://erratique.ch/software/cmdliner/doc/cookbook.html#top_tool_support_with_dune_install][~dune~ install instructions]] in the cookbook.

I'd like to thank @dbuenzli for his gracious feedback on these changes, and importantly for telling me “no” to several others beforehand :)

For all the other details see the [[https://github.com/dbuenzli/cmdliner/blob/master/CHANGES.md][release notes]].

- Homepage: https://erratique.ch/software/cmdliner
- Docs: https://erratique.ch/software/doc or ~odig doc cmdliner~
- Install: ~opam install cmdliner~ (once [[https://github.com/ocaml/opam-repository/pull/28962][the PR]] is merged, may take a few days)
      



* Other OCaml News
:PROPERTIES:
:CUSTOM_ID: 9
:END:
** From the ocaml.org blog


Here are links from many OCaml blogs aggregated at [[https://ocaml.org/blog/][the ocaml.org blog]].

- [[https://www.tunbury.org/2025/11/23/gas-meter/][Reading the Gas Meter]]
- [[https://fearful-odds.rocks/blog/azure-ssh-ocaml-containers-production][Enabling SSH in Azure App Service for OCaml Containers: A Production Journey]]
- [[https://www.youtube.com/watch/BAvXqd0QeVM?version=3][A Vision for OCaml in the AI Era - Thibaut Mattio - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/_uwvra1NFJg?version=3][OCaml at LexiFi - Nicolás Ojeda Bär - FUN OCaml 2025]]
- [[https://cambium.inria.fr/blog/testing-a-priority-queue-with-Monolith][Testing a priority queue with Monolith]]
- [[https://roscidus.com/blog/blog/2025/11/16/libdrm-ocaml/][Linux mode setting, from the comfort of OCaml]]
- [[https://www.tunbury.org/2025/11/15/ocaml-raspberry-pi/][OCaml on a Raspberry Pi]]
- [[https://www.youtube.com/watch/Q2-qIrYzSXw?version=3][I Can See The Pixels: Designing Cross-Stitch Patterns in OCaml - Mindy Preston - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/0Hwd7NxQ8_c?version=3][Frameworks: No, Libraries: Yes. Developing a product in OCaml from Scratch - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/exR5eWSQ_8o?version=3][Purely functional gRPC and HTTP/2 with OCaml - Adam Cholewiński - FUN OCaml 2025]]
- [[https://tarides.com/blog/2025-11-13-announcing-unikraft-support-for-mirageos-unikernels][Announcing Unikraft Support for MirageOS Unikernels]]
- [[https://www.youtube.com/watch/BL8bmtBfd7E?version=3][Analyzing Programs with SMT Solvers - Tikhon Jelvis - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/5HMpiGKHu9A?version=3][Slipshow: A Full-Featured Presentation Tool in OCaml - Paul-Elliot Anglès d'Auriac - FUN OCaml 2025]]
- [[https://anil.recoil.org/notes/path-to-uk-india-ai-summit][On the path to the UK/India AI Summit with OpenUK and the ATI]]
- [[https://www.youtube.com/watch/iQc5fHW5SZA?version=3][0xCaml From a System Engineer's Point of View - Dmitriy Kovalenko - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/UfrryqltZUQ?version=3][Performance Pitfalls: Tales From a Python/OCaml Codebase - Emma Jin - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/rHGMD49eb_k?version=3][Generating Static Websites the Functional Programming Way - Xavier Van de Woestyne - FUN OCaml 2025]]
- [[https://www.youtube.com/watch/zfGlQZ2pkss?version=3][From OCaml 4 to 5 and from Parmap to Effects: A legacy code transition story - FUN OCaml 2025]]
- [[https://hannes.robur.coop/Posts/ConexRunning][Conex, securing the opam-repository, is now in production]]
- [[https://patrick.sirref.org/ocaml-roundup-october-2025/][OCaml Roundup: October 2025]]
      



* Old CWN
:PROPERTIES:
:UNNUMBERED: t
:END:

If you happen to miss a CWN, you can [[mailto:alan.schmitt@polytechnique.org][send me a message]] and I'll mail it to you, or go take a look at [[https://alan.petitepomme.net/cwn/][the archive]] or the [[https://alan.petitepomme.net/cwn/cwn.rss][RSS feed of the archives]].

If you also wish to receive it every week by mail, you may subscribe to the [[https://sympa.inria.fr/sympa/info/caml-list][caml-list]].

#+BEGIN_authorname
[[https://alan.petitepomme.net/][Alan Schmitt]]
#+END_authorname
