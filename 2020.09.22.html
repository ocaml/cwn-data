<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-09-22 Tue 09:26 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="http://alan.petitepomme.net/cwn/2020.09.15.html">Previous Week</a> <a href="http://alan.petitepomme.net/cwn/index.html">Up</a> <a href="http://alan.petitepomme.net/cwn/2020.09.29.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of September 15 to 22, 2020.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">Liquidsoap 1.4.3</a></li>
<li><a href="#2">Simple63 v1: compression of integer sequences</a></li>
<li><a href="#3">bentov v1: streaming estimation of 1D histograms</a></li>
<li><a href="#4">opam-compiler 0.1.0</a></li>
<li><a href="#5">lua_parser 1.0.0</a></li>
<li><a href="#6">Merlin 3.4.0 : introducing external configuration readers</a></li>
<li><a href="#7">gRPC server and client in OCaml</a></li>
<li><a href="#8">Bitstring (and ppx_bitstring) 4.0.0</a></li>
<li><a href="#orgfa70e19">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-orga943471" class="outline-2">
<h2 id="1">Liquidsoap 1.4.3</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-liquidsoap-1-4-3/6429/1">https://discuss.ocaml.org/t/ann-liquidsoap-1-4-3/6429/1</a>
</p>
</div>

<div id="outline-container-org0eceab9" class="outline-3">
<h3 id="org0eceab9">Romain Beauxis announced</h3>
<div class="outline-text-3" id="text-org0eceab9">
<p>
I'm happy to announce that liquidsoap  <code>1.4.3</code>  is out at:
<a href="https://github.com/savonet/liquidsoap/releases/tag/v1.4.3">https://github.com/savonet/liquidsoap/releases/tag/v1.4.3</a>
</p>

<p>
This is the 3rd bugfix release for the  <code>1.4.x</code>  branch. It contains important fixes and a couple of
new minor features. Update is recommended and should be fairly safe.
</p>

<p>
Along we this release, we have now added builds for  <code>arm64</code>  debian packages and docker-ready
production images for  <code>amd64</code>  and  <code>arm64</code>  architectures available at:
<a href="https://hub.docker.com/repository/docker/savonet/liquidsoap">https://hub.docker.com/repository/docker/savonet/liquidsoap</a>
</p>

<p>
Again, we would like to warmly thank all users, contributors and reporters for helping us bring
liquidsoap to the next step!
</p>

<p>
Also, please note that a couple of issues had to be left out to make sure that the release comes out on
time. These are listed <a href="https://github.com/savonet/liquidsoap/milestone/7">here</a> and will be tackled as
soon as possible.
</p>

<p>
Next for liquidsoap, we will focus on getting the current  <code>2.x</code>  branch finalized and polished. We
already have support for encoded content and ffmpeg raw frames. We need to write a couple of inline
encoders and decoders and we'll have 90% of the features ready. This will be a major update for us!
</p>
</div>
</div>
</div>




<div id="outline-container-org37e567e" class="outline-2">
<h2 id="2">Simple63 v1: compression of integer sequences</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-simple63-v1-compression-of-integer-sequences/6431/1">https://discuss.ocaml.org/t/ann-simple63-v1-compression-of-integer-sequences/6431/1</a>
</p>
</div>

<div id="outline-container-orged457f3" class="outline-3">
<h3 id="orged457f3">Mika Illouz announced</h3>
<div class="outline-text-3" id="text-orged457f3">
<p>
This is to announce Simple63, an opam package for compression of integer sequences; similar to Anh and
Moffat's Simple-8b. More details found in:
</p>

<ul class="org-ul">
<li>github: <a href="https://github.com/barko/simple63">https://github.com/barko/simple63</a></li>
<li>documentation: <a href="https://barko.github.io/simple63/">https://barko.github.io/simple63/</a></li>
</ul>

<p>
Feedback and bug reports welcome.
</p>
</div>
</div>
</div>




<div id="outline-container-org1d5e049" class="outline-2">
<h2 id="3">bentov v1: streaming estimation of 1D histograms</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-bentov-v1-streaming-estimation-of-1d-histograms/6434/1">https://discuss.ocaml.org/t/ann-bentov-v1-streaming-estimation-of-1d-histograms/6434/1</a>
</p>
</div>

<div id="outline-container-orgb47fcbc" class="outline-3">
<h3 id="orgb47fcbc">Mika Illouz announced</h3>
<div class="outline-text-3" id="text-orgb47fcbc">
<p>
This is to announce bentov, a opam package that implements a 1D histogram-sketching algorithm. For more
details:
</p>

<ul class="org-ul">
<li>github: <a href="https://github.com/barko/bentov">https://github.com/barko/bentov</a></li>
<li>documentation: <a href="https://barko.github.io/bentov">https://barko.github.io/bentov</a></li>
</ul>

<p>
Feedback and bug reports welcome.
</p>
</div>
</div>
</div>




<div id="outline-container-org7bcaf38" class="outline-2">
<h2 id="4">opam-compiler 0.1.0</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-opam-compiler-0-1-0/6442/1">https://discuss.ocaml.org/t/ann-opam-compiler-0-1-0/6442/1</a>
</p>
</div>

<div id="outline-container-org6e812ba" class="outline-3">
<h3 id="org6e812ba">Etienne Millon announced</h3>
<div class="outline-text-3" id="text-org6e812ba">
<p>
On behalf of the opam maintainers, I'd like to announce the first release of opam-compiler, a plugin to
work with compiler variants, branches and forks.
</p>

<p>
This can cover a pretty wide range of use cases, so the first version is starting small with a single
command to create a switch from a branch or github PR:
</p>

<pre class="example">
% opam compiler create '#9921'
Opam plugin "compiler" is not installed. Install it on the current switch? [Y/n] y

...

&lt;&gt;&lt;&gt; Carrying on to "opam compiler create #9921" &gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;

[ocaml-variants.4.12.0+trunk+no-flat-float-array] synchronised from
git+https://github.com/gasche/ocaml#Atomic.create
ocaml-variants is now pinned to git+https://github.com/gasche/ocaml#Atomic.create (version
4.12.0+trunk)
% opam switch
...
→  ocaml-ocaml-9921
          [opam-compiler] ocaml/ocaml#9921 - stdlib: rename Atomic.make into Atomic.create
</pre>

<p>
You can also override the arguments passed to <code>--configure</code>.
</p>

<p>
As you can see in the above snippet, it's an opam plugin so it will auto-install if needed (assuming
you ran <code>opam update</code> recently) and will be available across all switches. Its sources and issue
tracker are available <a href="https://github.com/ocaml-opam/opam-compiler">here</a>.
</p>

<p>
For the next releases, our plan is to add a user-friendly way to setup a switch based on a local git
clone, so that it's easy to test your compiler fork with opam packages. You can find the other features
we'd like to add in the future in <a href="https://github.com/ocaml/opam/wiki/Spec-for-working-with-the-OCaml-compiler">the relevant part of the opam
roadmap</a>.
</p>

<p>
Thanks and have fun compiling compilers!
</p>
</div>
</div>
</div>




<div id="outline-container-org921c451" class="outline-2">
<h2 id="5">lua_parser 1.0.0</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-lua-parser-1-0-0/6445/1">https://discuss.ocaml.org/t/ann-lua-parser-1-0-0/6445/1</a>
</p>
</div>

<div id="outline-container-orgad9f0e6" class="outline-3">
<h3 id="orgad9f0e6">Jason Nielsen announced</h3>
<div class="outline-text-3" id="text-orgad9f0e6">
<p>
I've release <a href="https://github.com/drjdn/ocaml_lua_parser">lua_parser</a> which is now up on opam.  It is a
parser and pretty-printer for lua 5.2.  Actually it was developed with luajit in mind which is lua 5.1
plus goto/labels (which syntactically for the purposes of parsing and pretty-printing is lua 5.2).
</p>
</div>
</div>
</div>




<div id="outline-container-org54623c2" class="outline-2">
<h2 id="6">Merlin 3.4.0 : introducing external configuration readers</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-merlin-3-4-0-introducing-external-configuration-readers/6446/1">https://discuss.ocaml.org/t/ann-merlin-3-4-0-introducing-external-configuration-readers/6446/1</a>
</p>
</div>

<div id="outline-container-org72540c7" class="outline-3">
<h3 id="org72540c7">vds announced</h3>
<div class="outline-text-3" id="text-org72540c7">
<p>
I am glad to announce, on behalf of the Merlin team, the release of Merlin
<code>3.4.0</code> which brings some major changes in the way configuration is handled.
</p>

<p>
As you might know, Merlin reads its configuration from the closest <code>.merlin</code>
file to the source file being edited. These files tell merlin where to find
other source files and build artifacts, but also which flags should be passed to
the compiler, which syntax extensions are enabled and which packages are used by
the project.
</p>

<p>
In this setting the configuration is the same for all the source files of a
folder, regardless of their specificities. In other words, the configuration
loaded for a single source file contains the union of the dependencies of this
file and of all its siblings which is not an optimal behavior.
</p>

<p>
Starting with version <code>3.4.0</code> merlin will ship with two packages: <code>merlin</code>
and <code>dot-merlin-reader</code> which, as the name suggests, reads configuration from
<code>.merlin</code> files. Both are necessary for proper function.
</p>

<p>
When a <code>.merlin</code> file is present in the source folder the Merlin server will
start a <code>dot-merlin-reader</code> process and communicate with it via standard input
and output following a simple protocol. These processes are halted with the server.
</p>

<p>
<b>This change should not have any visible impact on users' workflows as long as
the <code>dot-merlin-reader</code> binary is correctly installed and in the path</b>. (which
should be the case in opam-based setups)
</p>

<p>
This change in itself will not solve the granularity problem mentioned earlier,
but it paves the way for such improvements: in a near-future Dune will stop
generating <code>.merlin</code> files and Merlin will obtain file-based configuration
directly from the build system using the same protocol as the one used by
<code>dot-merlin-reader</code>.
</p>
</div>

<div id="outline-container-orge601b8b" class="outline-4">
<h4 id="orge601b8b">Changelog</h4>
<div class="outline-text-4" id="text-orge601b8b">
<ul class="org-ul">
<li>merlin binary
<ul class="org-ul">
<li>fix completion of pattern matchings with exception patterns (#1169)</li>
<li>delegate configuration reading to external programs via a simple protocol and create a new package <code>dot-merlin-reader</code> with a binary that reads <code>.merlin</code> files. (#1123, #1152)</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>




<div id="outline-container-org8cb1302" class="outline-2">
<h2 id="7">gRPC server and client in OCaml</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/grpc-server-and-client-in-ocaml/6465/1">https://discuss.ocaml.org/t/grpc-server-and-client-in-ocaml/6465/1</a>
</p>
</div>

<div id="outline-container-orgc1c2f08" class="outline-3">
<h3 id="orgc1c2f08">blandinw announced</h3>
<div class="outline-text-3" id="text-orgc1c2f08">
<p>
TL;DR <a href="https://github.com/blandinw/ocaml-grpc-envoy/">https://github.com/blandinw/ocaml-grpc-envoy/</a>
</p>

<p>
Hey, I'm new to OCaml after writing some Clojure, C++ and Haskell in various contexts, including
working at FB (relevant below).
</p>

<p>
After browsing this forum and Reddit for a bit, the assumption seems to be that OCaml is not a good fit
for gRPC, since there's no pure implementation today. Now, this is something I have experience with, so
I thought I'd try and challenge this assumption.
</p>

<p>
As you may know, services inside FB use Thrift (both the format and protocol) to communicate. The
Thrift team worked primarily in C++ (for good reasons), causing support for other languages to lag
behind despite their best efforts. Now, the interchange format (equivalent to Protobuf) does not change
very often so it's fine to have a per-language implementation, but the client and server (equivalent to
HTTP2 + gRPC) frequently receive new features, optimizations and fixes. After a valiant and continued
effort to support most languages used internally, the Thrift team came up with an idea. Instead of
maintaining multiple implementations and dealing with obscure FFI bugs,
~FingerprintTrustManagerFactory~s and whatnot, they would focus solely on the C++ implementation and
provide a daemon to be ran alongside whatever code you were trying to run. You could then use simple
IPC to exchange Thrift (the format) messages with that daemon, and it would handle all the nitty-gritty
of running a service at scale (load balancing, connection pooling, service discovery, security,
retries, timeouts, network stats, hot restarts, etc.). Needless to say, it worked remarkably well even
at very high scale and everybody was much happier.
</p>

<p>
I wanted to replicate this idea with OCaml and gRPC. We already have support for protobuf thanks to the
excellent <code>ocaml-protoc</code>. All we need is a way to exchange protobuf messages reliably on the wire.
Instead of having an OCaml implementation that will have to stay up-to-date and have its own set of
bugs (the official <code>grpc/grpc-java</code> repo has 4450 commits and 2400 issues at the moment), can we reuse
existing infra with already massive support and production time?
</p>

<p>
Fortunately, the people at Lyft built just that, open-sourced it and contributed it to the Cloud Native
Computing Foundation in late 2017. It is called Envoy and it is bliss.
</p>

<p>
I demonstrate how to fit these pieces together at
<a href="https://github.com/blandinw/ocaml-grpc-envoy/">blandinw/ocaml-grpc-envoy</a> to build a simple KV store,
including a gRPC client and server in 200 lines of OCaml code. The idea is to spawn an Envoy process
that will handle all gRPC communication for our OCaml code. We use HTTP/1.1 to exchange Protobuf
messages with it, using for example <code>httpaf</code> and <code>Lwt</code>. This solution has the added benefit that it is
highly scalable from the start, allowing you for instance to spawn one OCaml process per core and load
balance between them. You can also use Envoy (with proper config!) as your web reverse proxy instead of
say, nginx.
</p>

<p>
At the very least, this solution allows us to start writing gRPC code today, and gracefully evolve
towards HTTP/2, Multicore and maybe a native OCaml implementation later.
</p>

<p>
I'm curious to hear your perspective on the future of building services with OCaml, or your past
experience like what went well, what was missing, etc.
</p>
</div>
</div>


<div id="outline-container-org4fe2e9d" class="outline-3">
<h3 id="org4fe2e9d">Yawar Amin asked and blandinw replied</h3>
<div class="outline-text-3" id="text-org4fe2e9d">
<blockquote>
<p>
Fantastic idea. So if I understand correctly, the only thing that Envoy (server-side) is doing is
translating the Protobuf from gRPC HTTP2 transport to HTTP1, and forwarding these Protobuf objects over
HTTP1 to the OCaml server? Envoy doesn't know to know about the actual gRPC schema, because it doesn't
touch the Protobuf objects themselves, right?
</p>
</blockquote>

<p>
That's correct. Envoy is only concerned with transporting bytes (along with load balancing, routing,
etc, etc). Only OCaml knows about the Protobuf schemas.
</p>

<p>
In the OCaml server case, Envoy listens for HTTP/2 gRPC requests, accesses the bytes payload with no
knowledge of the actual schema/layout and repackages these same bytes in a HTTP/1.1 request that OCaml
can process. OCaml then responds with bytes (an encoded Protobuf response message) that Envoy sends
back on the original HTTP2 connection.
</p>
</div>
</div>
</div>




<div id="outline-container-orga13c18f" class="outline-2">
<h2 id="8">Bitstring (and ppx_bitstring) 4.0.0</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-bitstring-and-ppx-bitstring-4-0-0/6471/1">https://discuss.ocaml.org/t/ann-bitstring-and-ppx-bitstring-4-0-0/6471/1</a>
</p>
</div>

<div id="outline-container-org5646b6c" class="outline-3">
<h3 id="org5646b6c">xrguerin announced</h3>
<div class="outline-text-3" id="text-org5646b6c">
</div>
<div id="outline-container-org5647ea7" class="outline-4">
<h4 id="org5647ea7">Features</h4>
<div class="outline-text-4" id="text-org5647ea7">
<ul class="org-ul">
<li>Add support for let bindings introduced in 4.08</li>
<li>Switch to PPXLIB</li>
</ul>
</div>
</div>

<div id="outline-container-org9c85043" class="outline-4">
<h4 id="org9c85043">Deprecations</h4>
<div class="outline-text-4" id="text-org9c85043">
<p>
As PPXLIB requires <code>ocaml &gt;= 4.04</code> support for earlier versions has been dropped.
</p>
</div>
</div>

<div id="outline-container-orge435fcb" class="outline-4">
<h4 id="orge435fcb">Breaking changes</h4>
<div class="outline-text-4" id="text-orge435fcb">
<p>
This release splits the library from the PPX to reduce runtime dependencies. Projects using the PPX
from bitstring will need to also depends on ppx_bitstring from now on.
</p>
</div>
</div>
</div>


<div id="outline-container-orgbd67eb0" class="outline-3">
<h3 id="orgbd67eb0">Rudi Grinberg added</h3>
<div class="outline-text-3" id="text-orgbd67eb0">
<p>
The project is hosted <a href="https://github.com/xguerin/bitstring">here</a> for those who are interested.There's
also some excellent <a href="https://bitstring.software/documentation/">docs</a>
</p>
</div>
</div>
</div>




<div id="outline-container-orgfa70e19" class="outline-2">
<h2 id="orgfa70e19">Old CWN</h2>
<div class="outline-text-2" id="text-orgfa70e19">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="http://alan.petitepomme.net/cwn/">the archive</a> or the <a href="http://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname">
<p>
<a href="http://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
