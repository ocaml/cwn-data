<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-03-01 Tue 14:46 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2022.02.22.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2022.03.08.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of February 22 to March 01, 2022.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">data-encoding.0.5 release</a></li>
<li><a href="#2">Tutorial: Roguelike with effect handlers</a></li>
<li><a href="#3">For Diversity and the OCaml Community: Outreachy Summer 2022</a></li>
<li><a href="#4">Bogue, the OCaml GUI</a></li>
<li><a href="#5">Friday 03/04 Intern presentations &#x2013; open attendance!</a></li>
<li><a href="#6">Affect: Composable concurrency primitives for OCaml 5.0</a></li>
<li><a href="#7">Segfault Systems Joins Tarides</a></li>
<li><a href="#8">OCaml User Survey 2022</a></li>
<li><a href="#org3f49505">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">data-encoding.0.5 release</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-data-encoding-0-5-release/9420/1">https://discuss.ocaml.org/t/ann-data-encoding-0-5-release/9420/1</a>
</p>
</div>

<div id="outline-container-org54db72a" class="outline-3">
<h3 id="org54db72a">Raphaël Proust announced</h3>
<div class="outline-text-3" id="text-org54db72a">
<p>
On behalf of <a href="https://www.nomadic-labs.com/">Nomadic Labs</a>, I'm happy to announce the release of data-encoding
version 0.5.
</p>

<p>
This new version brings several bug fixes, some increased test coverage, minor improvements in the API, and a major
new feature:
</p>
</div>

<div id="outline-container-org2bcd936" class="outline-4">
<h4 id="org2bcd936">Compact encodings: sub-byte tag sizes</h4>
<div class="outline-text-4" id="text-org2bcd936">
<p>
This new version provides a new set of combinators for <span class="underline">compact</span> encodings. These compact encodings will handle all
the verbose and error-prone bit-twidling process needed to combine multiple sub-byte discriminators into a single
byte-size one.
</p>

<p>
E.g., the encoding <code>let e1 = either (either bool unit) (option bool)</code> uses three bits in the shared tag and zero
bytes after that;
the encoding <code>let e2 = either int32 int64</code> uses one bit in the shared tag and either 4 or 8 bytes to represent the
integer;
the product encoding <code>let ee = tup2 e1 e2</code> uses four (3 + 1) bits in the shared tag and either 4 or 8 bytes to
represent the integer of <code>e2</code>.
</p>
</div>
</div>

<div id="outline-container-orgd20bc3b" class="outline-4">
<h4 id="orgd20bc3b">How to get</h4>
<div class="outline-text-4" id="text-orgd20bc3b">
<p>
The code is available under MIT license on <a href="https://gitlab.com/nomadic-labs/data-encoding">https://gitlab.com/nomadic-labs/data-encoding</a>.
</p>

<p>
It can be installed via <code>opam</code>.
</p>
</div>
</div>
</div>


<div id="outline-container-org66cad41" class="outline-3">
<h3 id="org66cad41">Dario Teixeira asked and Raphaël Proust replied</h3>
<div class="outline-text-3" id="text-org66cad41">
<blockquote>
<p>
Hi @raphael-proust! I have a question regarding the connection between <code>data-encoding</code> and <code>json-data-encoding</code>, also
developed at Nomadic Labs. The latter seems tied to JSON, whereas the former is more flexible, supporting also binary
encodings. However, since <code>data-encoding</code> also supports JSON, doesn't it subsume <code>json-data-encoding</code> completely?
</p>
</blockquote>

<p>
The <code>data-encoding</code> library uses <code>json-data-encoding</code> for its JSON backend. It delegates conversion from OCaml values
into and from JSON to the primitives provided in the interface of <code>json-data-encoding</code>.
</p>

<p>
In a way, yes, as an end-user you don't need to use <code>json-data-encoding</code> directly because you can use the <code>Json</code>
module of <code>data-encoding</code> instead. There are three possible reasons why you might add <code>json-data-encoding</code> as a
(non-transitive) dependency to your project and use it directly in your code:
</p>

<ul class="org-ul">
<li>You want to keep the dependency set and the number of abstraction layers as small as possible. E.g., in order to reduce binary size.</li>
<li>You want some static guarantees that some encodings are only every used for JSON. E.g., in your logging system.</li>
<li>You need to define a JSON encoding which is rejected by <code>data-encoding</code> on grounds that it is invalid in binary. Note that
<ul class="org-ul">
<li>This is very specific to some combinators but basically some combinators will reject their inputs (raise <code>Invalid_argument</code>) because using the serialiser would lead to undecodable data. Most typically, this happens if you try to concatenate two fields of unknown length. Decoding the result becomes a guessing game as to were one field stops and where the next begins. These could easily be represented as an array in JSON which includes all the delimiters you need to decode it.</li>
<li>There are other workarounds (e.g., prefixing the fields with a length field), but going for the JSON encoding directly is a valid approach if you only need JSON.</li>
</ul></li>
</ul>
</div>
</div>


<div id="outline-container-org8b8223d" class="outline-3">
<h3 id="org8b8223d">Raphaël Proust later announced</h3>
<div class="outline-text-3" id="text-org8b8223d">
<p>
Version 0.5.1 of the data-encoding has just been released.
</p>

<p>
This is a bugfix release making one of the library's internal checks more permissive. Without this fix (i.e., using
version 0.5), some valid encodings are rejected (raising <code>Invalid_argument</code>) by the library.
</p>

<p>
You can update via opam: <code>opam install data-encoding.0.5.1</code>
</p>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">Tutorial: Roguelike with effect handlers</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/tutorial-roguelike-with-effect-handlers/9422/1">https://discuss.ocaml.org/t/tutorial-roguelike-with-effect-handlers/9422/1</a>
</p>
</div>

<div id="outline-container-org7f1497e" class="outline-3">
<h3 id="org7f1497e">art-w announced</h3>
<div class="outline-text-3" id="text-org7f1497e">
<p>
The recent conversations about <a href="https://discuss.ocaml.org/t/eio-0-1-effects-based-direct-style-io-for-ocaml-5/9298/97"><code>eio</code>
0.1</a> and <a href="https://discuss.ocaml.org/t/how-to-block-in-an-agnostic-way/9368/51">agnostic
blocking</a> have made me very curious about effect
handlers. The multicore team has done an <a href="https://github.com/patricoferris/awesome-multicore-ocaml">awesome</a> job with
their <a href="https://github.com/ocamllabs/ocaml-effects-tutorial">tutorials</a>,
<a href="https://github.com/ocaml-multicore/effects-examples">examples</a> and
<a href="https://watch.ocaml.org/videos/watch/74ece0a8-380f-4e2a-bef5-c6bb9092be89">talks</a>, but the laymen have been too
quiet for such an exciting feature! Where are all the blog posts about how "you could have invented algebraic
effects" and "one-shot continuations are like spaghetti"?
</p>

<p>
In any case, I'm hoping to tease some of you into trying them out with <a href="https://hackmd.io/@yF_ntUhmRvKUt15g7m1uGw/BJBZ7TMeq">a simple tutorial about programming a
roguelike with effect handlers</a> :)
</p>

<p>
There's nothing new here besides the fun use-case! So if you already have an intuitive understanding of the syntax
and motivations, you may be more interested by <a href="https://hackmd.io/@yF_ntUhmRvKUt15g7m1uGw/Bk-5NXh15">a deeper look at the scope of effect
handlers</a> &#x2013; and a soft introduction to some less common
features of the type system. <i>(this link was previously posted deep into the <code>eio</code> thread)</i>
</p>

<p>
I would be grateful if you spot any mistake! I'm also curious of other fun applications for effect handlers&#x2026; and if
you feel like sharing your own surprises and discoveries, I believe it could really help others learn faster :)
</p>
</div>
</div>


<div id="outline-container-org986d59c" class="outline-3">
<h3 id="org986d59c">Kiran Gopinathan then said</h3>
<div class="outline-text-3" id="text-org986d59c">
<p>
Great blog post! That seems like a very elegant implementation!
</p>

<p>
Funny you should make a rougelike :smiley: , I guess effect handlers + games might be popular for games, because I
also had a blog post about effect handlers and their applications, in particular for games, although in my case it
was for animations:
</p>

<p>
<a href="https://gopiandcode.uk/logs/log-bye-bye-monads-algebraic-effects.html">https://gopiandcode.uk/logs/log-bye-bye-monads-algebraic-effects.html</a>
</p>
</div>
</div>


<div id="outline-container-orgb286053" class="outline-3">
<h3 id="orgb286053">gasche also replied</h3>
<div class="outline-text-3" id="text-orgb286053">
<p>
Note: the "upstream" status of effect handlers is a little uncertain/confusing right now. Your blog post (I didn't
get a chance to read it yet, but it sounds very nice!) uses the experimental syntax of multicore-4.12+effects, but
that syntax was intentionally <i>not</i> upstreamed, and it will <i>not</i> be part of OCaml 5.0.
</p>

<p>
I think there is a risk of confusion because the community is aware that Multicore OCaml has effect handlers, and
also that Multicore OCaml has been merged upstream. So it can be tempting to believe that the upcoming OCaml release
(or maybe one or two releases after that, we said the first Multicore release would be more like a preview) will
support effect handlers as a language feature. It will not! Effects as a language feature were removed from Multicore
OCaml before the upstream merge. And <i>no one knows</i> if/when they will be supported upstream.
</p>

<p>
So: I think that your blog posts on using effect handlers could have somewhere a short mention that the code is using
an experimental extension of OCaml that is not supported by the upstream implementation.
</p>


<p>
The reasoning for this choice is that we want to give a chance to a type system for effect handlers, but that still
need quite a bit more time than the Multicore runtime itself. We don't want to encourage the ecosystem to rely on
untyped effects, if it means a lot of pain upgrading to typed effects later (or risk having to support both).
</p>

<p>
5.0 only contains basic support for effect handlers as a <i>runtime primitive</i>, but dos <i>not</i> support handlers as a
<i>language feature</i>. I think they should be considered experimental: you can rely on them for their intended purpose
of exposing a flexible interface for concurrent fibers, but uses beyond that may break in the future.
</p>

<p>
So, in a sense, we don't want people to use them. It's of course fine to use experimental features from experimental
forks of the OCaml compiler (effect handlers, modular implicits or explicits, runtime type representations and what
not), and the people working on these experimental features do benefit from other people trying them and giving them
feedback. But we don't want people to depend on it <i>in production</i>, whatever that means. (For example, code using it
is likely to get stuck on 4.12 forever and never see an upgrade to upcoming OCaml versions, although of course people
could choose to port the experimental branch forward.)
</p>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">For Diversity and the OCaml Community: Outreachy Summer 2022</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/for-diversity-and-the-ocaml-community-outreachy-summer-2022/9234/4">https://discuss.ocaml.org/t/for-diversity-and-the-ocaml-community-outreachy-summer-2022/9234/4</a>
</p>
</div>

<div id="outline-container-org9b9196f" class="outline-3">
<h3 id="org9b9196f">Sonja Heinze announced</h3>
<div class="outline-text-3" id="text-org9b9196f">
<p>
Just in case anyone is actually interested in this: the project submission deadline has been extended from March 4th
to March 23rd. So the updated timeline now looks as follows:
</p>


<div id="org3ee2c11" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/5/534ca9a08bce10f13530e6c98eae1797fdf13e52.png" alt="534ca9a08bce10f13530e6c98eae1797fdf13e52.png" />
</p>
</div>

<p>
where 2. and 3. probably need to be done a bit in parallel.
</p>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">Bogue, the OCaml GUI</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-bogue-the-ocaml-gui/9099/23">https://discuss.ocaml.org/t/ann-bogue-the-ocaml-gui/9099/23</a>
</p>
</div>

<div id="outline-container-org24755ac" class="outline-3">
<h3 id="org24755ac">sanette announced</h3>
<div class="outline-text-3" id="text-org24755ac">
<p>
Hi, some new developments. I have implemented a new <code>Sdl_area</code> widget where one can conveniently issue any SDL
function (from the SDL Renderer API).
</p>

<p>
Here is (below) the new 'labelled graph' example. In this example I am using regular "label" widgets for creating the
nodes, and I am using an Sdl_area for drawing the lines.
</p>

<p>
The nice things for labels to be regular widgets is that one can click on them. To demonstrate this, in this example
they react to a click by jumping to another random location (with animation).
</p>


<div id="orgcb79462" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/optimized/2X/f/f9575838a7e5ea4c58485b955e96f7c9bbda384f_2_1266x1000.png" alt="f9575838a7e5ea4c58485b955e96f7c9bbda384f_2_1266x1000.png" />
</p>
</div>


<div id="org11e3ca0" class="figure">
<p><img src="https://aws1.discourse-cdn.com/standard11/uploads/ocaml/original/2X/d/d6958e266f27a557c5c8d8d37099d532eacf2c1c.gif" alt="d6958e266f27a557c5c8d8d37099d532eacf2c1c.gif" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">open </span><span style="color: #228b22;">Bogue</span>
<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #228b22;">W</span> = <span style="color: #228b22;">Widget</span>
<span style="color: #000000; font-weight: bold;">module</span> <span style="color: #228b22;">L</span> = <span style="color: #228b22;">Layout</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">n</span> = 15 <span style="color: #b22222;">(* </span><span style="color: #b22222;">number of discs </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">radius</span> = 20
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">width</span> = 800
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">height</span> = 600

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">c</span> = <span style="color: #228b22;">Draw.</span>find_color <span style="color: #8b2252;">"#e5b92c"</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">cb</span> = <span style="color: #228b22;">Draw.</span>find_color <span style="color: #8b2252;">"#7b6b35"</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">disc_style</span> = <span style="color: #228b22;">Style.</span>(
    create <span style="color: #008b8b;">~border</span>:(
      mk_border ~radius (mk_line <span style="color: #008b8b;">~color</span>:<span style="color: #228b22;">Draw.</span>(opaque c) <span style="color: #008b8b;">~width</span>:1 <span style="color: #008b8b;">~style</span>:<span style="color: #000000; background-color: #ffffff;">Solid</span> ()))
      <span style="color: #008b8b;">~background</span>:(color_bg <span style="color: #228b22;">Draw.</span>(opaque cb)) ())

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">background</span> = <span style="color: #228b22;">L.</span>style_bg <span style="color: #228b22;">Style.</span>(
    of_bg (gradient <span style="color: #008b8b;">~angle</span>:45. <span style="color: #228b22;">Draw.</span>[opaque grey; opaque black]))

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">fg</span> = <span style="color: #228b22;">Draw.</span>(opaque white)

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">create_disc</span> <span style="color: #a0522d;">i</span> (<span style="color: #a0522d;">x</span>,<span style="color: #a0522d;">y</span>) =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">w</span> = 2*radius + 1 <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">bg</span> = <span style="color: #228b22;">Box.</span>create <span style="color: #008b8b;">~style</span>:disc_style <span style="color: #008b8b;">~width</span>:w <span style="color: #008b8b;">~height</span>:w () <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #228b22;">W.</span>label ~fg (string_of_int i)
  <span style="color: #a52a2a;">|&gt;</span> <span style="color: #228b22;">L.</span>resident <span style="color: #008b8b;">~background</span>:(<span style="color: #228b22;">L.</span>box_bg bg) <span style="color: #008b8b;">~x</span>:(x-radius) <span style="color: #008b8b;">~y</span>:(y-radius) ~w <span style="color: #008b8b;">~h</span>:w

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">move_disc</span> (<span style="color: #a0522d;">x</span>,<span style="color: #a0522d;">y</span>) <span style="color: #a0522d;">d</span> =
  <span style="color: #000000; font-weight: bold;">let</span> (<span style="color: #a0522d;">x0</span>, <span style="color: #a0522d;">y0</span>) = <span style="color: #228b22;">L.</span>xpos d, <span style="color: #228b22;">L.</span>ypos d <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #228b22;">L.</span>animate_x d (<span style="color: #228b22;">Avar.</span>fromto x0 x);
  <span style="color: #228b22;">L.</span>animate_y d (<span style="color: #228b22;">Avar.</span>fromto y0 y)

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">random_center</span> <span style="color: #a0522d;">_</span> =
  radius + <span style="color: #228b22;">Random.</span>int (width - 2*radius),
  radius + <span style="color: #228b22;">Random.</span>int (height - 2*radius)

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">area</span> =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">sdlw</span> = <span style="color: #228b22;">W.</span>sdl_area <span style="color: #008b8b;">~w</span>:width <span style="color: #008b8b;">~h</span>:height () <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">sdla</span> = <span style="color: #228b22;">W.</span>get_sdl_area sdlw <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">centers</span> = <span style="color: #228b22;">Array.</span>init n random_center <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">color</span> = <span style="color: #228b22;">Draw.</span>(opaque grey) <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">draw_lines</span> <span style="color: #a0522d;">renderer</span> = <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #000000; font-weight: bold;">open </span><span style="color: #228b22;">Draw</span> <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #a020f0;">for</span> i = 0 <span style="color: #a020f0;">to</span> n - 2 <span style="color: #a020f0;">do</span>
      <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">x0</span>, <span style="color: #a0522d;">y0</span> = to_pixels centers.(i) <span style="color: #000000; font-weight: bold;">in</span>
      <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">x1</span>, <span style="color: #a0522d;">y1</span> = to_pixels centers.(i+1) <span style="color: #000000; font-weight: bold;">in</span>
      line renderer ~color <span style="color: #008b8b;">~thick</span>:6 ~x0 ~y0 ~x1 ~y1
    <span style="color: #a020f0;">done</span> <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #228b22;">Sdl_area.</span>add sdla draw_lines;
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">discs</span> = <span style="color: #228b22;">Array.</span>mapi create_disc centers <span style="color: #a52a2a;">|&gt;</span> <span style="color: #228b22;">Array.</span>to_list <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #b22222;">(* </span><span style="color: #b22222;">move the disc when click on it </span><span style="color: #b22222;">*)</span>
  <span style="color: #228b22;">List.</span>iteri (<span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">i</span> <span style="color: #a0522d;">d</span> -&gt;
      <span style="color: #228b22;">W.</span>on_click <span style="color: #008b8b;">~click</span>:(<span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">_</span> -&gt;
          centers.(i) &lt;- random_center 0;
          <span style="color: #228b22;">Sdl_area.</span>update sdla;
          <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">x</span>,<span style="color: #a0522d;">y</span> = centers.(i) <span style="color: #000000; font-weight: bold;">in</span>
          move_disc (x - radius, y - radius) d) (<span style="color: #228b22;">L.</span>widget d))
    discs;
  <span style="color: #228b22;">L.</span>superpose <span style="color: #008b8b;">~w</span>:width <span style="color: #008b8b;">~h</span>:height ~background (<span style="color: #228b22;">L.</span>resident sdlw <span style="color: #000000; background-color: #ffffff;">::</span> discs)

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">board</span> = <span style="color: #228b22;">Bogue.</span>make <span style="color: #000000; background-color: #ffffff;">[]</span> [area]

<span style="color: #000000; font-weight: bold;">let</span> () = <span style="color: #228b22;">Bogue.</span>run board
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">Friday 03/04 Intern presentations &#x2013; open attendance!</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/friday-03-04-intern-presentations-open-attendance/9429/1">https://discuss.ocaml.org/t/friday-03-04-intern-presentations-open-attendance/9429/1</a>
</p>
</div>

<div id="outline-container-org2aeb3a4" class="outline-3">
<h3 id="org2aeb3a4">Aya announced</h3>
<div class="outline-text-3" id="text-org2aeb3a4">
<p>
This is Aya, one of the three <a href="https://outreachy.org/">Outreachy</a> interns working on OCaml this winter :camel: After
3 very fast months, our internships are already coming to a close. We have had such a great time working on our
projects and learning OCaml that we want to hold an event to mark the end of the internships, and we decided to open
it up to the community :tada:
</p>

<p>
As you might have seen in the <a href="https://discuss.ocaml.org/t/announcing-our-new-outreachy-interns/8932">initial
announcement</a>, @pitag @shonfeder @gs0510
@tmattio and @pkel all volunteered to mentor us from December 2021 to now. Thank you all so so much for mentoring us
and introducing us to OCaml :heart: :fire: It's been such an enjoyable experience!
</p>

<p>
We are inviting anyone who is interested to attend a virtual session of 3 short presentations on <b>Friday, March 4th,
4-5pm CET</b> (we will post the link to join on Thursday). There will be time for Q&amp;A after each presentation, and the
whole session will be recorded and posted online shortly after as well.
</p>

<ul class="org-ul">
<li>@ayc9 will present on updating a standard PPX deriver (mentors: @pitag @shonfeder)</li>
<li>@SaySayo will present on syntax highlighting and other updates to the vscode extension (mentors: @tmattio @gs0510)</li>
<li>@JiaeK will present on building a basic monitoring dashboard for <a href="http://ocaml.org/">ocaml.org</a> (mentors: @tmattio)</li>
</ul>

<p>
We hope you can make it!
</p>

<p>
-@ayc9 @SaySayo @JiaeK
</p>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">Affect: Composable concurrency primitives for OCaml 5.0</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/affect-composable-concurrency-primitives-for-ocaml-5-0/9430/1">https://discuss.ocaml.org/t/affect-composable-concurrency-primitives-for-ocaml-5-0/9430/1</a>
</p>
</div>

<div id="outline-container-orgb29bb8f" class="outline-3">
<h3 id="orgb29bb8f">Daniel Bünzli announced</h3>
<div class="outline-text-3" id="text-orgb29bb8f">
<p>
I looked a bit into the kind of fiber abstraction and concurrency structure I would like to use with the new tools
OCaml 5.0 is going to offer.  You can find some results in affect's
<a href="https://erratique.ch/software/affect/doc/Fiber/index.html"><code>Fiber</code></a> module.
</p>

<p>
This fiber abstraction supports terminating by returning values or abnormally (by aborting or via a spurious
exception). Termination of a fiber is aligned on function scopes: all the fibers spawn by a fiber function have to
terminate in order for it to terminate.
</p>

<p>
This means that if your fiber returns a value it waits for its spawns to terminate (in any way) before returning the
value. And if your fiber returns abnormally (uncaught eception or explicit abort) it first aborts all its
non-terminated spawns before returning abnormally – this provides affect's notion of cancellation.
</p>

<p>
Explicit fiber aborts raise the <code>Abort</code> exception in fibers. Combined with a disciplined use of <code>Fun.protect</code> and an
optional <code>finally</code> handler specified at fiber spawn, this lets them release the ressources they may hold when it's
time to say goodbye.
</p>

<p>
The module also provides a generic way of blocking and unblocking fibers that you can use to interface with your
favourite event loop. It does so without requiring to fiddle with effects, you just need to make judicious use of
<a href="https://erratique.ch/software/affect/doc/Fiber/index.html#val-block"><code>Fiber.block</code></a> and provide a suitable function
to <code>Fiber.run</code>'s built-in scheduler to let it know about fibers that can be unblocked.
</p>

<p>
A grab bag of comments:
</p>

<ol class="org-ol">
<li>The first goal of affect is to seek a concurrency and abort structure that are easy to understand, use and compose with event loops. Right now some efficiency and implementation aspects need to be improved. This will likely change the exposed set of primitive effects which doesn't feel exactly right yet (if you want to build your own scheduler).</li>

<li>I use abort rather than cancel terminology. From my non-native english speaker perspective, cancelling is more about not doing something that was planned but didn't happen yet. Aborting is more about stopping something that is going on. It also melds better with the uncaught exception case.</li>

<li>Say no to <code>unit</code> soups! Let fibers return values.</li>

<li>At that point I don't feel the need to add a promise/future abstraction to the toolbox. The whole point of direct style is to get rid of this async madness.</li>

<li>There's no synchronisation structure yet. Semaphores are always useful for throttling so I'll certainly add that at some point or a more fundamental primitive like an mvar.</li>

<li>The <a href="https://erratique.ch/software/affect/doc/Funix/index.html"><code>Funix</code></a> module has a few fiber friendly <code>Unix</code> module functions for playing with timers and the network, see <a href="https://github.com/dbuenzli/affect/blob/master/test/ping.ml"><code>ping.ml</code></a> for an example of use. In practice you want to be able to use something else than <code>select(2)</code> though. There are various ways one could go about this, see for example point 6. in these <a href="https://github.com/dbuenzli/affect/blob/master/DESIGN.md">design notes</a>.</li>

<li>The <a href="https://github.com/dbuenzli/affect/blob/master/test/mouse.ml"><code>mouse.ml</code></a> has a basic example on how to interface with the SDL event loop which provides another example on how one goes to interface <code>Fiber</code> with event loops.</li>
</ol>

<p>
I'm not fully convinced by everything yet. It will certainly need one or two more design rounds. If you try it, feel free to comment or make suggestions on the issue tracker.
</p>

<p>
Home page: <a href="https://erratique.ch/software/affect">https://erratique.ch/software/affect</a>
</p>

<p>
API docs: <a href="https://erratique.ch/software/affect/doc/">https://erratique.ch/software/affect/doc/</a> (or <code>odig doc affect</code>)
</p>

<p>
Install:
</p>
<pre class="example" id="orgc465973">
opam switch create 5.0.0+trunk
opam pin add https://erratique.ch/repos/affect.git
</pre>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">Segfault Systems Joins Tarides</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/segfault-systems-joins-tarides/9431/1">https://discuss.ocaml.org/t/segfault-systems-joins-tarides/9431/1</a>
</p>
</div>

<div id="outline-container-org58258a7" class="outline-3">
<h3 id="org58258a7">Thomas Gazagnaire announced</h3>
<div class="outline-text-3" id="text-org58258a7">
<p>
@kayceesrk and I are delighted to announce that Segfault Systems, a spinout from IIT-Madras, is joining Tarides.
Tarides has worked closely with Segfault Systems over the last couple of years, most notably on the award-winning
Multicore OCaml project and the upstreaming plans for OCaml 5.0. This alliance furthers the goals of Tarides,
bringing the compiler and benchmarking expertise of the Segfault team directly into the Tarides organisation, where
it can be commercially funded and supported.
</p>

<p>
All of Segfault Systems’ existing responsibilities and open-source commitments will migrate over to Tarides, where
work will continue towards the three main objectives in 2022:
</p>

<ul class="org-ul">
<li>Releasing OCaml 5.0 with support for domains and effect handlers</li>
<li>Supporting the ecosystem to migrate the OCaml community over to OCaml 5.0</li>
<li>Improving developer productivity for OCaml 5.0 by releasing the best platform tools</li>
</ul>

<p>
This alliance will complement the commercial offerings of Tarides &#x2013; already strengthened by the integration of
<a href="https://discuss.ocaml.org/t/ocaml-labs-joins-tarides/9229">OCaml Labs</a> &#x2013; and contribute to Tarides’ mission:
empowering developers, communities, and organisations to adopt OCaml as their primary programming experience by
providing training, expertise, and development services around the OCaml language.
</p>

<p>
Read the full announcement <a href="https://tarides.com/blog/2022-03-01-segfault-systems-joins-tarides">here</a>, including
details of our goals and the focus for 2022. This alliance brings the headcount of Tarides up to 60+ people, all
working towards making OCaml the best language for any and every project. Join our team and reach out for commercial
services at <a href="https://tarides.com/">https://tarides.com/</a>.
</p>
</div>
</div>
</div>




<div id="outline-container-8" class="outline-2">
<h2 id="8">OCaml User Survey 2022</h2>
<div class="outline-text-2" id="text-8">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-ocaml-user-survey-2022/9433/1">https://discuss.ocaml.org/t/ann-ocaml-user-survey-2022/9433/1</a>
</p>
</div>

<div id="outline-container-orga80fc2d" class="outline-3">
<h3 id="orga80fc2d">Kim Nguyễn announced</h3>
<div class="outline-text-3" id="text-orga80fc2d">
<p>
we are delighted to announce the <a href="https://forms.gle/oKy2Joz1cZhCPNtf6">OCaml User Survey 2022</a>. With this survey, the
OCSF is trying to get a better picture of the OCaml community and its needs. It would be very helpful if you could
take a few minutes (10 to 15) to fill the survey and share it with other OCaml programmers.
</p>

<p>
<a href="https://forms.gle/oKy2Joz1cZhCPNtf6">https://forms.gle/oKy2Joz1cZhCPNtf6</a>
</p>

<p>
The survey is run by the <a href="https://ocaml-sf.org/">OCaml Software Foundation</a>. It builds on <a href="https://discuss.ocaml.org/t/ann-ocaml-user-survey-2020/6624">the previous
iteration</a> issued in 2020. The results will be published
here on discuss and on the  <a href="https://ocaml-sf.org/">website of the OCSF</a>. We would like to particularly thank @cjr
for his help as well as everyone who commented on the previous survey. We tried our best to take all remarks into
account but surely missed something. Don't hesitate to give us your feedback (you can post here or send me a
message/email).
</p>

<p>
The survey will remain opened until March 11th 2022 (AOE).
</p>
</div>
</div>
</div>




<div id="outline-container-org3f49505" class="outline-2">
<h2 id="org3f49505">Old CWN</h2>
<div class="outline-text-2" id="text-org3f49505">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org811ede3">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
