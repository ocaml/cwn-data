<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-10-05 Tue 11:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>OCaml Weekly News</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<style type="text/css">#table-of-contents h2 { display: none } .title { display: none } .authorname { text-align: right }</style>
<style type="text/css">.outline-2 {border-top: 1px solid black;}</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">OCaml Weekly News</h1>
<p>
<a href="https://alan.petitepomme.net/cwn/2021.09.28.html">Previous Week</a> <a href="https://alan.petitepomme.net/cwn/index.html">Up</a> <a href="https://alan.petitepomme.net/cwn/2021.10.12.html">Next Week</a>
</p>

<p>
Hello
</p>

<p>
Here is the latest OCaml Weekly News, for the week of September 28 to October 05, 2021.
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#1">What's a usage pattern for existential type variables?</a></li>
<li><a href="#2">Multicore OCaml: September 2021, effect handlers will be in OCaml 5.0!</a></li>
<li><a href="#3">Développeur-euse oCaml - CDI Geneanet - Paris</a></li>
<li><a href="#4">OCaml 4.13.1, a small and early regression fix version</a></li>
<li><a href="#5">Set up OCaml 2.0.0-beta5</a></li>
<li><a href="#6">Liquidsoap 2.0.0</a></li>
<li><a href="#7">OCaml code snippets proposed as CC-BY-SA 4.0 candidates</a></li>
<li><a href="#orgf007647">Old CWN</a></li>
</ul>
</div>
</div>


<div id="outline-container-1" class="outline-2">
<h2 id="1">What's a usage pattern for existential type variables?</h2>
<div class="outline-text-2" id="text-1">
<p>
Archive: <a href="https://discuss.ocaml.org/t/whats-a-usage-pattern-for-existential-type-variables/8538/1">https://discuss.ocaml.org/t/whats-a-usage-pattern-for-existential-type-variables/8538/1</a>
</p>
</div>

<div id="outline-container-orge8cf0d4" class="outline-3">
<h3 id="orge8cf0d4">hyphenrf asked</h3>
<div class="outline-text-3" id="text-orge8cf0d4">
<p>
Online, (Scala/Java) and Haskell-specific tutorials on existential types seem to be dominant. Because I wouldn't get
stuck too much on notation, I went with Haskell tutorials, and they all seem to imply that <b>existentials that are
unconstrained are useless</b>.
</p>

<p>
The usual example for existentials is information (but not trait) hiding, in which for example you can have a
definition like so (with some syntax parallels for those unfamiliar with haskell):
</p>
<pre class="example" id="org6c3f14e">
{-
ocaml: ~type gadt = Constr : typexpr~
haskell: ~data Gadt where Constr :: typexpr~
-}

data Hidden where
  Hide :: Show a =&gt; a -&gt; Hidden

{-
ocaml: iter (fun (Hide x) -&gt; ...) [Hide 1; Hide ...]
-}

main :: IO ()
main =
  mapM_ (\(Hide x) -&gt; print x) [Hide 1, Hide "a", Hide 4.2]
</pre>

<p>
The problem with such implication is that I can't find a usage for an existential introduced by an OCaml GADT because
I don't know how I'd express the <code>Show a =&gt; a</code> constraint.
</p>
<pre class="example" id="orga3c2bd6">
type hidden = Hide : 'a -&gt; hidden
</pre>
<p>
Would simply completely cloak <code>'a</code>, and any attempt at interacting with it would produce a type scope escaping error.
</p>

<p>
That considered, since <code>Show a =&gt; a</code> is best emulated now with passing a first-class module, that was the vector I
was walking in with my existentials experiments, but I have a feeling there's better, more valid, usage of those type
variables that isn't reliant on constraining.
</p>

<p>
So my question is, have you ever come across a pattern where an existential type variable is the solution?
</p>
</div>
</div>


<div id="outline-container-orgca9693b" class="outline-3">
<h3 id="orgca9693b">octachron replied</h3>
<div class="outline-text-3" id="text-orgca9693b">
<p>
Your showable example can be written as:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">showable</span> = <span style="color: #000000; background-color: #ffffff;">Show</span>: 'a * ('a -&gt; string) -&gt; showable
</pre>
</div>
<p>
And there is fact many similar way to constraint existential types, either using type constructors:
if you have an <code>'a. 'a t</code>, you may still be able to write useful functions, or coupling various producers or
consumers of the existential types.
</p>

<p>
The <code>showable</code> example is a little artificial here but that are many examples where existential types are useful for:
</p>
<ul class="org-ul">
<li>representing internal types.</li>
<li>hiding some type information at an abstraction barrier.</li>
</ul>

<p>
I can offer one examples that combines the two to implement a zipper through mutually recursive trees.
Starting from a simplified data structure
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">a_tree</span> =
  | <span style="color: #000000; background-color: #ffffff;">Leaf</span> <span style="color: #a020f0;">of</span> int
  | <span style="color: #000000; background-color: #ffffff;">Node_A</span> <span style="color: #a020f0;">of</span> b_tree * b_tree
<span style="color: #000000; font-weight: bold;">and</span> <span style="color: #a0522d;">b_tree</span> =
  | <span style="color: #000000; background-color: #ffffff;">Leaf</span> <span style="color: #a020f0;">of</span> float
  | <span style="color: #000000; background-color: #ffffff;">Node_B</span> <span style="color: #a020f0;">of</span> a_tree * a_tree
</pre>
</div>
<p>
Then zipper over a binary tree would be simply:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">dir</span> = <span style="color: #000000; background-color: #ffffff;">Left</span> | <span style="color: #000000; background-color: #ffffff;">Right</span>
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">zipper</span> = { value: tree; path: (dir * tree) list }
</pre>
</div>
<p>
but here our problem is that we have alternatively <code>a_tree</code> and <code>b_tree</code>. We can use existential types to keep a
similar representation as the simpler zipper described above. The first step is to describe a step in the data
structure as
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">('a,'b) step</span> =
  | <span style="color: #000000; background-color: #ffffff;">A</span>: dir * b_tree -&gt; (b_tree,a_tree) step
  | <span style="color: #000000; background-color: #ffffff;">B</span>: dir * a_tree -&gt; (a_tree,b_tree) step
</pre>
</div>
<p>
Then we can connect the step using an existential types to describe that if we have a path from
nodes of type <code>top</code> to a node of type <code>bottom</code>, we don't necessarily know the intermediary types
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">('bottom,'top) path</span> =
  | <span style="color: #000000; background-color: #ffffff;">[]</span>: ('top,'top) path
  | (::):
  ('bottom , 'previous_bottom) step * ('previous_bottom,'top) path -&gt;
    ('bottom,'top) path
</pre>
</div>

<p>
Then a zipper is simply:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">('bottom,'top) zipper</span> = { value: 'bottom; path:('bottom,'top) path }
</pre>
</div>
<p>
However, sometime we don't care if we don't know where we are in the tree, thus we may need to erase the <code>bottom</code>
information from the zipper:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">'top any_zipper</span> = <span style="color: #000000; background-color: #ffffff;">Any</span>: ('bottom, 'top) zipper -&gt; 'top any_zipper
</pre>
</div>
<p>
and we can still use this <code>any_zipper</code> type to write an <code>up</code> function for instance:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">up</span> (<span style="color: #a020f0;">type</span> <span style="color: #228b22;">top</span>) (<span style="color: #000000; background-color: #ffffff;">Any</span> <span style="color: #a0522d;">z</span>: <span style="color: #228b22;">top any_zipper</span>) =
  <span style="color: #a020f0;">match</span> z.path <span style="color: #a020f0;">with</span>
  | <span style="color: #000000; background-color: #ffffff;">[]</span> -&gt; <span style="color: #000000; background-color: #ffffff;">Any</span> z
  | <span style="color: #000000; background-color: #ffffff;">A</span> (<span style="color: #000000; background-color: #ffffff;">Left</span>,r) <span style="color: #000000; background-color: #ffffff;">::</span> rest -&gt;
    <span style="color: #000000; background-color: #ffffff;">Any</span> { path=rest; value = <span style="color: #000000; background-color: #ffffff;">Node_A</span>(z.value,r) }
  | <span style="color: #000000; background-color: #ffffff;">B</span> (<span style="color: #000000; background-color: #ffffff;">Left</span>,r) <span style="color: #000000; background-color: #ffffff;">::</span> rest -&gt;
    <span style="color: #000000; background-color: #ffffff;">Any</span> { path=rest; value = <span style="color: #000000; background-color: #ffffff;">Node_B</span>(z.value,r) }
  | <span style="color: #000000; background-color: #ffffff;">A</span> (<span style="color: #000000; background-color: #ffffff;">Right</span>,l) <span style="color: #000000; background-color: #ffffff;">::</span> rest -&gt;
    <span style="color: #000000; background-color: #ffffff;">Any</span> { path=rest; value = <span style="color: #000000; background-color: #ffffff;">Node_A</span>(l, z.value) }
  | <span style="color: #000000; background-color: #ffffff;">B</span> (<span style="color: #000000; background-color: #ffffff;">Right</span>,l) <span style="color: #000000; background-color: #ffffff;">::</span> rest -&gt;
    <span style="color: #000000; background-color: #ffffff;">Any</span> { path=rest; value = <span style="color: #000000; background-color: #ffffff;">Node_B</span>(l, z.value) }
</pre>
</div>
</div>
</div>


<div id="outline-container-orgd935c9d" class="outline-3">
<h3 id="orgd935c9d">octachron later added</h3>
<div class="outline-text-3" id="text-orgd935c9d">
<p>
Any time you have useful functions of type <code>'a. 'a t -&gt; ..</code>, you can quantify existentially that type parameter and
still retain some functionality. For instance, I can compute a length for an <code>any_list</code>:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">any_list</span> = <span style="color: #000000; background-color: #ffffff;">Any_list</span> : 'a list -&gt; any_list
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">len</span> (<span style="color: #000000; background-color: #ffffff;">Any_list</span> <span style="color: #a0522d;">l</span>) = <span style="color: #228b22;">List.</span>length l
</pre>
</div>
<p>
then there is also the possibility to use type witnesses to recover the quantified type at a later date:
</p>
<div class="org-src-container">
<pre class="src src-ocaml"> <span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">'a num_ty</span> =
| <span style="color: #000000; background-color: #ffffff;">Int</span>: int num
| <span style="color: #000000; background-color: #ffffff;">Float</span>: float num
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">num</span> = <span style="color: #000000; background-color: #ffffff;">Num</span>: 'a num_ty * 'a -&gt; num
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">num_array</span> = <span style="color: #000000; background-color: #ffffff;">Narray</span>: 'a num_ty * 'a array -&gt; num_array
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">sum</span> (<span style="color: #000000; background-color: #ffffff;">Narray</span> (<span style="color: #a0522d;">witness</span>, <span style="color: #a0522d;">array</span>)) = <span style="color: #a020f0;">match</span> witness <span style="color: #a020f0;">with</span>
| <span style="color: #000000; background-color: #ffffff;">Int</span> -&gt; <span style="color: #000000; background-color: #ffffff;">Num</span>(<span style="color: #000000; background-color: #ffffff;">Int</span>, <span style="color: #228b22;">Array.</span>fold_left (<span style="color: #0000ff;">+</span>) 0 array)
| <span style="color: #000000; background-color: #ffffff;">Float</span> -&gt; <span style="color: #000000; background-color: #ffffff;">Num</span>(<span style="color: #000000; background-color: #ffffff;">Float</span>, <span style="color: #228b22;">Array.</span>fold_left (<span style="color: #0000ff;">+.</span>) 0. array)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgc4bded0" class="outline-3">
<h3 id="orgc4bded0">Josh Berdine also replied</h3>
<div class="outline-text-3" id="text-orgc4bded0">
<p>
@octachron's examples are very good. For variety, here is a small example of a slightly different flavor that we use
in ocamlformat to wrap Cmdliner: (from
<a href="https://github.com/ocaml-ppx/ocamlformat/blob/main/vendor/ocamlformat-stdlib/cmdliner_ext.ml">here</a>)
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">include</span> <span style="color: #228b22;">Cmdliner</span>

<span style="color: #8b2252;">(** existential package of a Term and a setter for a ref to receive the</span>
<span style="color: #8b2252;">    parsed value *)</span>
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">arg</span> = <span style="color: #000000; background-color: #ffffff;">Arg</span> : 'a <span style="color: #228b22;">Term.</span>t * ('a -&gt; unit) -&gt; arg

<span style="color: #8b2252;">(** convert a list of arg packages to a term for the tuple of all the arg</span>
<span style="color: #8b2252;">    terms, and apply it to a function that sets all the receiver refs *)</span>
<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">tuple</span> <span style="color: #a0522d;">args</span> =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">pair</span> (<span style="color: #000000; background-color: #ffffff;">Arg</span> (<span style="color: #a0522d;">trm_x</span>, <span style="color: #a0522d;">set_x</span>)) (<span style="color: #000000; background-color: #ffffff;">Arg</span> (<span style="color: #a0522d;">trm_y</span>, <span style="color: #a0522d;">set_y</span>)) =
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">trm_xy</span> = <span style="color: #228b22;">Term.</span>(const (<span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">a</span> <span style="color: #a0522d;">b</span> -&gt; (a, b)) <span style="color: #a52a2a;">$</span> trm_x <span style="color: #a52a2a;">$</span> trm_y) <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">set_xy</span> (<span style="color: #a0522d;">a</span>, <span style="color: #a0522d;">b</span>) = set_x a ; set_y b <span style="color: #000000; font-weight: bold;">in</span>
    <span style="color: #000000; background-color: #ffffff;">Arg</span> (trm_xy, set_xy)
  <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">init</span> = <span style="color: #000000; background-color: #ffffff;">Arg</span> (<span style="color: #228b22;">Term.</span>const (), <span style="color: #a020f0;">fun</span> () -&gt; ()) <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> (<span style="color: #000000; background-color: #ffffff;">Arg</span> (<span style="color: #a0522d;">trm</span>, <span style="color: #a0522d;">set</span>)) = <span style="color: #228b22;">Base.List.</span>fold_right <span style="color: #008b8b;">~f</span>:pair args ~init <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #228b22;">Term.</span>app (<span style="color: #228b22;">Term.</span>const set) trm

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">args</span> :<span style="color: #228b22;"> arg list </span><span style="color: #483d8b;">ref</span><span style="color: #228b22;"> </span>= <span style="color: #483d8b;">ref</span> <span style="color: #000000; background-color: #ffffff;">[]</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">mk</span> ~<span style="color: #a0522d;">default</span> <span style="color: #a0522d;">arg</span> =
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #a0522d;">var</span> = <span style="color: #483d8b;">ref</span> default <span style="color: #000000; font-weight: bold;">in</span>
  <span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">set</span> <span style="color: #a0522d;">x</span> = var := x <span style="color: #000000; font-weight: bold;">in</span>
  args := <span style="color: #000000; background-color: #ffffff;">Arg</span> (arg, set) <span style="color: #000000; background-color: #ffffff;">::</span> <span style="color: #a52a2a;">!</span>args ;
  var

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">parse</span> <span style="color: #a0522d;">info</span> <span style="color: #a0522d;">validate</span> =
  <span style="color: #228b22;">Term.</span>eval (<span style="color: #228b22;">Term.</span>(ret (const validate <span style="color: #a52a2a;">$</span> tuple <span style="color: #a52a2a;">!</span>args)), info)
</pre>
</div>
<p>
The idea here is similar to an "any list", where an existential around a pair of an <code>'a Cmdliner.Term.t</code> representing
a command-line argument yielding an <code>'a</code> value, and a function of type <code>'a -&gt; unit</code> to set a ref to the parsed value.
Then a list of such packages can be built using <code>mk</code> and then converted with <code>tuple</code> to a single <code>Cmdliner.Term</code> for
the list as a tuple.
</p>

<p>
I don't think this example needs anything more from the type system, but is an almost minimal example of packaging a
value with the interesting operations over it into an existentially-typed value.
</p>
</div>
</div>


<div id="outline-container-orgf586e99" class="outline-3">
<h3 id="orgf586e99">Malcolm also replied</h3>
<div class="outline-text-3" id="text-orgf586e99">
<p>
I have made my own futures library and one of the features is futures are connected to each other creating a
dependency tree.  This is done so that you can do <code>Future.abort fut</code> and it will abort that future and everything
connected to it.  I accomplish this by each future storing a list of those futures that depend on it.  But those
futures do not necessarily have the same type.  So I hide the type in an existential so I can still perform actions
on the future that do not depend on the type.
</p>

<p>
Note, I stole this from @dbuenzli 's futures library which I used to start mine.
</p>

<p>
Here is the code from my library:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #b22222;">(* </span><span style="color: #b22222;">The concrete type of a future.  Future's are mutable, but once they are</span>
<span style="color: #b22222;">   determined they become immutable.  A future has a state which starts as</span>
<span style="color: #b22222;">   undetermined, can become determined or an alias.  An alias is a future that</span>
<span style="color: #b22222;">   needs to exist because some unknown computation will eventually become its</span>
<span style="color: #b22222;">   value, and once that computation is found out, we set the future to an</span>
<span style="color: #b22222;">   alias to that future. </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">'a u</span> = { <span style="color: #a020f0;">mutable</span> state : 'a state }

<span style="color: #000000; font-weight: bold;">and</span> 'a <span style="color: #a0522d;">state</span> =
  [ 'a <span style="color: #228b22;">Abb_intf.Future.Set.</span>t
  | <span style="color: #000000; background-color: #ffffff;">`Undet</span> <span style="color: #a020f0;">of</span> 'a undet
  | <span style="color: #000000; background-color: #ffffff;">`Alias</span> <span style="color: #a020f0;">of</span> 'a u
  ]

<span style="color: #b22222;">(* </span><span style="color: #b22222;">An undetermined has an optional function, which is some work to be</span>
<span style="color: #b22222;">   executed, watchers are executed when this undetermined future becomes</span>
<span style="color: #b22222;">   determined, deps are futures that are not required to be executed before</span>
<span style="color: #b22222;">   this future is determined but in some meaningful way connected to it, the</span>
<span style="color: #b22222;">   abort function is what to do if this future is aborted, and finally num_ops</span>
<span style="color: #b22222;">   is how many operations have been performed on this future.  The definition</span>
<span style="color: #b22222;">   of an "operation" is kind of vague but basically it corresponds to mutating</span>
<span style="color: #b22222;">   this undetermined future in some way. </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">and</span> 'a <span style="color: #a0522d;">undet</span> = {
  <span style="color: #a020f0;">mutable</span> f : (<span style="color: #228b22;">State.</span>t -&gt; <span style="color: #228b22;">State.</span>t) option;
  <span style="color: #a020f0;">mutable</span> watchers : 'a <span style="color: #228b22;">Watcher.</span>t list;
  <span style="color: #a020f0;">mutable</span> deps : dep list;
  abort : abort;
  <span style="color: #a020f0;">mutable</span> num_ops : int;
}

<span style="color: #b22222;">(* </span><span style="color: #b22222;">A dependency can be any future and it will not have the same type as this</span>
<span style="color: #b22222;">   future, so we have to hide the actual type in an existential so we can</span>
<span style="color: #b22222;">   reference any future as a dependency. </span><span style="color: #b22222;">*)</span>
<span style="color: #000000; font-weight: bold;">and</span> <span style="color: #a0522d;">dep</span> = <span style="color: #000000; background-color: #ffffff;">Dep</span> : 'a u -&gt; dep
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-2" class="outline-2">
<h2 id="2">Multicore OCaml: September 2021, effect handlers will be in OCaml 5.0!</h2>
<div class="outline-text-2" id="text-2">
<p>
Archive: <a href="https://discuss.ocaml.org/t/multicore-ocaml-september-2021-effect-handlers-will-be-in-ocaml-5-0/8554/1">https://discuss.ocaml.org/t/multicore-ocaml-september-2021-effect-handlers-will-be-in-ocaml-5-0/8554/1</a>
</p>
</div>

<div id="outline-container-orgd81f2b8" class="outline-3">
<h3 id="orgd81f2b8">Anil Madhavapeddy announced</h3>
<div class="outline-text-3" id="text-orgd81f2b8">
<p>
Welcome to the September 2021 <a href="https://github.com/ocaml-multicore/ocaml-multicore">Multicore OCaml</a> monthly report!
This month's update along with the <a href="https://discuss.ocaml.org/tag/multicore-monthly">previous updates</a> have been
compiled by me, @ctk21, @kayceesrk and @shakthimaan. The team has been working over the past few months to finish the
<a href="https://github.com/ocaml-multicore/ocaml-multicore/projects/4">last few features</a> necessary to reach feature parity
with stock OCaml. We also worked closely with the core OCaml team to develop the timeline for upstreaming Multicore
OCaml to stock OCaml, and have now agreed that:
</p>

<p>
<b><b>OCaml 5.0 will support shared-memory parallelism through domains <span class="underline">and</span> direct-style concurrency through effect
handlers (without syntactic support)</b></b>.
</p>

<ul class="org-ul">
<li>The <a href="https://github.com/ocaml-multicore/parallel-programming-in-multicore-ocaml">Domain mechanism</a> permits OCaml programmers to speed up OCaml code by taking advantage of parallel processing via multiple cores available on modern processors.</li>
<li>Effect handlers allow OCaml programmers to write <a href="https://github.com/ocaml-multicore/eio">high-performance concurrent programs in direct-style</a>, without the use of monadic concurrency as is the case today with the Lwt and Async libraries. Effect handlers also serve as a useful abstraction to build other non-local control-flow abstractions such as <a href="https://github.com/ocaml-multicore/effects-examples/blob/master/generator.ml">generators</a>, <a href="https://github.com/ocaml-multicore/effects-examples/blob/master/sched.ml">lightweight threads</a>, etc. OCaml will be one of <a href="https://arxiv.org/abs/2104.00250">the first industrial-strength languages to support effect handlers</a>.</li>
</ul>

<p>
The new code will have to go through the usual rigorous review process of contributions to upstream OCaml, but we
expect to advance the review process over the next few months.
</p>
</div>

<div id="outline-container-org9a7274f" class="outline-4">
<h4 id="org9a7274f">Recap: what are effect handlers?</h4>
<div class="outline-text-4" id="text-org9a7274f">
<p>
Below is an excerpt from <a href="https://arxiv.org/pdf/2104.00250.pdf">"Retrofitting Effect Handlers onto OCaml"</a>:
</p>

<blockquote>
<p>
Effect handlers provide a modular foundation for user-defined effects. The key idea is to separate the definition
of the effectful operations from their interpretations, which are given by handlers of the effects. For example:
</p>

<div class="org-src-container">
<pre class="src src-ocaml">effect <span style="color: #000000; background-color: #ffffff;">In_line</span> : in_channel -&gt; string
</pre>
</div>

<p>
declares an effect <code>In_line</code>, which is parameterised with an input channel of type <code>in_channel</code>, which when
performed returns a <code>string</code> value. A computation can perform the <code>In_line</code> effect without knowing how the
<code>In_line</code> effect is implemented. This computation may be enclosed by different handlers that handle <code>In_line</code>
differently. For example, <code>In_line</code> may be implemented by performing a blocking read on the input channel or
performing the read asynchronously by offloading it to an event loop such as libuv, without changing the
computation.
</p>

<p>
Thanks to the separation of effectful operations from their implementation, effect handlers enable new approaches
to modular programming. Effect handlers are a generalisation of exception handlers, where, in addition to the
effect being handled, the handler is provided with the delimited continuation of the perform site. This
continuation may be used to resume the suspended computation later. This enables non-local control-flow mechanisms
such as resumable exceptions, lightweight threads, coroutines, generators and asynchronous I/O to be composably
expressed.
</p>
</blockquote>

<p>
The implementation of effect handlers in OCaml are <i>single-shot</i> &#x2013; that is, a continuation can be resumed only once,
and must be explicitly discontinued if not used. This restriction makes for easier reasoning about control flow in
the presence of mutable data structures, and also allows for a high performance implementation.
</p>

<p>
You can read more about effect handlers in OCaml in the <a href="https://arxiv.org/pdf/2104.00250.pdf">full paper</a>.
</p>
</div>
</div>

<div id="outline-container-orgdaee0ac" class="outline-4">
<h4 id="orgdaee0ac">Why is there no syntactic support for effect handlers in OCaml 5.0?</h4>
<div class="outline-text-4" id="text-orgdaee0ac">
<p>
Effect handlers currently in Multicore OCaml do not ensure <a href="https://arxiv.org/abs/2104.00250"><i>effect safety</i></a>. That
is, the compiler will not ensure that all the effects performed by the program are handled. Instead, unhandled
effects lead to exceptions at runtime. Since we plan to extend OCaml with support for an <a href="https://github.com/ocaml/subsystem-meetings/tree/main/effect_system/2021-09-30">effect
system</a> in the future, OCaml 5.0 will
not feature the syntactic support for programming with effect handlers. Instead, we expose the same features through
functions from the standard library, reserving the syntax decisions for when the effect system  lands. The function
based effect handlers is just as expressive as the current syntaxful version in Multicore OCaml. As an example, the
syntax-free version of:
</p>

<div class="org-src-container">
<pre class="src src-ocaml">effect <span style="color: #000000; background-color: #ffffff;">E</span> : string

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">comp</span> () =
  print_string <span style="color: #8b2252;">"0 "</span>;
  print_string (perform <span style="color: #000000; background-color: #ffffff;">E</span>);
  print_string <span style="color: #8b2252;">"3 "</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">main</span> () =
  <span style="color: #a020f0;">try</span>
    comp ()
  <span style="color: #a020f0;">with</span> effect <span style="color: #000000; background-color: #ffffff;">E</span> k -&gt;
    print_string <span style="color: #8b2252;">"1 "</span>;
    continue k <span style="color: #8b2252;">"2 "</span>;
    print_string &#8220;4 <span style="color: #8b2252;">"</span>
</pre>
</div>

<p>
will be:
</p>

<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">type</span> <span style="color: #228b22;">_ eff</span> += <span style="color: #000000; background-color: #ffffff;">E</span> : string eff

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">comp</span> () =
  print_string <span style="color: #8b2252;">"0 "</span>;
  print_string (perform <span style="color: #000000; background-color: #ffffff;">E</span>);
  print_string <span style="color: #8b2252;">"3 "</span>

<span style="color: #000000; font-weight: bold;">let</span> <span style="color: #0000ff;">main</span> () =
  try_with comp ()
  { effc = <span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">e</span> -&gt;
      <span style="color: #a020f0;">match</span> e <span style="color: #a020f0;">with</span>
      | <span style="color: #000000; background-color: #ffffff;">E</span> -&gt; <span style="color: #000000; background-color: #ffffff;">Some</span> (<span style="color: #a020f0;">fun</span> <span style="color: #a0522d;">k</span> -&gt;
          print_string <span style="color: #8b2252;">"1 "</span>;
          continue k <span style="color: #8b2252;">"2 "</span>;
          print_string &#8220;4 &#8220;)
      | e -&gt; <span style="color: #000000; background-color: #ffffff;">None</span> }
</pre>
</div>

<p>
One can imagine writing a ppx extension that enable programmers to write code that is close to the earlier version.
</p>
</div>
</div>

<div id="outline-container-org2d7f39b" class="outline-4">
<h4 id="org2d7f39b">Which opam switch should I use today?</h4>
<div class="outline-text-4" id="text-org2d7f39b">
<p>
The <code>4.12+domains</code> opam switch has <span class="underline">all</span> the features that will go into OCaml 5.0, including the
effect-handlers-as-functions. The exact module under which the functions go will likely change by 5.0, but the basic
form should remain the same.
</p>

<p>
The <code>4.12+domains+effects</code> opam switch will be preserved, but the syntax will not be upstreamed. This switch is
mainly useful to try out the examples of OCaml effect handlers in the academic literature.
</p>

<p>
To learn more about programming using this effect system, see the <a href="https://github.com/ocaml-multicore/eio">eio</a>
library and <a href="https://watch.ocaml.org/videos/watch/74ece0a8-380f-4e2a-bef5-c6bb9092be89">this recent talk</a>. In the
next few weeks, the <code>eio</code> library will be ported to <code>4.12+domains</code> to use the function based effect handlers so that
it is ready for OCaml 5.0.
</p>
</div>
</div>

<div id="outline-container-orgc7d5d04" class="outline-4">
<h4 id="orgc7d5d04">Onto the September 21 update</h4>
<div class="outline-text-4" id="text-orgc7d5d04">
<p>
A number of enhancements have been merged to improve the thread safety of the stdlib, improve the test suite
coverage, along with the usual bug fixes. The documentation for the ecosystem projects has been updated for
readabilty, grammar and consistency. The sandmark-nightly web service is currently being Dockerized to be deployed
for visualising and analysing benchmark results. The Sandmark 2.0-beta branch is also released with the 2.0 features,
and is available for testing and feedback.
</p>

<p>
We would like to acknowledge the following people for their contribution:
</p>
<ul class="org-ul">
<li>@lingmar (Linnea Ingmar) for reporting a segmentation fault in 4.12.0+domains at <code>caml_shared_try_alloc</code>.</li>
<li>@dhil (Daniel Hillerström) provided a patch to remove <code>drop_continuation</code> in the compiler sources.</li>
<li>@nilsbecker (Nils Becker) reported a crash with 14 cores when using Task.pool management.</li>
<li>@cjen1 (Chris Jensen) observed and used ulimit to fix a <code>Unix.ENOMEM</code> error when trying out the Eio README example.</li>
<li>@anuragsoni (Anurag Soni) has contributed an async HTTP benchmark for <code>retro-httpaf-bench</code>.</li>
</ul>

<p>
As always, the Multicore OCaml updates are listed first, which are then followed by the updates from the ecosystem
tools and libraries. The Sandmark-nightly work-in-progress and the Sandmark benchmarking tasks are finally listed for
your reference.
</p>

<p>
<i>Editor’s note: the detailed changelog is omitted, please follow the archive link above to read it.</i>
</p>
</div>
</div>
</div>


<div id="outline-container-org89ac7a3" class="outline-3">
<h3 id="org89ac7a3">Sid asked and Anil Madhavapeddy replied</h3>
<div class="outline-text-3" id="text-org89ac7a3">
<blockquote>
<p>
What is the upcoming OCaml debugging story? Firing up the native executable and debugging using gdb/rr is going to be
difficult because all you will see is low level stuff.
</p>
</blockquote>

<p>
We've gone to some effort to preserve DWARF unwinding correctly in multicore OCaml (see <a href="https://anil.recoil.org/papers/2021-pldi-retroeff.pdf">the effects
paper</a> for more details). You may also want to check the
<a href="https://github.com/ocaml-multicore/ocaml-multicore/wiki/Debugging-the-OCaml-Multicore-runtime">debugging tips and
tricks</a> in the OCaml
multicore wiki which has info on how to use gdb and rr. You do get your functions back as mangled names, but it's
pretty easy to visually map those back to their original OCaml function names by inspection.
</p>
</div>
</div>
</div>




<div id="outline-container-3" class="outline-2">
<h2 id="3">Développeur-euse oCaml - CDI Geneanet - Paris</h2>
<div class="outline-text-2" id="text-3">
<p>
Archive: <a href="https://discuss.ocaml.org/t/developpeur-euse-ocaml-cdi-geneanet-paris/8557/1">https://discuss.ocaml.org/t/developpeur-euse-ocaml-cdi-geneanet-paris/8557/1</a>
</p>
</div>

<div id="outline-container-org3813cf6" class="outline-3">
<h3 id="org3813cf6">Yves RENOUE announced</h3>
<div class="outline-text-3" id="text-org3813cf6">
<p>
Avec plus de 4 millions de membres et 7 milliards d'individus référencés, Geneanet est leader sur le marché de la
généalogie. Dans le cadre de notre croissance, nous recherchons un(e) développeur(euse) OCaml afin de renforcer nos
équipes de développement.
</p>

<p>
DESCRIPTION DU POSTE
</p>

<p>
Vous intégrerez une équipe SCRUM et prendrez part au développement du logiciel OpenSource
<a href="https://github.com/geneweb/geneweb">GeneWeb</a>, qui est au coeur de l’architecture des outils de saisie et de
présentation des généalogies sur Geneanet.
</p>

<p>
Vous pourrez participer à de nombreux projets d’évolution sur les arbres généalogiques (saisie, calculs de parenté,
exports, recherche d’informations), apporter vos idées et votre créativité lors de semaines de labs et prendre en
charge des sujets plus large d’évolution de la plateforme technique.
</p>

<p>
PROFIL REQUIS
</p>

<ul class="org-ul">
<li>Vous promouvez et partagez les valeurs de l'Open Source.</li>
<li>Vous avez une réelle expérience sur l’utilisation du langage OCaml.</li>
<li>Une connaissance des technologies du web (PHP, Mysql, HTML, CSS, Javascript) est requise.</li>
<li>Vous avez le souci de la maintenabilité du code et du service rendu à l’utilisateur final.</li>
<li>Vous aimez travailler en équipe.</li>
<li>Vous êtes éventuellement intéressé(e) par la généalogie, l’Histoire ou les jeux de société à la pause de midi…</li>
</ul>

<p>
Si vous vous reconnaissez dans ce qui précède, envoyez nous votre CV à
recrutement-tech@geneanet.org ! Poste basé à Paris, possibilité de
télétravail 3j/semaine.
</p>
</div>
</div>
</div>




<div id="outline-container-4" class="outline-2">
<h2 id="4">OCaml 4.13.1, a small and early regression fix version</h2>
<div class="outline-text-2" id="text-4">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-4-13-1-a-small-and-early-regression-fix-version/8558/1">https://discuss.ocaml.org/t/ocaml-4-13-1-a-small-and-early-regression-fix-version/8558/1</a>
</p>
</div>

<div id="outline-container-orgeee101c" class="outline-3">
<h3 id="orgeee101c">octachron announced</h3>
<div class="outline-text-3" id="text-orgeee101c">
<p>
We have discovered a regression within OCaml 4.13.0 that make the compiler
crash on classes named <code>row</code>
</p>
<div class="org-src-container">
<pre class="src src-ocaml"><span style="color: #000000; font-weight: bold;">module</span> <span style="color: #228b22;">M</span> = <span style="color: #000000; font-weight: bold;">struct</span>
   <span style="color: #000000; font-weight: bold;">class</span> <span style="color: #0000ff;">row</span> = <span style="color: #000000; font-weight: bold;">object</span> <span style="color: #000000; font-weight: bold;">end</span>
<span style="color: #000000; font-weight: bold;">end</span>
</pre>
</div>
<p>
due to a collision between two families of internal identifiers.
</p>

<p>
To restore your freedom to name classes however you want, we have
released OCaml 4.13.1 as an early bug-fix release.
</p>

<p>
This new version is available as a set of OPAM switches with
</p>
<pre class="example" id="org9f0ee23">
opam update
opam switch create 4.13.1
</pre>
<p>
and as a source download here:
</p>

<p>
<a href="https://caml.inria.fr/pub/distrib/ocaml-4.13">https://caml.inria.fr/pub/distrib/ocaml-4.13</a>
</p>
</div>

<div id="outline-container-orgd6e2454" class="outline-4">
<h4 id="orgd6e2454">Regression fix</h4>
<div class="outline-text-4" id="text-orgd6e2454">
<ul class="org-ul">
<li><a href="https://github.com/ocaml/ocaml/issues/10661">10661</a>, <a href="https://github.com/ocaml/ocaml/issues/10662">10662</a>: fix a bug with classes named "row" (Gabriel Scherer, report and review by Nicolás Ojeda Bär)</li>
</ul>
</div>
</div>
</div>
</div>




<div id="outline-container-5" class="outline-2">
<h2 id="5">Set up OCaml 2.0.0-beta5</h2>
<div class="outline-text-2" id="text-5">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta5/8566/1">https://discuss.ocaml.org/t/ann-set-up-ocaml-2-0-0-beta5/8566/1</a>
</p>
</div>

<div id="outline-container-org6b7baca" class="outline-3">
<h3 id="org6b7baca">Sora Morimoto announced</h3>
<div class="outline-text-3" id="text-org6b7baca">
</div>
<div id="outline-container-orgc230f2d" class="outline-4">
<h4 id="orgc230f2d">Changed</h4>
<div class="outline-text-4" id="text-orgc230f2d">
<ul class="org-ul">
<li>Reduce GitHub API calls to avoid issues that can easily hit rate-limiting.</li>
</ul>
</div>
</div>

<div id="outline-container-org574bc65" class="outline-4">
<h4 id="org574bc65">Fixed</h4>
<div class="outline-text-4" id="text-org574bc65">
<ul class="org-ul">
<li>If no user-input version is found in the opam-repository, explicitly raise an error instead of implicitly breaking the workflow.</li>
<li>Retrieve the base compiler version from opam-repository to use the live released compiler version.</li>
</ul>

<p>
<a href="https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta5">https://github.com/ocaml/setup-ocaml/releases/tag/v2.0.0-beta5</a>
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-6" class="outline-2">
<h2 id="6">Liquidsoap 2.0.0</h2>
<div class="outline-text-2" id="text-6">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ann-liquidsoap-2-0-0/8571/1">https://discuss.ocaml.org/t/ann-liquidsoap-2-0-0/8571/1</a>
</p>
</div>

<div id="outline-container-orgd1f9176" class="outline-3">
<h3 id="orgd1f9176">Romain Beauxis announced</h3>
<div class="outline-text-3" id="text-orgd1f9176">
<p>
It with great excitement and some ~2 years of anticipation that we have now the pleasure to announce the release of
<a href="https://github.com/savonet/liquidsoap/releases/tag/v2.0.0">Liquidsoap 2.0.0</a>!
</p>


<div id="org1867465" class="figure">
<p><img src="https://user-images.githubusercontent.com/871060/135865244-4c858167-ecf6-498e-9f25-f6aac3861a2f.gif" alt="135865244-4c858167-ecf6-498e-9f25-f6aac3861a2f.gif" />
</p>
</div>

<p>
The release is currently being deployed to opam and should be available through their main repository shortly. If you
need to install it right away you can do:
</p>
<pre class="example" id="org772013c">
git clone https://github.com/savonet/liquidsoap.git
cd liquidsoap &amp;&amp; git checkout v2.0.0
opam install -y .
</pre>

<p>
The release also includes binary packages for a bunch of platforms/OSes.
</p>
</div>

<div id="outline-container-orge763994" class="outline-4">
<h4 id="orge763994">🤔  What is liquidsoap?</h4>
<div class="outline-text-4" id="text-orge763994">
<p>
Liquidsoap is a statically-typed, type-inferred, functional scripting language equipped with specialized operators to
build audio and video stream automation.
</p>

<p>
The liquidsoap language offers all the flexibility and expressivity of a fully featured programming language to help
build your media streams.
</p>

<p>
Using liquidsoap, one can very quickly stand up a media streaming platform that can rotate files from playlists,
accept live DJ input, mux audio and video, encode (or not!) and send the resulting data to youtube, icecast, HLS and
more..
</p>
</div>
</div>

<div id="outline-container-org4d03cd5" class="outline-4">
<h4 id="org4d03cd5">:white_check_mark: Why liquidsoap?</h4>
<div class="outline-text-4" id="text-org4d03cd5">
<p>
While there are many tools that offer competing features, the real difference with liquidsoap is its scripting
language.
</p>

<p>
Setting up tools using configuration files is often easier and more straight forward, however, when it comes to the
finer details, such as inserting jingles between shows, defining crossfades between tracks and more, potentially,
each project has its own set of expectations, and this is where liquidsoap becomes really useful!
</p>
</div>
</div>

<div id="outline-container-org9b37bf2" class="outline-4">
<h4 id="org9b37bf2">:zap:️ What's new in Liquidsoap 2.0.0?&#xa0;&#xa0;&#xa0;<span class="tag"><span class="zap">zap</span></span></h4>
<div class="outline-text-4" id="text-org9b37bf2">
<p>
Liquidsoap 2.0.0 brings major improvements in two areas:
</p>
</div>

<div id="outline-container-org9b64c7c" class="outline-5">
<h5 id="org9b64c7c">:film_projector: Video support via ffmpeg</h5>
<div class="outline-text-5" id="text-org9b64c7c">
<p>
While video has been supported for a while, audio remained the primary target of the software. This is all changed
now! In keeping with the tradition of focusing on what we do well and delegating to others what they have expertise
on, we implemented a tight integration of the remarkably awesome ffmpeg API.
</p>

<p>
This has brought to liquidsoap all the exciting features of ffmpeg, including support for multiple input and output
formats, filters and also support for end-to-end encoded content, which allows liquidsoap, when possible, to stream
content without having to re-encode it, a long requested user feature.
</p>

<p>
Our aim with the ffmpeg integration is to become a scripting language built on top of ffmpeg in such ways that, if
something is possible with the ffmpeg command-line, it should be possible with liquidsoap.
</p>

<p>
Meanwhile, the scripting language also provides functionalities based on ffmpeg that are either hard or impossible to
implement using the command-line executable, such as <a href="https://www.liquidsoap.info/doc-2.0.0/ffmpeg_filters.html">fully typed, composable ffmpeg filter
operators</a> and <a href="https://www.liquidsoap.info/doc-2.0.0/cookbook.html">shared
encoding</a>
</p>
</div>
</div>

<div id="outline-container-org66624fd" class="outline-5">
<h5 id="org66624fd">:gear: Expanded language features</h5>
<div class="outline-text-5" id="text-org66624fd">
<p>
With this release, the liquidsoap language is expanded, introducing multiple features much needed for the comfort of
the programmer such as:
</p>
<ul class="org-ul">
<li>Module and records, allow to attach method to variables</li>
<li>Exception handling</li>
<li>Support for structured data, tuples and etc.</li>
</ul>

<p>
Along with these changes, we have released <a href="https://www.liquidsoap.info/doc-dev/book.html">The Liquidsoap Book</a>,
which we hope will help users of all skill level to work with the liquidsoap language and streaming projects.
</p>

<p>
But we are not stopping here! We have even more exciting features in store for the liquidsoap language, some of them
already committed to the main development branch.
</p>
</div>
</div>
</div>

<div id="outline-container-org4a546ef" class="outline-4">
<h4 id="org4a546ef">:children_crossing: Roadmap and versioning</h4>
<div class="outline-text-4" id="text-org4a546ef">
<p>
Our roadmap consists of:
</p>
</div>

<div id="outline-container-org4fcec38" class="outline-5">
<h5 id="org4fcec38">:construction: Bugfix releases</h5>
<div class="outline-text-5" id="text-org4fcec38">
<p>
While we are satisfied with the current <code>2.0.0</code> release and believe it is safe to use for production-ready work,
software projects are never free of bugs so we will keep improving on the current stable branch.
</p>

<p>
Stable releases are numbered using the patch part of their version, i.e. <code>2.0.x</code>. However, when it comes to
liquidsoap, it is important to keep in mind that some of our operators have complex behavior and interactions with
each other. While we do our best to maintain backward compatibility between bugfix versions, we always recommend to
test them in a staging area before pushing them to production.
</p>

<p>
Our workflow for reporting bugs is via github's <a href="https://github.com/savonet/liquidsoap/issues">issues tracker</a>. This
is our preferred way to keep track of issues, discuss them and mark them as fixed. If you have questions related to
setting up your script, installing liquidsoap and etc, you can also start a
<a href="https://github.com/savonet/liquidsoap/discussions">discussion</a>. In some cases, issues get transfer to discussions as
we see fit and, also, discussions can in fact lead to reporting an associated issues.
</p>

<p>
We do encourage all reports as we find a lot of value in our users feedback. We try to respond to all of them
diligently but we also appreciated your patience.
</p>
</div>
</div>

<div id="outline-container-orge202b56" class="outline-5">
<h5 id="orge202b56">:bulb: Future major release</h5>
<div class="outline-text-5" id="text-orge202b56">
<p>
While we were busy stabilizing the current stable branch, we couldn't resist working on new features! So far, it
looks like the next major release will focus on expanding the language's capabilities with features such as:
</p>
<ul class="org-ul">
<li>Support for variable in encoders</li>
<li>Generalized extraction patterns</li>
<li>First-class module system</li>
<li>Vastly improved support for json parsing and rendering</li>
<li>Type-system flexibility improvements</li>
</ul>

<p>
A vision that we have is to bring the liquidsoap language to the same flexibility and type-safety as languages such
as TypesScript but with inferred types so you never have to write them (99% of the time..)! :slightly_smiling_face:
</p>
</div>
</div>
</div>

<div id="outline-container-orgbc35925" class="outline-4">
<h4 id="orgbc35925">🚀 Need help?</h4>
<div class="outline-text-4" id="text-orgbc35925">
<p>
If you need help with your liquidsoap project, you can join our online chat room, which is currently hosted on
<a href="http://slack.liquidsoap.info/">slack</a>. We also provide professional support. Holler at us if you are in such need
we'd love to see how we can help as well!
</p>
</div>
</div>
</div>
</div>




<div id="outline-container-7" class="outline-2">
<h2 id="7">OCaml code snippets proposed as CC-BY-SA 4.0 candidates</h2>
<div class="outline-text-2" id="text-7">
<p>
Archive: <a href="https://discuss.ocaml.org/t/ocaml-code-snippets-proposed-as-cc-by-sa-4-0-candidates/8572/1">https://discuss.ocaml.org/t/ocaml-code-snippets-proposed-as-cc-by-sa-4-0-candidates/8572/1</a>
</p>
</div>

<div id="outline-container-org39ca4ab" class="outline-3">
<h3 id="org39ca4ab">Damien Guichard announced</h3>
<div class="outline-text-3" id="text-org39ca4ab">
<p>
The idea is quite simple. There are many people lurking here that wish to write an OCaml book or tutorial or
blogpost, however :
</p>
<ul class="org-ul">
<li>either they miss the most illustrative ocaml code snippet</li>
<li>or they know what the best code is but there is a (potential) Statement of Rights violation</li>
</ul>

<p>
I want to help these people, starting with @dmbaturin and <a href="https://ocamlbook.org/">OCaml From the Ground Up</a>.
I will publish here my own code as <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA 4.0</a>.
Also i will link to resources that are known to be CC-BY-SA 4.0-compatible.
And i invite you to post your own code as CC-BY-SA 4.0 so that it can be inspiring and used in educational material.
</p>

<p>
<i>Editor’s note: this message was followed by many code snippets. Please follow the archive link above to read them.</i>
</p>
</div>
</div>
</div>




<div id="outline-container-orgf007647" class="outline-2">
<h2 id="orgf007647">Old CWN</h2>
<div class="outline-text-2" id="text-orgf007647">
<p>
If you happen to miss a CWN, you can <a href="mailto:alan.schmitt@polytechnique.org">send me a message</a> and I'll mail it to you, or go take a look at <a href="https://alan.petitepomme.net/cwn/">the archive</a> or the <a href="https://alan.petitepomme.net/cwn/cwn.rss">RSS feed of the archives</a>.
</p>

<p>
If you also wish to receive it every week by mail, you may subscribe <a href="http://lists.idyll.org/listinfo/caml-news-weekly/">online</a>.
</p>

<div class="authorname" id="org7d85083">
<p>
<a href="https://alan.petitepomme.net/">Alan Schmitt</a>
</p>

</div>
</div>
</div>
</div>
</body>
</html>
